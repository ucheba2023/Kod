(()=>{"use strict";var t,e,i={571058:(t,e,i)=>{i.d(e,{EasterEggs:()=>u});var n=i(795558),o=i(664988),a=i(953908),s=i(957973),r=i(193452),d=i(584356),c=i(68003),l=i(321850),h=i(931917);const u={URL:"easter-eggs",ACT_POPUP:"getPopup",ACT_FOUND_EGG:"foundEgg",ACT_HIDE_EVENT:"hideEvent",ACT_EASTER_EGGS:"getEasterEggs",ACT_PERFORM_ACTION:"performAction",frames:{},activeAnimations:{},_loadAnimator:()=>Promise.all([i.e(38288),i.e(55489)]).then(i.bind(i,682832)).then((t=>t.lottie)),_init:function(t){this.eggs=t,this._checkContainer(),this._setEggs(),this._setCurEvents()},_setCurEvents:function(){this.curSet||(this.curSet=!0,window.cur._back?(window.cur._back.hide&&window.cur._back.hide.push(this._flush.bind(this)),window.cur._back.show&&(window.cur._back.show.push(this._flush.bind(this)),window.cur._back.show.push(this.updateEggs.bind(this)))):(0,l.pushNavDestroy)((()=>this._flush())))},_flush:function(t){if(this.activeAnimations)for(let e in this.activeAnimations)if(this.activeAnimations.hasOwnProperty(e)){const i=e.split("_");(0,o.isNumeric)(t)&&t!==parseInt(i[0])||(this.activeAnimations[e].stop(),this.activeAnimations[e].destroy(),delete this.activeAnimations[e])}if(this.frames)for(let e in this.frames)if(this.frames.hasOwnProperty(e)){const i=e.split("_");(0,o.isNumeric)(t)&&t!==parseInt(i[0])||((0,a.removeEvent)(this.frames[e],"click"),(0,a.removeEvent)((0,n.geByClass)("EasterEggFrame__hideEvent",this.frames[e]),"click"),this.frames[e].parentNode.removeChild(this.frames[e]),delete this.frames[e])}this.container&&(this.container.innerHTML=""),this.frames=[],this.activeAnimations=[]},_checkContainer:function(){this.container||(this.container=document.body.appendChild((0,n.ce)("div",{className:"EasterEggsContainer",innerHTML:""})))},_setEggs:function(){this.eggs&&this.eggs.forEach((t=>{t.positions&&t.positions.length&&t.positions.forEach((e=>{this._validPosition(e.url_regexp)&&(this.player?this._appendEasterEgg(e,t):this._loadAnimator().then((i=>{this.player=i,this._appendEasterEgg(e,t)})))}))}))},_validPosition:function(t){if(t=(t||"").replace(/(^#)|(#$)/g,""))try{const e=new RegExp(t),i=this._getNormalizedUrl();return e.test(i)}catch(t){return!1}return!1},_getNormalizedUrl(){switch(window.cur.module){case"profile":return"/id"+(window.cur.oid||0);case"groups":return"/club"+(void 0===window.cur.oid?0:-window.cur.oid);default:return location.pathname}},_appendEasterEgg:function(t,e){var i,r;(null==(i=e.animation)?void 0:i.url)&&this._getAnimation(null==(r=e.animation)?void 0:r.url).then((i=>{var r,d;const c=document.createElement("div");c.className="EasterEggFrame",(0,a.addEvent)(c,"click",function i(){(0,a.removeEvent)(c,"click",i),this.onFrameClick({eggId:e.id,eggEventId:e.event_id,positionId:t.position_id,hash:t.hash,url:e.url,clickAnimation:e.click_animation})}.bind(this));const l=document.createElement("div");var h,u;(l.className="EasterEggFrame__hideEvent",(0,a.addEvent)(l,"click",(i=>{(0,a.stopEvent)(i),this.onHideClick({eventId:e.event_id,eggId:e.id,positionId:t.position_id})})),(0,o.isNumeric)(t.appearance.top)?(0,n.setStyle)(c,{top:t.appearance.top}):(0,o.isNumeric)(t.appearance.bottom)&&(0,n.setStyle)(c,{bottom:t.appearance.bottom}),(0,o.isNumeric)(t.appearance.left)?((0,n.setStyle)(c,{left:t.appearance.left}),(0,n.setStyle)(l,{right:0})):(0,o.isNumeric)(t.appearance.right)&&((0,n.setStyle)(c,{right:t.appearance.right}),(0,n.setStyle)(l,{left:0})),t.appearance.fixed&&(0,n.setStyle)(c,{position:"absolute"}),null==(r=e.animation)?void 0:r.width)&&(0,n.setStyle)(c,{width:null==(h=e.animation)?void 0:h.width});(null==(d=e.animation)?void 0:d.height)&&(0,n.setStyle)(c,{height:null==(u=e.animation)?void 0:u.height});c.appendChild(l);let p=null;t.appearance.container&&(p=document.querySelector(t.appearance.container)),p?p.appendChild(c):this.container.appendChild(c),c.style.display="block";const g=this.player.loadAnimation({container:c,renderer:"svg",loop:!0,autoplay:!0,animationData:i}),m=e.id+"_"+t.position_id;this.frames[m]=c,this.activeAnimations[m]=g,this.sendStats(s.IEasterEggsItemEventType.EGG_SHOW,e.id,e.event_id,t.position_id)}))},_runClickAnimation(t,e,i,o){var a,s;const r=t+"_"+e,d=this.frames[r];let l=this.activeAnimations[r];var h,u;(l&&(l.stop(),l.destroy()),49===t&&c.colorScheme.setMode(c.ColorSchemeMode.Dark),null==(a=i)?void 0:a.width)&&(0,n.setStyle)(d,{width:null==(h=i)?void 0:h.width});(null==(s=i)?void 0:s.height)&&(0,n.setStyle)(d,{height:null==(u=i)?void 0:u.height});l=this.player.loadAnimation({container:d,renderer:"svg",loop:!1,autoplay:!0,animationData:o}),this.activeAnimations[r]=l},_getAnimation:function(t){return new Promise(((e,i)=>{const n=new XMLHttpRequest;n.open("GET",t,!0),n.send(),n.onreadystatechange=()=>{if(4===n.readyState)try{const t=JSON.parse(n.responseText);e(t)}catch(t){i()}}}))},onFrameClick:function(t){if(!(0,o.isNumeric)(t.eggId)||!(0,o.isNumeric)(t.positionId))return;const e=()=>{this._foundEgg(t.eggId,t.positionId,t.hash,(()=>{if(this._flush(t.eggId),t.url)return window.nav.go(t.url);this._showPopup(t.eggId,t.eggEventId,t.positionId)}))};var i;t.clickAnimation&&t.clickAnimation.url?this._getAnimation(null==(i=t.clickAnimation)?void 0:i.url).then((i=>{var n;this._runClickAnimation(t.eggId,t.positionId,t.clickAnimation,i),setTimeout(e,(null==(n=t.clickAnimation)?void 0:n.duration)||0)})):e()},onHideClick:function(t){window.ajax.post(this.URL,{act:this.ACT_HIDE_EVENT,event_id:t.eventId,egg_id:t.eggId,position_id:t.positionId},{onDone:()=>{this.updateEggs()},onFail:()=>!0})},_foundEgg:function(t,e,i,n){window.ajax.post(this.URL,{act:this.ACT_FOUND_EGG,egg_id:t,position_id:e,position_hash:i},{onDone:()=>{this.updateEggs(),n&&n()},onFail:()=>!0})},updateEggs:function(){this._flush(),window.ajax.post(this.URL,{act:this.ACT_EASTER_EGGS,url:window.location.pathname},{onDone:t=>{t&&this._init(t)},onFail:()=>!0})},_showPopup:function(t,e,i){h.Ranges.isUserId(window.vk.id)&&window.ajax.post(this.URL,{act:this.ACT_POPUP,egg_id:t},{onDone:(n,o,a)=>{if(!o)return;if("function"!=typeof window.MessageBox)return;const r=new window.MessageBox({title:n,hideButtons:!0,needShadow:!1,containerClass:"ImageStatusPopup__container",onShow:()=>{this.sendStats(s.IEasterEggsItemEventType.POPUP_SHOW,t,e,i),this.curBoxData={eggId:t,eggEventId:e,positionId:i}},onDestroy:()=>{this.curBoxData={}}});r.content(o),r.show(),setTimeout((()=>{r.evalBox(a,this.URL,{act:this.ACT_POPUP})}))},onFail:()=>!0})},sendStats:function(t,e=0,i=0,n=0){t===s.IEasterEggsItemEventType.POPUP_ACTION&&this.curBoxData&&(e=this.curBoxData.eggId,i=this.curBoxData.eggEventId,n=this.curBoxData.positionId),r.easterEggsItemStat.logEvent(e,i,n,t)},performAction:function(t,e){e.preventDefault(),this.sendStats(s.IEasterEggsItemEventType.POPUP_ACTION),t&&window.ajax.post(this.URL,{act:this.ACT_PERFORM_ACTION,jwt:t},{onDone:()=>{var t;return null==(t=(0,d.curBox)())||t.hide(),!0},onFail:()=>{var t;return null==(t=(0,d.curBox)())||t.hide(),!0}})},setLightTheme(t){var e;t.preventDefault(),this.sendStats(s.IEasterEggsItemEventType.POPUP_ACTION),null==(e=(0,d.curBox)())||e.hide(),c.colorScheme.setMode(c.ColorSchemeMode.Light)}}},766751:(t,e,i)=>{var n,o,a,s=i(571058);(null==(o=window.vk)||null==(n=o.pe)?void 0:n.static_manager_dynamic_imports)&&(null==(a=window.vk)?void 0:a.stDomain)&&(i.p=window.vk.stDomain+"/dist/"),window.EasterEggs=s.EasterEggs;try{window.stManager.done(window.jsc("web/easter_eggs.js"))}catch(t){}}},n={};function o(t){var e=n[t];if(void 0!==e)return e.exports;var a=n[t]={exports:{}};return i[t].call(a.exports,a,a.exports,o),a.exports}o.m=i,o.amdO={},t=[],o.O=(e,i,n,a)=>{if(!i){var s=1/0;for(l=0;l<t.length;l++){for(var[i,n,a]=t[l],r=!0,d=0;d<i.length;d++)(!1&a||s>=a)&&Object.keys(o.O).every((t=>o.O[t](i[d])))?i.splice(d--,1):(r=!1,a<s&&(s=a));if(r){t.splice(l--,1);var c=n();void 0!==c&&(e=c)}}return e}a=a||0;for(var l=t.length;l>0&&t[l-1][2]>a;l--)t[l]=t[l-1];t[l]=[i,n,a]},o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((e,i)=>(o.f[i](t,e),e)),[])),o.u=t=>38288===t?"lottie.5e4758c39f106eab733a.js":55489===t?"lottie-light.319fff4bb343e96ef290.js":void 0,o.miniCssF=t=>{},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),e={},o.l=(t,i,n,a)=>{if(e[t])e[t].push(i);else{var s,r;if(void 0!==n)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var l=d[c];if(l.getAttribute("src")==t||l.getAttribute("data-webpack")=="vk:"+n){s=l;break}}s||(r=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack","vk:"+n),s.src=t),e[t]=[i];var h=(i,n)=>{s.onerror=s.onload=null,clearTimeout(u);var o=e[t];if(delete e[t],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((t=>t(n))),i)return i(n)},u=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),r&&document.head.appendChild(s)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.p="/dist/",(()=>{var t={77265:0};o.f.j=(e,i)=>{var n=o.o(t,e)?t[e]:void 0;if(0!==n)if(n)i.push(n[2]);else{var a=new Promise(((i,o)=>n=t[e]=[i,o]));i.push(n[2]=a);var s=o.p+o.u(e),r=new Error;o.l(s,(i=>{if(o.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var a=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;r.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",r.name="ChunkLoadError",r.type=a,r.request=s,n[1](r)}}),"chunk-"+e,e)}},o.O.j=e=>0===t[e];var e=(e,i)=>{var n,a,[s,r,d]=i,c=0;if(s.some((e=>0!==t[e]))){for(n in r)o.o(r,n)&&(o.m[n]=r[n]);if(d)var l=d(o)}for(e&&e(i);c<s.length;c++)a=s[c],o.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return o.O(l)},i=self.webpackChunkvk=self.webpackChunkvk||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var a=o.O(void 0,[75514,68592],(()=>o(766751)));a=o.O(a)})();