"use strict";(self.webpackChunkvk=self.webpackChunkvk||[]).push([[93786],{189214:(e,t,r)=>{function o(e){var t=new Date;return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function a(e){return o(new Date(e.getTime()+864e5))}function n(e){return o(new Date(e.getTime()-864e5))}r.d(t,{isToday:()=>o,isTomorrow:()=>n,isYesterday:()=>a})},939008:(e,t,r)=>{r.d(t,{initLang:()=>a,langNumeric:()=>s,langSex:()=>n,langWordNumeric:()=>i});var o;r(189214);function a(e){e.source,o=e.config}function n(e,t){if(!Array.isArray(t))return t;var r=o(),a=t[1];return r?(r.sexRules.some((function(r){return"*"===r[0]||e==r[0]&&t[r[1]]?(a=t[r[1]],!0):void 0})),a):a}function s(e,t,r){var a,n=o();if(!t||!n)return e;Array.isArray(t)?(a=t[1],e!==Math.floor(e)?a=t[n.numRules.float]:n.numRules.int.some((function(r){if("*"===r[0])return a=t[r[2]],!0;var o=r[0]?e%r[0]:e;return Array.isArray(r[1])&&-1!==r[1].indexOf(o)?(a=t[r[2]],!0):void 0}))):a=t;var s=e+"";if(r){for(var i=e.toString().split("."),c=[],u=i[0].length-3;u>-3;u-=3)c.unshift(i[0].slice(u>0?u:0,u+3));i[0]=c.join(n.numDel),s=i.join(n.numDec)}return a=(a||"%s").replace("%s",s)}function i(e,t,r){return Array.isArray(t)&&e<t.length?t[e]:s(e,r)}},216799:()=>{},816405:(e,t,r)=>{r.d(t,{API_VERSION:()=>o});const o="5.221"},606972:(e,t,r)=>{r.d(t,{createBrowserHistory:()=>c,createMemoryHistory:()=>u,parsePath:()=>g});var o,a=r(487462);!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(o||(o={}));var n=function(e){return e};var s="beforeunload",i="popstate";function c(e){void 0===e&&(e={});var t=e.window,r=void 0===t?document.defaultView:t,c=r.history;function u(){var e=r.location,t=e.pathname,o=e.search,a=e.hash,s=c.state||{};return[s.idx,n({pathname:t,search:o,hash:a,state:s.usr||null,key:s.key||"default"})]}var l=null;r.addEventListener(i,(function(){if(l)P.call(l),l=null;else{var e=o.Pop,t=u(),r=t[0],a=t[1];if(P.length){if(null!=r){var n=v-r;n&&(l={action:e,location:a,retry:function(){S(-1*n)}},S(n))}}else C(e)}}));var _=o.Pop,f=u(),v=f[0],k=f[1],R=d(),P=d();function y(e){return"string"==typeof e?e:p(e)}function I(e,t){return void 0===t&&(t=null),n((0,a.default)({pathname:k.pathname,hash:"",search:""},"string"==typeof e?g(e):e,{state:t,key:m()}))}function w(e,t){return[{usr:e.state,key:e.key,idx:t},y(e)]}function b(e,t,r){return!P.length||(P.call({action:e,location:t,retry:r}),!1)}function C(e){_=e;var t=u();v=t[0],k=t[1],R.call({action:_,location:k})}function S(e){c.go(e)}null==v&&(v=0,c.replaceState((0,a.default)({},c.state,{idx:v}),""));var $={get action(){return _},get location(){return k},createHref:y,push:function e(t,a){var n=o.Push,s=I(t,a);if(b(n,s,(function(){e(t,a)}))){var i=w(s,v+1),u=i[0],l=i[1];try{c.pushState(u,"",l)}catch(e){r.location.assign(l)}C(n)}},replace:function e(t,r){var a=o.Replace,n=I(t,r);if(b(a,n,(function(){e(t,r)}))){var s=w(n,v),i=s[0],u=s[1];c.replaceState(i,"",u),C(a)}},go:S,back:function(){S(-1)},forward:function(){S(1)},listen:function(e){return R.push(e)},block:function(e){var t=P.push(e);return 1===P.length&&r.addEventListener(s,h),function(){t(),P.length||r.removeEventListener(s,h)}}};return $}function u(e){void 0===e&&(e={});var t=e,r=t.initialEntries,s=void 0===r?["/"]:r,i=t.initialIndex,c=s.map((function(e){return n((0,a.default)({pathname:"/",search:"",hash:"",state:null,key:m()},"string"==typeof e?g(e):e))})),u=l(null==i?c.length-1:i,0,c.length-1),h=o.Pop,_=c[u],f=d(),v=d();function k(e,t){return void 0===t&&(t=null),n((0,a.default)({pathname:_.pathname,search:"",hash:""},"string"==typeof e?g(e):e,{state:t,key:m()}))}function R(e,t,r){return!v.length||(v.call({action:e,location:t,retry:r}),!1)}function P(e,t){h=e,_=t,f.call({action:h,location:_})}function y(e){var t=l(u+e,0,c.length-1),r=o.Pop,a=c[t];R(r,a,(function(){y(e)}))&&(u=t,P(r,a))}var I={get index(){return u},get action(){return h},get location(){return _},createHref:function(e){return"string"==typeof e?e:p(e)},push:function e(t,r){var a=o.Push,n=k(t,r);R(a,n,(function(){e(t,r)}))&&(u+=1,c.splice(u,c.length,n),P(a,n))},replace:function e(t,r){var a=o.Replace,n=k(t,r);R(a,n,(function(){e(t,r)}))&&(c[u]=n,P(a,n))},go:y,back:function(){y(-1)},forward:function(){y(1)},listen:function(e){return f.push(e)},block:function(e){return v.push(e)}};return I}function l(e,t,r){return Math.min(Math.max(e,t),r)}function h(e){e.preventDefault(),e.returnValue=""}function d(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter((function(e){return e!==t}))}},call:function(t){e.forEach((function(e){return e&&e(t)}))}}}function m(){return Math.random().toString(36).substr(2,8)}function p(e){var t=e.pathname,r=void 0===t?"/":t,o=e.search,a=void 0===o?"":o,n=e.hash,s=void 0===n?"":n;return a&&"?"!==a&&(r+="?"===a.charAt(0)?a:"?"+a),s&&"#"!==s&&(r+="#"===s.charAt(0)?s:"#"+s),r}function g(e){var t={};if(e){var r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));var o=e.indexOf("?");o>=0&&(t.search=e.substr(o),e=e.substr(0,o)),e&&(t.pathname=e)}return t}},451116:(e,t,r)=>{r.d(t,{VKME_VKCALL_CONTAINER_ID:()=>R,VkComRouter:()=>f,createFeatureFlags:()=>g,createLang:()=>_,isMasterTab:()=>v,isStandaloneProd:()=>P});var o=r(434788),a=r(316037),n=r(152136),s=r(866421),i=(r(216799),r(839470)),c=r(301230),u=r(652027),l=r(514986),h=r(95432),d=r(10781),m=r(29271),p=r(931917);function g(){const e={helloStickersPack:[21,12467,53098,50456,50459,18164,134,51117,16263,4275,6329,12296,21560,13312,20952,56896,20465,11607,53320,53647],helloKeywordPack:(null==(r=window.stickersKeywords)||null==(t=r["привет"])?void 0:t.filter((e=>e>0)))||[]};var t,r;return(0,o._)({},a.DEFAULT_FEATURE_FLAGS,{me_fc_multiple_windows:!0,me_fc_tooltips:!0,me_sticker_packs:e,me_fc_simple_composer:(0,i.partConfigEnabled)("me_fc_simple_composer"),me_fc_message_actions:(0,i.partConfigEnabled)("me_fc_message_actions"),me_message_selecting:(0,i.partConfigEnabled)("me_message_selecting"),vkm_hide_forward_author:(0,i.partConfigEnabled)("vkm_hide_forward_author"),vkm_send_promoted_stickers:(0,i.partConfigEnabled)("stickers_can_send_unpurchased_stickers"),vkm_convo_profile:!!(0,i.partConfigEnabled)("vkm_reforged_in_vkcom")||(0,i.partConfigEnabled)("vkm_convo_profile"),vkm_mediascope_collect:(0,i.partConfigEnabled)("messenger_mediascope_stats_collect"),vkm_widget_attaches:(0,i.partConfigEnabled)("vkm_widget_attaches"),vkm_reactions:(0,i.partConfigEnabled)("vkm_reactions"),vkm_extended_reaction_picker:(0,i.partConfigEnabled)("vkm_extended_reaction_picker"),vkm_marusia_chat:(0,i.partConfigEnabled)("vkm_marusia_chat"),vkm_marusia_pinned:(0,i.partConfigEnabled)("vkm_marusia_pinned"),vkm_settings:!!(0,i.partConfigEnabled)("vkm_reforged_in_vkcom")||a.DEFAULT_FEATURE_FLAGS.vkm_settings})}function _(e){const t=[m.getLang("month1","raw"),m.getLang("month2","raw"),m.getLang("month3","raw"),m.getLang("month4","raw"),m.getLang("month5","raw"),m.getLang("month6","raw"),m.getLang("month7","raw"),m.getLang("month8","raw"),m.getLang("month9","raw"),m.getLang("month10","raw"),m.getLang("month11","raw"),m.getLang("month12","raw")],r=Object.values(m.getLang("months_of","raw")),a=Object.values(m.getLang("months_sm_of","raw")),s=[m.getLang("global_monday","raw"),m.getLang("global_tuesday","raw"),m.getLang("global_wednesday","raw"),m.getLang("global_thursday","raw"),m.getLang("global_friday","raw"),m.getLang("global_saturday","raw"),m.getLang("global_sunday","raw")],i=[m.getLang("global_monday_short","raw"),m.getLang("global_tuesday_short","raw"),m.getLang("global_wednesday_short","raw"),m.getLang("global_thursday_short","raw"),m.getLang("global_friday_short","raw"),m.getLang("global_saturday_short","raw"),m.getLang("global_sunday_short","raw")];return new n.Lang(e,{keys:(0,o._)({},window.lang,{global_months:t,global_months_of:r,global_months_short_of:a,global_week_days:s,global_week_days_short:i}),config:window.langConfig})}class f extends s.Router{toUrl(e){switch(e.kind){case"HashtagProxyRoute":case"HashtagMentionProxyRoute":case"ScreenNameProxyRoute":case"AttachProxyRoute":return super.toUrl(e);case"AttachMediaProxyRoute":switch(e.attach.kind){case"Photo":{const t=e.attach.accessKey?`/${e.attach.accessKey}`:"";return`/im?z=photo${e.attach.ownerId}_${e.attach.id}${t}`}case"Video":{const t=e.attach.accessKey?`/${e.attach.accessKey}`:"";return`/im?z=video${e.attach.ownerId}_${e.attach.id}${t}`}default:return k(e.attach),null}case"PeerModalRoute":{const{peerId:t}=e;if((0,i.partConfigEnabled)("vkm_reforged_in_vkcom")&&this.isIm){const t=super.toUrl(e);return t?this.applyVkmeUrlQueryParam(t):t}return p.Ranges.isUserIdTransitional(t)?`/id${t}`:p.Ranges.isGroupId(t)?`/club${Math.abs(t)}`:p.Ranges.isContactId(t)?"/im?sel=mr"+(t-1e9):`/im?sel=${t}`}case"PollModalRoute":{const{pollId:t,ownerId:r}=e;return`/im?w=poll${r}_${t}`}case"MiniAppModalRoute":return`/app${e.miniAppId}${e.hash?`#${e.hash}`:""}`;case"SettingsRoute":if((0,i.partConfigEnabled)("vkm_reforged_in_vkcom")){const t=super.toUrl(e);return t?this.applyVkmeUrlQueryParam(t)+"&act=settings":t}return super.toUrl(e);case"ConvoRoute":if(e.search){if((0,i.partConfigEnabled)("vkm_reforged_in_vkcom")){const t=super.toUrl(e);return t?this.applyVkmeUrlQueryParam(t):t}return`/im?sel=${e.peerId}&st=${encodeURIComponent(e.search)}`}default:if((0,i.partConfigEnabled)("vkm_reforged_in_vkcom")){const t=super.toUrl(e);return t?this.applyVkmeUrlQueryParam(t):t}return super.toUrl(e)}}constructor(e,...t){super(...t),this.applyVkmeUrlQueryParam=e=>`im?vkme_url=${encodeURIComponent(e)}`,this.fromExternalUrl=e=>this.fromUrl(e),this.openLink=(e,t)=>{let r=null;if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)){switch(t.kind){case"AttachMediaProxyRoute":{e.preventDefault();const r=t.attach;switch(r.kind){case"Photo":var o;const a="c_uniq_tag",n={},s="vkcomIntegrationAdditionalParam"in t&&t.vkcomIntegrationAdditionalParam;let i;const c=Boolean("message"===(null==(o=t.source)?void 0:o.kind)&&s),l=(c?r.vkcomWebViewToken:r.messageAccessKey)||r.messageAccessKey||r.accessKey||"";if(r.sizes.forEach(((e,t)=>{const r=new URLSearchParams(e.url);r.delete(a);const o=decodeURIComponent(r.toString());n[t]=o,n[`${t}_`]=[o,e.width,e.height]})),c&&s){const e=[];i=s.reduce(((e,t)=>(e.push(`${t.ownerId}_${t.id}/${t.vkcomWebViewToken}`),e)),e).join(";")}return void(0,h.showPhoto)(`${r.ownerId}_${r.id}`,l,{additional:{draft_photos:i},temp:n,queue:1},e.nativeEvent);case"Video":return void(0,u.showVideo)(`${r.ownerId}_${r.id}`,r.accessKey||"",{autoplay:1,minimized:0,module:"",queue:1},e.nativeEvent);default:k(r)}break}case"AttachProxyRoute":{const o=t.attach;switch(o.kind){case"Poll":return e.preventDefault(),void(0,h.showWiki)({w:`poll${o.ownerId}_${o.id}`},!1,e.nativeEvent,{queue:1});case"Story":return e.preventDefault(),void(0,d.showStory)(`story${o.ownerId}_${o.id}/${o.ownerId}_${o.id}`);case"Gift":return e.preventDefault(),o.isStickerStyle&&o.id?window.Emoji.clickSticker(Math.abs(o.id)):void(0,l.showBox)("al_gifts.php",{act:"box",tab:"sent",mid:window.vk.id},{cache:1,stat:["page.css","gifts.css",window.jsc("web/gifts.js")]});case"MoneyTransfer":return e.preventDefault(),void(0,l.showBox)("al_payments.php?act=money_transfer_history_box",{});case"Geo":return e.preventDefault(),void(0,l.showBox)("al_places.php",{act:"show_photo_place",lat:o.coordinates.latitude,long:o.coordinates.longitude,provider:4});case"Link":return;default:r=this.toUrl(t)}break}case"MiniAppModalRoute":{const r=this.toUrl(t);return void(r&&(e.preventDefault(),(0,h.showWiki)({w:r.replace("/",""),app_ref:"snippet_im"},!1,e.nativeEvent)))}case"PollModalRoute":{e.preventDefault();const{pollId:r,ownerId:o}=t;return void(0,h.showWiki)({w:`poll${o}_${r}`},!1,e.nativeEvent,{queue:1})}case"HashtagProxyRoute":case"HashtagMentionProxyRoute":case"ScreenNameProxyRoute":default:r=this.toUrl(t);break;case"PhotoModalRoute":{e.preventDefault();const{ownerId:r,id:o,accessKey:a}=t;return void(0,h.showPhoto)(`${r}_${o}`,a,{},e.nativeEvent)}}r&&(e.preventDefault(),window.nav.go(r))}},this.isIm=e}}function v(){return!window.curNotifier||window.curNotifier.is_server||c.browser.safari}function k(e){throw new Error("Exhaustivness failure! This should never happen.")}const R="callsApp";function P(){return"web.vk.me"===window.location.hostname}},152136:(e,t,r)=>{r.d(t,{Lang:()=>l});var o=r(434788),a=r(939008),n=r(659397),s=r(997864),i=r.n(s),c=r(89131);const u="reforged-lang-debug";class l{constructor(e,t){this.isDebug=!1,this.decodedKeys={},this.toggleDebug=()=>{this.isDebug=!this.isDebug;try{this.isDebug?localStorage.setItem(u,"true"):localStorage.removeItem(u)}catch(e){}window.location.reload()},this.use=(e,...t)=>this.fold(e,(e=>e),(e=>e.join("")),...t),this.fold=(e,t,r,...n)=>{if(this.isDebug)return t(e);try{const s=n[0];let i=this.getTemplate(e);if(!i)return t(e);if(!s)return Array.isArray(i)?t(e):t(i);if("num"in s)s.values=(0,o._)({formatted:this.formatNumber(s.num,s.formatted)},s.values||{}),"short"===s.formatted&&(s.num=Math.min(1e3,s.num)),i="fallback"in s?(0,a.langWordNumeric)(s.num,i,this.getTemplate(s.fallback)).toString():(0,a.langNumeric)(s.num,i).toString();else if("sex"in s){const e={female:"1",male:"2",unknown:"*"};i=(0,a.langSex)(e[s.sex],i)}else if("now"in s){const e=new Date(s.now),t=new Date(s.date);i=m(e,t)?i[3]:function(e,t){const r=new Date(t.getTime()+d);return m(e,r)}(e,t)?i[2]:function(e,t){const r=new Date(t.getTime()-d);return m(e,r)}(e,t)?i[4]:i[1],s.values=(0,o._)({},this.splitDate(t,{shortMonths:s.shortMonths,genMonths:s.genMonths,capMonths:s.capMonths,shortWeekdays:s.shortWeekdays}),s.values||{})}if(Array.isArray(i)||!i)return t(e);if("values"in s&&Object.keys(s.values).length>0){const e=p.Grammar.tryParse(i),o=(e,a)=>{switch(a.type){case"StaticPlaceholder":{const t=s.values[a.name];e.push(t);break}case"FunctionPlaceholder":{const t=s.values[a.name],n=a.inner.reduce(o,[]);e.push(t(r(n)));break}case"Text":e.push(t(a.text));break;default:}return e},a=e.reduce(o,[]);return r(a)}return t(i)}catch(r){return t(e)}},this.formatDate=(e,t)=>{const r=new Date(e),o=new Date(t.now);try{switch(t.variant){case"time":{const{hour:e,minute:t,am_pm:o}=this.splitDate(r);return`${e}:${t} ${o}`}case"time-ago":{const t=Math.floor((o.getTime()-e)/1e3);switch(!0){case t<60:return this.use("global_just_now");case t<3600:{const e=Math.floor(t/60);return this.use("global_word_mins_ago",{num:e,fallback:"global_mins_ago"})}case t<43200:{const e=Math.floor(t/60/60);return this.use("global_word_hours_ago",{num:e,fallback:"global_hours_ago"})}default:return(0,c.isSameYear)(o,new Date(e))?this.use("global_short_date_time",{now:o.getTime(),date:e}):this.use("global_date_year_time",{now:o.getTime(),date:e})}}default:return(0,c.exhaustivenessCheck)(t.variant)}}catch(e){return this.logger.error(`[LANG] Ошибка форматирования даты ${t.variant}`,e),r.toISOString()}},this.formatNumber=(e,t="regular")=>{if("regular"===t)return e.toString().split(".").join(this.translations.config.numDec);let r,o;switch(!0){case e>1e9:r=e/1e9,o="B";break;case e>1e6:r=e/1e6,o="M";break;case e>1e3:r=e/1e3,o="K";break;default:r=e,o=""}const[a,n]=r.toFixed(1).split(".");return(Number(n)?[a,n]:[a]).join(this.translations.config.numDec)+o},this.getTemplate=e=>{if(!this.decodedKeys[e]){const t=this.translations.keys[e];if(!t)return;this.decodedKeys[e]=Array.isArray(t)?t.map(h):h(t)}return this.decodedKeys[e]},this.splitDate=(e,t={})=>{const r=(()=>{var e;const r=null!=(e=t.shortMonths)&&e;var o;const a=null==(o=t.genMonths)||o;var n;const s=null!=(n=t.capMonths)&&n;if(r)return this.getTemplate("global_months_short_of");const i=`${a}_${s}`;switch(i){case"false_false":return this.getTemplate("global_months");case"true_true":return this.getTemplate("global_months_cap_of");case"true_false":return this.getTemplate("global_months_of");case"false_true":return this.getTemplate("global_months_cap");default:return(0,c.exhaustivenessCheck)(i)}})(),o=t.shortWeekdays?this.getTemplate("global_week_days_short"):this.getTemplate("global_week_days"),a=e.getMinutes().toString().padStart(2,"0");let n=e.getHours().toString().padStart(2,"0");const s=e.getDate(),i=r[e.getMonth()]||r[0],u=o[(e.getDay()+6)%7]||o[0],l=e.getFullYear();let h="";const{timeSys:d}=this.translations.config;return"12hour"===d[0]&&(h=e.getHours()>11?d[2]:d[1],n=(e.getHours()%12==0?12:e.getHours()%12).toString().padStart(2,"0")),{year:l,month:i,weekday:u,day:s,hour:n,minute:a,am_pm:h}},this.logger=e,this.translations=t,(0,a.initLang)({source:()=>t.keys,config:()=>t.config}),this.locale=t.config.locale;try{this.isDebug=!!localStorage.getItem(u)}catch(e){}}}function h(e){return(0,n.decodeHTMLEntities)(e).replace(/<br\s*\/?>/gi,"\n")}const d=864e5;function m(e,t){const r=e.getDate(),o=e.getMonth(),a=e.getFullYear();return t.getFullYear()===a&&t.getMonth()===o&&t.getDate()===r}const p=i().createLanguage({Grammar:e=>i().alt(e.FunctionPlaceholder,e.StaticPlaceholder,e.Text).many(),StaticPlaceholder:e=>i().seqObj(i().string("{"),["name",e.Name],i().string("}")).map((({name:e})=>({type:"StaticPlaceholder",name:e}))),FunctionPlaceholder:e=>i().seqObj(i().string("{"),["name",e.Name],i().string("}")).chain((({name:t})=>i().alt(e.StaticPlaceholder,e.Text).many().skip(i().string(`{/${t}}`)).map((e=>({type:"FunctionPlaceholder",name:t,inner:e}))))),Name:()=>i().regex(/[a-zA-Z0-9_]+/),Text:()=>i().regex(/[^{}]+/).map((e=>({type:"Text",text:(0,n.decodeHTMLEntities)(e)})))})},316037:(e,t,r)=>{r.d(t,{DEFAULT_FEATURE_FLAGS:()=>o});const o={me_fc_tooltips:!0,me_fc_multiple_windows:!0,me_fc_message_actions:!1,me_fc_simple_composer:!1,me_sticker_packs:{helloKeywordPack:[],helloStickersPack:[]},me_community_messages_enabled:!1,me_message_selecting:!1,me_channels:!1,vkm_new_read_indicator:!1,vkm_convo_member_temporary_ban:!1,vkm_profile_info_screen_name:!1,vkm_hide_forward_author:!1,vkm_channels_temp:!1,vkm_composer_new:!1,vkm_send_promoted_stickers:!1,vkm_reactions:!1,vkm_reforged_in_vkcom:!1,vkm_convo_profile:!1,vkm_mediascope_collect:!1,vkm_settings:!1,vkm_widget_attaches:!1,vkm_marusia_chat:!1,vkm_marusia_pinned:!1,vkm_calls_history:!1,vkm_photo_viewer_rotating:!1,vkm_photo_viewer_scaling:!1,vkm_qr_code_chat_invitation:!1,vkm_photo_viewer_owner:!1,vkm_stats_config:{sendingAmount:1e3},vkm_new_chunk_parser:!1,vkm_message_context_menu:!1,vkm_video_messges_subtitles:!1,vkm_ugc_stickers_in_keyboard:!1,vkm_add_non_friends:!1,vkm_channels_sferum_url:!1,vkm_create_channel:!1,vkm_add_non_friends_by_phone:!1,vkm_write_non_friends_by_phone:!1,vkm_video_downloadable:!1,vkm_settings_experimental:!1,vkm_mention_highlight_tertiary:!1,vkm_account_switch_banner:!1,vkm_profile_channels:!1,vkm_media_viewer:!1,vkm_channel_post_editting:!1,vkm_convo_forbid_writing_all:!1,vkm_edu_profile_organizations:!1,vkm_message_preview_on_hover:!1,vkm_peers_liked_post_modal:!1,vkm_new_attach_track:!1,vkm_chat_analytics:!1,vkm_extended_reaction_picker:!1,vkm_channels_short_polling:!1,vkm_channels_search:!1}},866358:(e,t,r)=>{r.d(t,{findLastReply:()=>g,findReplyByCmid:()=>m,insertReplies:()=>i,isEmpty:()=>l,markDeleted:()=>h,replaceReply:()=>p,resolveCmid:()=>s,restoreDeleted:()=>d,toPlainText:()=>u,toWallReplyAttach:()=>c});var o=r(434788),a=r(504698),n=r(96190);function s(e){return(Number.isNaN(e)||void 0===e)&&(e=0),e}function i(e,t){e.replies.history=[...e.replies.history,...t]}function c(e){return{kind:"WallReply",attaches:e.attaches,chunks:e.chunks,id:e.cmid,postId:e.postCmid,authorId:e.peerId,date:e.sentAt,ownerId:n.resolveId(e.channelId)}}function u(e,t){return a.toPlainText(e.chunks,t)}function l(e){return 0===e.chunks.length&&!Object.keys(e.attaches).find((e=>"unknown"!==e))}function h(e){return(0,o._)({},e,{kind:"MarkedDeleted"})}function d(e){return(0,o._)({},e,{kind:"Normal"})}function m(e,t){return e.replies.history.find((e=>e.cmid===t))}function p(e,t){const r=e.replies.history.findIndex((e=>e.cmid===t.cmid));-1!==r&&(e.replies.history[r]=t)}function g(e,t){const r=e=>e.kind===t;for(let t=e.replies.history.length-1;t>=0;t--){const o=e.replies.history[t];if(o&&r(o))return o}}},866421:(e,t,r)=>{r.d(t,{Router:()=>f});var o,a=r(434788),n=r(997864),s=r(781982),i=r(606972),c=r(89131),u=r(839963),l=r(866358),h=r(999504),d=r(96190),m=r(777634),p=r(86144),g=r(197934),_=r(95154);!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(o||(o={}));class f{get state(){return this.history.location.state||{}}get currentRoute(){return this.fromUrl(v(this.history.location))}toUrl(e){if(s.IRouter.isProxyRoute(e)){const t=this.fromProxyRoute(e);if(t)return this.toUrlInternal(t);switch(e.kind){case"AttachMediaProxyRoute":return null;case"AttachProxyRoute":if(this.checkIsolation()&&"Article"!==e.attach.kind)return null;return this.utils.getAttachLink(e.attach,this.vkDomain)||e.fallbackUrl||null;case"HashtagProxyRoute":return this.checkIsolation()?null:`https://${this.vkDomain}/feed?q=${encodeURIComponent(e.tag)}&section=search`;case"HashtagMentionProxyRoute":return this.checkIsolation()||!e.authorId?null:`https://${this.vkDomain}/wall${e.authorId}?q=${encodeURIComponent(e.tag)}`;case"ScreenNameProxyRoute":return this.checkIsolation()?null:`https://${this.vkDomain}/${e.screenName}`;default:(0,c.exhaustivenessCheck)(e)}}return this.toUrlInternal(e)}toUrlInternal(e){return this.addBasePath(this.utils.toUrl(e))}fromProxyRoute(e){switch(e.kind){case"AttachProxyRoute":switch(e.attach.kind){case"MiniApp":return{kind:"MiniAppModalRoute",miniAppId:e.attach.id,hash:e.attach.hash};case"Wall":return this.featureFlags.me_channels&&u.isChannelId(e.attach.authorId)?{kind:"ChannelRoute",channelId:u.resolveId(e.attach.authorId),postCmid:p.resolveCmid(e.attach.id)}:null;case"WallReply":return this.featureFlags.me_channels&&u.isChannelId(e.attach.authorId)?{kind:"ChannelRoute",channelId:u.resolveId(e.attach.ownerId),postCmid:p.resolveCmid(e.attach.postId),commentCmid:l.resolveCmid(e.attach.id)}:null;case"Audio":case"AudioPlaylist":case"Podcast":case"Doc":case"Sticker":case"UgcSticker":case"Link":case"Voice":case"Market":case"MoneyTransfer":case"MoneyRequest":case"Gift":case"Graffiti":case"MarketAlbum":case"FinishedCall":case"Poll":case"Story":case"Article":case"WallHistory":case"Geo":case"ActiveCall":case"DonutLink":case"InviteLink":case"VideoMessage":case"Widget":return null;default:return(0,c.exhaustivenessCheck)(e.attach)}case"AttachMediaProxyRoute":{let t;if(e.source)switch(e.source.kind){case"message":t={kind:s.IRouter.RouteSourceKind.Message,cmid:e.source.cmid,peerId:e.source.peerId,mediaViewerItemPosition:e.source.mediaViewerItemPosition,messageAccessKey:e.attach.messageAccessKey};break;case"post":t={kind:s.IRouter.RouteSourceKind.Post,cmid:e.source.cmid,channelId:e.source.channelId};break;case"comment":t={kind:s.IRouter.RouteSourceKind.Comment,commentCmid:e.source.commentCmid,postCmid:e.source.postCmid,channelId:e.source.channelId};break;case"composer":t={kind:s.IRouter.RouteSourceKind.Composer};break;case"channelComposer":t={kind:s.IRouter.RouteSourceKind.ChannelComposer};break;default:(0,c.exhaustivenessCheck)(e.source)}return{kind:{Photo:"PhotoModalRoute",Video:"VideoModalRoute"}[e.attach.kind],id:e.attach.id,ownerId:e.attach.ownerId,accessKey:e.attach.accessKey,source:t,tab:e.tab}}case"HashtagProxyRoute":case"HashtagMentionProxyRoute":case"ScreenNameProxyRoute":return null;default:(0,c.exhaustivenessCheck)(e)}}constructor(e,t,r,n,c){this.screenRoute={kind:"MainRoute"},this.modalRoute=null,this.runtimeRoute=null,this.listeners=new Set,this.checkIsolation=()=>!1,this.notifyListeners=(e,t)=>{[...this.listeners].forEach((r=>r(e,t)))},this.handleRuntimeRouteChange=(e,t)=>{this.runtimeRoute="EmptyRuntimeRoute"===e.kind?null:e,this.notifyListeners(this.currentRoute,t)},this.handleRouteChange=e=>{const t=this.currentRoute;this.runtimeRoute=null,s.IRouter.isModalRoute(e)?(this.modalRoute=e,s.IRouter.isModalRoute(t)||(this.screenRoute=t)):(this.screenRoute=e,this.modalRoute=null)},this.addBasePath=e=>this.basePath?`${this.basePath}${"/"===e?"":e}`:e,this.removeBasePath=e=>{return this.basePath?e.replace(new RegExp(`^${t=this.basePath,t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}`),""):e;var t},this.openLink=(e,t,r)=>{if(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)return;const o=s.IRouter.isProxyRoute(t)?this.fromProxyRoute(t):t;o&&(e.preventDefault(),this.push(o,r))},this.push=(e,{silent:t,clearModals:r}={silent:!1,clearModals:!1})=>{r&&this.notifyListeners(this.screenRoute,o.Replace),s.IRouter.isRuntimeRoute(e)?this.handleRuntimeRouteChange(e,o.Push):t&&this.modalRoute&&!s.IRouter.isModalRoute(e)?(this.screenRoute=e,this.notifyListeners(this.modalRoute,o.Replace)):this.history.push(this.toUrl(e),{screenRoute:this.screenRoute})},this.replace=e=>{s.IRouter.isRuntimeRoute(e)?this.handleRuntimeRouteChange(e,o.Replace):this.history.replace(this.toUrl(e),{screenRoute:this.screenRoute})},this.back=()=>{this.history.back()},this.forward=()=>{this.history.forward()},this.subscribe=e=>{const t=this.history.listen((({location:t,action:r})=>{const o=this.fromUrl(v(t));this.handleRouteChange(o),e(o,r)}));return this.listeners.add(e),()=>{this.listeners.delete(e),t()}},this.fromExternalUrl=e=>{const t=this.fromUrl(e);if("NotFoundRoute"!==t.kind)return t;let r;try{r=new URL(e)}catch(e){return t}function o(e,t,o){const a=r.searchParams.get("reply");let n;return o?n=l.resolveCmid(parseInt(o.slice(1))):a&&(n=l.resolveCmid(parseInt(a))),[e?u.resolveId(parseInt(e)):void 0,t?p.resolveCmid(parseInt(t)):void 0,n]}function n(e){const[t,r,a]=e.slice(4).split("_");return o(t,r,a)}const s=this.fromSferumUrl(e);if("NotFoundRoute"!==s.kind)return s;const i=r.searchParams.get("w")||"",[c,h,d]=n(i);if(c&&this.featureFlags.me_channels)return(0,a._)({},t,{kind:"ChannelRoute",channelId:c,postCmid:h,commentCmid:d});const m=r.pathname.split("/"),g=m[1];if(r.hostname!==this.vkDomain&&"web.vk.me"!==r.hostname)return t;if(!g||g.length<3||g.length>25||"reforged.php"===g)return t;if(2===m.length){if("groups"===g||"channels"===g)return{kind:"ChannelsListRoute"};if(g.startsWith("wall")){const[e,r,o]=n(g);if(e&&this.featureFlags.me_channels)return(0,a._)({},t,{kind:"ChannelRoute",channelId:e,postCmid:r,commentCmid:o})}return{kind:"ScreenNameProxyRoute",screenName:g}}if(3===m.length){if("channels"===g){const e=m[2],n=r.searchParams.get("cmid")||"",s=r.searchParams.get("comment")||"",[i,c,u]=o(e,n,s);if(i&&this.featureFlags.me_channels)return(0,a._)({},t,{kind:"ChannelRoute",channelId:i,postCmid:c,commentCmid:u})}if("miniapp"===g)try{const e=this.utils.parser.MiniApp.tryParse(r.pathname+r.search);return(0,a._)({},t,e)}catch(e){}}return t},this.fromSferumUrl=e=>{try{const t=new URL(e);if(t.hostname===_.SFERUM_DOMAIN&&"channel"===t.searchParams.get("p")){const e=t.searchParams.get("channelId"),r=t.searchParams.get("postId");if(e)return(0,a._)({kind:"ChannelRoute",channelId:u.resolveId(parseInt(e))},r&&{postCmid:p.resolveCmid(parseInt(r))},{sferum:!0})}}catch(e){return{kind:"NotFoundRoute"}}return{kind:"NotFoundRoute"}},this.fromUrl=e=>this.utils.fromUrl(this.removeBasePath(e)),this.featureFlags=e,this.vkDomain=t,this.basePath=r,this.globalHistory=c,this.utils=new k(e),this.toUrl=this.toUrl.bind(this),this.fromProxyRoute=this.fromProxyRoute.bind(this),this.history=c||(n?(0,i.createMemoryHistory)():(0,i.createBrowserHistory)());const h=this.currentRoute;s.IRouter.isModalRoute(h)?(this.modalRoute=h,this.screenRoute=this.state.screenRoute||this.screenRoute):this.screenRoute=h}}function v(e){return`${e.pathname}${e.search}${e.hash||"#"}`}class k{constructor(e){this.routeParamsDelimiter="_",this.routeParamsDelimiterParser=n.string(this.routeParamsDelimiter),this.routeParamsOptionalDelimiterParser=this.routeParamsDelimiterParser.or(n.string("")),this.parser=n.createLanguage({ModalRoutes:e=>n.alt(e.Peer,e.Poll,e.Important,e.MiniApp,e.MiniAppCatalog,e.ChannelProfile,e.PhotoSourceMessage,e.PhotoSourcePost,e.PhotoSourceComment,e.PhotoSourceComposer,e.PhotoSourceChannelComposer,e.PhotoSourceLess,e.VideoSourceMessage,e.VideoSourcePost,e.VideoSourceComment,e.VideoSourceComposer,e.VideoSourceChannelComposer,e.VideoSourceLess),ScreenRoutes:e=>n.alt(e.Convo,e.Channel,e.ChannelsList,e.CallJoin,e.ChatJoin,e.Settings,e.SettingsMain,e.Main),Main:()=>n.regexp(/\/?/).map((()=>({kind:"MainRoute"}))),CallJoin:()=>n.seqObj(n.string("/call/join/"),["callJoinHash",n.regexp(/^(.*)+$/)]).map((e=>({kind:"CallJoinRoute",callJoinHash:e.callJoinHash}))),ChatJoin:()=>n.seqObj(n.string("/chat/join/"),["chatJoinHash",n.regexp(/^(.*)+$/)]).map((e=>({kind:"ChatJoinRoute",chatJoinHash:e.chatJoinHash}))),Convo:()=>n.seqObj(n.string("/convo/"),["peerId",n.regexp(/(-)?[0-9]{1,10}$/)]).map((e=>({kind:"ConvoRoute",peerId:d.resolveId(Number(e.peerId)),entrypoint:"list_all"}))),Channel:()=>n.seqObj(n.string("/channels/"),["channelId",n.regexp(/(-)[0-9]{1,10}$/)]).map((e=>({kind:"ChannelRoute",channelId:u.resolveId(Number(e.channelId))}))),ChannelsList:()=>n.regexp(/\/channels\/?/).map((()=>({kind:"ChannelsListRoute"}))),Settings:()=>n.seqObj(n.string("/settings/"),["section",n.alt(...s.IRouter.SettingsRouteSectionKeys.map((e=>n.string(e))))]).map((e=>({kind:"SettingsRoute",section:e.section}))),SettingsMain:()=>n.regexp(/\/settings\/?/).map((()=>({kind:"SettingsRoute"}))),Peer:()=>n.seqObj(n.string("/peer/"),["peerId",n.regexp(/(-)?\d*/)]).map((e=>({kind:"PeerModalRoute",peerId:d.resolveId(Number(e.peerId))}))),ChannelProfile:()=>n.seqObj(n.string("/channel/"),["channelId",n.regexp(/(-)[0-9]{1,10}/)],["section",n.alt(n.eof,n.seq(n.string("/"),n.alt(...s.IRouter.ChannelModalRouteSectionKeys.map((e=>n.string(e))))).map((e=>e[1])))]).map((e=>({kind:"ChannelModalRoute",channelId:u.resolveId(Number(e.channelId)),section:e.section}))),Poll:()=>n.seqObj(n.string("/poll/"),["ownerId",n.regexp(/(-)?\d*/)],n.string("_"),["pollId",n.regexp(/(-)?\d*/)]).map((e=>({kind:"PollModalRoute",ownerId:d.resolveId(Number(e.ownerId)),pollId:Number(e.pollId)}))),Important:()=>n.string("/important").map((()=>({kind:"ImportantMessagesModalRoute"}))),MiniAppCatalog:()=>n.string("/services").map((()=>({kind:"MiniAppCatalogModalRoute"}))),MiniApp:()=>n.seqObj(n.string("/miniapp/"),["miniAppId",n.regexp(/(-)?\d+/)],["groupPeerId",n.regexp(/(_-\d+)?/)]).map((e=>{const t=e.groupPeerId&&Number(e.groupPeerId.slice(1)),r=t?d.resolveId(t):void 0,o=r&&d.isGroupPeerId(r)?r:void 0;return(0,a._)({kind:"MiniAppModalRoute",miniAppId:(0,g.resolveMiniAppId)(Number(e.miniAppId))},o&&{groupPeerId:o})})),Photo:e=>n.seqObj(n.string("/photo/"),["ownerId",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["id",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["accessKey",e.AccessKey]),PhotoSourceLess:e=>n.seqObj(["photo",e.Photo]).map((e=>({kind:"PhotoModalRoute",ownerId:d.resolveId(Number(e.photo.ownerId)),id:Number(e.photo.id),accessKey:e.photo.accessKey}))),PhotoSourceMessage:e=>n.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.Message.toString()),this.routeParamsDelimiterParser,["peerId",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["cmid",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["messageAccessKey",e.AccessKey],this.routeParamsOptionalDelimiterParser,["mediaViewerItemPosition",n.regexp(/\d*/)]).map((e=>(0,a._)({},e.photo,{source:(0,a._)({kind:s.IRouter.RouteSourceKind.Message,peerId:d.resolveId(Number(e.peerId)),cmid:m.resolveCmid(Number(e.cmid)),messageAccessKey:e.messageAccessKey},e.mediaViewerItemPosition&&{mediaViewerItemPosition:parseInt(e.mediaViewerItemPosition,10)})}))),PhotoSourcePost:e=>n.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.Post.toString()),this.routeParamsDelimiterParser,["channelId",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["cmid",n.regexp(/(-)?\d*/)]).map((e=>(0,a._)({},e.photo,{source:{kind:s.IRouter.RouteSourceKind.Post,channelId:u.resolveId(Number(e.channelId)),cmid:p.resolveCmid(Number(e.cmid))}}))),PhotoSourceComment:e=>n.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.Comment.toString()),this.routeParamsDelimiterParser,["channelId",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["postCmid",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["commentCmid",n.regexp(/(-)?\d*/)]).map((e=>(0,a._)({},e.photo,{source:{kind:s.IRouter.RouteSourceKind.Comment,channelId:u.resolveId(Number(e.channelId)),postCmid:p.resolveCmid(Number(e.postCmid)),commentCmid:l.resolveCmid(Number(e.commentCmid))}}))),PhotoSourceComposer:e=>n.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.Composer.toString())).map((e=>(0,a._)({},e.photo,{source:{kind:s.IRouter.RouteSourceKind.Composer}}))),PhotoSourceChannelComposer:e=>n.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.ChannelComposer.toString())).map((e=>(0,a._)({},e.photo,{source:{kind:s.IRouter.RouteSourceKind.ChannelComposer}}))),Video:e=>n.seqObj(n.string("/video/"),["ownerId",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["id",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["accessKey",e.AccessKey]),VideoSourceLess:e=>n.seqObj(["video",e.Video]).map((e=>({kind:"VideoModalRoute",ownerId:d.resolveId(Number(e.video.ownerId)),id:Number(e.video.id),accessKey:e.video.accessKey}))),VideoSourceMessage:e=>n.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.Message.toString()),this.routeParamsDelimiterParser,["peerId",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["cmid",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["messageAccessKey",e.AccessKey],this.routeParamsOptionalDelimiterParser,["mediaViewerItemPosition",n.regexp(/\d*/)]).map((e=>(0,a._)({},e.video,{source:(0,a._)({kind:s.IRouter.RouteSourceKind.Message,peerId:d.resolveId(Number(e.peerId)),cmid:m.resolveCmid(Number(e.cmid)),messageAccessKey:e.messageAccessKey},e.mediaViewerItemPosition&&{mediaViewerItemPosition:parseInt(e.mediaViewerItemPosition,10)})}))),VideoSourcePost:e=>n.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.Post.toString()),this.routeParamsDelimiterParser,["channelId",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["cmid",n.regexp(/(-)?\d*/)]).map((e=>(0,a._)({},e.video,{source:{kind:s.IRouter.RouteSourceKind.Post,channelId:u.resolveId(Number(e.channelId)),cmid:p.resolveCmid(Number(e.cmid))}}))),VideoSourceComment:e=>n.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.Comment.toString()),this.routeParamsDelimiterParser,["channelId",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["postCmid",n.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["commentCmid",n.regexp(/(-)?\d*/)]).map((e=>(0,a._)({},e.video,{source:{kind:s.IRouter.RouteSourceKind.Comment,channelId:u.resolveId(Number(e.channelId)),postCmid:p.resolveCmid(Number(e.postCmid)),commentCmid:l.resolveCmid(Number(e.commentCmid))}}))),VideoSourceComposer:e=>n.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.Composer.toString())).map((e=>(0,a._)({},e.video,{source:{kind:s.IRouter.RouteSourceKind.Composer}}))),VideoSourceChannelComposer:e=>n.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,n.string(s.IRouter.RouteSourceKind.ChannelComposer.toString())).map((e=>(0,a._)({},e.video,{source:{kind:s.IRouter.RouteSourceKind.ChannelComposer}}))),AccessKey:()=>n.regexp(/[-0-9a-zA-Z]*/)}),this.fromUrl=e=>{const t=(0,i.parsePath)(e),r=new URLSearchParams(t.search),o=this.parseParams(r);if(!t.pathname)return(0,a._)({kind:"MainRoute"},o);try{const e=this.parser.ScreenRoutes.tryParse(t.pathname);switch(e.kind){case"MainRoute":{const e=r.get("call"),t=r.get("chat");return(0,a._)({kind:"MainRoute"},e&&{callJoinHash:e},t&&{chatJoinHash:t},this.parseConvoRouteExtraParams(r),o)}case"CallJoinRoute":return(0,a._)({kind:"CallJoinRoute",callJoinHash:e.callJoinHash},o);case"ChatJoinRoute":return(0,a._)({kind:"ChatJoinRoute",chatJoinHash:e.chatJoinHash},o);case"ConvoRoute":{const t=r.get("search"),n=r.get("chat_invite"),s=r.get("call_join"),i=r.get("cmid");return(0,a._)({kind:"ConvoRoute",peerId:d.resolveId(Number(e.peerId)),entrypoint:e.entrypoint},n&&{chatJoinHash:n},s&&{callJoinHash:s},null!=t?{search:t}:{},i&&{cmid:m.resolveCmid(Number(i))},this.parseConvoRouteExtraParams(r),o)}case"ChannelRoute":{const t=r.get("cmid"),n=r.get("comment"),s=r.get("sferum");return(0,a._)({kind:"ChannelRoute",channelId:u.resolveId(Number(e.channelId)),postCmid:null!==t?p.resolveCmid(Number(t)):void 0,commentCmid:null!==n?l.resolveCmid(Number(n)):void 0,sferum:s?Boolean(s):void 0},this.parseConvoRouteExtraParams(r),o)}case"ChannelsListRoute":return(0,a._)({kind:"ChannelsListRoute"},this.parseConvoRouteExtraParams(r),o);case"NotFoundRoute":return(0,a._)({kind:"NotFoundRoute"},o);case"SettingsRoute":return this.featureFlags.vkm_settings?e:{kind:"NotFoundRoute"};default:(0,c.exhaustivenessCheck)(e)}}catch(e){}try{const e=this.parser.ModalRoutes.tryParse(t.pathname);switch(e.kind){case"MiniAppModalRoute":{const t=r.get("hash");return(0,a._)({},e,t&&{hash:t},o)}case"PeerModalRoute":{const t=r.get("section");return(0,a._)({},e,t&&{section:t},o)}default:return(0,a._)({},e,o)}}catch(e){}return(0,a._)({kind:"NotFoundRoute"},o)},this.toUrl=e=>{const t=(t=new URLSearchParams)=>{const r=this.createGlobalQueryFromRoute(e,t);return""!==r.toString()?`?${(e=>{let t=[];return e.forEach(((e,r)=>{t.push(e?[r,encodeURIComponent(e)].join("="):r)})),t.join("&")})(r)}`:""};switch(e.kind){case"ConvoRoute":{const r=this.createConvoExtraParamsQueryFromRoute(e);return void 0!==e.search&&r.append("search",String(e.search)),e.cmid&&r.append("cmid",String(e.cmid)),e.chatJoinHash&&r.append("chat_invite",e.chatJoinHash),e.callJoinHash&&r.append("call_join",e.callJoinHash),`/convo/${e.peerId}${t(r)}`}case"ChannelsListRoute":{const r=this.createConvoExtraParamsQueryFromRoute(e);return`${u.CHANNELS_BASE_PATH}${t(r)}`}case"ChannelRoute":{const r=new URLSearchParams;return void 0!==e.commentCmid&&r.append("comment",e.commentCmid.toString()),void 0!==e.postCmid&&r.append("cmid",e.postCmid.toString()),`${u.CHANNELS_BASE_PATH}/${e.channelId}${t(r)}`}case"MainRoute":{const r=this.createConvoExtraParamsQueryFromRoute(e);return e.callJoinHash&&r.set("call",e.callJoinHash),e.chatJoinHash&&r.set("chat",e.chatJoinHash),`/${t(r)}`}case"CallJoinRoute":return`/call/join/${e.callJoinHash}${t()}`;case"ChatJoinRoute":return`/chat/join/${e.chatJoinHash}${t()}`;case"NotFoundRoute":return`/${t()}`;case"PeerModalRoute":const o=new URLSearchParams;return e.section&&o.append("section",e.section),`/peer/${e.peerId}${t(o)}`;case"ChannelModalRoute":return e.section?`/channel/${e.channelId}/${e.section}`:`/channel/${e.channelId}`;case"MiniAppModalRoute":{const r=new URLSearchParams;return e.hash&&r.append("hash",e.hash),`/miniapp/${e.miniAppId}${e.groupPeerId?`_${e.groupPeerId}`:""}${t(r)}`}case"MiniAppCatalogModalRoute":return"/services";case"PollModalRoute":return`/poll/${e.ownerId}_${e.pollId}`;case"ImportantMessagesModalRoute":return"/important";case"SettingsRoute":return e.section?`/settings/${e.section}`:"/settings";case"PhotoModalRoute":case"VideoModalRoute":const a="PhotoModalRoute"===e.kind?"/photo/":"/video/",n=[e.ownerId.toString(),e.id.toString(),e.accessKey||""];if(e.source)switch(n.push(e.source.kind.toString()),e.source.kind){case s.IRouter.RouteSourceKind.Message:var r;n.push(e.source.peerId.toString(),e.source.cmid.toString(),e.source.messageAccessKey||"",(null!=(r=e.source.mediaViewerItemPosition)?r:0).toString());break;case s.IRouter.RouteSourceKind.Post:n.push(e.source.channelId.toString(),e.source.cmid.toString());break;case s.IRouter.RouteSourceKind.Comment:n.push(e.source.channelId.toString(),e.source.postCmid.toString(),e.source.commentCmid.toString());break;case s.IRouter.RouteSourceKind.Composer:case s.IRouter.RouteSourceKind.ChannelComposer:break;default:(0,c.exhaustivenessCheck)(e.source)}return`${a}${n.join(this.routeParamsDelimiter)}${t()}`;default:(0,c.exhaustivenessCheck)(e)}},this.parseParams=e=>{const t={};return s.IRouter.globalParamsKeys.reduce(((r,o)=>{switch(o){case"createPoll":t[o]=Boolean(e.get(o));break;case"folder":const r=e.get("folder");r&&(t.folder=h.resolveId(Number(r)));break;case"tab":t.tab=function(e){switch(e){case"archive":case"unread":case"businessNotify":case"messageRequest":return e;default:return}}(e.get("tab"));break;case"sferum":t.sferum="true"===e.get("sferum");break;default:(0,c.exhaustivenessCheck)(o)}return r}),{}),t},this.parseConvoRouteExtraParams=e=>s.IRouter.convoRouteExtraParamsKeys.reduce(((t,r)=>(e.has(r)&&(t[r]=!0),t)),{}),this.createGlobalQueryFromRoute=(e,t=new URLSearchParams)=>(s.IRouter.globalParamsKeys.forEach((r=>{if(!(r in e))return;const o=e[r];o?t.append(r,o.toString()):t.delete(r)})),t),this.createConvoExtraParamsQueryFromRoute=(e,t=new URLSearchParams)=>(s.IRouter.convoRouteExtraParamsKeys.forEach((r=>{r in e&&(e[r]?t.append(r,""):t.delete(r))})),t),this.getAttachLink=(e,t)=>{switch(e.kind){case"Audio":return`https://${t}/audio${e.ownerId}_${e.id}`;case"AudioPlaylist":const r=e.accessKey?`_${e.accessKey}`:"";return`https://${t}/music/${e.type}/${e.ownerId}_${e.id}${r}`;case"Podcast":return`https://${t}/im?z=podcast${e.ownerId}_${e.id}`;case"Doc":return`https://${t}/doc${e.ownerId}_${e.id}`;case"Sticker":return`https://${t}/stickers`;case"UgcSticker":case"Voice":case"MoneyTransfer":case"MoneyRequest":case"Graffiti":case"MarketAlbum":case"FinishedCall":case"Geo":case"ActiveCall":case"VideoMessage":case"Widget":return"";case"Link":case"Article":case"InviteLink":return e.url;case"Market":return`https://${t}/market${e.ownerId}?w=product${e.ownerId}_${e.id}`;case"Gift":return`https://${t}/gifts`;case"Poll":return`https://${t}/im?w=poll${e.ownerId}_${e.id}`;case"Story":return`https://${t}/im?w=story${e.ownerId}_${e.id}/${e.ownerId}_${e.id}`;case"Wall":case"WallHistory":return`https://${t}/wall${e.ownerId}_${e.id}`;case"WallReply":return`https://${t}/wall${e.ownerId}_${e.postId}?reply=${e.id}`+(e.parentsStack&&e.parentsStack.length>0?`&thread=${e.parentsStack.join("_")}`:"");case"MiniApp":return`https://${t}/im?w=${e.appLink}${e.hash}`;case"DonutLink":return`https://${t}/donut/club${d.toRealId(e.ownerId)}`;default:return(0,c.exhaustivenessCheck)(e)}},this.featureFlags=e}}}}]);try{stManager.done("dist/abe7fff7348a3b2801b36ebec0c5f4fc.40926d01f5a6d481349f.js")}catch(e){}