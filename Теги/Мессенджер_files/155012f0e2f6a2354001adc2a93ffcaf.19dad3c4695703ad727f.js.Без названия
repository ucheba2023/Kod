(self.webpackChunkvk=self.webpackChunkvk||[]).push([[90613],{428817:t=>{t.exports={reactions_preview_item:'<div class="ReactionsPreviewItem ReactionsPreviewItem--stackOverlay %class%" style="background-image: url(\'%image_url%\');" aria-label="%title%"></div>'}},828109:(t,e,n)=>{"use strict";n.d(e,{preservePositionBetween:()=>a});var i=n(75272),o=n(659397);function a(t,{scrollByImpl:e=window.scrollBy}={}){let n=t;return{start:(0,o.once)((function(t){t&&(n=t);const a=(0,i.getElementOffset)(n);return(0,o.once)((function(t){if(t&&(n=t),n.isConnected){const t=(0,i.getElementOffset)(n);e(0,t.top-a.top)}}))}))}}},143790:(t,e,n)=>{"use strict";n.d(e,{animationModuleLoaderAsync:()=>s,destroyAnimationItem:()=>r,getAnimationAsync:()=>o,onAnimationReady:()=>a});var i=n(434788);const o=({animationDataGet:t,animationDataSet:e,animationModuleLoader:n})=>(...i)=>n().then((({loadAnimation:n})=>(({animationDataGet:t,animationDataSet:e,loadAnimation:n})=>(i,o,a)=>{var r;const s=i,c=t?t({animationId:s}):void 0,l=n({animationData:c,animationURL:i,container:o,loadAnimationParams:null==(r=a)?void 0:r.loadAnimationParams});return!c&&e&&function(t,e){t.addEventListener("data_ready",(()=>{e(t.animationData)}))}(l,(t=>{e({animationId:s,loadedAnimationData:t})})),l})({animationDataGet:t,animationDataSet:e,loadAnimation:n})(...i)));function a(t,e){t.isLoaded?e():t.addEventListener("DOMLoaded",(()=>{e()}))}function r(t){const e=function(t){return!t._cbs}(t);e||t.destroy()}const s=()=>Promise.all([n.e(38288),n.e(55489)]).then(n.bind(n,682832)).then((t=>{return{loadAnimation:(e=t.lottie,({animationData:t,animationURL:n,container:o,loadAnimationParams:a={}})=>{var r,s;const c=t?{animationData:t}:{path:n};var l,u;const d={renderer:"svg",autoplay:null!=(l=null==(r=a)?void 0:r.autoplay)&&l,loop:null==(u=null==(s=a)?void 0:s.loop)||u,rendererSettings:{progressiveLoad:!0}},v=(0,i._)({},c,d,{container:o});return e.loadAnimation(v)})};var e}))},59985:(t,e,n)=>{"use strict";n.d(e,{HIDE_TOOLTIP_TIMEOUT:()=>i,OPENED_REACTED_USERS_DEFAULT_REACTION_ID:()=>u,REACTION_ID_DEFAULT:()=>a,REACTION_ID_MAX:()=>r,REACTION_ID_MIN:()=>s,REACTION_ID_UNSET:()=>c,REACTION_SET_ITEMS_MIN_COUNT:()=>l,SHOW_TOOLTIP_TIMEOUT:()=>o});const i=600,o=140,a=0,r=7,s=0,c=void 0,l=2,u=a},457972:(t,e,n)=>{"use strict";n.d(e,{isDebugEnabled:()=>a});var i=n(531730);let o;const a=()=>(void 0!==o||(o=!!i.ls.get("reactions.debug_enabled")),o)},192441:(t,e,n)=>{"use strict";n.d(e,{reactionCountsBrandUnwrap:()=>o,reactionCountsBrandWrap:()=>a});var i=n(640971);const o=t=>(0,i.unwrap)(t),a=t=>(0,i.wrap)(t)},698216:(t,e,n)=>{"use strict";n.d(e,{reactionLogError:()=>a});var i=n(970978);const o="reactions";function a({error:t,reportError:e=!1}){e&&(0,i.logError)(t,{environment:o}),console.error(t)}},822715:(t,e,n)=>{"use strict";n.d(e,{areCountersEqual:()=>A,calcCounters:()=>S,calcCountersSum:()=>f,calcCountersWeightedSum:()=>R,counterForReactionId:()=>P,getDefaultReaction:()=>l,getDefaultReactionTitle:()=>u,getReaction:()=>c,hasReactionsForCounts:()=>E,isReactionIdSet:()=>m,isReactionIdUnset:()=>g,isUnknownObject:()=>s,isValidReactionId:()=>p,parseReactionId:()=>_,parseReactionIdOrUnset:()=>b,parseReactionMenuConfig:()=>I,prepareReactionMenuSet:()=>v,validateReactionSetPayloaditems:()=>w});var i=n(59985),o=n(192441),a=n(659397);const r=Number.isInteger||(t=>"number"==typeof t&&isFinite(t)&&Math.floor(t)===t),s=t=>null!==t&&"object"==typeof t,c=(t,e)=>t.itemsById[e],l=t=>c(t,i.REACTION_ID_DEFAULT),u=t=>{var e;return null==(e=l(t))?void 0:e.title},d=(t,e)=>0===t.length?"":((t,e,n=!0)=>t.reduce(((t,i)=>{const o=e(i),a=e(t);return a===o?n?t:i:a<o?t:i})))(t,(t=>Math.pow(e.width-t.width,2)+Math.pow(e.height-t.height,2)),!1).url,v=(t,e,n)=>{const i=e.map((({asset:t,color_sets:e,id:i,score:o,title:a})=>{var r,s;return{animationURL:t.animation_url||void 0,backgroundColor:null==(r=e)?void 0:r.background,id:i,imageMenuURL:d(t.images,n.imageMenuSize),imagePreviewURL:"imagePreviewSize"in n?d(t.images,n.imagePreviewSize):void 0,imageStoryPanelURL:"imageStoryPanelSize"in n?d(t.images,n.imageStoryPanelSize):void 0,imageStoryPreviewURL:"imageStoryPreviewSize"in n?d(t.images,n.imageStoryPreviewSize):void 0,score:o,title:a,titleColor:null==(s=e)?void 0:s.foreground}})),o={};return i.forEach((t=>{o[t.id]=t})),{id:t,items:i,itemsById:o}},m=t=>t!==i.REACTION_ID_UNSET,g=t=>t===i.REACTION_ID_UNSET,p=t=>r(t)&&t>=i.REACTION_ID_MIN&&t<=i.REACTION_ID_MAX,_=t=>{const e=parseInt(t,10);return p(e)?{isValid:!0,value:e}:{isValid:!1}},b=t=>{const e=_(t);return e.isValid?e.value:i.REACTION_ID_UNSET},w=(t,e)=>{if(t.length<i.REACTION_SET_ITEMS_MIN_COUNT)return{error:new Error(`Invalid reactions items count in set '${e}': ${t.length}`)}},I=t=>{if(!s(t))return;const e={},{animationShowStaticAfterEnd:n,menuShowDelay:o,openedDefaultReactionId:a,reportJsErrors:r}=t;return"number"!=typeof o&&void 0!==o||(e.menuShowDelay=o),"boolean"==typeof n&&(e.animationShowStaticAfterEnd=n),"boolean"==typeof r&&(e.reportJsErrors=r),"number"==typeof a||null===a?null===a?e.openedDefaultReactionId=void 0:p(a)&&(e.openedDefaultReactionId=a):e.openedDefaultReactionId=i.OPENED_REACTED_USERS_DEFAULT_REACTION_ID,e},S=(t,e)=>{const n=(0,o.reactionCountsBrandWrap)({});return Object.entries((0,o.reactionCountsBrandUnwrap)(t)).forEach((([t,i])=>{var o,a,r;const s=t;var c;const l=null!=(c=null==(r=e)||null==(a=r.itemsById)||null==(o=a[s])?void 0:o.score)?c:1;n[s]=l*(i||0)})),n},f=t=>Object.values((0,o.reactionCountsBrandUnwrap)(t)).reduce(((t,e)=>t+(e||0)),0),R=t=>f((0,o.reactionCountsBrandWrap)(t)),E=t=>f(t)>0;var y;const P=(t,e)=>null!=(y=t[e])?y:void 0,A=(t,e)=>t&&e?(0,a.isEqual)(t,e):t===e},640971:(t,e,n)=>{"use strict";n.d(e,{unwrap:()=>i,wrap:()=>o});const i=t=>t,o=t=>t},216833:(t,e,n)=>{"use strict";n.d(e,{isBadgesEnabled:()=>a,isBadgesRenderingEnabled:()=>r});var i,o=n(839470);!function(t){t.BADGES="badges",t.BADGES_RENDERING="badges_rendering",t.DONUT_ONE_TIME="donut_one_time_payments_users"}(i||(i={}));const a=()=>(0,o.partConfigEnabled)("badges"),r=()=>(0,o.partConfigEnabled)("badges_rendering")},508087:(t,e,n)=>{"use strict";n.d(e,{stripPercentVars:()=>i});const i=t=>t.replace(/%[-\w]+%/g,"")},693982:(t,e,n)=>{"use strict";function i(t){const e=t.match(/^([a-z_]+)([0-9\-_]+)$/);if(!e)return null;const[,n,i]=e;return{objectType:n,objectId:i}}n.d(e,{getElementLikeButtonCount:()=>s,getElementLikeButtonIcon:()=>l,getElementLikeButtonLabel:()=>d,likePostObjectId:()=>o,likeReplyObjectId:()=>a,parseLikeObjectId:()=>i});const o=t=>`wall${t}`,a=t=>`wall_reply${t}`;var r;const s=t=>{var e;return null!=(r=null==(e=t)?void 0:e.querySelector(".like_button_count, ._like_button_count"))?r:void 0};var c;const l=t=>{var e;return null!=(c=null==(e=t)?void 0:e.querySelector(".like_button_icon, ._like_button_icon"))?c:void 0};var u;const d=t=>null!=(u=t.querySelector(".like_button_label, ._like_button_label"))?u:void 0},135683:(t,e,n)=>{"use strict";n.d(e,{ATTR_USER_REACTION_ID:()=>i});const i="data-reaction-user-reaction-id"},299156:(t,e,n)=>{"use strict";n.d(e,{getLastOwnReactionChangeTime:()=>A,setDataCurrentId:()=>L,updateReactionButtonContainerForCounts:()=>E,updateReactionButtonCounts:()=>P,updateReactionButtonForCurrentReaction:()=>y});var i=n(11010),o=n(434788),a=n(664988),r=(n(75272),n(29271)),s=n(143790),c=n(457972),l=n(822715),u=n(795558),d=n(893106),v=n(135683),m=n(666734),g=n(775060),p=n(577698),_=n(908088);const b="data-reaction-last-own-change-time",w="PostButtonReactions__icon--animationActive";const I=t=>{var e;const n=null==(e=t.__reactionIconAnimation)?void 0:e.animationItem;if(n){!n._cbs||n.destroy(),delete t.__reactionIconAnimation}},S=(0,i._)((function*(t,e,n,i){var o;if(!(t!==(null==(o=n.__reactionIconAnimation)?void 0:o.animationURL))&&t||(I(n),e.innerHTML="",n.classList.remove(w)),!i||!t)return;const a=yield(0,m.getAnimationAsync)(t,e,{loadAnimationParams:{autoplay:!0,loop:!1}});(0,s.onAnimationReady)(a,(()=>{n.classList.add(w)}));a.addEventListener("complete",(()=>{var t;!0===(null==(t=(0,_.getReactionConfig)())?void 0:t.animationShowStaticAfterEnd)&&(n.classList.remove(w),I(n))})),n.__reactionIconAnimation={animationItem:a,animationURL:t}})),f=(t,e)=>{const n=t.querySelector('[data-section-ref="reactions-button-icon"]');if(!n)return;const{currentOption:i,isUserAction:o}=e;if(i.isReactionSet){var a,r;const t=i.current,e=null==(a=t)?void 0:a.imageMenuURL;n.style.backgroundImage=`url('${e}')`,n.setAttribute("aria-label",null==(r=t)?void 0:r.title)}else{var s;const t=i.default;var c;if(n.style.backgroundImage="",null==(s=t)?void 0:s.title)n.setAttribute("aria-label",null==(c=t)?void 0:c.title)}n.classList.toggle("PostButtonReactions__icon--custom",i.isReactionSet);{const t=i.isReactionSet?i.current.animationURL:void 0,e=(t=>{let e=t.querySelector(".PostButtonReactions__iconAnimation");return e||(e=(0,u.se)('<div class="PostButtonReactions__iconAnimation" data-section-ref="reactions-button-icon-animation"></div>'),t.appendChild(e),e)})(n);S(t,e,n,o)}},R=(t,e,n)=>{t.classList.toggle("PostButtonReactions--icon-active",e),t.classList.toggle("PostButtonReactions--active",e)},E=(t,e)=>{const n=!e||!(0,l.hasReactionsForCounts)(e);t.classList.toggle("PostBottomAction--empty",n)},y=(t,e,n,i)=>{const a=!(0,l.isReactionIdUnset)(e),s=((t,e)=>{let n,i=(0,l.getDefaultReaction)(t);if((0,l.isReactionIdUnset)(e)){if(i)return{isReactionSet:!1,default:i}}else{if(n=t.itemsById[e],n)return{isReactionSet:!0,current:n};console.error(new Error(`Missing reaction meta for ${e} in set '${t.id}'`))}return{_error:!0}})(n,e);"_error"in s||(f(t,{currentOption:s,isUserAction:i}),((t,e)=>{const{currentOption:n}=e,i=n.isReactionSet?n.current.titleColor:void 0,a=n.isReactionSet?n.current.backgroundColor:void 0,r=i?{"--reaction-button-title-color-light":i.light,"--reaction-button-title-color-dark":i.dark}:{"--reaction-button-title-color-light":null,"--reaction-button-title-color-dark":null},s=a?{"--reaction-button-background-color-light":a.light,"--reaction-button-background-color-dark":a.dark}:{"--reaction-button-background-color-light":null,"--reaction-button-background-color-dark":null},c=(0,o._)({},r,s);Object.entries(c).forEach((([e,n])=>{t.style.setProperty(e,n)}))})(t,{currentOption:s}),((t,e)=>{const{currentOption:n}=e;let i="";i=n.isReactionSet?(0,r.langReplace)(r.getLang("reactions_button_unset_reaction_title")||"",{reaction_name:n.current.title||""}):(0,r.langReplace)(r.getLang("reactions_button_set_reaction_with_name")||"",{reaction_name:n.default.title||""})||r.getLang("reactions_button_title")||"",t.setAttribute("aria-label",i||"")})(t,{currentOption:s}),(0,g.isCounterEnabledForBtn)(t)||((t,e)=>{const n=t.querySelector('[data-section-ref="reactions-button-title"]');if(!n)return;const{currentOption:i}=e,o=i.isReactionSet?i.current.title:i.default.title;o?n.innerText=o:(0,c.isDebugEnabled)()&&console.log("reactions: setReactionNameTitle: missing title",i)})(t,{currentOption:s})),R(t,a),i&&function(t,e){t.setAttribute(b,String(e))}(t,Date.now())},P=(t,e,n,i,o)=>{const a=(0,g.getCounterForTitle)(t,e,i,o);if((0,g.isCounterEnabled)(a)&&(((t,e)=>{const n=t.querySelector('[data-section-ref="reactions-button-title"]');if(!n)return;const{counterForTitle:i}=e;if((0,g.isCounterAvailable)(i)){const t=i.buttonText;(0,d.animateCount)(n,t,{allowZero:i.allowZeroAnimation,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})}else(0,c.isDebugEnabled)()&&console.log("reactions: setReactionTitle: missing title",i)})(t,{counterForTitle:a}),i)){((t,e)=>{var n;const i=null==(n=(0,p.getClosestLikeBtnContainerElem)(t))?void 0:n.querySelector('[data-section-ref="reactions-button-screen-reader-counter"]');if(!i)return;const o=(0,r.langNumeric)(e,r.getLang("reactions_n_reacted","raw")||"%s",!0);i.innerText=o})(t,(0,l.calcCountersSum)(i))}},A=t=>{const e=t.getAttribute(b);if(e&&(0,a.isNumeric)(e))try{return new Date(Number.parseInt(e)).getTime()||void 0}catch(t){return void console.error(t)}};const L=(t,e)=>{t.setAttribute(v.ATTR_USER_REACTION_ID,(0,l.isReactionIdUnset)(e)?"":String(e))}},282795:(t,e,n)=>{"use strict";n.d(e,{ReactionMenuTitleVariants:()=>a,TITLE_VARIANT_DEFAULT:()=>o,TitleVariantWithLikedUsers:()=>i});const i="WithLikedUsers",o=i,a=[i,"TitleOnly"]},225960:(t,e,n)=>{"use strict";n.d(e,{ButtonStyleVariant:()=>i});const i={Post:"post",Reply:"reply"}},398948:(t,e,n)=>{"use strict";n.d(e,{renderPreviewItems:()=>u});var i=n(822715),o=n(682615),a=n(795558),r=n(428817),s=n.n(r),c=n(225960),l=n(908088);const u=(t,e,n,r,u)=>{const d=((t,e,n=!1)=>{let o=[];for(const e of Object.keys(t)){const n=(0,i.parseReactionId)(e);n.isValid&&t[n.value]>0&&o.push(n.value)}return o=o.sort(((e,n)=>(t[n]||0)-(t[e]||0))).slice(0,e),n&&o.reverse(),o})(e,3),v=t.querySelector(".ReactionsPreview__items"),m=(0,l.getReactionSet)(n),g=0===(0,i.calcCountersSum)(e),p=s().reactions_preview_item;v&&m&&"string"==typeof p?(v.innerHTML=d.map((t=>{const e=m.itemsById[t];if(!e)return"";const n=(0,o.classNames)({"ReactionsPreviewItem--lite ReactionsPreviewItem--stackOverlayLite":u===c.ButtonStyleVariant.Reply,"ReactionsPreviewItem--post ReactionsPreviewItem--stackOverlayPost":u===c.ButtonStyleVariant.Post});return(0,a.rs)(p,{image_url:e.imagePreviewURL,title:e.title,class:n})})).join(""),t.classList.toggle("ReactionsPreview--empty",g),t.classList.toggle("ReactionsPreview--active",void 0!==r)):console.warn("Unable to render reaction previews",{itemsContainer:v,previewItemTemplate:p,reactionSet:m})}},898298:(t,e,n)=>{"use strict";n.d(e,{isIntentPreviewHidden:()=>c,isIntentPreviewInActionStatusBar:()=>s,isIntentPreviewUseCurrent:()=>l,isVariantHidden:()=>a,isVariantInActionStatusBar:()=>o,parsePreviewVariant:()=>d,previewVisibilityIntentForVariant:()=>u,previewVisibilityUseCurrent:()=>r});var i=n(580151);const o=t=>t===i.PreviewVariantActionStatusBar,a=t=>t===i.PreviewVariantHidden,r={kind:"useCurrent"},s=t=>t.kind===i.PreviewVariantActionStatusBar,c=t=>t.kind===i.PreviewVariantHidden,l=t=>"useCurrent"===t.kind,u=t=>t?{kind:t}:r,d=t=>i.PreviewVariants.includes(t)?t:void 0},580151:(t,e,n)=>{"use strict";n.d(e,{PreviewVariantActionStatusBar:()=>i,PreviewVariantHidden:()=>o,PreviewVariants:()=>a});const i="action_status_bar",o="hidden",a=[i,o]},682951:(t,e,n)=>{"use strict";n.d(e,{REACTIONS_COUNTS_RESPONSE_FIELD:()=>c,SIZE_128:()=>s,SIZE_32:()=>o,SIZE_40:()=>a,SIZE_96:()=>r,SUPPORTED_OBJECT_TYPES:()=>i,WK_SECTION_PREFIX_REACTIONS:()=>l});const i={wall:"wall",wall_reply:"wall_reply"},o={width:32,height:32},a={width:40,height:40},r={width:96,height:96},s={width:128,height:128},c="reactions_counts",l="reactions"},666734:(t,e,n)=>{"use strict";n.d(e,{animationItemHasData:()=>r,getAnimationAsync:()=>s});var i=n(143790);const o=(0,n(367431).makeSharedState)("reactions-animations-storage",(()=>({animationItemsData:new Map})),{version:0}),a=()=>o().animationItemsData,r=t=>a().has(t),s=(0,i.getAnimationAsync)({animationDataGet:({animationId:t})=>a().get(t),animationDataSet:({animationId:t,loadedAnimationData:e})=>{a().set(t,e)},animationModuleLoader:i.animationModuleLoaderAsync})},512637:(t,e,n)=>{"use strict";n.d(e,{ENABLED_IN_POST_REPLY:()=>o,isDebugEnabled:()=>i.isDebugEnabled});var i=n(457972);const o=!1},775060:(t,e,n)=>{"use strict";n.d(e,{getCounterForTitle:()=>r,isCounterAvailable:()=>c,isCounterEnabled:()=>s,isCounterEnabledForBtn:()=>a});var i=n(822715),o=n(29271);const a=t=>!!t.getAttribute("data-reaction-button-text-is-counter");function r(t,e,n,r){if(!a(t))return{kind:"disabled"};if(!n)return{kind:"error"};const s=0!==(r?(0,i.calcCountersSum)(r):0);if(!(0,i.hasReactionsForCounts)(n))return{kind:"enabled",allowZeroAnimation:s,buttonText:""};const c=(0,i.calcCounters)(n,e),l=(0,i.calcCountersWeightedSum)(c);return{kind:"enabled",allowZeroAnimation:s,buttonText:(0,o.langNumeric)(l,"%s",!0)}}function s(t){return!!t&&"disabled"!==t.kind}function c(t){return"enabled"===t.kind}},655154:(t,e,n)=>{"use strict";n.d(e,{addDataUpdateListener:()=>r,addReactionChooseListener:()=>c,emitDataUpdate:()=>s,emitReactionChoose:()=>l});var i=n(980602);const o=(0,n(367431).makeSharedState)("reactions-menu-events",(()=>({emitter:new i.default})),{version:0}),a=()=>o().emitter,r=(t,e)=>{const n=a(),i={[`${t}:data_update`]:e};return n.addListeners(i),()=>{n.removeListeners(i)}},s=(t,e)=>{a().emit(`${t}:data_update`,e)},c=(t,e)=>{const n=a(),i={[`${t}:reaction_choose`]:e};return n.addListeners(i),()=>{n.removeListeners(i)}},l=t=>{a().emit(`${t}:reaction_choose`)}},32375:(t,e,n)=>{"use strict";n.d(e,{getPreviewVariantForLikeBtn:()=>g,reactionsElemPayload:()=>p,reactionsElemPayloadForBadges:()=>_,shouldReactionsPreviewBeVisible:()=>S,updateReactionsButtonForCounts:()=>E,updateReactionsPreview:()=>R,verifyPayloadForBadges:()=>b});var i=n(265865),o=n(822715),a=n(893106),r=n(29271),s=n(908088),c=n(577698),l=n(249823),u=n(898298),d=n(398948),v=n(135683);const m=t=>{const e=t.getAttribute("data-reaction-counts");if(null===e)return{};const n=e?(0,i.parseJSON)(e):void 0;return"object"==typeof n&&null!==n?n:void 0},g=t=>{const e=t.getAttribute("data-reaction-preview-variant");if(e)return(0,u.parsePreviewVariant)(e)},p=t=>{const e=t.getAttribute("data-reaction-target-object"),n=t.getAttribute("data-reaction-hash"),i=t.getAttribute("data-reaction-set-id");if(null===i)return;const a=t.getAttribute(v.ATTR_USER_REACTION_ID),r=a?(0,o.parseReactionIdOrUnset)(a):void 0,s=t.getAttribute("data-reaction-style-variant"),c=s&&(0,l.isValidButtonStyleVariant)(s)?s:void 0,u=t.getAttribute("data-reaction-menu-title-variant"),d=u&&(0,l.isValidButtonTitleVariant)(u)?u:void 0,p=g(t);return{counts:m(t),csrfHash:n,objectRaw:e,reactionSetId:i,styleVariant:c,titleVariant:d,userReactionId:r,previewVariant:p}},_=t=>({objectId:t.getAttribute("data-badges-object-id"),objectOwnerId:t.getAttribute("data-badges-object-owner-id"),objectType:t.getAttribute("data-badges-object-type"),ref:t.getAttribute("data-badges-ref"),showOnboarding:t.getAttribute("data-badges-show-onboarding")}),b=t=>{const{objectId:e,objectOwnerId:n,objectType:i}=t;return e&&n&&i};var w;const I=(t,e,n,i)=>{const o=(0,r.langNumeric)(n,r.getLang("reactions_n_reacted","raw")||"%s",!0);t.setAttribute("aria-label",o);const s=null!=(w=t.querySelector('[data-section-ref="like-button-count"]'))?w:void 0;if(!s)return;if(t.tt&&"object"==typeof t.tt){var c,l;if(!(t.tt.shown||t.tt.showing))null==(l=t.tt)||null==(c=l.destroy)||c.call(l)}const u=(0,r.langNumeric)(e,"%s",!0);(0,a.animateCount)(s,u,{allowZero:0!==i,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})},S=t=>(0,o.hasReactionsForCounts)(t),f=(t,e,n)=>{const i=p(t);i&&i.objectRaw&&((t,{counts:e,countsPrevious:n,objectRaw:i,reactionId:a,reactionSetId:r,styleVariant:l})=>{const u=(0,s.getReactionSet)(r),v=(0,o.calcCounters)(e,u),m=(0,o.calcCountersWeightedSum)(v),g=(0,o.calcCountersSum)(e),p=n?(0,o.calcCountersSum)(n):0,_=(0,c.getPreviewElem)(i);_&&((0,d.renderPreviewItems)(_,e,r,a,l),I(_,m,g,p))})(0,{counts:e,countsPrevious:n,objectRaw:i.objectRaw,reactionId:i.userReactionId,reactionSetId:i.reactionSetId,styleVariant:i.styleVariant})},R=(t,e)=>{const n=(0,c.getLikeBtnElem)(t),i=e.counts;n&&i?f(n,i,e.countsPrevious):console.warn("Unable to update object reactions",{objectRaw:t,options:e})},E=(t,{counts:e})=>{const n=(0,c.getLikeBtnElem)(t);n&&((t,e)=>{t.setAttribute("data-reaction-counts",JSON.stringify(e))})(n,e)}},403702:(t,e,n)=>{"use strict";n.d(e,{reactionLogError:()=>a});var i=n(698216),o=n(908088);const a=({error:t})=>{var e;var n;const a=null!=(n=null==(e=(0,o.getReactionConfig)())?void 0:e.reportJsErrors)&&n;(0,i.reactionLogError)({error:t,reportError:a})}},577698:(t,e,n)=>{"use strict";var i;n.d(e,{getButtonContainer:()=>l,getClosestLikeBtnContainerElem:()=>r,getHiddenLikeBtn:()=>p,getLikeBtn:()=>m,getLikeBtnElem:()=>o,getLikeWrap:()=>c,getMenuMount:()=>d,getPreviewElem:()=>_});const o=t=>null!=(i=document.querySelector(`[data-section-ref="reactions-button"][data-reaction-target-object="${t}"]`))?i:void 0;var a;const r=t=>null!=(a=t.closest('[data-section-ref="reactions-button-container"]'))?a:void 0;var s;const c=t=>{const e=o(t);if(e)return null!=(s=e.closest(".like_wrap"))?s:void 0},l=t=>t.closest('[data-section-ref="reactions-button-container"]');var u;const d=t=>null!=(u=t.querySelector('[data-section-ref="reactions-menu-mount"]'))?u:null;var v;const m=t=>null!=(v=t.querySelector('[data-section-ref="reactions-button"]'))?v:null;var g;const p=t=>null!=(g=t.querySelector('[data-section-ref="reactions-hidden-button"]'))?g:void 0,_=t=>document.querySelector(`[data-section-ref="reactions-preview-items"][data-reaction-target-object="${t}"]`)},908088:(t,e,n)=>{"use strict";n.d(e,{getReactionConfig:()=>p,getReactionSet:()=>m,storageAddSets:()=>v,storageSetConfig:()=>g});var i=n(434788),o=n(659397),a=n(822715),r=n(367431),s=n(403702),c=n(682951),l=n(512637);const u=(0,r.makeSharedState)("reactions-storage",(()=>new Map),{version:0}),d=(0,r.makeSharedState)("reactions-config",(()=>({config:void 0})),{version:0}),v=t=>{(0,l.isDebugEnabled)()&&console.log(t),Object.entries(t).forEach((([t,e])=>{const n=(0,a.validateReactionSetPayloaditems)(e,t);if(n)return void(0,s.reactionLogError)({error:n.error});const r=e.map((t=>(0,i._)({},t,{title:(0,o.decodeHTMLEntities)(t.title)})));u().set(t,(0,a.prepareReactionMenuSet)(t,r,{imageMenuSize:c.SIZE_96,imagePreviewSize:c.SIZE_32,imageStoryPanelSize:c.SIZE_128,imageStoryPreviewSize:c.SIZE_40}))}))},m=t=>{const e=u().get(t);if(e)return e;{const e=new Error(`Reaction set not found: ${t}`);(0,s.reactionLogError)({error:e})}},g=t=>{(0,l.isDebugEnabled)()&&console.log(t);const e=(0,a.parseReactionMenuConfig)(t);e?d().config=e:console.warn("Reactions: invalid menu config passed",t)},p=()=>{var t;return null==(t=d())?void 0:t.config}},249823:(t,e,n)=>{"use strict";n.d(e,{isValidButtonStyleVariant:()=>v,isValidButtonTitleVariant:()=>d,isValidEnvironment:()=>r,preloadImage:()=>s,usePrevious:()=>c,usePreviousRef:()=>l});var i=n(667294),o=n(282795),a=n(225960);const r=()=>{var t,e,n;return"function"==typeof(null==(t=window.cur)?void 0:t.viewAsBox)?(window.cur.viewAsBox(),!1):!(window.vk.widget&&!window.vk.id)||(null==(n=window.Widgets)||null==(e=n.oauth)||e.call(n),!1)},s=t=>new Promise(((e,n)=>{const i=new Image;i.src=t,i.onload=()=>e(),i.onerror=()=>n()})),c=t=>{const e=(0,i.useRef)(t);return(0,i.useEffect)((()=>{e.current=t})),e.current},l=t=>{const e=(0,i.useRef)(t);return(0,i.useEffect)((()=>{e.current=t})),e},u=Object.values(a.ButtonStyleVariant),d=t=>o.ReactionMenuTitleVariants.includes(t),v=t=>u.includes(t)},109454:(t,e,n)=>{"use strict";n.d(e,{isReactionsFullUpdatePayload:()=>r,reactionsCountsOnlyUpdatePayload:()=>s,reactionsCountsUpdatePayload:()=>a});var i=n(434788),o=n(900641);const a=(t,e)=>(0,i._)({kind:o.PayloadKindFull},t,{reactionIdState:{reactionId:e.id}}),r=t=>t.kind===o.PayloadKindFull,s=t=>(0,i._)({kind:o.PayloadKindCountsOnly},t)},900641:(t,e,n)=>{"use strict";n.d(e,{PayloadKindCountsOnly:()=>i,PayloadKindFull:()=>o});const i="counts_only",o="counts_with_current_reaction"},530517:(t,e,n)=>{"use strict";n.d(e,{postRenderReactionsInit:()=>k});var i=n(299156),o=n(659397),a=n(828109),r=n(795558),s=n(508087),c=n(693982),l=n(512637),u=n(32375),d=n(898298),v=n(577698),m=n(109454),g=n(358496),p=n(170864),_=n(72569),b=n(655154),w=n(580151),I=n(908088),S=n(216833);const f=(t,e,n=(()=>{var t;return null==(t=window.cur)?void 0:t.wallTpl})())=>{var i;const o=null==(i=n)?void 0:i[t];if(o)return(0,s.stripPercentVars)((0,r.rs)(o,e));console.warn(`renderTemplate: missing template '${t}'`,n)},R=({isUserAction:t=!1},...e)=>{t?console.error(...e):(0,l.isDebugEnabled)()&&console.warn(...e)},E=t=>(0,S.isBadgesEnabled)()&&t.classList.contains("PostActionStatusBar--withBadges");const y=(t,e,{isActionStatusBarVisible:n,isReactionsPreviewVisible:i,positionTrackingEnd:a})=>{const s=((t,e)=>{var n,i,o;const a=(0,v.getLikeWrap)(t);if(!a)return;const s=null==(n=(0,p.getPostElem)(e,a))?void 0:n.querySelector('[data-section-ref="post-action-status-bar"]');if(s)return{actionStatusBar:s};const c=(0,_.isWkLayerWallPostOpen)()?null==(i=window.wkcur)?void 0:i.wallTpl:null==(o=window.cur)?void 0:o.wallTpl,l=(0,r.se)(f("post_action_status_bar",{class:"PostActionStatusBar--hidden"},c));return l?((0,r.domInsertBefore)(l,a),{actionStatusBar:l}):void 0})(t,e.postFullId);if(!s)return void R({},"Unable to init ActionStatusBar in post",e);const{actionStatusBar:c}=s;if(c.classList.toggle("PostActionStatusBar--hidden",!n),E(c)&&c.classList.toggle("PostActionStatusBar--withReactions",i),n&&!(0,v.getPreviewElem)(t)){const e=(0,r.se)(function(t,e,n={}){var i,a;const r=(0,_.isWkLayerWallPostOpen)()?null==(i=window.wkcur)?void 0:i.wallTpl:null==(a=window.cur)?void 0:a.wallTpl,s=(0,o.classNames)({"ReactionsPreview--empty":!t,"ReactionsPreview--isInActionStatusBar":!!n.isInActionStatusBar});return f("post_reactions_preview",{class:s,object_raw:e},r)}(i,t,{isInActionStatusBar:!0}));if(E(c)){const t=c.querySelector(".PostActionStatusBar__leftInner");t&&t.prepend(e)}else c.prepend(e)}if(a){var l;const e=(0,v.getLikeBtnElem)(t);null==(l=a)||l(e)}},P=t=>{var e;if(!(t=>void 0!==t.counts)(t))return void R(t,"Counts is invalid or missing");const n=(0,c.likePostObjectId)(t.postFullId),i=(0,p.getPostElem)(t.postFullId,(0,v.getLikeWrap)(n));i||R(t,"Missing post element for reactions preview update",{payload:t,likeWrap:(0,v.getLikeWrap)(n)});const o=(0,v.getLikeBtnElem)(n);if(!o)return void R(t,"Unable to find reactions button",{likeObjectId:n});const a=(0,u.reactionsElemPayload)(o),r=null==(e=a)?void 0:e.counts;A({elemPayload:a,likeBtnElem:o,likeObjectId:n,payload:t}),L({countsPrevious:r,likeBtnElem:o,likeObjectId:n,payload:t,postEl:i})},A=({elemPayload:t,likeBtnElem:e,likeObjectId:n,payload:o})=>{const{counts:a}=o;if(!!o.isQueueUpdate&&(t=>{const e=(0,i.getLastOwnReactionChangeTime)(t);if(!e)return!1;const n=e+1e4;return Date.now()<n})(e))(0,l.isDebugEnabled)()&&console.log("Ignoring reactions update from queue",o);else{if(t){const{counts:n,reactionSetId:r}=t,s=(0,I.getReactionSet)(r);if((0,m.isReactionsFullUpdatePayload)(o)){const t=o.reactionIdState.reactionId;s&&(0,i.updateReactionButtonForCurrentReaction)(e,t,s,o.isUserAction)}s&&((0,i.updateReactionButtonCounts)(e,s,o.isUserAction,a,n),(0,i.updateReactionButtonContainerForCounts)(e,a))}if((0,m.isReactionsFullUpdatePayload)(o)){var r;const n=o.reactionIdState.reactionId;(0,i.setDataCurrentId)(e,n),o.isUserAction&&(null==(r=t)?void 0:r.objectRaw)&&(0,b.emitDataUpdate)(t.objectRaw,{currentReactionId:n})}(0,u.updateReactionsButtonForCounts)(n,{counts:a})}},L=({countsPrevious:t,likeBtnElem:e,likeObjectId:n,payload:i,postEl:o})=>{const{counts:r,previewVisibility:s=d.previewVisibilityUseCurrent}=i,c=((t,e)=>{if((0,d.isIntentPreviewInActionStatusBar)(t))return{previewVariant:w.PreviewVariantActionStatusBar};if((0,d.isIntentPreviewHidden)(t))return{previewVariant:w.PreviewVariantHidden};if((0,d.isIntentPreviewUseCurrent)(t)){const t=(0,u.getPreviewVariantForLikeBtn)(e);if(t)return{previewVariant:t}}})(s,e);if(!c)return;const{previewVariant:l}=c,v=(0,d.isVariantInActionStatusBar)(l),m=(0,u.shouldReactionsPreviewBeVisible)(r),g=(0,d.isVariantHidden)(l)||v&&!m;if(v){let t;i.isPrimaryLikeButtonClick&&!i.isFromWkLayer&&(t=(0,a.preservePositionBetween)(e).start());const r=m;var p;if(!(0,S.isBadgesEnabled)())null==(p=o)||p.classList.toggle("post--withActionStatusBar",r);y(n,i,{isActionStatusBarVisible:r,isReactionsPreviewVisible:m,positionTrackingEnd:t})}g||(0,u.updateReactionsPreview)(n,{counts:r,countsPrevious:t})},C=t=>{if(!l.ENABLED_IN_POST_REPLY)return!1;const{counts:e}=t;if(!e)return;const n=(0,c.likeReplyObjectId)(t.replyFullId);(0,u.updateReactionsPreview)(n,{counts:e,countsPrevious:void 0}),(0,u.updateReactionsButtonForCounts)(n,{counts:e})},k=()=>{let t=[(0,g.registerUniqueListener)("wall-post-action-status-bar",g.WallDataEvents.post_reactions_counts_update,P),(0,g.registerUniqueListener)("wall-reply-reactions-counts",g.WallDataEvents.reply_reactions_counts_update,C)];return{onDestroy:()=>{t.forEach((t=>{t()})),t=[]}}}},505426:(t,e,n)=>{"use strict";n.d(e,{WallDataEvents:()=>r,emitEvent:()=>d,registerNonGlobalNonUniqueListener:()=>u,registerUniqueListener:()=>l});var i=n(434788),o=n(980602),a=n(367431);const r={post_reactions_counts_update:"wall/post_reactions_counts_update",reply_reactions_counts_update:"wall/reply_reactions_counts_update",post_subscribe_update:"wall/post_subscribe_update"},s=(0,a.makeSharedState)("wall-data",(()=>({emitter:new o.default,keyedListeners:Object.create(null)})),{version:0}),c=(t,e,n)=>{var o,a;const r=s(),c=null==(a=r.keyedListeners)||null==(o=a[t])?void 0:o[e];return c&&r.emitter.removeListener(t,c),((t,e,n)=>{const o=s();return o.emitter.addListener(t,n),o.keyedListeners[t]=(0,i._)({},o.keyedListeners[t],{[e]:n}),()=>{var i,a;o.emitter.removeListener(t,n),(null==(i=o.keyedListeners[t])?void 0:i[e])===n&&(null==(a=o.keyedListeners[t])||delete a[e])}})(t,e,n)},l=(t,e,n)=>c(e,t,n),u=(t,e)=>((t,e)=>{const n=s();return n.emitter.addListener(t,e),()=>{n.emitter.removeListener(t,e)}})(t,e),d=(t,e)=>{s().emitter.emit(t,e)}},358496:(t,e,n)=>{"use strict";n.d(e,{WallDataEvents:()=>i.WallDataEvents,registerUniqueListener:()=>i.registerUniqueListener});var i=n(505426)},170864:(t,e,n)=>{"use strict";n.d(e,{getPostElem:()=>a,replyUserImageImg:()=>l,replyUserImageLinkClosest:()=>s});var i,o;const a=(t,e)=>{var n;return null!=(o=null!=(i=(t=>{var e;if("string"==typeof t)return null!=(e=document.querySelector(`#post${t}`))?e:void 0})(t))?i:null==(n=e)?void 0:n.closest("._post, .wl_post"))?o:void 0};var r;const s=t=>null!=(r=t.closest(".reply_image, ._reply_image"))?r:void 0;var c;const l=t=>null!=(c=t.querySelector("img.reply_img"))?c:void 0}}]);try{stManager.done("dist/155012f0e2f6a2354001adc2a93ffcaf.19dad3c4695703ad727f.js")}catch(t){}