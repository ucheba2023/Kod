"use strict";(self.webpackChunkvk=self.webpackChunkvk||[]).push([[41140],{437683:(_,e,t)=>{t.d(e,{NO_POST_ID:()=>l,THUMB_TYPE_ALBUM:()=>n,THUMB_TYPE_DOC:()=>i,THUMB_TYPE_MARKET_ALBUM:()=>r,THUMB_TYPE_PHOTO:()=>s,THUMB_TYPE_VIDEO:()=>a,addThumbsInData:()=>D,deleteThumbInData:()=>p,getThumbByIndex:()=>u,getThumbsMediaItems:()=>b,isValidThumbType:()=>d,moveThumbsInData:()=>P});var o=t(839470);const l="no_post_id",i="doc",s="photo",a="video",n="album",r="market_album";function d(_){const e=[i,s,a];return(0,o.partConfigEnabled)("attachments_primary_mode_web_feature")||e.push(n,r),!!~e.indexOf(_.toString())}const E=([_,,e])=>_===i?"editable"in e&&function(_){return _.editable&&"gif"!==_.ext}(e):d(_);var c;const b=_=>{var e;return null!=(c=null==(e=_)?void 0:e.filter(E))?c:[]};const P=(_,e,t)=>{const o=b(t),l=t.map((_=>d(_[0])?void 0:_)),i=o[_];return o.splice(_,1),o.splice(e,0,i),l.map((_=>_||o.shift()))},u=(_,e)=>b(e)[_],p=(_,e)=>{const t=u(_,e);return e.filter((_=>_!==t))},D=(_,e)=>{const[t,o]=_,l=e.findIndex((([_,e])=>_===t&&e===o));return l<0?e.push(_):e[l]=_,e}},137363:(_,e,t)=>{t.d(e,{ANALYTICS_SCREEN_OTHER:()=>i,ANALYTICS_SCREEN_SETTINGS:()=>l,GroupAdminLevel:()=>o});const o={USER:0,MODERATOR:1,EDITOR:2,ADMINISTRATOR:3,HOST:4,EVENT_CREATOR:5,CREATOR:6,PSEUDO_LEVEL_ADVERTISER:100},l="settings",i="other"},234275:(_,e,t)=>{t.d(e,{BestFriendsEventType:()=>o,sendBestFriendsAnalytic:()=>s});var o,l=t(504867),i=t(839470);function s(_,e){const t={event_type:_,nav_screen:e||window.cur.module};(0,i.partConfigEnabled)("best_friends_analytics_log")&&console.log(t),(0,l.statlogsValueEvent)("best_friends_product_analytic",t)}!function(_){_.addFriendsFromChat="add_friends_from_chat",_.clear="clear",_.moreChats="more_chats",_.selectFriendFromSearch="select_friend_from_search",_.selectChatFromSearch="select_chat_from_search",_.saveBestFriendsList="save_best_friends_list",_.updatePopupSave="update_popup_save",_.updatePopupCancel="update_popup_cancel",_.createPostFromPopupBest="create_post_from_popup_best",_.createPostFromPopupFriends="create_post_from_popup_friends",_.clickToLockFriends="click_to_lock_friends",_.clickToLockBestFriends="click_to_lock_best_friends",_.editBestFriendsFromPopup="edit_best_friends_from_popup",_.editBestFriends="edit_best_friends",_.selectBestFriends="select_best_friends",_.clickToBestFriendsEntrypoint="click_to_best_friends_entrypoint"}(o||(o={}))},899740:(_,e,t)=>{t.d(e,{ATTACH_VIEW_EVENTS:()=>o});const o={grid:"grid_mode",carousel:"carousel_mode"}},514914:(_,e,t)=>{t.d(e,{PostingItemStatCollector:()=>i});var o=t(957973),l=t(193452);class i{logEvent(_){const e={type:o.ClickProductionStatEventTypes.TYPE_POSTING_ITEM,[o.ClickProductionStatEventTypes.TYPE_POSTING_ITEM]:_},t={type:o.EventItemType.POST};this.clickStatCollector.logEvent(e,t)}constructor(){this.productStatCollector=new l.ProductionStatCollector,this.clickStatCollector=new l.ClickStatCollector(this.productStatCollector)}}},874162:(_,e,t)=>{t.d(e,{DEFAULT_CACHE:()=>n,ORDER_ERRORS:()=>d,ORDER_ITEM_ERRORS:()=>E,SAMPLE_RECIPIENT_ID:()=>r,STICKER_ANIMATION:()=>a,STICKER_IMAGE:()=>s,STICKER_PACK_ICON:()=>l,STICKER_PACK_THUMB:()=>i});var o=t(899033);const l={square_png:{id:"square.png",width:104,height:104},square_15x_png:{id:"square_1.5x.png",width:156,height:156},square_2x_png:{id:"square_2x.png",width:208,height:208},square_3x_png:{id:"square_3x.png",width:312,height:312},square_4x_png:{id:"square_4x.png",width:416,height:416}},i={"102_png":{id:"102.png",width:102,height:102,theme:o.Theme.LIGHT},"51_png":{id:"51.png",width:51,height:51,theme:o.Theme.LIGHT},"68_png":{id:"68.png",width:68,height:68,theme:o.Theme.LIGHT},"34_png":{id:"34.png",width:34,height:34,theme:o.Theme.LIGHT},"60_png":{id:"60.png",width:60,height:60,theme:o.Theme.LIGHT},"30_png":{id:"30.png",width:30,height:30,theme:o.Theme.LIGHT},"102b_png":{id:"102b.png",width:102,height:102,theme:o.Theme.DARK},"51b_png":{id:"51b.png",width:51,height:51,theme:o.Theme.DARK},"68b_png":{id:"68b.png",width:68,height:68,theme:o.Theme.DARK},"34b_png":{id:"34b.png",width:34,height:34,theme:o.Theme.DARK},"60b_png":{id:"60b.png",width:60,height:60,theme:o.Theme.DARK},"30b_png":{id:"30b.png",width:30,height:30,theme:o.Theme.DARK},"44_png":{id:"44.png",width:44,height:44},"22_png":{id:"22.png",width:22,height:22}},s={"64_png":{id:"64.png",width:64,height:64,theme:o.Theme.LIGHT},"128_png":{id:"128.png",width:128,height:128,theme:o.Theme.LIGHT},"256_png":{id:"256.png",width:256,height:256,theme:o.Theme.LIGHT},"352_png":{id:"352.png",width:352,height:352,theme:o.Theme.LIGHT},"512_png":{id:"512.png",width:512,height:512,theme:o.Theme.LIGHT},"64b_png":{id:"64b.png",width:64,height:64,theme:o.Theme.DARK},"128b_png":{id:"128b.png",width:128,height:128,theme:o.Theme.DARK},"256b_png":{id:"256b.png",width:256,height:256,theme:o.Theme.DARK},"352b_png":{id:"352b.png",width:352,height:352,theme:o.Theme.DARK},"512b_png":{id:"512b.png",width:512,height:512,theme:o.Theme.DARK}},a={[o.Theme.LIGHT]:"animation.json",[o.Theme.DARK]:"animation.b.json"},n={products:(0,o.createProductsMap)([]),productIdsQueue:new Set,productsPromise:void 0,productPromises:new Map,stickers:new Map},r=-1;var d,E;!function(_){_.NOT_SIGNED_IN="not_signed_in",_.NO_VALID_ITEMS="no_valid_items"}(d||(d={})),function(_){_.DUPLICATE_PRODUCT="duplicate_product"}(E||(E={}))},899033:(_,e,t)=>{var o;t.d(e,{ProductsByType:()=>c,Theme:()=>o,UserProductStateKey:()=>a,createProductsMap:()=>s,imageSizeCache:()=>i,imageSizesIndex:()=>l,isBasePack:()=>n,isPackProduct:()=>d,isStyleProduct:()=>r}),function(_){_.LIGHT="light",_.DARK="dark",_.DEFAULT="light"}(o||(o={}));const l=Symbol(),i=Symbol(),s=_=>new Map(_);var a;!function(_){_.IsNew="is_new"}(a||(a={}));const n=_=>void 0!==_.sticker_ids,r=_=>void 0!==_.base_id,d=_=>n(_)&&!r(_);var E;!function(_){_.Pack="pack",_.Style="style"}(E||(E={}));class c{add(_){_&&(d(_)?this.pack.add(_):r(_)&&this.style.add(_))}getPack(){return this.pack.values().next().value}getStyles(){return Array.from(this.style.values())}getCount(){return this.pack.size+this.style.size}constructor(_=[]){this.pack=new Set,this.style=new Set,_.forEach((_=>this.add(_)))}}},457299:(_,e,t)=>{t.d(e,{getStickerAnimationUrl:()=>d,getStickerImageUrl:()=>r,getStickerPackIconUrl:()=>E,getStickersKitModule:()=>b,isSampleOrderItem:()=>c,logStickersError:()=>P});var o=t(899033),l=t(874162),i=t(970978);const s=(_,e,t,l=o.Theme.DEFAULT)=>{const i=window.devicePixelRatio,s=[e*=i,t*=i,l].toString();let a=_[o.imageSizeCache];if(a&&a.has(s)){const _=a.get(s);if(_)return _}a||(a=new Map,_[o.imageSizeCache]=a);const n=(_=>{let e=_[o.imageSizesIndex];return e||(e=Object.values(_).sort(((_,e)=>_.width-e.width||_.height-e.height)),_[o.imageSizesIndex]=e),e})(_).filter((_=>!_.theme||_.theme===l)),r=n.find((_=>_.width>=e&&_.height>=t))||n[n.length-1];return a.set(s,r),r},a=(_,e,t=o.Theme.DEFAULT)=>s(l.STICKER_IMAGE,_,e,t),n=(_,e)=>_.image.base_url+"/"+e.id+(_.image.version?`?${_.image.version}`:"");function r(_,e,t,l=o.Theme.DEFAULT){var i;if(null==(i=_.render)?void 0:i.images){const{images:o}=_.render;let i;o.sort(((_,e)=>_.width-e.width||_.height-e.height));for(const _ of o)if(_.width>=e&&_.height>=t){if(_.theme===l)return _.url;i=_}if(i)return i.url}return n(_,a(e,t,l))}const d=(_,e=o.Theme.DEFAULT)=>_.animation?_.animation.base_url+"/"+l.STICKER_ANIMATION[e]+(_.animation.version?`?${_.animation.version}`:""):"",E=(_,e,t,i=o.Theme.DEFAULT)=>((_,e)=>_.icon.base_url+"/"+e.id+(_.thumb.version?`?${_.thumb.version}`:""))(_,((_,e,t=o.Theme.DEFAULT)=>s(l.STICKER_PACK_ICON,_,e,t))(e,t,i)),c=_=>_.recipient_id===l.SAMPLE_RECIPIENT_ID,b=()=>t.e(51162).then(t.bind(t,406857)),P=_=>{(0,i.logError)(new Error(`Stickers: ${_}`),{environment:"stickers"})}},975687:(_,e,t)=>{function o(_){try{_.offsetWidth,_.offsetHeight}catch(_){}}t.d(e,{reflow:()=>o})},910240:(_,e,t)=>{t.d(e,{getPrimaryCarouselGallery:()=>l});var o=t(459474);function l(_){const e=_.closest(`.${o.UI_GALLERY_CLASSNAME}`);if(!e)return;const t=(0,o.uiGetGallery)(e);return t||void 0}},346675:(_,e,t)=>{t.d(e,{AttachmentsViewSelector:()=>n});var o=t(903006),l=t(953908),i=t(426585),s=t(899740);const a=new(t(514914).PostingItemStatCollector);class n{setMediaSelectedValue(_){this.addMedia.setAttachView(_)}createTooltip(){var _;const e=this.selectorEl.querySelector(".post_action_tt_content"),t=this.selectorEl.querySelector(".post_action_btn_layout");if(!e||!t)return;const s=null==(_=(0,o.createPostTooltip)(i.ACTION_BUTTON_ID,this.linkId,void 0,{customShow:!0}))?void 0:_.toooltip;return s&&((0,l.addEvent)(t,"click",(()=>{this._isEnabled&&s.toggle()})),this.selectorEl.querySelectorAll(".radiobtn").forEach((_=>{(0,l.addEvent)(_,"click",this.handleOptionClick.bind(this))}))),s}handleOptionClick(_){var e;if(!(_.currentTarget instanceof HTMLElement))return;const t=_.currentTarget.getAttribute("data-value");if(null==(e=this.tooltip)||e.hide(),t){this.setMediaSelectedValue(t),this.selectOption(t);const _=s.ATTACH_VIEW_EVENTS[t];_&&a.logEvent({primary_mode_event:{primary_mode_event_type:_}})}}updateTooltipRadioBtn(_,e){(0,o.updatePostTooltipActionRadioBtn)(_,e,`post_settings_btn${i.ACTION_BUTTON_ID}${this.linkId}`)}updateActionButtonText(_,e){e&&(_.innerText=e,_.setAttribute("aria-label",e))}selectOption(_){const e=this.selectorEl.querySelector(`[data-value="${_}"]`),t=this.selectorEl.querySelector(".post_action_btn_text");if(!(e instanceof HTMLElement&&t instanceof HTMLElement))return;this.updateTooltipRadioBtn(e,_);const o=e.getAttribute("aria-label")||"";this.updateActionButtonText(t,o)}isHidden(){return this._isHidden}setVisibility(_){this.selectorEl.style.display=_?"":"none",this._isHidden=!_}isEnabled(){return this._isEnabled}setEnabled(_){_?this.selectorEl.classList.remove(i.ACTION_BUTTON_DISABLED):this.selectorEl.classList.add(i.ACTION_BUTTON_DISABLED),this._isEnabled=_}constructor(_,e,t,o,l={isHidden:!0,isEnabled:!1}){this.linkId=e,this.selectorEl=t,this.tooltip=this.createTooltip(),this.addMedia=_,this.selectOption(o),this.setVisibility(!l.isHidden),this.setEnabled(l.isEnabled),this.setMediaSelectedValue(o)}}},411741:(_,e,t)=>{t.d(e,{initAttachmentsViewSelector:()=>i});var o=t(346675),l=t(838563);const i=(_,e,t,i)=>{if(!(e instanceof HTMLElement))return;const s=(0,l.renderTemplate)("primary_attachments_view_template",{link_id:_});if(!s)return;const a=e.querySelector(".PostDonutDuration")||e.querySelector(".post_available");var n;a?null==(n=a.parentNode)||n.insertBefore(s,a.nextSibling):e.insertBefore(s,e.firstChild);const r=new o.AttachmentsViewSelector(t,_,s,null!=i?i:(0,l.getAttachmentsPrimaryModeDefaultValue)()),d=_=>{_?(r.setVisibility(!0),r.setEnabled(!0)):r.setVisibility(!1)};return d(t.getMediaUIViewSelectorAvailable()),t.emitter.on(t.eventTypes.previewUpdate,d),t.emitter.on(t.eventTypes.viewDraw,d),{setOption:_=>{r.selectOption(_)},onClear:()=>{r.setVisibility(!1)}}}},838563:(_,e,t)=>{t.d(e,{getAttachmentsPrimaryModeDefaultValue:()=>b,getAttachmentsPrimaryModeParam:()=>r,renderTemplate:()=>n,saveAttachmentsPrimaryModeDefaultValue:()=>c});var o=t(426585),l=t(82161),i=t(795558),s=t(531730),a=t(839470);const n=(_,e)=>{const t=(0,l.getTemplate)(_,e);return t?(0,i.se)(t):null},r=_=>{var e,t,l;const i=document.getElementById(`${o.ACTION_BUTTON_ID}${_}`);if(null==(e=i)?void 0:e.classList.contains(o.ACTION_BUTTON_DISABLED))return;const s=null==(l=i)||null==(t=l.querySelector(".radiobtn.on"))?void 0:t.getAttribute("data-value");return s?{primary_attachments_mode:s}:void 0},d="posting_attachments_primary_mode_default_value",E=()=>`${d}_${window.vk.id}`,c=_=>{(0,a.partConfigEnabled)("content_multiaccount_web_feature")?s.ls.set(E(),_):s.ls.set(d,_)},b=()=>{const _=(0,a.partConfigEnabled)("attachments_primary_mode_web_carousel_default_feature")?o.ATTACHMENT_PRIMARY_MODE.carousel:o.ATTACHMENT_PRIMARY_MODE.grid;let e;var t,l,i,n;(0,a.partConfigEnabled)("content_multiaccount_web_feature")?e=null!=(l=null!=(t=s.ls.get(E()))?t:s.ls.get(d))?l:_:e=null!=(i=s.ls.get(d))?i:_;return null!=(n=o.ATTACHMENT_PRIMARY_MODE[e])?n:_}},748143:(_,e,t)=>{t.d(e,{getPostTopicSelectorParams:()=>l.getPostTopicSelectorParams,initPostTopicCreatingSelector:()=>r,initPostTopicEditingSelector:()=>E,isPostTopicEditingEnabled:()=>l.isPostTopicEditingEnabled,isPostTopicSettingEnabled:()=>l.isPostTopicSettingEnabled,topicUISelectorHide:()=>a.topicUISelectorHide});var o=t(382141),l=t(717911),i=t(202609),s=t(483761),a=t(820375);const n=(_,e,t,l)=>{const a=o.TopicUISelector.create(e,{linkId:_,selectTopicId:i.selectTopicId});if(a)return(0,i.initActionsParamsState)(_,a,l),a.selectTopicId(t[s.WallPostParams.topicId]),{clearSelection:()=>{a.clearSelection()},onDestroy:()=>{a.destroy()}}},r=(_,e,t)=>n(_,e,{[s.WallPostParams.topicId]:l.TOPIC_ID_NONE},t);var d;const E=(_,e,t,o)=>n(_,e,{[s.WallPostParams.topicId]:null!=(d=t[s.WallPostParams.topicId])?d:l.TOPIC_ID_NONE},o)},483761:(_,e,t)=>{var o;t.d(e,{WallPostParams:()=>o}),function(_){_.topicId="topic_id"}(o||(o={}))},202609:(_,e,t)=>{t.d(e,{getActionParams:()=>n,getSelectorRegistry:()=>s,initActionsParamsState:()=>a,selectTopicId:()=>d});var o=t(434788),l=t(483761);let i=new Map;const s=_=>i.get(_),a=(_,e,t)=>((_,e)=>i.set(_,e))(_,{actionParams:void 0,selector:e,onChange:t}),n=_=>{var e;return null==(e=i.get(_))?void 0:e.actionParams},r=(_,e)=>{((_,e)=>{const t=i.get(_);void 0!==t&&i.set(_,e(t))})(_,(_=>{var t,l;(null==(t=_)?void 0:t.onChange)&&_.onChange(null==(l=e)?void 0:l.topic_id);return(0,o._)({},_,{actionParams:e})}))},d=(_,e)=>{r(_,{[l.WallPostParams.topicId]:e})}},717911:(_,e,t)=>{t.d(e,{TOPIC_ID_NONE:()=>i,getPostTopicSelectorParams:()=>s,isPostTopicEditingEnabled:()=>n,isPostTopicSettingEnabled:()=>a});var o=t(483761),l=t(202609);const i=-1,s=_=>{var e;const t=null==(e=(0,l.getActionParams)(_))?void 0:e[o.WallPostParams.topicId];return void 0!==t&&t!==i?{[o.WallPostParams.topicId]:t}:void 0},a=_=>{var e;return!0===(null==(e=_)?void 0:e.wallPostTopicSettingEnabled)},n=_=>void 0!==_.topic_options},382141:(_,e,t)=>{t.d(e,{TopicUISelector:()=>E});var o=t(84543),l=t(795558),i=t(953908),s=t(820375),a=t(717911),n=t(664988),r=t(75272),d=t(903006);class E{static create(_,e){const t=(0,s.renderSelector)(_,e.linkId);if(!t)return;const o=this.getSelectorContentEl(t),i=(0,l.domQuery1)(".post_action_btn_layout",t);return o&&i?new E(i,t,e,o):void 0}static getSelectorContentEl(_){return(0,l.domQuery1)(".post_action_tt_content",_)}destroy(){this.tooltip.destroy(),delete window.radioBtns[this.radioBtnId]}tooltipHide(){this.tooltip.hide()}selectTopicId(_){this.options.selectTopicId(this.linkId,_),this.updateViewForSelectedTopic({isTopicSelected:_!==a.TOPIC_ID_NONE,topicId:_})}clearSelection(){this.selectTopicId(a.TOPIC_ID_NONE)}updateViewForSelectedTopic({isTopicSelected:_,topicId:e}){const t=E.getSelectOptionEl(this.containerEl,e),o=t&&(0,r.getJsonDataValue)(t,"data-click-params"),i=(0,l.domQuery1)(".post_action_btn_text",this.containerEl);if(!t||!o||!i)return;const{label:a}=o;(0,d.updatePostTooltipActionRadioBtn)(t,void 0,(0,s.getTooltipId)(this.options.linkId));const c=i.getAttribute("data-empty")||"",b=_?a:c;i.innerHTML=b,i.setAttribute("aria-label",(0,n.replaceEntities)(b)),(0,l.toggleClass)(this.containerEl,"on",_)}static getSelectOptionEl(_,e){return(0,l.domQuery1)(`[data-value="${e}"]`,_)}constructor(_,e,t,a){this.btnEl=_,this.containerEl=e,this.options=t,this.selectorContentEl=a,this.onOptionClickWrapper=(..._)=>{this.tooltip.hide();const e=_[0].currentTarget;if(!(e instanceof HTMLElement))return;const t=(0,r.getJsonDataValue)(e,"data-click-params");t&&this.selectTopicId(t.value)},this.linkId=this.options.linkId,this.radioBtnId=(0,s.getTooltipId)(this.options.linkId),window.radioBtns[this.radioBtnId]={val:!1,els:a.children},this.tooltip=new o.ElementTooltip(_,{appendTo:e,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-12*(window.vk.rtl?-1:1),7],content:a,align:"left",onFirstTimeShow:()=>{(0,l.show)(a)}}),(0,l.domQuery)('[data-onclick="togglePostTopic"]',e).forEach((_=>{(0,i.addEvent)(_,"click",this.onOptionClickWrapper)}))}}},820375:(_,e,t)=>{t.d(e,{getTooltipId:()=>s,renderSelector:()=>a,topicUISelectorHide:()=>n});var o=t(795558),l=t(82161),i=t(202609);const s=_=>`post_discover_category_btn${_}`,a=(_,e)=>{const t=(_=>{const e=(0,l.getTemplate)("postCategorySelect",_);return e?(0,o.se)(e):null})({link_id:String(e)});if(_ instanceof HTMLElement&&t instanceof HTMLElement)return _.appendChild(t),t},n=_=>{var e,t;null==(t=(0,i.getSelectorRegistry)(_))||null==(e=t.selector)||e.tooltipHide()}},986229:(_,e,t)=>{t.d(e,{ClassifiedsWallForm:()=>b});var o,l,i=t(11010),s=t(434788),a=t(662273),n=t(599809),r=t(664988),d=t(931917),E=t(920697),c=t(95432);!function(_){_.unknown="unknown",_.emptyMessage="empty_message",_.wrongAttachAdded="wrong_attach_added",_.wrongSettingAdded="wrong_setting_added",_.detectClassifiedsNotProduct="detect_classifieds_not_product"}(o||(o={})),function(_){_.unknown="unknown",_.attached="snipped_attached",_.deletedByUser="snipped_user_deleted",_.autoDeleted="snipped_auto_deleted"}(l||(l={}));class b{isNativeCreateEnabled(){return this.isNativeFormEnabled}isAutoRecognitionEnabled(){return!this.isNativeFormEnabled&&this.isFormAutoRecognitionEnabled}isClassifiedsFormEnabled(){return this.isAutoRecognitionEnabled()||this.isNativeCreateEnabled()}isClassifiedsAutoRecognitionBarEnabled(){return this.isClassifiedsAutoRecognitionPostBarEnabled}autoRecognitionPostCheck(_){var e=this;return(0,i._)((function*(){var t;if((null==(t=e.productData)?void 0:t.description)!==_&&_&&e.draftIdBeforeThrottle===e.draftId&&!window.cur.postSent&&!e.productWasUnChosen&&e.isAutoRecognitionEnabled()&&e.checkIfRecognitionNeeded())try{const t=e.draftId,{is_classifieds_product:o,price:l,title:i,ml_response:s}=yield e.requestClassifiedsCheck({post_text:_,dry_run:1,is_auto_recognition:1,owner_id:e.ownerId});if(window.cur.postSent||!window.Wall.getMessage()||t!==e.draftId||e.productWasUnChosen||!e.checkIfRecognitionNeeded())return;o&&i?e.setProductData({price:l?l.toString():"",title:i,description:_,ml_response:s}):e.removeProductData("detect_classifieds_not_product")}catch(_){console.error("AutoRecognition error:",_)}}))()}setProductData(_){var e;this.productData||(null==(e=window.ClassifiedsViewAnalytics)||e.logAutoRecognitionSnippetAttached(window.cur.module,{owner_id:this.ownerId,draft_id:this.draftId}));this.snippetStatus="snipped_attached",this.productData=_,this.updateSnippetProductData()}removeProductData(_){var e;if(!this.productData)return;const t=window.cur.wallAddMedia||{};this.clearProductData(),this.removeReason=_,window.cur.noDraftSave=!1,null==(e=t)||e.unchooseMediaForType(E.MEDIA_SELECTOR_PRODUCT)}updateSnippetProductData(){var _;if(this.productWasUnChosen||this.formWasDisabled||!this.productData)return;const e=window.cur.wallAddMedia||{},t=(window.cur.wallAddMedia?e.getMedias():[]).find((([_])=>"photo"===_));let o;if(t&&t[5]){var l,i;const _=t[5];o=(null==(i=JSON.parse(_.view_opts))||null==(l=i.temp)?void 0:l.x)||_.thumb_m}const a=(0,s._)({},this.productData,{img:o});window.cur.noDraftSave=!1,null==(_=e)||_.addOrUpdateChosenMedia(E.MEDIA_SELECTOR_PRODUCT,void 0,a)}showCrossPosting(_){const{crossposting_url_hash:e,product_link:t,miniapp_id:o}=_;if(this.ownerId&&d.Ranges.isUserId(this.ownerId))return void(0,c.showWiki)({w:t});const l={layer:!0,url_hash:`${e}&force_crossposting_result=true`,onHide:()=>(0,c.showWiki)({w:t})};(0,c.showApp)(void 0,o,!1,null,null,l)}disable(){this.removeProductData("wrong_setting_added"),this.formWasDisabled=!0}reset(){this.clearProductData(),this.productWasUnChosen=!1,this.formWasDisabled=!1,this.removeReason="unknown",this.snippetStatus="unknown"}updateDraftId(){this.draftId=(0,r.irand)(0,1e7)}onMessageChange(_){_?this.throttleAutoRecognitionPostCheck(_):this.removeProductData("empty_message")}onMediaAdd({type:_}){this.productWasUnChosen||this.formWasDisabled||("photo"===_?this.updateSnippetProductData():_!==E.MEDIA_SELECTOR_PRODUCT&&this.removeProductData("wrong_attach_added"))}onMediaRemove(_={}){if(this.productWasUnChosen||this.formWasDisabled)return;const{removedTypes:e=[],source:t,isReset:o}=_;if(e.includes(E.MEDIA_SELECTOR_PRODUCT)){this.productWasUnChosen=!0,this.clearProductData();const _={owner_id:this.ownerId,draft_id:this.draftId};var l,i;if(!o)if("close"===t)this.snippetStatus="snipped_user_deleted",null==(l=window.ClassifiedsClickAnalytics)||l.logAutoRecognitionSnippetUserDeletedEvent(window.cur.module,_);else this.snippetStatus="snipped_auto_deleted",null==(i=window.ClassifiedsClickAnalytics)||i.logAutoRecognitionSnippetAutoDeletedEvent(window.cur.module,(0,s._)({},_,{snippet_delete_reason:this.removeReason}))}else this.updateSnippetProductData()}requestClassifiedsCheck(_){return(0,n.api)("classifieds.detectClassifieds",(0,s._)({snippet_status:this.snippetStatus,draft_id:this.draftId},_))}simpleCreateProduct(_){return(0,n.api)("classifieds.simpleCreateProduct",_)}autoRecognitionCreateProduct(_){return(0,n.api)("classifieds.autoRecognitionCreateProduct",(0,s._)({},_,{draft_id:this.draftId}))}checkIfRecognitionNeeded(){var _;if(this.formWasDisabled||(null==(_=window.cur.poster)?void 0:_.isOpen()))return!1;const e=window.cur.wallAddMedia||{},t=window.cur.wallAddMedia?e.getMedias():[];return!(t.some((([_])=>!["photo",E.MEDIA_SELECTOR_PRODUCT].includes(_)))||t.length>=10)}clearProductData(){this.productData=null}getPostBar(_){const[,e]=_.split("_");return document.getElementById("classifiedsBar-"+e)}hideAutoRecognitionPostBar(_){const e=this.getPostBar(_);e&&(e.style.display="none")}showAutoRecognitionPostBar(_){const e=this.getPostBar(_);e&&(e.style.display="block")}deleteAutoRecognitionPostBar(_){var e;null==(e=this.getPostBar(_))||e.remove()}constructor({interval:_,ownerId:e,isNativeFormEnabled:t=!1,isFormAutoRecognitionEnabled:o=!1,isClassifiedsAutoRecognitionPostBarEnabled:l=!1}){this.productData=null,this.productWasUnChosen=!1,this.formWasDisabled=!1,this.snippetStatus="unknown",this.removeReason="unknown",this.ownerId=e,this.isNativeFormEnabled=t,this.isFormAutoRecognitionEnabled=o,this.isClassifiedsAutoRecognitionPostBarEnabled=l;const i=(0,a.throttle)(this.autoRecognitionPostCheck,_);this.throttleAutoRecognitionPostCheck=_=>{this.draftIdBeforeThrottle=this.draftId,i.call(this,_)},this.reset(),this.updateDraftId(),this.draftIdBeforeThrottle=this.draftId}}},508216:(_,e,t)=>{t.d(e,{TOOLTIP_SUCCESS_EVENT:()=>l,TooltipEventService:()=>i});var o=t(368614);const l="group_tooltip_success_event",i={onUploadAvatar:()=>{window.dispatchEvent(new CustomEvent(l,{detail:o.OnboardingTooltipIds.Avatar}))},onUploadCover:()=>{window.dispatchEvent(new CustomEvent(l,{detail:o.OnboardingTooltipIds.Cover}))},onAddPost:()=>{window.dispatchEvent(new CustomEvent(l,{detail:o.OnboardingTooltipIds.Post}))},onAddMarketItem:()=>{window.dispatchEvent(new CustomEvent(l,{detail:o.OnboardingTooltipIds.MarketItem}))},onAddServiceItem:()=>{window.dispatchEvent(new CustomEvent(l,{detail:o.OnboardingTooltipIds.ServiceItem}))}}},368614:(_,e,t)=>{var o;t.d(e,{OnboardingTooltipIds:()=>o}),function(_){_.Avatar="business_groups_web:avatar",_.Cover="business_groups_web:cover",_.ActionButton="business_groups_web:action_button",_.MarketItem="business_groups_web:add_item",_.ServiceItem="business_groups_web:add_service",_.Post="business_groups_web:make_post",_.Dov="business_groups_web:fill_dov"}(o||(o={}))},533919:(_,e,t)=>{t.d(e,{highlightModule:()=>d});var o=t(145637),l=t(10645),i=t(438221),s=t(795558),a=t(321850);let n,r;function d(_){const e=document.getElementById(_.module);if(!e||!e.classList.contains("module"))return;window.cur.__narrowBarForceNotFixed=!0;const t=_.speed?_.speed:300;(0,i.scrollToY)((0,s.getXY)(e)[1]-100,t);const d=()=>{n&&(n.hideTT(),(0,i.enableBodyScroll)(),delete window.cur.__narrowBarForceNotFixed,(0,l.updateNarrow)(),_.onClose&&_.onClose())};n=new o.default(e,_.text,{highlight:!0,width:250,offset:[0,-17],side:"bottom",withCloseButton:!0,onBGClick:d,onCloseButtonClick:d}),n.show(),(0,i.disableBodyScroll)(),_.autoCancelDelay&&(r=setTimeout((()=>{d(),r=null}),_.autoCancelDelay),(0,a.pushNavDestroy)((()=>{r&&clearTimeout(r)})))}},82226:(_,e,t)=>{t.d(e,{PostponedPosts:()=>u,isPostponedPostsActResult:()=>O,isPostponedPostsFixEnabled:()=>w,isPostponedPostsPaginationEnabled:()=>p,isPostponedPostsParallelLoadingEnabled:()=>D,isPostponedPostsUpdateEnabled:()=>M});var o=t(434788),l=t(363444),i=t(839470),s=t(321850),a=t(662273),n=t(29271),r=t(664988),d=t(812685),E=t(128149),c=t(235108);function b(_){return new Promise(((e,t)=>{l.ajax.post("al_wall.php",(0,o._)({act:"get_postponed"},_),{onDone:_=>{e(_)},onFail:_=>{t(_)},local:1})}))}function P(_){const e=document.querySelector("#page_postponed_posts");e&&e.insertAdjacentHTML("beforeend",_)}class u{setLock(_){this.lock=_,this.lock?this.showMoreButton.lock():this.showMoreButton.unlock()}static new(){return new u}getPostsSize(){return this.postsSize}isLocked(){return this.lock}updateState(_){Object.assign(this,_)}toggleSort(){this.sort="sort_desc"===this.sort?"sort_asc":"sort_desc"}canStartInitialLoading(){var _;const e=document.querySelector("#page_postponed_posts");return 0===this.offset||""===(null==(_=e)?void 0:_.innerHTML.trim())}areAllPostsLoaded(){return this.offset>=this.postsSize}getNextPosts(){this.setLock(!0),b({offset:this.offset,owner_id:this.ownerId,sort:this.sort}).then((_=>{P(_.rendered_posts),this.offset=this.offset+this.limit,this.restoreLoadingState()})).catch((()=>{this.restoreLoadingState()}))}initPaginationAndShowMoreButton(){this.areAllPostsLoaded()||(this.showMoreButton.renderInWallModule(),p()&&this.paginate())}paginationHandler(){const{scrollTop:_,scrollHeight:e,clientHeight:t}=document.documentElement;_+t>=(this.offset<2*this.limit?0:e/2)&&!this.areAllPostsLoaded()&&!this.lock&&this.getNextPosts()}destroyPagination(){window.removeEventListener("scroll",this.throttledPaginationHandler)}paginate(){return window.addEventListener("scroll",this.throttledPaginationHandler,{passive:!0}),(0,s.pushNavDestroy)(this.destroyPagination.bind(this)),this.destroyPagination}removePost(){this.postsSize-=1,this.offset-=1}restorePost(){this.postsSize+=1,this.offset+=1}cleanUp(){this.destroyPagination(),this.showMoreButton.remove()}cleanUpOnNavigation(){this.cleanUp(),this.makeInitialState()}makeInitialState(){this.offset=0,this.postsSize=0,this.lock=!1,this.ownerId=0,this.limit=0,this.sort="sort_asc"}restoreLoadingState(){this.setLock(!1),this.areAllPostsLoaded()&&(this.showMoreButton.remove(),this.destroyPagination())}chunkedPostponedPostRequests(_=0){return(0,c.rangeWithStep)(this.limit,this.postsSize,_).map((_=>{var e;return b({offset:_,owner_id:null!=(e=window.cur.oid)?e:0,sort:this.sort})}))}loadInParallel(_,{onLoaded:e,onError:t},o){this.setLock(!0),(0,E.trackStartWithMarkName)(E.POSTPONED_POSTS_PARALLEL_LOADING_MARK);const l=this.chunkedPostponedPostRequests(_);Promise.all(l).then((_=>{var t,l,i,s;const a=(0,E.trackEndWithMarkName)(E.POSTPONED_POSTS_PARALLEL_LOADING_MARK),n=_.map((_=>_.rendered_posts)).reduce(((_,e)=>_+e),""),r=null==(l=_)||null==(t=l[0])?void 0:t.count,d=null==(s=_)||null==(i=s[0])?void 0:i.limit;var c;(0,E.saveLoadingStats)(E.POSTPONED_STATS_KEY,a.duration,{type:"parallel",action:o?"after_posting":"just_loading",offset:this.offset,limit:d,postsSize:r,userId:null!=(c=window.cur.oid)?c:0,hasError:!1}),this.offset=r,this.limit=d,this.postsSize=r,this.restoreLoadingState();e({count:r,limit:d,rendered_posts:n})})).catch((_=>{var e;this.restoreLoadingState();const l=(0,E.trackEndWithMarkName)(E.POSTPONED_POSTS_PARALLEL_LOADING_MARK),i=(0,E.getErrorMessage)(_);var s;(0,E.saveLoadingStats)(E.POSTPONED_STATS_KEY,l.duration,{type:"parallel",action:o?"after_posting":"just_loading",offset:this.offset,limit:this.limit,postsSize:this.postsSize,userId:null!=(s=window.cur.oid)?s:0,hasError:!1,errorMessage:i}),null==(e=t)||e(_)}))}loadInitialForPagination({onLoaded:_,onError:e}){var t;this.setLock(!0),b({offset:0,owner_id:null!=(t=window.cur.oid)?t:0,sort:this.sort}).then((e=>{var t;_(e),this.postsSize=e.count,this.offset=e.limit,this.ownerId=null!=(t=window.cur.oid)?t:0,this.limit=e.limit,this.initPaginationAndShowMoreButton(),this.restoreLoadingState()})).catch((_=>{var t;null==(t=e)||t(_),this.restoreLoadingState()}))}loadOnTabReturn(){this.initPaginationAndShowMoreButton()}loadAfterPosting(_){var e;this.postsSize=_.count,this.limit=_.limit,this.offset=_.limit,this.ownerId=null!=(e=window.cur.oid)?e:0,this.cleanUp(),this.initPaginationAndShowMoreButton()}loadAllAfterPosting(_){var e;(this.cleanUp(),this.areAllPostsLoaded())||(this.initPaginationAndShowMoreButton(),this.loadInParallel(null!=(e=_.starts_from)?e:0,{onLoaded:_=>{P(_.rendered_posts)}},!0))}constructor(){this.throttledPaginationHandler=(0,a.throttle)(this.paginationHandler.bind(this),500).bind(this),this.offset=0,this.postsSize=0,this.lock=!1,this.ownerId=0,this.limit=0,this.sort="sort_asc",this.showMoreButton=d.ShowMoreButton.new(n.getLang("wall_post_text_show_more"),{onClick:this.getNextPosts.bind(this)}),this.destroyPagination=this.destroyPagination.bind(this)}}function p(){return(0,i.partConfigEnabled)("wall_postponed_posts_pagination_web")}function D(){return(0,i.partConfigEnabled)("wall_postponed_posts_parallel_loading_web")}function w(){return p()||D()}function M(){return(0,i.partConfigEnabled)("wall_postponed_posts_update_enabled_web")}function O(_){return!!_&&(!("string"==typeof _||!(0,r.isObject)(_))&&"rendered_posts"in _)}},128149:(_,e,t)=>{t.d(e,{POSTPONED_POSTS_PARALLEL_LOADING_MARK:()=>i,POSTPONED_STATS_KEY:()=>l,getErrorMessage:()=>s,saveLoadingStats:()=>a,trackEndWithMarkName:()=>r,trackStartWithMarkName:()=>n});t(504867);var o=t(385376);const l="wall_postponed_posts_stats",i="postponed_posts_parallel_loading_mark";function s(_){return _?"string"==typeof _?_:_ instanceof Error&&_.message?_.message:"Unknown error":"Unknown error"}function a(_,e,t){(0,o.saveStatlogEvents)({name:_,value:e,keys:[t]})}function n(_){window.cur.postponedPostsPerformanceMarks||(window.cur.postponedPostsPerformanceMarks={}),window.cur.postponedPostsPerformanceMarks[_]=performance.now()}function r(_){return window.cur.postponedPostsPerformanceMarks&&window.cur.postponedPostsPerformanceMarks[_]?{duration:performance.now()-+window.cur.postponedPostsPerformanceMarks[_]}:{duration:-1}}},812685:(_,e,t)=>{t.d(e,{ShowMoreButton:()=>l});var o=t(854099);class l{static new(_,e){return new l(_,e)}putInContainer(){this.container=document.createElement("div"),this.container.style.display="flex",this.container.style.justifyContent="center",this.container.style.marginBottom="16px",this.container.append(this.button)}lock(){o.FlatButton.lock(this.button)}unlock(){o.FlatButton.unlock(this.button)}remove(){var _;null==(_=this.container)||_.remove()}renderInWallModule(){var _;this.container||this.putInContainer();null==(_=document.querySelector(".wall_module"))||_.append(this.container)}constructor(_,{onClick:e}){this.button=o.FlatButton.render({children:_,appearance:o.FlatButtonAppearance.SECONDARY,size:o.FlatButtonSize.M}),this.onClick=e,this.button.addEventListener("click",this.onClick)}}},235108:(_,e,t)=>{function o(_,e,t=0){return Array.from(Array(Math.ceil((e-t)/_)).keys()).map((e=>e*_+t))}t.d(e,{rangeWithStep:()=>o})},513669:(_,e,t)=>{t.d(e,{getNavigableTabs:()=>l,showHiddenNavigableTabs:()=>i});var o=t(795558);const l=_=>{const e=[],t=document.querySelector("#wall_tabs");return t?Array.from(t.querySelectorAll(".ui_tab")).filter((e=>{const t=e.parentNode;return null!==t&&t!==_&&!(0,o.hasClass)(t,"unshown")&&!(0,o.matchesSelector)(t,'[data-ui-tab="no_posts"]')})):e},i=()=>{var _,e;null==(e=null==(_=document.querySelector("#wall_tabs"))?void 0:_.querySelector(".page_wall_no_posts"))||e.remove(),(0,o.removeClass)(document.querySelector("#wall_tabs"),"page_tabs_hidden")}},863727:(_,e,t)=>{t.d(e,{checkPostLen:()=>b,getPostAvatarString:()=>P,removeUnseenStories:()=>E});var o=t(795558),l=t(82161),i=t(854099),s=t(29271),a=t(170864),n=t(266014),r=t(12468),d=t(555510);function E(_){var e;if(c(document,_),null==(e=window.wkcur)?void 0:e.pageReplaced)for(let e of window.wkcur.pageReplaced)c(e[0],_)}function c(_,e){const t=_.querySelectorAll(".reply_image_stories_unseen"+e);for(const _ of t){var o;_.classList.remove("reply_image_stories_unseen","reply_image_stories_unseen"+e),null==(o=(0,a.replyUserImageLinkClosest)(_))||o.removeAttribute("onclick")}(0,n.removeAvatarRichOutlineAtNode)(_,String(e),"stories_unseen");const l=_.querySelectorAll(".post_image_stories_unseen"+e);for(const _ of l){var i;_.classList.remove("post_image_stories_unseen","post_image_stories_unseen"+e),null==(i=_.closest(".post_image, ._post_image"))||i.removeAttribute("onclick")}}function b(_,e,t,a){var n;if(!_)return;const r=null==(n=window.cur.options)?void 0:n.max_post_full_length;if(!r)return!0;const d=(0,o.ge)(_);if(!d)return;let E=(0,l.trim)(window.Emoji.val(d)).replace(/\n\n\n+/g,"\n\n");if(d.lastLen===E.length&&!a)return d.lastLen<=r;const c=d.lastLen=E.length;if(e=(0,o.ge)(e),c>r-100){const _=c>r;if(e&&(_?(t&&(i.FlatButton.isFlatButton(t)?i.FlatButton.setDisabled(t,!0):(0,o.toggleClass)(t,"button_disabled",!0)),e.innerHTML=s.getLang("text_exceeds_symbol_limit",c-r),(0,o.toggleClass)(e,"post_field_warning_red",!0)):e.innerHTML=s.getLang("text_N_symbols_remain",r-c),(0,o.show)(e)),_)return!1}else e&&(0,o.hide)(e);return e&&(0,o.toggleClass)(e,"post_field_warning_red",!1),t&&(i.FlatButton.isFlatButton(t)?i.FlatButton.setDisabled(t,!1):(0,o.toggleClass)(t,"button_disabled",!1)),!0}const P=(_,e,t=d.REPLY_IMAGE_DEFAULT_SIZE,o=!1,l)=>{const i=[e,"_post_field_image"];return l&&i.push(l),(0,r.renderAvatarToString)(_,t,null,i,null,void 0,!1,void 0,"",!(t<d.MIN_NFT_IMAGE_SIZE)&&o)}},943331:(_,e,t)=>{t.d(e,{getThumbsCount:()=>r,isCarouselAllowed:()=>d,mediaDataToAttachments:()=>E,mediaDataToClickHandlers:()=>b,renderCarousel:()=>u});var o=t(790500),l=t(437683),i=t(970978),s=t(910240),a=t(320422),n=t(29271);const r=_=>(0,l.getThumbsMediaItems)(_).length,d=(_,{skipClipsCheck:e=!1}={})=>{var t;const o=r(_)>1,i=e||(null==(t=_)?void 0:t.every((([_,,e])=>{var t,o;return!(_===l.THUMB_TYPE_VIDEO&&(null==(o=e)||null==(t=o.editable)?void 0:t.is_short_video))})));return Boolean(o&&i)},E=_=>[...new Set((0,l.getThumbsMediaItems)(_).map((([_,e])=>`${_}${e}`)))].join(",");var c;const b=_=>{var e;return null!=(c=null==(e=_)?void 0:e.reduce(((_,e)=>{if(e[2]&&"editable"in e[2]){var t,o;const l=null==(o=e[2])||null==(t=o.editable)?void 0:t.click;_[e[1]]=null!=l?l:_[e[1]]}return _}),{}))?c:{}},P=_=>e=>{if(!_)return;if(!(e.target instanceof HTMLElement))return;const t=function(_){const e=".js-PrimaryAttachment",t=_.closest(e);if(!t)return void(0,i.logError)(new Error("PrimaryAttachment: posting delete handler: missing card"));const o=t.closest(".js-PrimaryAttachmentCarousel");if(!o)return void(0,i.logError)(new Error("PrimaryAttachment: posting delete handler: missing carousel"));const l=o.querySelectorAll(e),a=Array.prototype.indexOf.call(l,t);if(-1===a)return void(0,i.logError)(new Error("PrimaryAttachment: posting delete handler: card not in carousel"));const n=(0,s.getPrimaryCarouselGallery)(t);if(!n)return;return{gallery:n,index:a}}(e.target);if(!t)return void(0,i.logError)(new Error("PrimaryAttachment: posting delete handler: missing gallery instance"));const{gallery:o,index:l}=t;o.removeItem(l),_(l)},u=({oid:_,postId:e,attachments:t,photoClickHandlers:l,onDelete:i,wkView:s=!1},r)=>{r.firstChild||(r.innerHTML='<div class="PrimaryAttachmentCarousel__skeleton"></div>');let d=()=>{},E=!1,c=!1;return{renderCarouselPromise:new Promise(((o,l)=>{const i=window.ajax.post("al_wall.php",{act:"render_carousel",post_id:e,owner_id:_,attachments:t,wk_view:s?1:0},{onDone:o,onFail:()=>(l(),!1)});d=()=>{c||(E=!0,i.abort(),l())}})).catch((()=>({carousel_html:""}))).then((_=>{var e;const t=null==(e=_)?void 0:e.carousel_html;if(!E&&r&&t){var s;r.innerHTML=`<div class="PrimaryAttachmentCarouselWrapper">${String(t)}</div>`,Object.keys(l).forEach((_=>{var e;null==(e=r.querySelector(`[data-photo-id="${_}"]`))||e.addEventListener("click",(e=>{var t,o;e.stopPropagation(),e.preventDefault(),null==(t=(o=l)[_])||t.call(o)}))}));const _=null!=(s=r.querySelector(".PrimaryAttachmentCarouselWrapper"))?s:void 0;r.querySelectorAll(".js-PrimaryAttachmentCarousel__close").forEach((e=>{e.addEventListener("mouseover",(()=>{(0,a.showTooltip)(e,{text:n.getLang("dont_attach"),shift:[11,8],black:1,appendEl:_,dir:void 0})}))})),(0,o.default)(r,".js-PrimaryAttachmentCarousel__close","click",P(i))}c=!0})),abort:d}}},687437:(_,e,t)=>{t.d(e,{PROFILE_MEDIA_NARROW_BLOCK_ID:()=>o});const o="profile_media_narrow_block"},84852:(_,e,t)=>{t.d(e,{getReactionsButtonPostTemplate:()=>b,getReactionsButtonReplyTemplate:()=>P,likeDataReactionsFields:()=>D});var o=t(839470),l=t(795558),i=t(682951),s=t(908088),a=t(822715),n=t(192441),r=t(222285);const d=(_,e,t)=>{var o,i,n;const d=null==(o=(_=>{try{const e=JSON.parse(_);if(null!==e&&"object"!=typeof e)return;return e}catch(_){return}})(_))?void 0:o.set_id,E="string"==typeof d?d:void 0;if(!e||!E)return;const c=(0,s.getReactionSet)(E);return c?{likeClassName:"like_btn--hidden PostBottomAction--hidden",template:(0,l.rs)(e,{reactions_button_title:(0,a.getDefaultReactionTitle)(c)||"",reactions_set_id:E,badges_object_type:r.BadgesObjectType.WALL,badges_object_owner_id:(null==(i=t)?void 0:i.objectOwnerId)||0,badges_object_id:(null==(n=t)?void 0:n.objectId)||0,badges_ref:r.BadgesEventRef.POST_BTN})}:void 0},E=(_,e)=>e.length>_,c=_=>{const e=_[2],[t,o]=e.split("_");return{objectOwnerId:Number(t),objectId:Number(o)}},b=(_,e)=>{var t,o;const l=c(_),i=null==(o=e)||null==(t=o.wallTpl)?void 0:t.post_likes_reactions,s=E(14,_)?_[14]:void 0;if("string"==typeof s)return d(s,i,l)},P=(_,e)=>{var t,l;const i=c(_),s=null==(l=e)||null==(t=l.wallTpl)?void 0:t.reply_likes_reactions;if(!(0,o.partConfigEnabled)("reactions_enabled_post_replies"))return;const a=E(14,_)?_[14]:void 0;return"string"==typeof a?d(a,s,i):void 0},u=_=>{let e=JSON.parse(_);if(null===e||"object"==typeof e||Array.isArray(e)){if(Array.isArray(e)){e=(0,n.reactionCountsBrandWrap)((t=e,Object.assign({},t)))}var t;return e}},p=_=>{const e=E(5,_)?_[5]:void 0;if("string"!=typeof e)return;const t=(_=>{const e=_.indexOf(";"),t=_.substr(0,e),o=_.substr(e+1);if("1"===t)return u(o)})(e);return t?{counts:t}:void 0},D=_=>{var e;const t=p(_);return{[i.REACTIONS_COUNTS_RESPONSE_FIELD]:null==(e=t)?void 0:e.counts}}},727931:(_,e,t)=>{var o;t.d(e,{REGULAR_SIZES:()=>i,SIZE_512:()=>l,StickerSize:()=>o}),function(_){_[_.SMALL=128]="SMALL",_[_.MIDDLE=168]="MIDDLE",_[_.BIG=208]="BIG"}(o||(o={}));const l=512,i=[64,128,256,352,l]},991243:(_,e,t)=>{t.d(e,{findClosestStickerSize:()=>w,getBoxLayerWrap:()=>c,getLangCode:()=>D,getPurchaseResult:()=>u,hideLoader:()=>P,showLoader:()=>b,updateStickersFromQueue:()=>p});var o=t(221780),l=t(29271),i=t(68003),s=t(795558),a=t(584356),n=t(899033),r=t(727931),d=t(457299);function E(){return document.querySelector("#box_loader")}function c(){return document.querySelector("#box_layer_wrap")}function b(){const _=E();(0,a.boxRefreshCoords)(_),(0,s.show)(_),(0,s.show)(c())}function P(){(0,s.hide)(E())}function u(_){const e=new n.ProductsByType(_.items.filter((_=>!_.error)).map((_=>_.product))),t=e.getPack(),i=e.getStyles();if(t)return i.length?(0,o.langStr)(l.getLang("purchases_stickers_purchase_result_pack_and_styles",i.length),"pack_title",t.title,"n",i.length):(0,o.langStr)(l.getLang("purchases_stickers_purchase_result_pack"),"title",t.title);if(i.length)switch(i.length){case 1:return(0,o.langStr)(l.getLang("purchases_stickers_purchase_result_1_style"),"title",i[0].title);case 2:return(0,o.langStr)(l.getLang("purchases_stickers_purchase_result_2_styles"),"title1",i[0].title,"title2",i[1].title);case 3:return(0,o.langStr)(l.getLang("purchases_stickers_purchase_result_3_styles"),"title1",i[0].title,"title2",i[1].title,"title3",i[2].title);case 4:return(0,o.langStr)(l.getLang("purchases_stickers_purchase_result_3_styles_and_1_more"),"title1",i[0].title,"title2",i[1].title,"title3",i[2].title);default:const _=i.length-3;return(0,o.langStr)(l.getLang("purchases_stickers_purchase_result_3_styles_and_n_more",_),"title1",i[0].title,"title2",i[1].title,"title3",i[2].title,"n",_)}return null}function p(_){!function(_){const e=i.colorScheme.isDarkScheme()?"data-src-dark":"data-src-light";_.querySelectorAll(`.sticker_img[${e}]`).forEach((_=>{const t=_.getAttribute(e);t&&(_.src=t)}))}(_)}const D=()=>window.vk.lang||"ru",w=_=>_>r.SIZE_512?((0,d.logStickersError)("Нет размера стикера больше 512px"),r.SIZE_512):r.REGULAR_SIZES.find((e=>e>=_))},880660:(_,e,t)=>{t.d(e,{highlightNarrativeBlock:()=>p,prepareStoriesForPublishing:()=>P,updateNarrativeBlock:()=>u,updateNarrativeSnippetsFromQueueByPost:()=>D});var o=t(795558),l=t(584356),i=t(533919),s=t(29271),a=t(664988),n=t(687437),r=t(964262),d=t(970978),E=t(839470),c=t(931917);const b="NarrativeSnippet";function P(_){return _.map((_=>_.id)).join(",")}function u(_=!1){const e=(0,a.intval)(window.cur.oid);if(window.cur.narrativeBlock)window.ajax.post("al_stories.php",{act:"get_narrative_block",owner_id:e},{onDone:_=>{const e=(0,a.intval)(window.cur.oid),t=document.getElementById(`narratives_module${e}_wrapper`);if(t)if(_)(0,o.domReplaceEl)(t,_),window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),window.NarrativeBlock&&(window.cur.narrativeBlock=new window.NarrativeBlock);else{var l,i;const _=t.parentElement;var s;if((null==(l=_)?void 0:l.children.length)&&(null==(i=_)?void 0:i.children.length)>1)t.remove();else null==(s=_)||s.remove();window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),delete window.cur.narrativeBlock}(0,r.removeStoryList)(`narratives${e}`)}});else if(c.Ranges.isUserId(e)&&"profile"===window.cur.module){const _=document.getElementById(n.PROFILE_MEDIA_NARROW_BLOCK_ID),t=!_;window.ajax.post("al_stories.php",{act:"get_narrative_block",owner_id:e,need_wrap_block:(0,a.intval)(t)},{onDone:t=>{if(_)_.insertAdjacentHTML("afterbegin",t);else{const _=document.getElementById("narrow_column");if(!_)return;_.insertAdjacentHTML("beforeend",t)}window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),window.NarrativeBlock&&(window.cur.narrativeBlock=new window.NarrativeBlock,window.cur.narrativeBlock.showOnboardTooltipIfNeeded()),(0,r.removeStoryList)(`narratives${e}`)}})}else _&&function(_){window.boxQueue.hideAll();const e=document.querySelector("#box_layer_wrap"),t=document.querySelector("#box_loader");window.nav.reload({onDone:()=>{_&&_()},showProgress:()=>{(0,o.show)(e),(0,o.show)(t),(0,l.boxRefreshCoords)(t)},hideProgress:()=>{(0,o.hide)(e),(0,o.hide)(t)}})}((()=>{window.cur.needNarrativeOnboard=!0}))}function p(_){if(!_)return;const e=`narratives_module${window.vk.id}`;(0,i.highlightModule)({module:e,text:s.getLang("stories_narrative_block_onboarding_text"),onClose:()=>{delete window.cur.needNarrativeOnboard,window.ajax.post("al_index.php",{act:"hide_feature_tt",hash:_,type:"profile_narrative"})},autoCancelDelay:1e4,speed:600})}function D(_){if(!window.vk.id)return;if(!(0,E.partConfigEnabled)("update_private_snippets_by_queue"))return;const e=Array.from(_.querySelectorAll(`.${b}`));if(!e.length)return;const t=[];e.forEach((_=>{if(!window.vk.id||!_.dataset.needUpdate)return;const e=_.dataset.narrativeRawId;e&&t.push({narrative_raw_id:e,snippet_type:_.dataset.snippetType,from:_.dataset.from})})),t.length&&window.ajax.post("al_stories.php",{act:"get_narrative_snippets",narrative_snippets:JSON.stringify(t)},{onDone:_=>{e.forEach((e=>{e.dataset.narrativeRawId&&_[e.dataset.narrativeRawId]&&(e.outerHTML=_[e.dataset.narrativeRawId])}))},onFail:()=>((0,d.logError)(new Error("Fail: updateNarrativeSnippetFromQueueByPost")),!0)})}},964262:(_,e,t)=>{t.d(e,{createUserStackMaskIfNeeded:()=>u,fetchDiscover:()=>c,getStoryBlockKey:()=>P,getStoryList:()=>r,getVolume:()=>a,isDiscoverLoading:()=>b,isNewDesignEnabled:()=>p,preloadDiscoverList:()=>E,removeStoryList:()=>d,setVolume:()=>n});var o=t(517366),l=t(795558),i=t(839470),s=t(321850);function a(){const _=window.ls.get("video_volume");return"number"==typeof _?Math.min(1,Math.max(0,_)):1}function n(_){window.ls.set("video_volume",_)}function r(_){return window.cur[`stories_list_${_}`]}function d(_){delete window.cur[`stories_list_${_}`]}function E(_=!1){if(window.cur.storiesDiscoverFetchingPromise)return window.cur.storiesDiscoverFetchingPromise;let e,t;const l=r(o.StoryListName.feed);return l&&(t=l.find((_=>_.type===o.StoryBlockType.discover)),t&&(e=t.track_code)),window.cur.storiesDiscoverFetchingPromise=c("",e,_).then((([_,e])=>(t&&(t.grouped=_,t.next_from=e),_))).finally((()=>{delete window.cur.storiesDiscoverFetchingPromise})),window.cur.storiesDiscoverFetchingPromise}function c(_="",e="",t=!1,o=15){return new Promise(((l,i)=>{window.ajax.post("al_stories.php",{act:"get_discover",start_from:_,count:o,track_code:e},{loader:t,onDone:(_,e)=>{l([_,e])},onFail:_=>(i(_),!0)})}))}function b(){return Boolean(window.cur.storiesDiscoverFetchingPromise)}function P(_){var e,t,o,l,i;return(null==(t=_)||null==(e=t.author)?void 0:e.id)&&(null==(l=_)||null==(o=l.narrative)?void 0:o.id)?`${_.author.id}narrative${null==(i=_.narrative)?void 0:i.id}`:`${_.id}`}function u(){const _="users_stack_stories_mask";let e=document.getElementById(_);e||(e=(0,l.se)(`\n        <svg width="0" height="0">\n          <defs>\n            <clipPath id="${_}">\n              <path transform="translate(1.5 0)" d="M1.20772 8C1.20772 6.32671 0.768742 4.75626 0 3.39821C1.44342 1.34278 3.8277 0 6.52463 0C10.9293 0 14.5 3.58172 14.5 8C14.5 12.4183 10.9293 16 6.52463 16C3.8277 16 1.44342 14.6572 0 12.6018C0.768742 11.2437 1.20772 9.6733 1.20772 8Z"></path>\n            </clipPath>\n          </defs>  \n        </svg>  \n      `),e&&(document.body.appendChild(e),(0,s.pushNavDestroy)((()=>{var _;null==(_=e)||_.remove()}))))}function p(){return(0,i.partConfigEnabled)("story_reactions_sending_feature_web")}},841936:(_,e,t)=>{t.d(e,{scrollOutsideFixedReplyArea:()=>i});var o=t(795558),l=t(518952);const i=(_,e)=>{if(!(_ instanceof HTMLElement&&e instanceof HTMLElement))return;const t="fixed"===(0,o.getStyle)(e,"position"),i=void 0!==window.cur.wallLayer;if(!t){if(i)return;const _=e.closest(".replies_wrap");return void(_&&(_=>{const e=(0,o.clientHeight)();if(_.getBoundingClientRect().bottom>e){const t=(0,o.getXY)(_)[1]+(0,o.getH)(_)-e;(0,l.setActiveAreaScroll)(t)}})(_))}const s=_.getBoundingClientRect(),a=20-(e.getBoundingClientRect().top-s.bottom);a>0&&(0,l.scrollActiveAreaToYDelta)(a)}},731951:(_,e,t)=>{t.d(e,{postSubscribeHandlerInit:()=>M,subscribeByAction:()=>p,subscribeByButton:()=>D,subscribeToAuthor:()=>u});var o=t(434788),l=t(725296),i=t(82161),s=t(795558),a=t(514986),n=t(363444),r=t(29271),d=t(72569),E=t(505426),c=t(931917),b=t(854099);const P="_subscribed";function u(_,e,t,l,i){const s=(0,o._)({onFail:_=>{setTimeout((0,a.showFastBox)(r.getLang("global_error"),_).hide,3e3)}},l);i=i||{},c.Ranges.isUserId(e)?n.ajax.post("al_friends.php",(0,o._)({act:_?"remove":"add",mid:e,hash:t,from:"post_subscribe_button"},i),s):n.ajax.post("al_groups.php",(0,o._)({act:_?"list_leave":"list_enter",gid:-e,hash:t},i),s)}function p(_,e,t,n){if((0,l.actionsMenuItemLocked)(_))return;const d=(0,i.intval)((0,s.domData)(_,"value"))?1:0;let E={showProgress:()=>(0,l.lockActionsMenuItem)(_),hideProgress:()=>(0,l.unlockActionsMenuItem)(_)};const b={};c.Ranges.isUserId(e)&&n?b.from=n:c.Ranges.isGroupId(e)&&(E=(0,o._)({},E,{onDone:(o,l,i)=>{if(l){const _=(0,a.showFastBox)(r.getLang("global_warning"),l,r.getLang("group_leave_group"),(()=>{_.hide(),u(d,e,t,E,{confirm:1})}),r.getLang("global_cancel"));return!0}(0,s.val)(_,o),_.setAttribute("data-value",String(1-d)),i&&((0,s.re)((0,s.domNS)(_)),(0,s.re)(_))}})),u(d,e,t,E,b)}function D(_,e,t,{query:o}={}){const i=_.querySelector(".post_header_subscribe_button_loader"),s="post_header_subscribe_button_icons_only_loading";let a=_.classList.contains(P);const n=(0,d.isWkLayerWallPostOpen)(),r=b.FlatButton.isFlatButton(_);u(a,e,t,{onDone:()=>{n?_.classList.toggle(P,!a):(0,E.emitEvent)(E.WallDataEvents.post_subscribe_update,{groupId:-e,isSubscribed:!a})},showProgress:()=>{r?b.FlatButton.lock(_):(_.classList.toggle(s,!0),(0,l.showProgress)(i))},hideProgress:()=>{if(r)return b.FlatButton.unlock(_),void _.blur();_.classList.toggle(s,!1),(0,l.hideProgress)(i)}},o)}const w=_=>{var e;const{isSubscribed:t,groupId:o}=_,l=null==(e=document.querySelector(`[id^="post-${o}"]`))?void 0:e.querySelector(".post_header_subscribe_button");l&&l.classList.toggle(P,t)},M=()=>(0,E.registerUniqueListener)("wall-post-subscribe",E.WallDataEvents.post_subscribe_update,w)},198186:(_,e,t)=>{t.d(e,{highlightUpdatedPost:()=>l,highlightUpdatedPostContent:()=>i});var o=t(75272);const l=_=>{(0,o.triggerAnimationClass)(_,"post_highlight_updated",3e3)},i=_=>{(0,o.triggerAnimationClass)(_,"post_highlight_updated_content",3e3)}},925006:(_,e,t)=>{t.d(e,{getFixedReplyField:()=>o,replyBoxOwnerIsNftFromAttr:()=>l});const o=()=>{var _,e;return window.cur.wallLayer?null!=(_=document.getElementById("wl_reply_form"))?_:void 0:"full"===window.cur.wallType&&null!=(e=document.querySelector(`#reply_box_wrap${window.cur.oid}_${window.cur.pid} .reply_box_inner_wrap`))?e:void 0},l=_=>"1"===_},216324:(_,e,t)=>{t.d(e,{wallPostRenderInit:()=>i});var o=t(530517),l=t(731951);const i=()=>{(0,o.postRenderReactionsInit)(),(0,l.postSubscribeHandlerInit)()}},518952:(_,e,t)=>{t.d(e,{scrollActiveAreaToYDelta:()=>i,setActiveAreaScroll:()=>l});var o=t(438221);const l=_=>{window.cur.wallLayer?window.wkLayerWrap&&(window.wkLayerWrap.scrollTop=_):(0,o.scrollToY)(_,0,!1,!0)},i=_=>{var e,t;l((window.cur.wallLayer?null!=(t=null==(e=window.wkLayerWrap)?void 0:e.scrollTop)?t:0:(0,o.scrollGetY)())+_)}},860442:(_,e,t)=>{t.d(e,{buildOwnerDraftKey:()=>l,parseObjectPostId:()=>o});t(434788),t(307411);const o=_=>{const e=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/);if(e)return{type:e[3]||"wall",id:e[1]+"_"+e[4]}},l=_=>"wall_draft"+window.vk.id+"_"+_},902716:(_,e,t)=>{function o(){return{icon:'<svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M3.53 2.46a.75.75 0 0 0-1.07 1.07L4.94 6 2.46 8.47a.75.75 0 1 0 1.07 1.07L6 7.06l2.47 2.48a.75.75 0 0 0 1.07-1.07L7.06 6l2.48-2.47a.75.75 0 1 0-1.07-1.07L6 4.94z" fill="currentColor"/></svg>',name:"cancel_12"}}t.d(e,{getIcon12Cancel:()=>o})},772913:(_,e,t)=>{function o(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g id="user_outline_20__Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="user_outline_20__Icons-20/user_outline_20"><g id="user_outline_20__user_outline_20"><path opacity=".1" d="M0 0h20v20H0z"/><path d="M12.5 5a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0ZM14 5a4 4 0 1 1-8 0 4 4 0 0 1 8 0ZM4 15.5c0 .72.36 1 1 1h10c.64 0 1-.28 1-1 0-2.33-2.57-3.5-6-3.5s-6 1.17-6 3.5Zm-1.5 0c0-3.48 3.33-5 7.5-5s7.5 1.52 7.5 5c0 1.63-1.1 2.5-2.5 2.5H5c-1.4 0-2.5-.87-2.5-2.5Z" id="user_outline_20__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></g></svg>',name:"user_outline_20"}}t.d(e,{getIcon20UserOutline:()=>o})},421577:(_,e,t)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M12.73 11.48a.75.75 0 0 1 .94-.5 7.26 7.26 0 0 1 1.64.71 4.22 4.22 0 0 1 2.15 3.2.75.75 0 0 1-1.49.19 2.72 2.72 0 0 0-1.43-2.1 5.76 5.76 0 0 0-1.3-.56.75.75 0 0 1-.5-.94ZM6 5a4 4 0 1 1 4 4 .75.75 0 0 1 0-1.5A2.5 2.5 0 1 0 7.5 5 .75.75 0 0 1 6 5ZM3.22 17.36c.45.42 1.08.64 1.78.64h9.44l.78.78a.75.75 0 1 0 1.06-1.06L3.78 5.22a.75.75 0 0 0-1.06 1.06l4.48 4.48c-.95.2-1.8.5-2.51.93A4.23 4.23 0 0 0 2.5 15.5c0 .81.27 1.44.72 1.86Zm2.24-4.38A2.74 2.74 0 0 0 4 15.5c0 .46.14.67.25.77.12.11.35.23.75.23h7.94l-4.42-4.42c-1.27.13-2.31.45-3.06.9Z" clip-rule="evenodd"/></svg>',name:"user_slash_outline_20"}}t.d(e,{getIcon20UserSlashOutline:()=>o})},806427:(_,e,t)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="m12 10.3-5.36 4.47a1 1 0 1 1-1.28-1.54l6-5a1 1 0 0 1 1.28 0l6 5a1 1 0 1 1-1.28 1.54L12 10.3Z"/></svg>',name:"chevron_up_24"}}t.d(e,{getIcon24ChevronUp:()=>o})},145637:(_,e,t)=>{t.d(e,{ON_BOARDING_BG_RECT_ID:()=>n,default:()=>E});var o=t(795558),l=t(953908),i=t(438221),s=t(23087),a=t(84543);const n="onboarding_bg_rect",r="page_header_cont",d="onboarding";class E{initOnboardingBG(){if(!window.onboardingBG){let _='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',e=(0,o.se)(_);(0,o.domInsertBefore)(e,window.layerBG),window.onboardingBGHeader=(0,o.ge)("onboarding_bg_header"),window.onboardingBG=(0,o.ge)("onboarding_bg"),window.onboardingBGRect=(0,o.ge)(n),window.onboardingBGClip=(0,o.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,o.hide)(window.onboardingBG),(0,o.hide)(window.onboardingBGHeader),(0,o.removeClass)((0,o.ge)(r),d),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,l.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,l.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,_]=(0,o.getXY)(this.el);this.tt=new a.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const e=this.tt.getContent();(0,s.isElementInViewport)(this.el)&&(0,s.isElementInViewport)(e)||(0,i.scrollToY)(_-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,l.removeEvent)(window,"scroll"),(0,l.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,l.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,l.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,l.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let _=this.el.offsetWidth,e=this.el.offsetHeight,t=(0,o.getXY)(this.el);(0,o.attr)(window.onboardingBGClip,"width",_+this.border[1]+this.border[3]),(0,o.attr)(window.onboardingBGClip,"height",e+this.border[0]+this.border[2]),(0,o.attr)(window.onboardingBGClip,"x",t[0]-this.border[1]),(0,o.attr)(window.onboardingBGClip,"y",t[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let _=this.getPageHeight();window.onboardingBG.height!=_&&this.setDartToFullHeight()}setDartToFullHeight(){(0,o.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,o.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,o.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,o.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,o.show)(window.onboardingBG),(0,o.isVisible)(window.onboardingBGHeader)||((0,o.show)(window.onboardingBGHeader),(0,o.addClass)((0,o.ge)(r),d)))}removeDarkens(){this.hideDarkness&&((0,o.hide)(window.onboardingBG),(0,o.hide)(window.onboardingBGHeader),(0,o.removeClass)((0,o.ge)(r),d))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const _=document.documentElement,e=document.body;return Math.max(e.scrollWidth,_.scrollWidth,e.offsetWidth,_.offsetWidth,e.clientWidth,_.clientWidth)}getPageHeight(){const _=document.documentElement,e=document.body;return Math.max(e.scrollHeight,_.scrollHeight,e.offsetHeight,_.offsetHeight,e.clientHeight,_.clientHeight)}constructor(_,e,t={}){this.el=_,this.text=e,this.hideDarkness=!0,this.oldColor=!1;var o;let l={autoShow:!1,noAutoHideOnWindowClick:null==(o=t.noAutoHideOnWindowClick)||o,content:e instanceof HTMLElement?e:`${e}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{var _;const e=null!=(_=t.class)?_:"";return t.tooltipWhite?e:e+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:t.scrollOffset||0,align:t.align||a.ElementTooltip.ALIGN_CENTER};t.side&&(l.forceSide=t.side),t.offset&&(l.offset=t.offset),t.width&&(l.width=t.width),t.shift&&(l.centerShift=t.shift),t.border?this.border=t.border:this.border=[10,10,10,10],t.ttOnHide&&(l.onHide=t.ttOnHide),t.withCloseButton&&(l.withCloseButton=t.withCloseButton,l.onCloseButtonClick=t.onCloseButtonClick),t.align&&(l.align=t.align),this.ttParams=l,this.opts=t,this.initOnboardingBG()}}},23087:(_,e,t)=>{function o(_){const e=_.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}t.d(e,{isElementInViewport:()=>o})},560004:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_65__=__webpack_require__(11010),_swc_helpers_extends__WEBPACK_IMPORTED_MODULE_74__=__webpack_require__(434788),_swc_helpers_object_without_properties_loose__WEBPACK_IMPORTED_MODULE_68__=__webpack_require__(820224),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9480),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(301230),_web_lib_market__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(577552),_shared_lib_site__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(404145),_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(731951),_web_wall_post_update_view_utils__WEBPACK_IMPORTED_MODULE_76__=__webpack_require__(198186),_web_wall_wall_post_elem_utils__WEBPACK_IMPORTED_MODULE_77__=__webpack_require__(170864),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(659397),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(29271),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_79__=__webpack_require__(815671),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_80__=__webpack_require__(850343),_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(795558),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(95432),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(953908),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(320422),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(514986),_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(725296),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(531730),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(82161),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(584356),_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(215066),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(438221),_web_lib_fx__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(893106),_web_lib_video__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(652027),_web_lib_lang__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(221780),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(962983),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(501087),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(643897),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(96756),_web_lib_utils__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(705758),_web_donut__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(82490),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(555510),_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(84852),_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(920697),_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(748143),_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(664988),_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(903006),_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(841936),_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(709291),_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_70__=__webpack_require__(925006),_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(216324),_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(860442),_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(513669),_web_lib_date__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(672948),_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(482043),_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(234275),_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(880660),_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(90692),_web_reports_reports__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(965109),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(839470),_web_likes_helpers__WEBPACK_IMPORTED_MODULE_75__=__webpack_require__(693982),_icons_desktop__WEBPACK_IMPORTED_MODULE_66__=__webpack_require__(772913),_icons_desktop__WEBPACK_IMPORTED_MODULE_67__=__webpack_require__(421577),_icons_desktop__WEBPACK_IMPORTED_MODULE_69__=__webpack_require__(806427),_icons_desktop__WEBPACK_IMPORTED_MODULE_71__=__webpack_require__(902716),_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(385376),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(854099),_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(863727),_web_ecomm_classifieds_legacy_injects_ClassifiedsWallForm__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(986229),_web_stickers_utils__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(991243),_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(137363),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(10645),_web_profile_profile_utils__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(930776),_shared_components_avatar_renderAvatarToString__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(12468),_shared_utils_reflow__WEBPACK_IMPORTED_MODULE_78__=__webpack_require__(975687),_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_73__=__webpack_require__(321850),_web_Badges_constants__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(222285),_web_ecomm_onboarding_Tooltips_services_TooltipEventService__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(508216),_shared_ranges__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(931917),_web_attachments_view_selector_init_view_ui_selector__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(411741),_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_58__=__webpack_require__(838563),_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__=__webpack_require__(437683),_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__=__webpack_require__(943331),_web_ord_utils__WEBPACK_IMPORTED_MODULE_61__=__webpack_require__(827502),_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__=__webpack_require__(426585),_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_72__=__webpack_require__(809053),_web_Badges_helpers__WEBPACK_IMPORTED_MODULE_63__=__webpack_require__(849776),_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__=__webpack_require__(82226);const Wall={LS_ADS_EVENTS:"ads.events",postponedPosts:null,deleteAll:function(_,e,t){ajax.post("al_wall.php",{act:"delete_all",post:e,hash:t},{onDone:function(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_));t.oldt=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,e)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{className:"progress"})))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_))}})},restoreAll:function(_,e,t){const o=Math.floor(1e5*Math.random());cur.wallRnd=o,ajax.post("al_wall.php",{act:"restore_all",post:e,hash:t,rnd:o},{onDone:function(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,t.oldt)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("span",{className:"progress_inline"})))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_))}})},deleteThread:function(_,e,t){ajax.post("al_wall.php",{act:"delete_thread",post:e,hash:t,from_deleted:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e),"reply_deleted")},{onDone:function(t){let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("dld_inner",_);if(o)o.oldElements=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(o,t);else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("reply_wrap",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(l),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{id:"post_del"+e,className:"dld",innerHTML:'<span class="dld_inner">'+t+"</span>"}),_.appendChild(o)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("replies_wrap_deep"+e)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(_);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post_actions",_);if(e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(e,"post_actions_progress");else{let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_);e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{className:"progress"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_).appendChild(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(e))}},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(_);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post_actions",_);e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(e,"post_actions_progress"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_))}})},restoreThread:function(_,e,t){ajax.post("al_wall.php",{act:"restore_thread",post:e,hash:t},{onDone:function(){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("replies_wrap_deep"+e),t.oldElements)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,t.oldElements);else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("reply_wrap","post"+e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)("post_del"+e)}},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(_);let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_);e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{className:"progress"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_).appendChild(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(e))},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_))}})},block:function(_,e,t,o,l){ajax.post("al_wall.php",{act:"block",post:e,hash:t,bl:o,from:l},{onDone:function(e){o?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_).insertBefore((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("span",{innerHTML:e}),_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(_)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_)))},showProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.showProgress)(_,"post_inline_progress","post_inline_progress",!0)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)("post_inline_progress")}})},blockEx:function(_,e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showBox)("groupsedit.php",{act:"bl_edit",name:"id"+e,gid:_,auto:1},{stat:["page.css","ui_controls.js","ui_controls.css"]})},withMentions:!(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mozilla&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.version.match(/^2\./)||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile),editPost:function(_,e,t,o,l){var i;if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsUpdateEnabled)()&&(null==(i=Wall.postponedPosts)?void 0:i.isLocked()))return;if(cur.editingPost&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wpe_text")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wall_posts",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wpe_text"));if(!_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(_))return o&&o(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.notaBene)("wpe_text");Wall.cancelEdit()}cur.editingPost=[e],Wall.withMentions?window.stManager.add(["ui_controls.css","ui_controls.js",window.jsc("web/wall_edit.js")]):window.stManager.add([window.jsc("web/wall_edit.js")]);ajax.post("al_wall.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({act:"edit",post:e,mention:Wall.withMentions?1:""},t),{onDone:(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_65__._)((function*(..._){var o;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(_[4])&&cur.options&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(cur.options.filter_media_types)){const e=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(_[4],(function(_,t){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(cur.options.filter_media_types,(function(_,o){if(t[0]===o[0])return e.push(o),!1}))})),_[4]=e}_.unshift(e),t&&t.fromAds&&_.push(t.fromAds),(null==(o=cur.classifiedsWallForm)?void 0:o.isClassifiedsAutoRecognitionBarEnabled())&&cur.classifiedsWallForm.hideAutoRecognitionPostBar(e),cur.isYoulaProductPublishedWebFlashMessageEnabled&&Wall.handleClassifiedsFlashMessageState("hide");const[i,s,a,n,r,d,E]=_;WallEdit.editPost.call(window,i,s,a,n,r,d,E),l&&l()})),onFail:()=>{cur.editingPost=!1,o&&o()},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.lock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post_actions","post"+e),"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.unlock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post_actions","post"+e),"post_actions_progress")},noSort:!0})},fixPost:function(link,post,hash,value){return ajax.post("al_wall.php",{act:"a_fix_post",post,hash,value},{onDone:function(js){if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__.logEvalError)(_,js)}const postEl=cur.wallLayer==post?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+post);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("post_fixed"),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(this,"post_fixed")})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(postEl,"post_fixed",value),link&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(link,value?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_unfix_post"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_fix_post")),link.onclick=function(){return Wall.fixPost(link,post,hash,value?0:1)}),cur.onWKFix&&(cur.onWKFix(value),delete cur.onWKFix)},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(link,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton.pbind("wpe_fix"+post)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(link,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockActionsMenuItem)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton.pbind("wpe_fix"+post)}}),!1},cancelEdit:function(_){if(cur.editingPost){if(!0===_&&cur.editingPost[0].match(/^-?\d+_/))return;window.WallEdit?WallEdit.cancelEditPost():cur.editingPost=!1}},searchWall:function(){},switchTabContent:function(_){switch((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("page_wall_posts","page_postponed_posts","page_suggested_posts","page_search_posts","page_top_posts","page_archive_posts","page_donut_posts"),_){case"own":case"all":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("page_wall_posts");break;case"postponed":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("page_postponed_posts"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("wall_more_link");break;case"suggested":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("page_suggested_posts");break;case"search":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("page_search_posts");break;case"top":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("page_top_posts");break;case"archive":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("page_archive_posts");break;case"donut":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("page_donut_posts")}},switchWall:function(_,e,t){var o,l,i;if(e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.checkEvent)(e))return!0;if(t||(t="own"==cur.wallType?"all":"own"),e&&"click"==e.type&&e.clientX&&e.offsetX&&cur.wallTab==t&&cur.wallType==t&&"top"!==t)return nav.go(_,e);"postponed"==cur.wallTab&&(console.log("clean up on switch wall"),null==(i=Wall.postponedPosts)||i.cleanUp(),wall.checkPostponedCount(),uiTabs.hideSort());if("archive"!==cur.wallTab&&"archive"!==t||((cur.wallLayer?wkcur:cur).wallMyDeleted={}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(cur.wallArchiveFeatureTooltipHide)&&cur.wallArchiveFeatureTooltipHide(),!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(t,["top","archive","donut"])){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_posts");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(_,"own"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(_,"all"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(_,t)}cur.wallType=t,cur.wallTab=t,uiTabs.switchTab(_),uiTabs.hideProgress(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(t,["top","archive","donut"])?(cur.baseWallModule=cur.module,cur.module="wall_"+t,cur.topWallFeatureTT&&cur.topWallFeatureTT.hide()):cur.baseWallModule&&(cur.module=cur.baseWallModule,delete cur.baseWallModule);const s="donut"===t&&Wall.cantAccessDonutPosts();return Wall.hasPosts()||s?(Wall.update(),Wall.showWall()):(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,cur.wallArchiveRestored=0,cur.wallArchiveArchived=0,cur.wallArchiveRolledback=0,cur.wallDonutNextFrom=0,"top"===t?delete cur.wallTopFinished:"archive"===t?delete cur.wallArchiveFinished:"donut"===t&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_)),(null==(l=_)||null==(o=l.dataset)?void 0:o.donutLogEvent)&&(0,_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_39__.logDonutEvent)(_.dataset.donutLogEvent),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)},resetWall:function(){if(cur.wallType&&cur.wallTab){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_wall_tab_"+cur.wallType);_&&(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,(cur.wallLayer?wkcur:cur).wallMyDeleted={},"top"===cur.wallType?delete cur.wallTopFinished:"archive"===cur.wallType?delete cur.wallArchiveFinished:"donut"===cur.wallType&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_,!0))}},hasPosts:function(_){_=_||cur.wallType;const e=Wall.getPostsWrap(_);return!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post",e)},getPostsWrap:function(_){switch(_){case"archive":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_archive_posts");case"top":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_top_posts");case"donut":return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_donut_posts");default:return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_posts")}},showSuggested:function(ev,rows,notAll){if(ev&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.checkEvent)(ev))return!0;if(!cur.oid)return!1;let el=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_suggest");if(el=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(el,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domQuery1)("#page_wall_suggest_more .ui_tab_group_item"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_tab",el),!el)return!1;if(uiTabs.switchTab(el),cur.wallTab="suggested",delete cur.suggestedDeletedCount,void 0!==rows)wall.suggestLoaded(rows,notAll);else{if(cur.suggestedLoading)return!1;const curOid=cur.suggestedLoading=cur.oid;uiTabs.showProgress(el),ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid},{onDone:function(rows,notAll,js,count){if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__.logEvalError)(_,js)}cur.suggestedLoading=!1,uiTabs.hideProgress(el),Wall.updateTabCounter("page_wall_suggested_cnt",count),curOid===cur.oid&&"suggested"==cur.wallTab&&wall.suggestLoaded.apply(window,arguments)}})}return!1},deleteSuggested:function(_,e,t,o){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isButtonLocked)(o))return;(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(o);const l=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)({title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_action_confirmation"),onHide:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(o)}},_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_delete_suggested_box"),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_delete_suggested_btn"),(function(o){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isButtonLocked)(o)||((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(o),ajax.post("al_wall.php",{act:"delete_suggested",post_id:_,hash:t,group_id:e},{onDone:function(_){if("full_own"==cur.wallType||"full_all"==cur.wallType){const e=(Math.ceil(_/cur.pgPerPage)-1)*cur.pgPerPage;e<cur.pgOffset&&(e>0?nav.objLoc.offset=e:delete nav.objLoc.offset,nav.setLoc(nav.objLoc)),nav.reload()}else Wall.showSuggested();l.hide()},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(o),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(o)}))}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_cancel"))},suggestLoaded:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_suggested_posts",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggle)("wall_more_link",e),wall.switchTabContent("suggested")},suggestMore:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_suggested_posts"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_more_link");(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isButtonLocked)(e)||ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid,offset:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("post",_).length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("dld",_).length},{onDone:function(t,o){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{innerHTML:t});let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(l);for(;i;)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(i.id)||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(i,"post")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(i):_.appendChild(i),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(l);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggle)(e,o)},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton.pbind(e)})},suggestUpdate:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_suggests_count");let t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e));e&&(-1!==_&&1!==_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e,t+=_),Wall.updateTabCounter("page_wall_suggested_cnt",t))},suggestPublished:function(_,e,t){if(cur.onepost)return nav.go("/wall"+cur.oid);var o,l;(Wall.suggestUpdate(-1),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(e),cur.wallMyDeleted[_]=1,cur.editingPost=!1,Wall.deinitComposer((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wpe_text")),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),cur.postWpeIsPoster=!!cur.posterWpeSendParams,cur.posterWpe&&cur.posterWpeSendParams&&WallEdit.posterDestroy(),t)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_postponed_posts",t),(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsActResult)(t)?(null==(o=Wall.postponedPosts)||o.updateState({postsSize:t.count}),wall.postponeUpdateCount(null==(l=Wall.postponedPosts)?void 0:l.getPostsSize())):wall.postponeUpdateCount());if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_suggests_count")))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)("post"+_);else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_rmenu");_?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_rmenu_item",_).click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_wall_menu_suggested",_))):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_tabs")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_suggest",!1))}},showDonutWall:function(_){if(!cur.oid)return!1;const e="donut";Wall.updateTabVisibility("page_wall_donut",!0);const t=Wall.getWallTabLink(e);if(!t)return!1;uiTabs.switchTab(t),cur.wallTab=e,cur.wallType=e,void 0!==_&&Wall.donutWallSetRows(_)},donutWallSetRows(_){const e="donut",t=Wall.getPostsWrap(e);t&&(t.innerHTML=_,Wall.switchTabContent(e),Wall.update())},getWallTabLink:_=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(`page_wall_${_}`);return((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domQuery1)(`#page_wall_${_}_more .ui_tab_group_item`):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_tab",e))||null},showPostponedFull:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("ui_rmenu_postponed"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_posts");if(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"ui_rmenu_item_sel")||!t){const _={0:nav.objLoc[0],postponed:1};return nav.go(_)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,_),FullWall.updateSummary((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("post",t).length)},initPostponedSort(){var _;const e=document.querySelector(".js-ui_tab_sort_wrap");function t(){var _;null==(_=Wall.postponedPosts)||_.toggleSort(),Wall.showPostponed({},void 0,!0)}return null==(_=e)||_.addEventListener("click",t),()=>{var _;null==(_=e)||_.removeEventListener("click",t)}},showPostponed:function(_,e,t=!1){if(_&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.checkEvent)(_)&&!t)return!0;if(!cur.oid)return!1;if("postponed"===cur.wallTab&&!e&&!t)return!1;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_postponed");if(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"unshown")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domQuery1)("#page_wall_postponed_more .ui_tab_group_item"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_tab",o),!o)return!1;if(uiTabs.switchTab(o),cur.wallTab="postponed",void 0!==e){const _=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsActResult)(e)?e.rendered_posts:e,t=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsActResult)(e)?e.count:void 0;var l,i,s;if(Wall.postponedLoaded(_,t),console.log("result",e),(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsFixEnabled)())null==(l=Wall.postponedPosts)||l.updateState({offset:null!=(i=e.starts_from)?i:0,limit:e.limit,postsSize:e.count});if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsActResult)(e)&&(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsParallelLoadingEnabled)())null==(s=Wall.postponedPosts)||s.loadAllAfterPosting(e);else if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsActResult)(e)){var a;null==(a=Wall.postponedPosts)||a.loadAfterPosting(e)}}else{if(cur.postponedLoading)return!1;const _=cur.postponedLoading=cur.oid;uiTabs.showProgress(o);const e=()=>{cur.postponedLoading=!1,uiTabs.hideProgress(o),uiTabs.showSort(),_===cur.oid&&cur.wallTab};var n,r,d,E;if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsFixEnabled)())if((null==(n=Wall.postponedPosts)?void 0:n.canStartInitialLoading())||t){if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsParallelLoadingEnabled)())null==(r=Wall.postponedPosts)||r.updateState({offset:0,ownerId:window.cur.oid,limit:window.cur.postponedPostsRequestLimit,postsSize:window.cur.postponedPostsCount}),null==(d=Wall.postponedPosts)||d.loadInParallel(0,{onLoaded:_=>{e(),Wall.postponedLoaded(_.rendered_posts,_.count)}});else if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsPaginationEnabled)()){var c;null==(c=Wall.postponedPosts)||c.loadInitialForPagination({onLoaded:_=>{e(),Wall.postponedLoaded(_.rendered_posts,_.count)},onError:()=>{cur.postponedLoading=!1,uiTabs.hideProgress(o)}})}}else cur.postponedLoading=!1,uiTabs.hideProgress(o),uiTabs.showSort(),wall.switchTabContent("postponed"),null==(E=Wall.postponedPosts)||E.loadOnTabReturn();else ajax.post("al_wall.php",{act:"get_postponed",owner_id:cur.oid},{onDone:function(e){cur.postponedLoading=!1,uiTabs.hideProgress(o),_===cur.oid&&"postponed"==cur.wallTab&&Wall.postponedLoaded(e)}})}return!1},showSortTooltip(_,e){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(_,{text:e,typeClass:"tt_black",slide:4,shift:[10,8],hasover:1,showdt:50,hidedt:50,dir:"auto"})},postponedLoaded:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_postponed_posts",_),wall.switchTabContent("postponed"),e?wall.postponeUpdateCount(e):wall.postponeUpdateCount()},postponeUpdateCount:function(_){let e=0;if(_)e=_;else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_postponed_posts");if(e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("post",_).length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("dld",_).length||0,!_)return}Wall.updateTabCounter("page_wall_postponed_cnt",e)},checkPostponedCount:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("post","page_postponed_posts");let e=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(_,(function(){const _=this.id.replace("post","");cur.wallMyDeleted[_]||e++})),e||wall.updateTabVisibility("page_wall_postponed",!1)},updateTabCounter:function(_,e){e=e?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_20__.langNumeric)(e,"%s",!0):"",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)(_).forEach((function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(_,e);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"ui_tab_group_item")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"default-label",t.innerHTML)}))},updateTabVisibility:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_more_tab");if(t)if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(t))if(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"unshown")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_+"_more","unshown")){let e=!1;cur.wallTabsMorePriority.forEach((function(t){e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"unshown")||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(t,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(t+"_more","unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(_,"unshown"),e=!0)})),e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(_+"_more","unshown")}}else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"unshown"))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_+"_more"),"unshown");else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(e,"unshown");const _=cur.wallTabsLimit-1-(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_37__.getNavigableTabs)(t).length;if(_>0){let e=_;cur.wallTabsMorePriority.forEach((function(_){if(e<=0)return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_+"_more");t&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"unshown")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_),"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(t,"unshown"),e--)}))}}const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("ui_tab_group_item",t);o.length-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("unshown",t).length<=1&&(o.forEach((function(_){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"unshown")||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_.id.replace(/_more$/,"")),"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(_,"unshown"))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(t,"unshown"))}else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_),"unshown",!e);const o=(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_37__.getNavigableTabs)(t).length;if(o>cur.wallTabsLimit){let _=o-(cur.wallTabsLimit-1);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("ui_tab_group_item",t).forEach((function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(_,"unshown")})),cur.wallTabsMorePriority.forEach((function(e){if(_<=0)return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(e);t&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"unshown")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(t,"unshown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(e+"_more"),"unshown"),_--)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(t,"unshown"),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.statlogsValueEvent)("wall_more_tab_shown",cur.oid)}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_),"unshown",!e)},postponedPublished:function(_,e){if(cur.onepost)return nav.go("/wall"+cur.oid);"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),e&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(e),cur.wallMyDeleted[_]=1;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("post",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_postponed_posts")),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);if(t.length<=1&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(o,t)){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_rmenu");_?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_rmenu_item",_).click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_wall_menu_postponed",_))):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_tabs")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_postponed",!1))}else{var l,i;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(o),(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsFixEnabled)())null==(l=Wall.postponedPosts)||l.removePost(),wall.postponeUpdateCount(null==(i=Wall.postponedPosts)?void 0:i.getPostsSize());else wall.postponeUpdateCount()}},onWallSearchSend:function(_,e){e?Wall.showSearch(e,0):Wall.hideSearch()},showSearch:function(_,e){if(cur.searchLoading&&cur.searchLoading==_||!cur.oid)return!1;const t=cur.oid;cur.wallQuery=cur.searchLoading=_,"search"!=cur.wallTab&&(cur.prevWallTab=cur.wallTab,cur.wallTab="search");const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_more_link"),l=+new Date;return ajax.post("al_wall.php",{act:"s",search:1,q:_,owner_id:cur.oid,offset:e,inline:1,owners_only:1},{onDone:function(i,s,a){if(t!==cur.oid)return;if("search"!=cur.wallTab)return;const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_search_posts");e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(n,""),n.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.cf)(i)),wall.switchTabContent("search"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggle)(o,s<a),o.onclick=Wall.showSearch.pbind(_,s);const r=_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserIdTransitional(cur.oid)?_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceWallUsers:_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceWallGroups,d=+new Date-l;(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.saveSearchAttemptStats)(r,0,a,_,0,0,d)},showProgress:function(){uiSearch.showProgress("wall_search"),e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(o)},hideProgress:function(){cur.searchLoading=!1,uiSearch.hideProgress("wall_search"),e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(o)}}),!1},hideSearch:function(){if(delete cur.wallQuery,!cur.prevWallTab)return;const _=(_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserIdTransitional(cur.oid),_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceWallUsers);(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_),cur.wallTab=cur.prevWallTab,cur.prevWallTab=!1,wall.switchTabContent(cur.wallTab),wall.update()},publishPostponedPost:function(_,e,t){var o;(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsUpdateEnabled)()&&(null==(o=Wall.postponedPosts)?void 0:o.isLocked())||(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_action_confirmation"),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_publish_postponed_confirm"),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_publish_postponed_btn"),(function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.curBox)().hide(),ajax.post("al_wall.php",{act:"publish_postponed",post:_,from:t,hash:e},{onDone:Wall.postponedPublished.pbind(_),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton.pbind("wpe_publish"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton.pbind("wpe_publish"+_)})}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_cancel"))},publishFreeDonutCopy:function(_,e,t,o){const l=_.currentTarget,i=o?{title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_warning"),content:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_publish_donut_as_free_confirmation_warn")}:{title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_publish_donut_as_free_confirmation_title"),content:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_publish_donut_as_free_confirmation_confirm")},s=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(i.title,i.content,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_publish_donut_as_free_confirmation_btn"),(()=>{const _=()=>{s.hide()},o=s.btns.ok[0];ajax.post("al_wall.php",{act:"publish_free_donut_copy",post_id:e,hash:t},{onDone:e=>{Wall.publishFreeDonutCopyDone({menuActionEl:l,message:e}),_()},onFail:()=>{_()},showProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(o)},hideProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(o)}})}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_cancel"))},publishFreeDonutCopyDone({message:_,menuActionEl:e}){"full_own"!==cur.wallType&&"full_all"!==cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),_&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(_,{timeout:3e3}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(e)},cmp:function(_,e){const t=_.length,o=e.length;return t<o?-1:t>o?1:_<e?-1:_>e?1:0},cleanBlocksDefault:["page_top_posts","page_wall_posts","page_archive_posts","page_donut_posts"],cleanBlocks:function(_=Wall.cleanBlocksDefault){_.forEach((function(_){if("page_donut_posts"===_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_donut_info"))return;let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_));for(;e;){const _=e;e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(e),_.tagName&&"input"===_.tagName.toLowerCase()||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(_)}}))},receive:function(_,e,t,o){o=!0===o;const l="top"===(t=t||cur.wallType),i="archive"===t,s="donut"===t,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{innerHTML:_}),n=!!cur.options.revert,r=Wall.getPostsWrap(t),d=[];let E,c,b,P,u=[],p=0;if(o)u=Wall.cleanBlocksDefault;else{const[,_]=[[i,"page_archive_posts"],[l,"page_top_posts"],[s,"page_donut_posts"],[!0,"page_wall_posts"]].find((([_])=>_));u=Wall.cleanBlocksDefault.filter((e=>e!==_)),b=n?r.firstChild:r.lastChild}function D(_){return!!(_&&_.tagName&&"div"===_.tagName.toLowerCase()&&_.id&&"post"===_.id.substr(0,4))&&_.id}Wall.cleanBlocks(u);for(let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(n?a.firstChild:a.lastChild);_;_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(n?a.firstChild:a.lastChild))if("input"!=_.tagName.toLowerCase()){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"post_fixed")||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_.id))if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"_ads_promoted_post"))d.push({el:_,beforePost:D(n?a.firstChild:E),afterPost:D(n?E:a.lastChild)});else{for(;b&&b.tagName&&"div"==b.tagName.toLowerCase()&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(b,"post_fixed")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(b,"_ads_promoted_post")||!l&&!i&&Wall.cmp(b.id,_.id)<0);)b=n?b.nextSibling:b.previousSibling;++p,b?Wall.cmp(b.id,_.id)?(P=b,c=n?b.previousSibling:b.nextSibling,c&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(c,"_ads_promoted_post")&&(P=c),n?r.insertBefore(_,P):r.insertBefore(_,P.nextSibling)):(r.replaceChild(_,b),b=_,--p):n?r.appendChild(_):r.insertBefore(_,r.firstChild),E=_,(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_24__.placeholderSetup)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByTag1)("textarea",_),{fast:1})}}else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_.id);e?r.replaceChild(_,e):r.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(_,r.firstChild):r.appendChild(_)}if(d.length)for(let _=0,e=d.length;_<e;++_){const e=d[_];if(!e.beforePost&&!e.afterPost)continue;let t="no_position";for(let _=n?r.firstChild:r.lastChild;_;_=n?_.nextSibling:_.previousSibling){P=null;const o=D(_);if(o){if(e.beforePost===o?P=_:e.afterPost===o&&(P=_.nextSibling),P&&(P.previousSibling&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(P.previousSibling,"_ads_promoted_post")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(P,"_ads_promoted_post"))){P=null,t="ads_sibling";break}if(P){r.insertBefore(e.el,P),t=!1;break}}}t&&(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.statlogsValueEvent)("debug_watch",1,"js_page_ads_promoted_post_no_position",t)}l&&!p?cur.wallTopFinished=cur.oid:i&&!p?cur.wallArchiveFinished=cur.oid:s&&!p&&(cur.wallDonutFinished=cur.oid),"full_own"!==t&&"full_all"!==t||(Pagination.recache(p),FullWall.updateSummary(cur.pgCount)),Wall.update(),wall.addReplyNames(e),Wall.updateMentionsIndex(),p&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_8__.getAudioPlayer)().updateCurrentPlaying()},showMore:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox();if(cur.wallLayer)return;if("suggested"===cur.wallTab)return Wall.suggestMore();if(cur.wallTypeLoading&&cur.wallTypeLoading[cur.wallType]||"top"===cur.wallType&&cur.wallTopFinished===cur.oid||"archive"===cur.wallType&&cur.wallArchiveFinished===cur.oid||"donut"===cur.wallType&&cur.wallDonutFinished===cur.oid)return;const o=cur.wallType,l="top"===o,i="archive"===o,s="donut"===o,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_more_link"),n=cur.wallLoading=cur.oid,r=l&&!!cur.wallTopOnlyCache;let d="";0!==_&&(d=i?cur.wallArchiveNextFrom:l?cur.wallTopNextFrom:s?cur.wallDonutNextFrom:cur.wallNextFrom),cur.wallTypeLoading=cur.wallTypeLoading||{},cur.wallTypeLoading[o]=!0,t=!0===t&&!_,ajax.post("al_wall.php",{act:"get_wall",owner_id:cur.oid,offset:_,type:o,fixed:cur.options.fixed_post_id||"",wall_start_from:d,onlyCache:r},{local:1,onDone:function(a,r,d,E){return e&&uiTabs.hideProgress(e),n!==cur.oid||o!==cur.wallType?(delete cur.wallLoading,void delete cur.wallTypeLoading[o]):l&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isObject)(a)&&a.wait?(cur.wallTopLoadingDelay=cur.wallTopLoadingDelay?cur.wallTopLoadingDelay+100:200,void(cur.wallTopLoadingDelay<500?setTimeout((function(){delete cur.wallLoading,delete cur.wallTypeLoading[o],Wall.showMore(_)}),cur.wallTopLoadingDelay):(delete cur.wallLoading,delete cur.wallTypeLoading[o],cur.wallTopOnlyCache=!1,Wall.showMore(_)))):(delete cur.wallTopLoadingDelay,cur.wallVideos&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(d,(function(_,e){cur.wallVideos[_]&&(cur.wallVideos[_].list=cur.wallVideos[_].list.concat(e.list))})),i?cur.wallArchiveNextFrom=E:l?cur.wallTopNextFrom=E:s?cur.wallDonutNextFrom=E:cur.wallNextFrom=E,void setTimeout((function(){Wall.receive(a,r,o,t),_||o!==cur.wallType||Wall.showWall(),delete cur.wallLoading,delete cur.wallTypeLoading[o]}),0))},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton.pbind(a),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton.pbind(a)})},showWall:function(){wall.switchTabContent(cur.wallType);const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("wall_module",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_posts")))[1];_<(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)()&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)(_-15)},checkTextLen:function(_,e,t){const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(Emoji.editableVal(_).replace(/\n\n\n+/g,"\n\n"));if(_.lastLen===o.length&&!t)return void(window.FullWall&&cur.onepost&&FullWall.onePostOnScroll());const l=_.lastLen=o.length,i=(cur.options||{}).max_post_len||(window.mvcur||{}).maxReplyLength,s=l-o.replace(/\n/g,"").length;e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(e),l>i-100||s>4?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(e),e.innerHTML=l>i?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_recommended_exceeded",l-i):s>4?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_recommended_lines",s-4):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("text_N_symbols_remain",i-l)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(e),window.FullWall&&cur.onepost&&FullWall.onePostOnScroll()},checkPostLen:_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_47__.checkPostLen,postChanged:function(_,e){var t;const o=Wall.isPosterEditorOpen();if((o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)("submit_post"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_box"),"shown")||Wall.showEditPost(void 0,!1,Boolean(e)),vk.id&&!vk.widget&&!(null==(t=cur.options)?void 0:t.no_draft)){clearTimeout(cur.postAutosave);const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(cur.oid)==vk.id?Wall.saveDraft:Wall.saveOwnerDraftText.pbind(cur.oid);!0===_?e():cur.postAutosave=setTimeout(e,10===_?10:1e3)}o||(setTimeout((()=>Wall.checkPostLen(window.cur.postField,window.cur.postWarningField,window.cur.sendPostBtn))),setTimeout(Wall.checkPosterAvailability))},ownerDraftKey:function(_){return(0,_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_36__.buildOwnerDraftKey)(_)},ownerDraftData:function(){return cur.wallDraftData||(cur.wallDraftData={}),cur.wallDraftData},addOwnerDraftMedia:function(_,e){var t;if(null==(t=cur.options)?void 0:t.no_draft)return;const o=Wall.ownerDraftData(),l=e[0],i=e[1];let s=e[2];o._attach_cache=o._attach_cache||{},s?o._attach_cache[l+i]=s:s=o._attach_cache[l+i],o.attaches=o.attaches||[];const a=ls.get(Wall.ownerDraftKey(_))||{};!1!==l?o.attaches.push([l,i,s,o.attaches.length]):!1===l&&void 0!==i&&(o.attaches=o.attaches.filter((function(_){return _[3]!==i}))),ls.set(Wall.ownerDraftKey(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(a,{txt:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)(Wall.getDraftData().message||""),medias:o.attaches}))},cleanOwnerDraftMedia:function(_){var e;if(null==(e=cur.options)?void 0:e.no_draft)return;const t=Wall.ownerDraftData(),o=ls.get(Wall.ownerDraftKey(_))||{};t.attaches=[],ls.set(Wall.ownerDraftKey(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({txt:""},o,{medias:[]}))},saveOwnerDraftText:function(_){var e;if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),null==(e=cur.options)?void 0:e.no_draft)return;const t=Wall.ownerDraftData(),o=ls.get(Wall.ownerDraftKey(_))||{},l=Wall.getDraftData(),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)(l.message||"");let s=null;if(t.txt=i,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(o.medias||{},(function(_,e){switch(e[0]){case"postpone":l.postpone&&(o.medias[_][1]=l.postpone,o.medias[_][2].draft=1);break;case"poll":const e=(cur.wallAddMedia||{}).pollData(!0,!0);e&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(o.medias[_][2],e);break;case"copyright":const t=(cur.wallAddMedia||{}).copyrightData(!0);t&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(o.medias[_][2],t);break;case _web_donut__WEBPACK_IMPORTED_MODULE_26__.ATTACH_DATA_DONUT_DURATION:l[_web_donut__WEBPACK_IMPORTED_MODULE_26__.ATTACH_DATA_DONUT_DURATION]&&(o.medias[_][2]=Object.assign(o.medias[_][2]||{},{[_web_donut__WEBPACK_IMPORTED_MODULE_26__.ATTACH_DATA_DONUT_DURATION]:l[_web_donut__WEBPACK_IMPORTED_MODULE_26__.ATTACH_DATA_DONUT_DURATION]}))}})),i&&l.bkg_id&&(s={id:l.bkg_id},cur.poster&&cur.poster.isCustomBkgId(l.bkg_id)&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(s,cur.poster.getCustomBkg()),o.bkg_id&&delete o.bkg_id),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(o,{txt:i,bkg:s}),cur.shareShowImg&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(o,{shareShowImg:cur.shareShowImg}),_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(_)){const _=cur.poster?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_box"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("_submit_post_box",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("official"));(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(o,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"from-oid")||vk.id,signed:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)("signed")?1:0});(0,_web_donut__WEBPACK_IMPORTED_MODULE_26__.fieldValueIsDonutOnlyPost)(_,cur.wallAddMedia)?o.donutOnly=1:delete o.donutOnly}ls.set(Wall.ownerDraftKey(_),o)},getOwnerDraft:function(_){var e;if(null==(e=cur.options)?void 0:e.no_draft)return[];const t=ls.get(Wall.ownerDraftKey(_))||[],o={from:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(t.from),signed:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(t.signed),shareShowImg:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(t.shareShowImg)};return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(t.donutOnly)&&(o.donutOnly=1),[t.txt,t.medias,!0,o,t.bkg]},saveOwnerDraftMedia:function(_,e,t,o){var l;if(null==(l=cur.options)?void 0:l.no_draft)return;Wall.cleanOwnerDraftMedia(_);const i=cur.wallAddMedia||{};let s=[],a=(cur.wallAddMedia?i.getMedias():[]).slice().map((function(_){return _.slice(0,2)}));void 0!==t&&e?s=[[e,t,o]]:e||void 0===t||a.splice(t,1),a=a.concat(s),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(a,(function(){Wall.addOwnerDraftMedia(_,this)}))},saveDraft:function(){var _;if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),null==(_=cur.options)?void 0:_.no_draft)return;if(cur.noDraftSave)return void(cur.noDraftSave=!1);if(cur.postSent||vk.id!=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(cur.oid))return;const e=Wall.getDraftData();e.delayed||ajax.post("al_wall.php",Wall.fixPostParams((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({act:"save_draft",hash:cur.options.post_hash},e)),{onFail:function(){return!0}})},getDraftData:function(){var _;if(null==(_=cur.options)?void 0:_.no_draft)return{};const e=cur.wallAddMedia||{},t=e.chosenMedia||{},o=cur.wallAddMedia?e.getMedias():[],l=e.shareData||{};let i="",s=0,a=null;if(Wall.isPosterEditorOpen())i=cur.poster.getText(),a=i?cur.poster.getBkgId():null;else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_field");i=window.Emoji?Emoji.editableVal(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(_),i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(i)}let n={message:i,bkg_id:a};return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(t)&&t.length&&o.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clone)(t)),o.length&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(o,(function(_,t){if(!t)return;const o=this[0];let a=this[1];switch(o){case"poll":const _=e.pollData(!0,!0);if(!_)return n.delayed=!0,!1;a=_.question,delete _.question,n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(n,_);break;case"copyright":const o=e.copyrightData(!0);if(o)return void(n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(n,o));break;case"share":if(l.failed||!l.title&&(!l.images||!l.images.length)&&!l.photo_url&&!l.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(n.delayed=!0,!1):void 0;l.video?(a=l.video_owner_id+"_"+l.video_id,n.snippet_video=1):a=l.user_id&&l.photo_id&&!l.noPhoto?l.user_id+"_"+l.photo_id:"",l.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(i)==l.initialPattern&&(n.message=""),l.is_vk_mini_app&&(n.is_vk_mini_app=!0,n.is_photo_edit=l.isPhotoEdit,n.image_offset=cur.shareShowImg),n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(n,{url:l.url,module:cur.module,mode:l.mode,title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(l.title),description:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(l.description),button_text:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(l.button_text),button_action:l.button_action,extra:l.extra,extra_data:l.extraData,photo_url:l.video?"":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(l.photo_url),open_graph_data:(l.openGraph||{}).data,open_graph_hash:(l.openGraph||{}).hash});break;case"page":l.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(i)==l.initialPattern&&(n.message="");break;case"postpone":const s=+e.postponeDate;return void(n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(n,{postpone:s}));case"mark_as_ads":return void(n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(n,{mark_as_ads:1}));case _web_donut__WEBPACK_IMPORTED_MODULE_26__.ATTACH_DATA_DONUT_DURATION:return void(n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(n,(0,_web_donut__WEBPACK_IMPORTED_MODULE_26__.getPostParamsFromDurationMedia)(t)))}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(i)==this[3]&&(n.message=""),n["attach"+(s+1)+"_type"]=o,n["attach"+(s+1)]=a,s++})),n},setDraft:function(_){var e;if(null==(e=cur.options)?void 0:e.no_draft)return;if(!(_[0]||_[1]&&_[1].length||null!=_[4]))return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_field");if(!t)return;const o=_[4];o||Emoji.val(t,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(_[0]||"")).replace(/\n/g,"<br/>")),Wall.showEditPost((function(){setTimeout((function(){var e;if(o&&cur.poster){Wall.hidePosterFeatureTooltip();const e={text:_[0]||""};if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isString)(o)?e.bkgId=_[4]:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isObject)(o)&&(cur.poster.isCustomBkgId(o.id)&&cur.poster.addCustomBkg(o),e.bkgId=o.id),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(Wall.getMainPostBlock()))return cur.poster.setBkg(e.bkgId,!0),cur.poster.setText(e.text),void Emoji.val(t,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(_[0])).replace(/\n/g,"<br/>"));Wall.openPosterEditor(e)}window.cur.addPostData=Array.isArray(_[1])?_[1]:[],Wall.drawMedia({skipClear:!0}),Wall.checkPosterAvailability(),Wall.saveDraft(),Wall.checkPostLen(window.cur.postField,window.cur.postWarningField,window.cur.sendPostBtn),(null==(e=window.cur.classifiedsWallForm)?void 0:e.isAutoRecognitionEnabled())&&window.cur.classifiedsWallForm.autoRecognitionPostCheck(_[0])}),0)}),!0),_[2]&&wall.focusOnEnd(),_[3]&&(wall.setReplyAsGroup((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("official"),_[3]),_[3].shareShowImg&&(cur.shareShowImgRestored=_[3].shareShowImg),_[3].donutOnly&&cur.wallAddMedia&&cur.wallAddMedia.donutPostSettings&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly()),cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)},drawMedia:function({skipPoll:_=!1,skipClear:e=!1}={}){if(window.cur.addPostData&&cur.wallAddMedia){e||cur.wallAddMedia.clearMedia({skipPoll:_,skipNotifications:!0});for(const e in window.cur.addPostData){const t=window.cur.addPostData[e];_&&t[0]===_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_29__.MEDIA_SELECTOR_POLL||(cur.noDraftSave=!0,cur.wallAddMedia.chooseMediaNoNotify(...t))}}},initPostEditable:function(_){const e=cur.postField;if(!e||e.emojiInited)return!1;e.emojiInited=!0,window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.init(e,{ttDiff:-42,rPointer:!0,controlsCont:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(e),noStickers:!0,onSend:Wall.sendPost,noEnterSend:!0,ref:"post",onChange:()=>{var _;(null==(_=window.cur.classifiedsWallForm)?void 0:_.isAutoRecognitionEnabled())&&window.cur.classifiedsWallForm.onMessageChange(Wall.getMessage())},checkEditable:Wall.postChanged,initUploadForImagePasteCallback:function(_,e,t){window.Upload&&Upload.onFileApiSend(cur.wallUploadInd,[t])}}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(e,"submit_post_inited"),_?setTimeout(Wall.setDraft.pbind(_),0):cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)})),setTimeout((function(){cur.postFieldZoomText&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(e,"keydown paste",(function(){setTimeout((function(){cur.postFieldZoomText(cur.postField,cur.wallAddMedia)}),0)}))}),0)},initEmoji:function(){window.stManager.add([window.jsc("web/emoji.js")])},showEditPost:function(_,e,t){var o;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_field");if(cur.viewAsBox)return setTimeout((function(){l.blur()}),0),cur.viewAsBox();if(0===cur.editing)return;const i=document.getElementById("submit_post_box"),s={owner_id:parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(i,"oid")),posting_source:"wall",posting_form:"native_create_recognition"},a=(null==(o=window.cur.classifiedsWallForm)?void 0:o.isNativeCreateEnabled())&&!e&&(void 0===t||t);var n,r;a&&(null==(n=window.ClassifiedsClickAnalytics)||n.logCreateProductClick(cur.module,s));(setTimeout(WallUpload.init,0),Wall.initComposer(l,{lang:{introText:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("profile_mention_start_typing"),noResult:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("profile_mention_not_found")},checkLen:Wall.postChanged,onValueChange:Wall.onPostValChange,onItemSelect:Wall.onPostItemSelect},_),Wall.hideEditPostReply(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)("submit_post_box","shown"),cur.editing=0,Wall.showPosterFeatureTooltip(),Wall.showPostCopyrightFeatureTooltip(),Wall.showPostGearIconOrdTooltip(i),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(cur.onShowEditPost)&&cur.onShowEditPost(),a)&&(null==(r=window.ClassifiedsClickAnalytics)||r.logNativeFormLoadedClickEvent(cur.module,s));window.stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")])},postBoxFocus:function(_,e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.stopEvent)(_||window.event);const t=Wall.isPosterEditorOpen();(cur.postField&&window.Emoji||t)&&setTimeout((function(){e?t?(cur.poster.focusPoster(),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(cur.poster.getPosterElement())[1]-15)):(Emoji.focus(cur.postField),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(cur.postField)[1]-15)):t?cur.poster.focusPoster():Emoji.focus(cur.postField,!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_box"))}),0)},initComposer:function(_,e,t){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"composer"))t&&t();else if(cur.composerAdded){const o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}else window.stManager.add(["wide_dd.css",window.jsc("web/wide_dd.js")],(function(){cur.composerAdded=!0;const o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}))},deinitComposer:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"composer");e&&Composer.destroy(e),_.emojiId&&window.Emoji&&Emoji.destroy(_.emojiId)},hasComposerMedia:function(_){const e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"composer");return!(!e||!e.addMedia)&&e.addMedia.attachCount()>0},composerListShown:function(_){const e=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"composer");if(!e)return!1;const t=e.wdd;let o=0;for(const _ in t.shown)o+=1;return!!(t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(t.listWrap)&&o)},onPostValChange:function(_){var e;if((null==(e=window.cur.classifiedsWallForm)?void 0:e.isAutoRecognitionEnabled())&&window.cur.classifiedsWallForm.onMessageChange(_),cur.wallAddMedia&&!cur.isUrlsRecognitionDisabled&&cur.wallAddMedia.checkMessageURLs.apply(window,arguments),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||Pagination.pageTopUpdated(),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie&&!_){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_field");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.elfocus)(_)}},onPostItemSelect:function(_){if(!_||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(_[0])>=0||!cur.wallAddMedia)return;const e=`${(0,_shared_lib_site__WEBPACK_IMPORTED_MODULE_3__.getHostName)()}/event${-_[0]}`;cur.wallAddMedia.checkMessageURLs(e,!0)},hideEditPost:function(_){var e;cur.editing=!1;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_field"),o=cur.wallAddMedia||{},l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t));!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.opera_mobile&&t&&(!_&&(l||o.chosenMedia||o.getMedias&&o.getMedias().length>0||o.activeState||o.attachCount&&o.attachCount()>0)||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)("submit_post_box","shown"),t&&!l&&cur.postMention&&(cur.postMention.options.minHeight=cur.emptyPostheight||14),null==(e=window.cur.classifiedsWallForm)||e.reset(),cur.onWallSendCancel&&cur.onWallSendCancel(),window.WallUpload&&WallUpload.hide(),cur.wallAddMedia&&cur.wallAddMedia._hideAddMedia(!0)))},clearInput:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("page_add_media"),window.cur.addPostData=[];const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_field");if(Wall.withMentions){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"mention");e&&(e.rtaEl.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(e.cont),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(_))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(_,""),_.blur(),_.phonblur(),Wall.hideEditPost(!0),cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(void 0,void 0,{isReset:!0}),Wall.resetPostVisibilityAccess();const e=document.querySelector("#submit_post_box");e&&Wall.resetPostOrdData(e),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.checkbox)("export_status",!1),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.checkbox)("close_comments",!1),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.forEach((_=>{_()}));const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"composer");t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(t.articleConvertEl),t.articleConvertEl=!1)},fixPostParams:function(_){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clone)(_);return e.Message=_.message,delete e.message,e},focusOnEnd:function(_){if(!(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_field")))return;if("TEXTAREA"==_.tagName)return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.elfocus)(_);const e=_.innerHTML?_.innerHTML.length:_.length?_.length:_.childNodes.length-1;if(_.focus(),document.selection){const _=document.selection.createRange();_.moveStart("character",e),_.select()}else window.getSelection().collapse(_,_.childNodes.length)},showPostSettings:function(_,e){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"ett")){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_),t=e&&e.querySelector("#post-copyright-button");new ElementTooltip(_,{cls:"post_settings_tooltip"+(t?" post_settings_tooltip_with_custom_btn":""),content:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e),defaultSide:"top",offset:[0,-5],appendTo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_)}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(e)}e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.checkKeyboardEvent)(e)&&"click"===e.type&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"ett").toggle()},togglePostVisibilityAccess:function(_,e,t,o){t=t||"";const l="post_visibility_btn",i=cur[l+t];i&&i.hide(),(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_32__.updatePostTooltipActionRadioBtn)(_.closest(".radiobtn"),e,"post_settings_btn"+l+t);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_visibility_btn"+t),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post_action_btn_text",s),n=![_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.VISIBILITY_ACCESS_OPTIONS.ONLY_FRIENDS,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS].includes(e);if(e===_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("best_friends_only"+t).querySelector(".PostVisibilityBestFriendsOnlyOption"),o=Number(e.dataset.count);_.classList.contains("PostVisibilityBestFriendsOnlyOption__editLink")||0===o?((0,_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_40__.sendBestFriendsAnalytic)(_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_40__.BestFriendsEventType.editBestFriends),this.resetPostVisibilityAccess(),window.stManager.add([window.jsc("web/best_friends.js")],(()=>{window.bestFriendsBoxSettings((_=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("best_friends_only"+t);if(0===_)e.innerHTML=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.getTemplate)("visibility_access_best_friends_only_option",{html:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_choose_best_friends"),count:_}),this.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("no_friends_only"+t),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.VISIBILITY_ACCESS_OPTIONS.PUBLIC,t,!0);else{const o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_best_friends_settings_box_conversation_friends_count",_);e.innerHTML=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.getTemplate)("visibility_access_best_friends_only_option",{html:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.getTemplate)("visibility_access_best_friends_only_item",{count_text:o}),count:_}),this.togglePostVisibilityAccess(e,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS,t,!0)}}))}))):((0,_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_40__.sendBestFriendsAnalytic)(_shared_lib_best_friends_analytics__WEBPACK_IMPORTED_MODULE_40__.BestFriendsEventType.selectBestFriends),a.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_best_friends_only"),a.setAttribute("aria-label",_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_best_friends_only")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(s,"best_friends_only"))}else if(n){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("no_friends_only"+t).querySelector(".FancyElementTT__itemLabel").innerHTML;a.innerHTML=_,a.setAttribute("aria-label",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(_)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(s,"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(s,"best_friends_only")}else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("friends_only"+t).querySelector(".FancyElementTT__itemLabel").innerHTML;a.innerHTML=_,a.setAttribute("aria-label",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(_)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(s,"on"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(s,"best_friends_only")}var r;(o||Wall.postChanged(),n)||(null==(r=window.cur.classifiedsWallForm)||r.disable())},resetPostVisibilityAccess(){Wall.canChangeVisibilityForNewPost()&&Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("no_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.VISIBILITY_ACCESS_OPTIONS.PUBLIC,!1,!0)},resetPostOrdData(_){const e=_.querySelector("#post_icon_gear_settings"),t=_.querySelector("#ads_ord_mini_app_option"),o=t&&t.querySelector('[name="ord_pred_id"]'),l=t&&t.querySelector('[name="erid"]');e&&e.classList.remove("PostOption__iconWrapperApplied","on"),t&&t.classList.remove("PostOption__withMarkAdsOrdMiniApp","on"),o&&(o.value=""),l&&(l.value="")},canChangeVisibilityForNewPost:()=>!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_visibility_btn"),initPostVisibilitySelector(_){Wall.canChangeVisibilityForNewPost()&&(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_32__.createPostTooltip)("post_visibility_btn",_.id)},cantAccessDonutPosts:()=>!1===window.cur.donutGroupUserHasWallAccess,togglePostMarkAsAds:function(_,e){var t;e=e||"mute_notifications";const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(e);if(!o)return;const l=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)(_);if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.disable)(o,l),l)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(o,"prev-state",+(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)(o)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(o,"on");else{const _=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(o,"prev-state");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(o,"on",_)}null==(t=window.cur.classifiedsWallForm)||t.disable()},needCheckSign:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("check_sign");return _&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)(_)},saveCheckSign:function(_){const e=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)(_),t=_.querySelector(".PostOption__iconWrapper");let o="",l="";var i;e?(o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_check_sign_disabled"),l=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_66__.getIcon20UserOutline)().icon,null==(i=window.cur.classifiedsWallForm)||i.disable()):(o=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_check_sign_enabled"),l=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_67__.getIcon20UserSlashOutline)().icon);t.innerHTML=l,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"title",o),window.tooltips&&tooltips.hide(_,{onHide:_.onmouseover.bind(_)}),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.checkbox)(_,!e)},checkAsGroup:function(_){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.checkbox)(_),wall.setReplyAsGroup(_,{fromGroup:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)(_)})},showBoxError:function(_){const e=document.getElementById("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(e)){const _=document.getElementById("box_layer_wrap");(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_18__.slideDown)(e,100),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_18__.animate)(_,{scrollTop:0})}},messageGetter:()=>window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val,getMessage:function(_){const e=_||document.getElementById("post_field");return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(Wall.messageGetter()(e))},sendPost:function(_){var e,t,o,l;if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsFixEnabled)()&&(null==(e=Wall.postponedPosts)?void 0:e.isLocked())&&"postponed"===window.cur.wallTab)return;cur.poster&&!!(null==(t=_)?void 0:t.posterSendParams)?Wall.sendSimplePost(_):(null==(o=window.cur.classifiedsWallForm)?void 0:o.isNativeCreateEnabled())?Wall.sendPostOrClassifieds(_):(null==(l=window.cur.classifiedsWallForm)?void 0:l.isAutoRecognitionEnabled())?Wall.sendClassifiedsAutoRecognized(_):Wall.sendSimplePost(_)},sendSimplePost:(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_65__._)((function*({skipLocked:_=!1,posterSendParams:e}={}){var t,o,l,i;const s=cur.wallAddMedia||{},a=s.chosenMedia||{};let n=cur.wallAddMedia?s.getMedias():[];const r=s.shareData||{},d=cur.poster&&!!e;if(!Wall.checkPostLen(cur.postField))return;let E=d?e.text:Wall.getMessage(),c=!1;const b=d?null:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("send_post");let P=cur.options.suggesting?"suggest":cur.wallType;"top"===P&&(P="all"),d&&(n=n.filter((_=>{if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(_)){const[e]=_;return["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_26__.MEDIA_TYPE_DONUT_DURATION].includes(e)}})));const u=d?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_box"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("_submit_post_box",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("official")),p=(0,_web_donut__WEBPACK_IMPORTED_MODULE_26__.fieldValueIsDonutOnlyPost)(u,s);let D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(u,"from-oid")==cur.postTo?1:"";u&&cur.postTo||D||cur.defaultPostSettings&&(D=cur.defaultPostSettings.official?1:"");const{ord_is_ad:w,ord_erid:M,ord_external_id:O}=(()=>{const _=document.getElementById("ads_ord_mini_app_option"),e=_&&_.querySelector('[name="ord_pred_id"]'),t=_&&_.querySelector('[name="erid"]'),o=_&&_.classList.contains("on"),l=e&&e.value;return{ord_is_ad:o,ord_erid:t&&t.value,ord_external_id:l}})();let m={act:"post",message:E,to_id:cur.postTo,type:P,friends_only:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)("friends_only"),best_friends_only:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)("best_friends_only"),check_sign:Wall.needCheckSign(),close_comments:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("close_comments")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)("close_comments")?1:0:"",mute_notifications:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("mute_notifications")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)("mute_notifications")?1:0:"",mute_notifications_in_mentions:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("mute_notifications_in_mentions")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)("mute_notifications_in_mentions")?1:0:"",mark_as_ads:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)("mark_as_ads")||w?1:0,ord_erid:M,ord_external_id:O,official:D,signed:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)("signed"),hash:cur.options.post_hash,from:cur.from?cur.from:"",fixed:cur.options.fixed_post_id||"",situational_suggest_id:cur.options.situational_suggest_id||null},C=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,(0,_web_donut__WEBPACK_IMPORTED_MODULE_26__.getDonutPostParams)(p,s)),cur.options.additional_save_params&&(m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,cur.options.additional_save_params));const g=cur.wallAddMedia&&cur.wallAddMedia.id||"";if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_30__.getPostTopicSelectorParams)(String(g))),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_44__.partConfigEnabled)("attachments_primary_mode_web_feature")){const _=(0,_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_58__.getAttachmentsPrimaryModeParam)(String(g));var T,h;if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,_),_)(0,_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_58__.saveAttachmentsPrimaryModeDefaultValue)(_.primary_attachments_mode),null==(h=cur)||null==(T=h.attachmentsViewSelectorResult)||T.setOption(_.primary_attachments_mode)}(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(a)&&a.length&&n.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clone)(a)),d&&(m.poster_bkg_id=e.bkgId,m.poster_bkg_access_hash=e.accessHash,e.fallbackObj&&(n.push(["photo",e.fallbackObj.owner_id+"_"+e.fallbackObj.id,!1]),m.poster_photo_hash=e.fallbackObj.post_hash),m.poster_bkg_id!==cur.posterCtaBkgId&&(m.poster_author_bkg_check=!0)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("submit_post_error");const A=_=>{if(this.showBoxError(_),Wall.isPosterEditorOpen()){const _=cur.poster.getErrorWrapperElement();_.innerHTML="",_.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_error"))}};let B;if(n.length){let e=0;B=!1,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(n,(function(_,t){if(!t)return;const o=this[0];let l=this[1];switch(o){case"video":if(c||"suggest"==P)break;const _=Wall.getOwnerDraft(cur.oid)[1];if(!_)break;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(_,(function(_,t){t[1]===l&&t[2]&&t[2].upload_new&&e++}));break;case"poll":const t=s.pollData();if(!t)return B=!0,!1;l=t.question,delete t.question,m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,t);break;case"copyright":const o=s.copyrightData();if(o)return void(m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,o));break;case"share":if(r.failed||!r.title&&(!r.images||!r.images.length)&&!r.photo_url&&!r.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(B=!0,!1):void 0;if((cur.options.share||{}).button_exclusive&&r.button_text&&r.button_action){let _;n.length>1&&(_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_share_too_many_attachments")),E.split("\n").length-1>(cur.options.share||{}).button_exclusive_max_message_newlines&&(_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_ads_post_too_many_newlines")),E.length>(cur.options.share||{}).button_exclusive_max_message_len&&(_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_ads_post_too_long_message"));const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extractUrls)(" "+E+" "),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extractUrls)(" "+r.url+" ")[0];if(t&&e.length){"/"===t.query&&(t.query=""),"www."===t.domain.substr(0,4)&&(t.domain=t.domain.substr(4));for(let o=0;o<e.length;++o){const l=e[o];if("/"===l.query&&(l.query=""),"www."===l.domain.substr(0,4)&&(l.domain=l.domain.substr(4)),t.domain!=l.domain||t.query!=l.query){_=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_share_too_many_links");break}}}if(_)return A(_),B=!0,!1}if(!r.title)return A(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_share_title_required")),B=!0,!1;if(!r.url)return A(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_share_url_required")),B=!0,!1;if(r.url=new URL(r.url).href,r.video?(l=r.video_owner_id+"_"+r.video_id,m.snippet_video=1):l=r.user_id&&r.photo_id&&!r.noPhoto?r.user_id+"_"+r.photo_id:"",r.share_upload_failed&&!l)return void(r.share_upload_failed=0);if(r.images&&r.images.length&&!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(r.images[cur.shareShowImg])&&!l&&!r.noPhoto&&!r.share_own_image&&!r.video)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(b),s.uploadShare((function(){Wall.sendPost({skipLocked:!0})})),B=!0,!1;if((cur.options.share||{}).require_image&&!l)return A(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_share_image_required")),B=!0,!1;r.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(E)==r.initialPattern&&(m.message=""),r.is_vk_mini_app&&(m.is_vk_mini_app=!0,m.is_photo_edit=r.isPhotoEdit,m.image_offset=cur.shareShowImg),m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,{url:r.url,module:cur.module,mode:r.mode,title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(r.title),description:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(r.description),button_text:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(r.button_text),button_action:r.button_action,extra:r.extra,extra_data:r.extraData,photo_url:r.noPhoto||r.video?"":(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.replaceEntities)(r.photo_url),open_graph_data:(r.openGraph||{}).data,open_graph_hash:(r.openGraph||{}).hash});break;case"page":r.initialPattern&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(E)==r.initialPattern&&(m.message="");break;case"postpone":const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("postpone_date"+s.lnkId);return m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,{postpone:a}),cur.postponedLastDate=a,void(c=!0);case"mark_as_ads":return void(m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,{mark_as_ads:1}));case"pretty_cards":if(!s.prettyCardGallery)return;if(s.prettyCardGallery.needSendData())return s.prettyCardGallery.saveCards(Wall.sendPost,(function(_){A(_)})),B=!0,!1;const d=s.prettyCardGallery.getSendData();l=d.attachVal;break;case"podcast":if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(this[2],"attach_disabled"))return!1;break;case _web_donut__WEBPACK_IMPORTED_MODULE_26__.MEDIA_TYPE_DONUT_DURATION:return;case"donut_link":var i;m["attach"+(C+1)+"_owner_id"]=null==(i=this[5])?void 0:i.owner_id}this[3]&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(E)==this[3]&&(m.message=""),m["attach"+(C+1)+"_type"]=o,m["attach"+(C+1)]=l,C++}));const t=_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(cur.postTo)||cur.postTo===vk.id;if(cur.wallUploadVideoOpts&&cur.wallUploadVideoOpts.vars.is_wall_postponed_allowed&&t&&e&&!_&&!cur.postponeVideoPost)return(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.curBox)().hide(),void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showBox)("al_video.php?act=postponed_post_box",{videos_count:e},{onDone:function(_,e){_.removeButtons(),_.addButton(e.video_post_later_text,(function(){cur.postponeVideoPost=!0,Wall.sendPost({skipLocked:!0}),_.hide()})),_.addButton(e.video_post_now_text,(function(){Wall.sendPost({skipLocked:!0}),_.hide()}),"no")}});if(B)return void(_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(b))}if(!C&&!E)return _&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(b),void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.elfocus)("post_field");if(b&&!_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isButtonLocked)(b))return;cur.postponeVideoPost&&(m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(m,{postpone_video:!0,postpone_video_hd:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("postponed_post_hd"))})),cur.postAutosave&&clearTimeout(cur.postAutosave),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("submit_post_error"),cur.postSent=!0;const L=window.GroupsAdminTips&&window.GroupsAdminTips.isShownSection()?1:0;m.update_admin_tips=L;const W=(0,_web_donut__WEBPACK_IMPORTED_MODULE_26__.isPaidAttachPicked)(s,cur.oid);if(m.donut_duration&&-1!==m.donut_duration&&W&&!cur.donutAttachesApproved)return void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)({title:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_action_confirmation"),onHide:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(b)}},_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_publish_donut_freeing_attaches_confirmation_title"),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_publish_postponed_btn"),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.curBox)().hide(),cur.donutAttachesApproved=!0,Wall.sendPost(_,e)}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_cancel"),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.curBox)().hide(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(b)}));const I=null==(t=window.cur.classifiedsWallForm)?void 0:t.draftId;if(null==(o=window.cur.classifiedsWallForm)||o.updateDraftId(),m.message&&(null==(l=window.cur.classifiedsWallForm)?void 0:l.isAutoRecognitionEnabled())&&(null==(i=window.cur.classifiedsWallForm)?void 0:i.checkIfRecognitionNeeded()))try{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(b),yield window.cur.classifiedsWallForm.requestClassifiedsCheck({post_text:m.message,draft_id:I,is_auto_recognition:1,owner_id:cur.oid})}catch(_){}setTimeout((function(){ajax.post("al_wall.php",Wall.fixPostParams(m),{onDone:function(_,e,t,o){var l;if(_web_ecomm_onboarding_Tooltips_services_TooltipEventService__WEBPACK_IMPORTED_MODULE_55__.TooltipEventService.onAddPost(),null==(l=window.cur.classifiedsWallForm)?void 0:l.isClassifiedsFormEnabled()){const e=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsActResult)(_)?_.rendered_posts:_,t=e?e.match(/data-post-id=".*?_(.*?)"/):[null,"0"],o=window.cur.classifiedsWallForm.isNativeCreateEnabled()?"native_create_recognition":"auto_recognition",l={owner_id:cur.oid,draft_id:I,posting_source:"wall",posting_form:o,content_id:parseInt(t)};var i,a;if("suggest"==P)null==(i=window.ClassifiedsClickAnalytics)||i.logCreateSuggestPostClickEvent(cur.module,l);else null==(a=window.ClassifiedsClickAnalytics)||a.logCreatePostClickEvent(cur.module,l)}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isString)(t)||(t=null),cur.poster&&d&&(cur.poster.unlockEditPoster(),cur.poster.closeEditor(),cur.poster.resetPoster(),cur.posterCtaBkgId&&(cur.posterCtaBkgId=null)),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),Wall.clearInput(),cur.postSent=!1,cur.postponeVideoPost=!1,cur.donutAttachesApproved=!1;const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("mark_as_ads"),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("mute_notifications");if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)(r)&&E&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(E,"on"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.disable)(E,0)),r&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(r,"on"),s.donutUpdateVisibility()),cur.options.onSendPostDone)return void cur.options.onSendPostDone.apply(window,arguments);if(o&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(o),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isObject)(_)&&_.redirect)return void nav.go(_.redirect);(0,_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_37__.showHiddenNavigableTabs)();let b=(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsActResult)(_)?_.rendered_posts:_;if(c){if("feed"==P)(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(b,{out:3e3});else if("full_own"==P||"full_all"==P)return Wall.showPostponedFull(b);return wall.updateTabVisibility("page_wall_postponed",!0),void Wall.showPostponed(!1,_)}if(("full_own"==P||"full_all"==P)&&(cur.pgStart||nav.objLoc.postponed)){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clone)(nav.objLoc);return delete _.offset,delete _.postponed,vk.id!=cur.oid&&delete _.own,nav.go(_)}if(vk.id!=cur.oid&&"full_own"==P){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clone)(nav.objLoc);return delete _.own,nav.go(_)}if("feed"==P)return cur.wallPostCb();if("suggest"==P)return wall.updateTabVisibility("page_wall_suggest",!0),Wall.showSuggested(!1,b,e),Wall.suggestUpdate();if(p)return void Wall.showDonutWall(b);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_tabs")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_tab",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_tabs")).click(),Wall.receive(b,e),cur.onWallSendPost&&cur.onWallSendPost(),L&&null!==t&&window.GroupsAdminTips&&window.GroupsAdminTips.refreshSection(t);if((0,_web_profile_profile_utils__WEBPACK_IMPORTED_MODULE_52__.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module){var u;if(n.some((([_])=>"article"===_)))null==(u=window.Profile)||u.reloadOwnerContentTab("articles")}},onFail:function(_){if(cur.postSent=!1,cur.postponeVideoPost=!1,cur.donutAttachesApproved=!1,cur.poster&&d&&cur.poster.unlockEditPoster(),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),cur.options.onSendPostFail)return void cur.options.onSendPostFail.apply(window,arguments);if(!_)return!0;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)("submit_post_error")||(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_18__.slideDown)("submit_post_error",100),Wall.isPosterEditorOpen()){const _=cur.poster.getErrorWrapperElement();_.innerHTML="",_.appendChild(e)}return!0},showProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(b)},hideProgress:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(b)},noSort:!0})}),0)})),sendPostOrClassifieds:(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_65__._)((function*(){var _,e,t;const o=document.getElementById("post_field"),l=document.getElementById("submit_post_box"),i=document.getElementById("submit_post_error"),s=cur.wallAddMedia||{},a=cur.wallAddMedia?s.getMedias():[],n=Wall.getMessage(o),r=parseInt(null==(e=l)||null==(_=e.dataset)?void 0:_.oid),d=_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.convertOwnerIdToGroupId(r),E=document.getElementById("send_post"),c=a.map((([_,e])=>`${_}${e}`));if(!n&&0===a.length)return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.elfocus)("post_field");const b={owner_id:r,posting_source:"wall",posting_form:"native_create_recognition"};null==(t=window.ClassifiedsClickAnalytics)||t.logNativeFormSentClickEvent(cur.module,b);const P=!!n&&!a.length,u=!!n&&(a||[]).every((_=>"photo"===_[0]));if(P||u){i.style.display="none",cur.postSent=!0,(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(E);try{var p;null==(p=window.ClassifiedsClickAnalytics)||p.logClassifiedsDetectStartClickEvent(cur.module,b);const{is_classifieds_product:_,price:e,title:t,ml_response:o}=yield window.cur.classifiedsWallForm.requestClassifiedsCheck({post_text:n,photo_ids:c,is_auto_recognition:0,owner_id:r});if(!_||!t)return void Wall.sendSimplePost({skipLocked:!0});const{crossposting_url_hash:l,miniapp_id:i,product_link:s,error:a}=yield window.cur.classifiedsWallForm.simpleCreateProduct({group_id:d,price:e,title:t,description:n,attachments:c,ml_response:JSON.stringify(o),type:"post",screen:cur.module,posting_source:"wall"});a?Wall.showBoxError(a.error_text||a.error_msg||_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_unknown_error")):(Wall.clearInput(),window.cur.classifiedsWallForm.showCrossPosting({crossposting_url_hash:l,miniapp_id:i,product_link:s})),cur.onWallSendPost&&cur.onWallSendPost()}catch(_){var D;if(4527===(null==(D=_.error)?void 0:D.error_code))return void Wall.sendSimplePost({skipLocked:!0});cur.options.onSendPostFail&&cur.options.onSendPostFail.apply(window,[_.message]),Wall.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_unknown_error"))}cur.postSent=!1,(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(E)}else Wall.sendSimplePost()})),sendClassifiedsAutoRecognized:(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_65__._)((function*(_){if(!window.cur.classifiedsWallForm.productData)return void Wall.sendSimplePost(_);const e=document.getElementById("send_post");if(e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isButtonLocked)(e))return;const t=document.getElementById("post_field"),o=document.getElementById("submit_post_box"),l=cur.wallAddMedia||{},i=cur.wallAddMedia?l.getMedias():[],s=Wall.getMessage(t),a=parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(o,"from-oid")),n=parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(o,"oid"))||a,r=i.filter((([_])=>"photo"===_)).map((([_,e])=>`${_}${e}`));cur.postSent=!0,(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("submit_post_error");try{const _=yield window.cur.classifiedsWallForm.requestClassifiedsCheck({post_text:s,is_auto_recognition:1,owner_id:n}),{is_classifieds_product:e}=_,t=(0,_swc_helpers_object_without_properties_loose__WEBPACK_IMPORTED_MODULE_68__._)(_,["is_classifieds_product"]),{title:o,price:l,ml_response:i}=e?t:window.cur.classifiedsWallForm.productData,E=a===cur.postTo&&_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(n)?1:0,c=["close_comments","mute_notifications","signed"].reduce(((_,e)=>{const t=document.getElementById(e);return t&&(_[e]=t.classList.contains("on")),_}),{}),{crossposting_url_hash:b,miniapp_id:P,post_id:u,product_link:p,error:D}=yield window.cur.classifiedsWallForm.autoRecognitionCreateProduct({owner_id:n,price:l,title:o,description:s,attachments:r,ml_response:JSON.stringify(i),type:"post",screen:cur.module,posting_source:"wall",post_as_group:E,post_settings:JSON.stringify(c)});if(D?Wall.showBoxError(D.error_text||D.error_msg||_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_unknown_error")):(Wall.clearInput(),window.cur.classifiedsWallForm.showCrossPosting({crossposting_url_hash:b,miniapp_id:P,product_link:p})),c.close_comments){var d;const _=null==(d=Wall.getPostsWrap(cur.wallType))?void 0:d.querySelector(`[data-post-id="${n}_${u}"] [data-like-button-type="comment"]`);_&&_.remove()}window.cur.classifiedsWallForm.updateDraftId(),cur.options.suggesting&&(Wall.updateTabVisibility("page_wall_suggest",!0),Wall.showSuggested(),Wall.suggestUpdate()),cur.onWallSendPost&&cur.onWallSendPost()}catch(_){var E;if(4527===(null==(E=_.error)?void 0:E.error_code))return void Wall.sendSimplePost({skipLocked:!0});cur.options.onSendPostFail&&cur.options.onSendPostFail.apply(window,[_.message]),Wall.showBoxError(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_unknown_error"))}cur.postSent=!1,(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)(e)})),_repliesLoaded:function(_,e,t,o,l){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_);if(!i)return;const s=i.nextSibling;if(e){const _=i.offsetHeight;i.innerHTML=t,(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)((0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)()+(i.offsetHeight-_),0,void 0,!0),setTimeout(Wall.scrollHighlightReply.pbind("post"+e),0)}else i.innerHTML=t;if(s&&"replies_open"==s.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(s),ajax._framenext(),_==cur.wallLayer){const _=wkcur.reverse;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(wkcur,{offset:!_&&l.offset||0,loaded:l.num||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("reply",i,"div").length,count:l.count}),wall.addReplyNames(o),WkView.wallUpdateReplies(),_||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll())}else wall.addReplyNames(o),Wall.repliesSideSetup(_);Wall.updateMentionsIndex(),setTimeout((function(){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_8__.getAudioPlayer)().updateCurrentPlaying()}),10),l&&Likes.updateComments("wall"+_,l.count)},repliesSideSetup:function(_){if(cur.wallLayer==_)return void WkView.wallUpdateReplies();const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_);if(!e)return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wr_header",e,"a"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"deep_active");let i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_side"+_);if(cur.wallMyOpened[_]&&(t||l)){if(!i){const t=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_69__.getIcon24ChevronUp)().icon,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(`<div class="replies_side_wrap"><div id="replies_side${_}" class="replies_side"><div class="replies_side_icon">${t}</div></div></div>`);e.parentNode.insertBefore(o,e),i=o.firstChild,i.onmouseover=Wall.repliesSideOver.pbind(_),i.onmouseout=Wall.repliesSideOut.pbind(_),i.onclick=l?Wall.hideDeepReplies.pbind(_):Wall.repliesSideClick.pbind(_)}e.onmouseover=Wall.repliesSideOver.pbind(_),e.onmouseout=Wall.repliesSideOut.pbind(_),Wall.repliesSideOver(_)}else(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.floatingButtonCollapseAllRepliesHide)(i),e.onmouseover=null,e.onmouseout=null},repliesSideClick:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_),t=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)(),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(e)[1];return t>o&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)(o-100,0),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.floatingButtonCollapseAllRepliesHide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_side"+_)),Wall.showReplies(_,3,!1)},repliesSideOver:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_side"+_);if(!e)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(t))[1],l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(t)[1],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(e)[1],s=e.offsetHeight,a=window.lastWindowHeight||0,n=o+l-a+15,r=i+s-a;cur.wallRepliesSideOver=[_,t,n,r],Wall.repliesSideUpdate()},repliesSideOut:function(_){cur.wallRepliesSideOver&&cur.wallRepliesSideOver[0]==_&&delete cur.wallRepliesSideOver},repliesSideUpdate:function(_){const e=cur.wallRepliesSideOver;if(!e)return;const t=e[1],o=e[4]||{},l=e[5]||"";let i,s="replies_side";void 0===_&&(_=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)()),_<e[2]?((0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.floatingButtonCollapseAllRepliesShow)(t),i={marginTop:0,opacity:1}):_<e[3]?((0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.floatingButtonCollapseAllRepliesShow)(t),s+=" replies_side_fixed",i={opacity:Math.max(0,Math.min(1,(e[3]-_)/200))}):(s+=" replies_side_hidden",i={marginTop:e[3]-e[2],opacity:0,display:null}),(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_5__.isEqual)(o,i)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(o,(function(_,e){o[_]=null})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.setStyle)(t,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(o,i)),e[4]=i),l!=s&&(t&&(t.className=s),e[5]=s)},highlightReply:function(_){(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_))&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(_,"reply_highlighted"),setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(_,"reply_highlighted")}),1500))},scrollHighlightReply:function(_){if(!(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_)))return;if(cur.wallLayer||_.id.match(/^post-?\d+(photo|video|market)?_\d+$/)&&(window.wkcur&&wkcur.shown||window.mvcur&&mvcur.mvShown||cur.pvShown)){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(_,!0)[1];return void(e<0||e>lastWindowHeight-200?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_18__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+e-50},300,Wall.highlightReply.pbind(_)):Wall.highlightReply(_))}const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(_)[1];e<(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)()+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)("page_header")[1]?((0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)(e,300),setTimeout(Wall.highlightReply.pbind(_),300)):Wall.highlightReply(_)},showReply:function(_,e,t,o){if(cur.viewAsBox)return!1;if(o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.checkEvent)(o))return!0;if(window.mvcur&&mvcur.post==e)return Videoview.showComment(t),!1;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+t);if(l)Wall.scrollHighlightReply(l);else if(cur.wallLayer==e)WkView.wallShowPreviousReplies(t);else if(e.match(/market/))Market.comments(e);else{if(_.tt&&_.tt.hide&&_.tt.hide(),"full"==cur.wallType){const _=t.split("_");return delete nav.objLoc.offset,nav.go((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(nav.objLoc,{reply:_[1]}))}Wall.showReplies(e,!1,t)}return!1},showReplies:function(_,e,t,o){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.checkEvent)(o||window.event))return!0;if(cur.viewAsBox)return cur.viewAsBox();if(cur.wallLayer==_&&wkcur.reverse)return;cur.wallMyOpened[_]=3!=e;const l={act:"get_replies",post:_,count:e},i={onDone:Wall._repliesLoaded.pbind(_,t),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton.pbind("wrh"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton.pbind("wrh"+_),local:1};if(t||e&&!(e>20)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(l,{cont:"replies"+_}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(i,{frame:1}),cur.onFrameBlocksDone=function(){setTimeout(Wall.repliesSideSetup.pbind(_),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie?100:10)}),ajax.post("al_wall.php",l,i),!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie&&e>0&&e<10){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_);let o=t&&t.lastChild;const l=[];for(;l.length<e&&o;)"DIV"==o.tagName&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"reply")&&l.push(o),o=o.previousSibling;if(l.length==e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("reply",t,"div").length;for((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,'<a class="wr_header wrh_all"></a>'),Wall.updateRepliesHeader(_,t.firstChild,e,o),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.floatingButtonCollapseAllRepliesHide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_side"+_));l.length;)t.appendChild(l.pop());(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)("wrh"+_)}}return!1},moreReplies:function(_,e,t,o){let l;if(o.deep){const i=_.split("_");l={act:"get_post_replies",offset:e,owner_id:i[0],item_id:i[1],count:t},o.order&&(l.order=o.order)}else l={act:"get_replies",offset:e,post:_,count:t};return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(l,{rev:o.rev,from:o.from}),ajax.post("al_wall.php",l,{onDone:function(e,t,l){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_);o.clear?i.innerHTML=e:o.rev||o.append?i.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.cf)(e)):i.innerHTML=e+i.innerHTML,wall.addReplyNames(t),o.onDone&&o.onDone(e,t,l),Wall.updateMentionsIndex()},onFail:()=>!1,showProgress:o.showProgress,hideProgress:o.hideProgress}),!1},openDeepShortReplies:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("replies_next",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_));return t&&((0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.loadRepliesLinkShow)(t),t.focus(),t.click(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(_)),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)},collapseDeepReplies:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+e);if(!t||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"replies_list_deep"))return;const o=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)();let l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(_)[1];const i=Math.round((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.clientHeight)()/2);cur.wallLayer?(l-=o,l<i&&(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_18__.animate)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+l-i},300)):o>l-i&&(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)(l-i);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e);s&&(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.highlightUpdatedReply)(s);const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("span",{className:"progress_inline replies_next_loader"});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(_),t.innerHTML="";const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box_wrap"+e);n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(n);const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap_deep"+e),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",t),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(d,"post-id"),c=wall.getRepliesOrder(E);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(r,"replies_deep_has_field"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(r,"replies_deep_has_short"),wall.updateRepliesOnScroll(),ajax.post("al_wall.php",{act:"get_collapsed_replies",reply_id:e,order:c},{onDone:function(_){t.innerHTML=_},onFail:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(cur.wallTpl.reply_deep_next,{post_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(d,"post-id"),reply_id:e,offset:0,text:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_next_n_replies",cur.options&&cur.options.replies_page_count||20),class:" replies_next_deep"}));t.appendChild(_),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.loadRepliesLinkShow)(_)},showProgress:function(){t.appendChild(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(a)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(a)}})},overCollapseDeepReplies:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("replies_deep_collapse_icon",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(e),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getStyle)(e,"bottom")),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(_),s=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)(),a=cur.wallLayer?wkLayerWrap.scrollTop:s;cur.wallLayer&&(i[1]-=s);const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.clientHeight)(),r=i[1]+l[1];let d,E,c=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_70__.getFixedReplyField)(),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(c)[1];cur.wallLayer?(d=a+r-n,E=a+i[1]+t[1]+o+o-n):(d=r-n,E=i[1]+t[1]+o+o-n),cur.onScrollCollapseDeepReplies=wall.updCollapseDeepRepliesIcon.pbind(_,e,{iconSize:t,iconBottom:o,collapseSize:l,collapsePos:i,fixedField:c,fixedFieldSize:b,maxFixedScroll:d,topMaxScroll:E}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"resize",cur.onScrollCollapseDeepReplies),cur.onScrollCollapseDeepReplies()},outCollapseDeepReplies:function(_){cur.onScrollCollapseDeepReplies&&((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"resize",cur.onScrollCollapseDeepReplies),delete cur.onScrollCollapseDeepReplies);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("replies_deep_collapse_icon",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updCollapseDeepRepliesIcon:function(_,e,t){const o=cur.wallLayer?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)();let l=t.maxFixedScroll;if((cur.wallLayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t.fixedField,"wl_reply_form_fixed")||"full"===cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t.fixedField,"fixed"))&&(l+=t.fixedFieldSize),o<l){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((t.collapseSize[0]-t.iconSize[0])/2),l=t.topMaxScroll+t.fixedFieldSize-o;let i=t.fixedFieldSize+t.iconBottom;l>0&&(i-=l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.setStyle)(e,{position:"fixed",bottom:i,left:t.collapsePos[0]+_,right:"auto"})}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.setStyle)(e,{position:null,bottom:null,left:null,right:null})},updateCollapseDeepReplies:function(_){if(!cur.wallTpl||!cur.wallTpl.reply_deep_collapse)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap_deep"+_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("replies_wrap_deep",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_));if(!e)return;_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"post-id");const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_);if(!t)return t;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("reply",t).length>=2;let l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("replies_deep_collapse",e);if(o){if(l)return;l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(cur.wallTpl.reply_deep_collapse,{reply_id:_})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(l,t)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(l)},showNextReplies:function(_,e,t){const o=e.split("_"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"offset"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"count"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"collapse");let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"replies_prev"),n=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e);const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)("post"+e,"reply"),d={act:"get_post_replies",owner_id:o[0],item_id:o[1],offset:l,count:i,collapse:s},E=a?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPS)(_);if(E&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(E,"reply")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(E,"replies_wrap_deep"))){const _=((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(E,"post-id")||"").split("_")[1];a?d.next_id=_:d.prev_id=_}if(r)cur.wallLayer||(n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",n));else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+e),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"top-ids");t&&(d.top_replies=t)}const c=n.offsetHeight,b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(n,"post-id");d.order=wall.getRepliesOrder(b);const P=r&&wall.isDescRepliesOrder(b,d.order);P&&(a=!a);const u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("span",{className:"progress_inline replies_next_loader"});return ajax.post("al_wall.php",d,{onDone:function(t,o,i){const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domChildren)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{innerHTML:t})),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.cf)();let E=!1;r.forEach((function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"wr_header"))return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_.id);e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"reply")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"replies_wrap_deep"))||(d.appendChild(_),E=!0)}));const u=a&&!P||!a&&P;let p,D,w=!1;if(u){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap_deep"+e),"replies_deep_has_short")){const e=window.innerHeight||document.documentElement.clientHeight,t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)("page_header")[1],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(o)[1];p=cur.wallLayer?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)(),w=cur.wallLayer?l<e:l<p+e-t}D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(d,_)}else D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domLC)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertAfter)(d,_);const M=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(i.num),O=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(i.offset),m=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(i.count),C=Math.max(0,O+(a?-M:M)),g=m-C;let T=0;if(E&&(a&&O>0||!a&&g>0)&&(T=a?l-C:Math.min(g,M),i.closest_inx>=0&&(T=Math.min(T,i.closest_inx))),document.activeElement===_?(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(_,"focusout",(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(_)})):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(_),T){const e=_.cloneNode(!0),t=e.querySelector(".js-replies_next_label");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(e,"replies_next_pre_deleted"),s||(u?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(e,D),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_prev_n_replies",T))):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertAfter)(e,D),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_next_n_replies",T))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"count",T),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"offset",C))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap_deep"+e),"replies_deep_has_short");const h=n.offsetHeight-c;if(w&&h){const _=p+h;cur.wallLayer?wkLayerWrap.scrollTop=_:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)(_,0,!1,!0)}wall.updateCollapseDeepReplies(e),wall.updateMentionsIndex(),wall.addReplyNames(o),wall.addDeepRepliesBlock(e),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[b]=1,wall.repliesSideSetup(b),wall.updateRepliesOnScroll()},onFail:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(_,"replies_next_pre_deleted")},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(_,"replies_next_pre_deleted"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertAfter)(u,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(u)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(u)}}),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(!1)},emojiOpts:{},emojiShowTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttShow(Wall.emojiOpts[_],e,t)},emojiHideTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttHide(Wall.emojiOpts[_],e,t)},initReplyEditable:function(_,e,t,o,l){if(_.emojiInited)return!1;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_button"+t),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_media_preview"+t);_.emojiInited=!0,window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){const a=Emoji.init(_,{ttDiff:o?-40:-42,rPointer:!0,controlsCont:e,noStickers:"undefined"!=typeof mvcur&&!!mvcur.noStickers,shouldFocus:!l,ref:"reply",onSend:function(){Wall.sendReply(t),_.blur()},ctrlSend:function(){return Wall.customCur().wallTpl.reply_multiline||Wall.composerListShown(_)},checkEditable:function(){cur.onReplyChanged&&cur.onReplyChanged(_,t),Wall.checkTextLen(_,"reply_warn"+t)},onChange:function(){i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(i,"reply_send_disabled",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(Emoji.editableVal(_))&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(s,"media_preview_has_medias")),Wall.hideCheckTimer(t,"editing")},onStickerSend:function(_,e){Wall.sendReply(t,!1,{stickerId:_,sticker_referrer:e})},initUploadForImagePasteCallback:Page.initUploadForImagePaste});if(vk.widget&&!window.emojiStickers&&Emoji.updateTabs(),Wall.emojiOpts[t]=a,cur.afterEmojiInit&&cur.afterEmojiInit[t]){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("emoji_smile",Emoji.opts[a].controlsCont);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(_)&&(cur.afterEmojiInit[t](),delete cur.afterEmojiInit[t])}}))},initEditReply:function(_,e,t,o){let l=_,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_fakebox"+_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+_);const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(s,"reply"),d=cur.wallLayer?wkcur:cur;let E,c=!1;if(r){if(E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",s),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(E,"deep_active"),c){if(!cur.reply_to){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(s,"answering-id");if(e){const t=_.split("_")[1];cur.reply_to=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(t)],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("reply_to"+_,t)}}wall.addDeepRepliesBlock(_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_fakebox"+_)}l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(E,"post-id")}else cur.wallLayer?(c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post"),"deep_active"),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_reply_form_inner")):(E=s,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(E,"deep_active"));if(!E&&a?E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_post_wrap",a):!E&&n&&(E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_post_wrap",n)),a){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+l),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"can_reply_as_group"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"can_reply_as_any_group"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"owner-photo")||"",E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"owner-href")||"",b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"owner-name")||"",P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"owner-is-nft")||"",u=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_70__.replyBoxOwnerIsNftFromAttr)(P);let p="";o?p=d.wallTpl.reply_form_any_group:t&&(p=d.wallTpl.reply_form_group);const{is_nft:D,avatar_url:w}=d.wallTpl.default_replier,M=r&&c?_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.REPLY_IMAGE_SMALL_SIZE:_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.REPLY_IMAGE_DEFAULT_SIZE,O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(d.wallTpl.reply_form_user_image,{href:"",primary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_47__.getPostAvatarString)(w,"post_field_user_image",M,D),secondary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_47__.getPostAvatarString)(s,"post_field_user_image",M,u,"post_field_image_secondary")});n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(c&&d.wallTpl.reply_form_new?d.wallTpl.reply_form_new:d.wallTpl.reply_form,{add_buttons:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(p,{post_id:_,oid:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(_),owner_photo:s||"/images/blank.gif",primary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_47__.getPostAvatarString)(w,"post_field_choose_image",M,D),secondary_image:(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_47__.getPostAvatarString)(s,"post_field_choose_image",M,u,"post_field_choose_secondary")}),post_id:_,oid:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(_),owner_is_nft:P,owner_photo:s,owner_href:E,owner_name:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.unclean)(b)),reply_image:O})),a.parentNode.replaceChild(n,a),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_)}if(!i){throw new Error("Failed to init new reply or edit reply: no reply field")}if(Wall.initReplyEditable(i,n,_,e,t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(i,"composer"))o&&o();else{const e=[];let t,s,a,n,r=!1;window.mvcur&&mvcur.mvShown?t=mvcur.mvMediaTypes:cur.wallLayer==l?t=wkcur.options.rmedia_types:window.pvcur&&cur.pvShown?(t=pvcur.rmedia_types,s=0,a=0):t=d.options&&d.options.rmedia_types,(c||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(E.parentElement,"VerticalVideoLayerInfo__commentsReply"))&&(r=!0,s=0,a=0),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(t||d.options&&d.options.media_types||[],(function(){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(this[0],["photo","video","short_video","audio","doc","link","page"])&&e.push(this)}));let b=!1;const P=l.match(/^(\d+_)?-?\d+_(photo|video|topic|market)?\d+(mv)?(_\d+)?$/);e.length>0&&P?(n={lnk:c?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_more_attaches"+_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_add_media_"+_),preview:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_media_preview"+_),actionsEl:!1,gearEl:!1,types:e,options:{from:"topic"===P[2]?"board":"comment",limit:2,disabledTypes:["album","market","market_album","poll",_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_29__.MEDIA_SELECTOR_GROUP],toggleLnk:!0,maxShown:void 0!==s?s:void 0,hideAfterCount:void 0!==a?a:void 0,vectorIcon:r,hideLabel:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_reply_add_attach_label"),toId:"full"===cur.wallType?cur.oid:cur.postTo,onToggleBlock:function(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("reply_box_photo",t);o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggle)(o,e)},onMediaChanged:function(){Wall.hideCheckTimer(_,"editing"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)("reply_button"+_,"reply_send_disabled",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(Emoji.editableVal(i))&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)("reply_media_preview"+_,"media_preview_has_medias"))}}},l.match(/^-?\d+_topic/)&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(n.options,{disabledTypes:["album","share","link","page"],limit:10,editable:1,sortable:1,teWidth:280,teHeight:200}),b=!0)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)("reply_add_media_"+_),Wall.initComposer(i,{lang:{introText:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("profile_mention_start_typing"),noResult:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("profile_mention_not_found")},toup:b,wddClass:"reply_composer_dd",width:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(i.parentNode)[0],media:n,isReply:!0},o)}return void 0!==i.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),{postId:l,postEl:E,isReply:r,rf:i}},showEditReply:function(_,e,t,o,l,i){if(cur.viewAsBox)return setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_).blur()}),0),cur.viewAsBox();if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)("post"+_,"Post--with_closed_comments_donut"))return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.setStyle)("replies_wrap"+_,{display:""}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e);const s=wall.initEditReply(_,t,l,i);if(s.rf){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("reply_box_wrap",s.rf));const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("replies_wrap_deep",s.rf);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(_,"replies_deep_has_field")}return cur.wallMyOpened&&(cur.wallMyOpened[_]=cur.wallMyOpened[_]||!1),cur.editing===_?(Emoji.editableFocus(s.rf,!1,!0),!1):(Wall.hideEditPostReply(),s.isReply?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap_deep"+_),"deep_reply_box_open"):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(s.postEl,"reply_box_open"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(s.postEl,"post--replyBoxWasOpened")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.setStyle)("replies_wrap"+_,{display:""}),cur.editing=_,window.Emoji&&setTimeout((function(){Emoji.editableFocus(s.rf,!1,!0),Wall.repliesSideOver(_)}),0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.triggerEvent)(window,"scroll"),void 0!==s.rf.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),cur.wallTpl&&cur.wallTpl.reply_multiline_intro&&ajax.post("al_wall.php",{act:"a_ctrl_submit_intro",hash:cur.wallTpl.poll_hash},{onDone:function(e){e&&cur.editing===s.postId&&Wall.replySubmitTooltip(_,1)},onFail:function(){return!0}}),window.mvcur&&(mvcur.post==s.postId&&Videoview.onShowEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),mvcur.scrollBottom&&mvcur.scrollBottom()),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(cur.onReplyFormSizeUpdate)&&cur.onReplyFormSizeUpdate(s.rf),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(cur.onReplyFormFocus)&&cur.onReplyFormFocus(s.rf),!1)},hideEditReply:function(_,e){cur.editing=!1;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+_),i=cur.reply_to&&Wall.getReplyName(cur.reply_to[0]);let s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(window.Emoji?Emoji.editableVal(t):"");const a=Wall.hasComposerMedia(t);let n;const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"reply");if(n=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_reply_form_inner"):r?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",o):o,!n&&l&&(n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_post_wrap",l)),!t||a&&!e)return;if(i&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(i)&&i[1]&&(s&&i[1].indexOf(s)||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,""),s="")),e&&(s||a)){const _=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(t,"composer");_?Composer.reset(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,""),s="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("reply_warn",n))}if(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.opera_mobile||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile||s)return;(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.curBox)().isVisible()||(r?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap_deep"+_),"deep_reply_box_open"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(n,"reply_box_open")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_link"+_)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("replies_wrap"+_),window.tooltips&&l&&tooltips.hideAll(l),t.blur(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.triggerEvent)(window,"scroll"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("reply_to"+_,""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("reply_to_title"+_),cur.reply_to=!1;const d=Wall.emojiOpts[_];d>=0&&Emoji.opts[d]&&Emoji.opts[d].onChange&&Emoji.opts[d].onChange(),cur.onReplyFormSizeUpdate&&cur.onReplyFormSizeUpdate();const E=cur.replySubmitSettings;E&&E.tt&&E.tt.el&&E.tt.destroy(),window.mvcur&&mvcur.post==_&&(Videoview.onHideEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate())},replyNamesRE:function(){wall.addReplyNames({});const _=wall.getReplyNames();if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isEmpty)(_))return!1;const e=[];return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(_,(function(_,t){t&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(t)&&(t=t[1]),"string"==typeof t&&e.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.escapeRE)(t)))})),new RegExp("^("+e.join("|")+")")},replyTo:function(_,e,t,o){const l=window.cur.wallLayer==_?wkcur:window.cur;Wall.showEditReply(_,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("reply_to"+_,e);const i=l.reply_to&&Wall.getReplyName(l.reply_to[0]);l.reply_to=[t,e];const s=Wall.getReplyName(t),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_as_group"+_),n=_.match(/^(-?\d+)_([a-z]+)?(\d+)([a-z]+)?$/),r=n[1],d=n[2]||"",E=n[4]||"",c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+r+d+"_"+e),b=c&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("reply_to",c,"a"),P=Wall.replyNamesRE(),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",c)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",c),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(u,"deep_active"),D=p?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("replies_wrap_deep",c):null,w=D?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(D,"post-id"):_;let M="";if(!p||D){let _=((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(s)?s[0]:s)||"";_='<a class="reply_to_mem" onclick="return wall.showReply(this, \''+w+"', '"+r+d+"_"+e+E+"', event);\">"+_+"</a>";const t=`<span class="reply_to_cancel" onclick="return Wall.cancelReplyTo('${w}', event);">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_71__.getIcon12Cancel)().icon}</span>`,o='<div class="reply_to_label">'+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.langStr)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_reply_to"),"user",_)+"</div>";M=p?o+t:t+o}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("reply_to_title"+w,M);const O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+w);if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(s)&&s[1]&&window.Emoji){const e=O;let t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(Emoji.val(e)));t=t.replace(/&nbsp;/g," "),!t||i&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(i)&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.winToUtf)(i[1]).indexOf((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.winToUtf)(t))?Emoji.val(e,s[1]):P&&(t=t.replace(P,s[1]),Emoji.val(e,t));const o=Wall.emojiOpts[_];o>=0&&Emoji.opts[o]&&Emoji.opts[o].onChange&&Emoji.opts[o].onChange(),Emoji.focus(e,!0)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggle)("reply_to_title"+w,M),a){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(a.parentNode)&&_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(r)&&b&&b.getAttribute("rid")===r;Wall.setReplyAsGroup(a,{from:_?r:vk.id})}const m=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_70__.getFixedReplyField)();return p&&O&&m&&(0,_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_33__.scrollOutsideFixedReplyArea)(O,m),l.onReplyFormSizeUpdate&&l.onReplyFormSizeUpdate(),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.stopEvent)(o),!1},cancelReplyTo:function(_,e){const t=window.cur.wallLayer==_?wkcur:window.cur,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_),l=t.reply_to&&Wall.getReplyName(t.reply_to[0]);let i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(window.Emoji?Emoji.editableVal(o):""));const s=Wall.replyNamesRE(),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",a)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",a),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(n,"deep_active");if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(l)&&l[1]&&window.Emoji){i&&l[1].indexOf(i)?s&&(i=i.replace(s,""),Emoji.val(o,i)):(i="",Emoji.val(o,i));const e=Wall.emojiOpts[_];e>=0&&Emoji.opts[e]&&Emoji.opts[e].onChange&&Emoji.opts[e].onChange(),Emoji.focus(o,!0)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("reply_to_title"+_),r){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"answering-id");if(e){const o=_.split("_")[1];t.reply_to=[(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(o)],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("reply_to"+_,o)}else t.reply_to=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("reply_to"+_,"")}else window.mvcur&&mvcur.post==_?mvcur.mvReplyTo=!1:t.reply_to=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("reply_to"+_,"");return t.onReplyFormSizeUpdate&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(t.onReplyFormSizeUpdate)&&t.onReplyFormSizeUpdate(o),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.stopEvent)(e),!1},replySubmitTooltip:function(_,e,t){const o=_&&window.cur.wallLayer==_?wkcur:window.cur,l=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_fakebox"+_)),i=l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("button_blue",l,"div");let s=o.replySubmitSettings;if(t&&i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(i))return;if(t=t||i,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"flat_button")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isButtonLocked)(t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"button_disabled"))return void(!e&&s&&s.tt&&s.tt.hide&&s.tt.hide());if(s||(s=o.replySubmitSettings=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{className:"reply_submit_hint_tt_point"})),!e)return void(s&&s.tt&&s.tt.hide&&s.tt.hide());if(!t)return;if(s.parentNode==t&&s.tt&&s.tt.show)return void s.tt.show();s.tt&&s.tt.el&&s.tt.destroy(),t.insertBefore(s,t.firstChild);const a=Wall.customCur().wallTpl.reply_multiline?1:0,n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(Wall.customCur().wallTpl.reply_multiline_hint,{enabled:a?"on":"",disabled:a?"":"on"}),r=l&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",l)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",l)),d=r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(r,"deep_active");(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(s,{text:n,typeClass:"tt_default_right",slide:15,shift:d?[15,8]:[0,8],asrtl:1,hasover:1,toup:!1,showdt:700,hidedt:700,dir:"auto",noZIndex:!0,onCreate:function(){radioBtns.reply_submit={els:Array.prototype.slice.apply((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_submit_hint_opts"))),val:n?1:0}}})},onReplySubmitChanged:function(_,e){if(cur.wallTpl?cur.wallTpl.reply_multiline=_:mvcur.wallTpl&&(mvcur.wallTpl.reply_multiline=_),Wall.customCur().wallTpl&&(Wall.customCur().wallTpl.reply_multiline=_),e){const _=cur.replySubmitSettings;_&&_.tt&&_.tt.el&&_.tt.destroy()}else ajax.post("al_wall.php",{act:"a_save_ctrl_submit",value:_,hash:Wall.customCur().wallTpl.poll_hash}),window.Notifier&&Notifier.lcSend("wall_reply_multiline",{value:_})},getReplyFromId:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_as_group"+_);return!(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(e.parentNode))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("_submit_post_box",e),"from-oid")},showCheckTimer(_,e,t){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+_),i=l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("WallCheckComment__timer",l);if(!o||!i)return;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(o,{text:t.description,showdt:0,hidedt:0,shift:[0,-1],width:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(o)[0],forcetoup:!0,nohide:!0,noZIndex:_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie_edge,className:"WallCheckComment__tt"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByTag)("span",i).forEach((_=>{_.style.animationDuration=`${t.delay}s`})),l.classList.add("WallCheckComment--shown");const s=setTimeout((()=>{l.classList.remove("WallCheckComment--shown"),Wall.sendReply(_,void 0,e)}),1e3*t.delay);i.timeout=s,i.onclick=()=>{Wall.hideCheckTimer(_,"button")},cur.destroy||(cur.destroy=[]),cur.destroy.push((()=>{s&&clearTimeout(s)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.elfocus)(o)},hideCheckTimer(_,e=!1){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+_),l=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("WallCheckComment__timer",o);if(!t||!l)return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"check_timestamp");e&&i&&Wall.isCheckTimerShown(_)&&ajax.post("al_wall.php",{act:"check_comment_cancelled",post_raw:_,timestamp:i,reason:e}),l.timeout&&clearTimeout(l.timeout),t.tt&&t.tt.hide&&t.tt.hide(),o.classList.remove("WallCheckComment--shown"),"button"===e&&setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.elfocus)(t)),0)},isCheckTimerShown(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+_);return e&&e.classList.contains("WallCheckComment--shown")},sendReply:function(_,e,t){t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({},t);const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap_deep"+_);let l,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("reply_to"+_);if(o?(l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",o),"post-id"),i=i||_.split("_")[1]):l=_,window.mvcur&&mvcur.post==l)return Videoview.sendComment(l,e,t);const s=window.cur.wallLayer==l,a=s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+l),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(a,"deep_active"),d=s?wkcur:window.cur,E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_),c=E&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(E,"composer"),b=d.reply_to&&Wall.getReplyName(d.reply_to[0]);let P,u;const p=E&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(E,"send");if(p&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(p))return p(_,e,t);if(t.stickerId)u={message:"",attach1_type:"sticker",attach1:t.stickerId,sticker_referrer:t.sticker_referrer};else if(t.suggest)u={message:t.suggest};else{if(u=c?Composer.getSendParams(c,Wall.sendReply.pbind(_)):{message:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)(Emoji.editableVal(E))},u.delayed)return;if(!u.attach1_type&&(!u.message||(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(b)&&b[1]&&!b[1].indexOf(u.message)))return void Emoji.editableFocus((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_),!1,!0)}let D;const w=window.wkcur&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wk_content");if(E&&(w&&w.contains(E)?wkcur.wallCheckComments:d.wallCheckComments)){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(E,"check_in_progress"))return;if(D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(E,"check_timestamp")||void 0,!D)return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.stopEvent)(e),void ajax.post("al_wall.php",{act:"check_comment",post_raw:l,text:u.message},{onDone(e){e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(E,"check_timestamp",e.timestamp),e.description&&e.delay)?Wall.showCheckTimer(_,t,e):Wall.sendReply(_,void 0,t)},onFail:()=>((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(E,"check_timestamp",Date.now()),Wall.sendReply(_,void 0,t),!0),showProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(E,"check_in_progress",!0)},hideProgress(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(E,"check_in_progress",null)}});if(Wall.isCheckTimerShown(_))return void Wall.hideCheckTimer(_,"button");Wall.hideCheckTimer(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(E,"check_timestamp",null)}t.stickerId||t.suggest||(c?P=Composer.reset(c):window.Emoji&&Emoji.val(E,""),E.autosize&&E.autosize.update()),d.wallMyOpened=d.wallMyOpened||{},d.wallMyReplied[l]=1,d.wallMyOpened[l]=1;const M=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_hash"+l)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_hash"+l).value:d.options.post_hash;let O=null,m=r&&(o||!s&&"full"!==d.wallType);const C=wall.getRepliesOrder(l),g=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(n,"top-ids");let T=!1;if(m&&n){const _=!o&&wall.isDescRepliesOrder(l,C)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(n):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domLC)(n);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"replies_next")&&(m=!1,T=!0)}const h=(0,_web_feed_feed_common__WEBPACK_IMPORTED_MODULE_72__.getTrackCodeFromPost)(a);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(u,{act:"post",type:d.wallType,reply_to:l,reply_to_msg:i,reply_to_user:d.reply_to&&d.reply_to[0]||0,start_id:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("start_reply"+l),from:s?"wkview":"",hash:M,only_new:m?1:0,need_last:T?1:0,order:C,top_replies:g||null,timestamp:D,track_code:h}),d.reverse&&(u.rev=1);const A=wall.getReplyFromId(_);let B;if(A&&(u.from_oid=A),B=d.wallType?"feed"==d.wallType?"news"==d.section?"feed_"+(d.subsection?d.subsection:d.section):"recommended"==d.section?"feed_recommended"+("recent"!=d.subsection?"_"+d.subsection:""):-1!==["friends","groups","videos","photos","list"].indexOf(d.section)?"feed_"+d.section+(d.subsection?"_"+d.subsection:""):"feed_"+d.section:"top"==d.wallType?"wall_top":"wall_"+(d.onepost?"one":(d.wallType||"").indexOf("full_")?"page":"full"):d.module,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(u,{ref:B}),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile?Wall.hideEditReply(_):(Emoji.editableFocus(E,!1,!0),Wall.cancelReplyTo(_,e)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("reply_warn"+_),ajax.post("al_wall.php",Wall.fixPostParams(u),{onDone:function(e,t,o,i){if(r){if(m)return wall.onOnlyNewReplySent.apply(window,arguments);if(T)return wall.onLastChunkReplySent.apply(window,arguments);if(s)return wall.onNewReplySentLayer.apply(window,arguments)}if("full"===d.wallType)return r?FullWall.onNewReplySent.apply(window,arguments):FullWall.onReplySent.apply(window,arguments);d.wallMyReplied[l]=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)("reply_link"+l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("reply_warn"+l),Wall._repliesLoaded(_,!1,t,o,i),Wall.processPostReplyActions(e)},onFail:function(_){if(O&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(O),c?P=Composer.restore(c,P):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(E,u.message),E.autosize&&E.autosize.update(),_)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_error"),_),!0},showProgress:function(){r?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_button"+_),!0):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_button"+_))},hideProgress:function(){r?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_button"+_),!1):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_button"+_))}}),window.cur.onPostReply&&window.cur.onPostReply(_),u.from_oid||!u.message||m)return;const L=-++d.wallMyRepliesCnt,W=Emoji.emojiToHTML((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)(u.message),!0),I=wall.getReplyNames(),R=_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(u.reply_to_user)?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_replied_to_group"):I[u.reply_to_user]&&I[u.reply_to_user][0],U=R?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(d.wallTpl.reply_link_to,{to_user:R}):"";if(O=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(d.wallTpl.reply_fast,{reply_id:"0_"+L,message:W.replace(/\n/g,"<br/>"),to_link:U,date:Wall.getNowRelTime(d)})),n&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(n)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_link"+_))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)("reply_link"+_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("replies_wrap"+_);else if(!d.onepost){const e=n.nextSibling;if(e&&"replies_open"==e.className&&Wall.openNewComments(_),!s){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wr_header",n,"a"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("reply",n,"div").length+1,o=t;e&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e.getAttribute("offs").split("/")[1])+1),(o>5||t<o)&&(e||n.insertBefore(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("a",{className:"wr_header"}),n.firstChild),Wall.updateRepliesHeader(_,e,t,o))}}d.reverse?n.insertBefore(O,n.firstChild):n.appendChild(O),s&&(WkView.wallUpdateReplies(),d.reverse||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()))},onOnlyNewReplySent:function(_,e,t){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"reply"),i=l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",o):o,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(i,"post-id"),a=!l&&wall.isDescRepliesOrder(s);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(i,"deep_active"))return;const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("replies_wrap_deep",o);l&&n&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(n,"post-id"));const r=cur.wallLayer===s,d=Wall._getRepliesInfoBeforeAddNewReply(_,r),E=Wall._checkVisibilityBeforeAddNewReply(_,d,a,r);l&&wall.addDeepRepliesBlock(_);const c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(e);a&&d.repliesListEl.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(c,d.repliesListEl.firstChild):d.repliesListEl.appendChild(c),Wall._fixScrollAfterAddNewReply(_,d,E,a,r),l&&wall.updateCollapseDeepReplies(_),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.highlightUpdatedReply)(c),wall.incReplyCounter(i),wall.addReplyNames(t)},onLastChunkReplySent:function(_,e,t,o,l,i){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+l),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(s,"reply"),n=a?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",s)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",s):s,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(n,"post-id"),d=!a&&wall.isDescRepliesOrder(r);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(n,"deep_active"))return;const E=cur.wallLayer===r,c=Wall._getRepliesInfoBeforeAddNewReply(l,E),b=Wall._checkVisibilityBeforeAddNewReply(l,c,d,E);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(c.repliesListEl,e),Wall._fixScrollAfterAddNewReply(l,c,b,d,E);const P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+i);P&&(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.highlightUpdatedReply)(P),a&&wall.updateCollapseDeepReplies(l),wall.incReplyCounter(n,1,_),wall.addReplyNames(o)},_getRepliesInfoBeforeAddNewReply:function(_,e){const t=e?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)(),o=window.innerHeight||document.documentElement.clientHeight,l=t+(e?0:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)("page_header_cont")[1]),i=t+o,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(s,e)[1],n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(s)[1];return{repliesListEl:s,scrollY:t,topY:l,bottomY:i,viewportHeight:o,repliesListY:a,repliesListH:n,repliesListEndY:a+n,layerFieldH:e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)("wl_reply_form")[1]:0}},_checkVisibilityBeforeAddNewReply:function(_,e,t,o){let l=!1;return l=t?o?e.repliesListY>0&&e.repliesListY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListY&&e.bottomY>e.repliesListY:o?e.repliesListEndY>0&&e.repliesListEndY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListEndY&&e.bottomY>e.repliesListEndY,l},_fixScrollAfterAddNewReply:function(_,e,t,o,l){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(e.repliesListEl)[1];if(o)t||(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)(e.repliesListY-100,300,!1,!0);else if(t){const _=e.scrollY+i-e.repliesListH;l?wkLayerWrap.scrollTop=_:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)(_,0,!1,!0)}else{const _=e.repliesListY+i-300;l?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_18__.animate)(wkLayerWrap,{scrollTop:e.scrollY+_},300):(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)(_,300,!1,!0)}},incReplyCounter:function(_,e,t){e=e||1;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"post-id"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("comment",_);let i;l&&(t||(i=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"count"),t=Math.max(0,i+e)),Likes.update("wall"+o,{comment_num:t}))},onNewReplySentLayer:function(_,e,t,o){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wl_replies",l);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(i,e);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domChildren)(i).filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"reply")})).length;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(wkcur,{offset:t,loaded:s,count:_}),wall.addReplyNames(o),WkView.wallUpdateReplies();const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"post-id");wall.isDescRepliesOrder(a)?wkLayerWrap.scrollTop=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(l)[1]-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)("wl_replies_wrap")[1]-30:wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()},postTooltip:function(_,e,t,o){if(cur.viewAsBox)return;const l=(t||{}).reply,i=(t||{}).className||"",s=l&&!(l%2)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(_)[0]>420;o=o||{},l||(o.appendEl=document.body),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(_,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({url:"al_wall.php",params:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({act:"post_tt",post:e},t||{}),slide:15,shift:[s?417:27,6,6],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",className:"rich wall_tt"+i,typeClass:s?"tt_default_right":"tt_default"},o))},adsMarkTooltip:function(_){cur.viewAsBox||(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(_,{black:1,shift:[15,7,0],text:_.getAttribute("data-tooltip")})},hideEditPostReply:function(_,e){if(!1===cur.editing)return;if(cur.wallLayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)("wl_post","deep_active")&&(e=!0),!e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(boxLayerBG)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(layerBG)))return;const t=_&&_.target?_.target:{},o=t.id;cur.editing?cur.editingHide?cur.editingHide(cur.editing,t):_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("_reply_wrap",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"reply_link")||o=="reply_field"+cur.editing||"reply_to_link"==t.className)||Wall.hideEditReply(cur.editing):(cur.wallAddMedia||{}).chosenMedia||_&&"post_field"==o||Wall.hideEditPost()},postShowDeletedMessage:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);if(t){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_post_content",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("feedback_row_t",t);(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_19__.revertLastInlineVideo)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(o),"post_publish")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(o));const l="post_del"+_,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(l),s='<span class="dld_inner">'+e+"</span>";return i?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(i,s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(i)):t.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{id:l,className:"dld",innerHTML:s})),!0}return!1},postHideDeletedMessage:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);if(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_post_content",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("feedback_row_t",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(t),"post_publish")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(t));const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_del"+_);return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(o),!0}return!1},isArchiveWall:function(){return cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module},rollbackPostsArchiveState:function(_,e,t){if(!Wall.isArchiveWall()||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.linkLocked)(_))return;const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_rollback_state",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){cur.wallArchiveRolledback=!0,Wall.postShowDeletedMessage(e,_)},showProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockLink)(_),hideProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockLink)(_)})},restoreLastRollbackPostsArchiveState:function(_,e,t){if(!Wall.isArchiveWall()||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.linkLocked)(_))return;const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_restore_last_rollback",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){delete cur.wallArchiveRolledback,Wall.postShowDeletedMessage(e,_)},showProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockLink)(_),hideProgress:(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockLink)(_)})},postSetArchiveState:function(actionEl,postRaw,hash,state,isRollback){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.actionsMenuItemLocked)(actionEl)||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.linkLocked)(actionEl))return;const postId=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(postRaw.split("_")[1]),isActionMenuItem=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(actionEl,"ui_actions_menu_item"),localCur=cur.wallLayer?wkcur:cur;localCur&&(localCur.wallMyDeleted||(localCur.wallMyDeleted={}),localCur.wallMyDeleted[postRaw]=!Wall.isArchiveWall()==!state?0:1);const extended=!isRollback&&(Wall.isArchiveWall()?cur.wallArchiveRestored>=3&&!cur.wallArchiveRolledback:!cur.wallArchiveArchived);ajax.post("al_wall_archive.php",{act:"a_set_state",from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_more_tab")?"profile":cur.pid?"post":"wall",hash,state:state?1:void 0,extended:extended?1:void 0,postId},{onDone:function(msg,js){if(Wall.isArchiveWall()&&(state=!state,isRollback||(cur.wallArchiveRestored||(cur.wallArchiveRestored=0),cur.wallArchiveRestored++)),state&&(cur.wallArchiveArchived=!0),isRollback?Wall.postHideDeletedMessage(postRaw):Wall.postShowDeletedMessage(postRaw,msg)){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+postRaw);"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(state?-1:1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"reply")&&(state?--cur.pgOffset:++cur.pgOffset,state?--cur.pgCount:++cur.pgCount,FullWall.repliesSummary(cur.pgCount)),"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"own")&&(state?++cur.deletedCnts.own:--cur.deletedCnts.own),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"all")&&(state?++cur.deletedCnts.all:--cur.deletedCnts.all),Wall.isArchiveWall()&&(state?--cur.deletedCnts.archive:++cur.deletedCnts.archive),Wall.update())}if(js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__.logEvalError)(_,js)}},showProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockActionsMenuItem.pbind(actionEl):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockLink)(actionEl),hideProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockActionsMenuItem.pbind(actionEl):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockLink)(actionEl)})},deletePost:function(_,e,t,o,l){var i;if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsUpdateEnabled)()&&(null==(i=Wall.postponedPosts)?void 0:i.isLocked()))return;(cur.wallLayer?wkcur:cur).wallMyDeleted[e]=1;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post_actions",s),n={act:"delete",post:e,hash:t,root:o?1:0,confirm:l?1:0,from:"wall"};cur.suggestedDeletedCount&&cur.suggestedDeletedCount>=2&&(n.delete_all=1),(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_25__.isClaimContent)()&&(n._nol=JSON.stringify(window.nav.objLoc)),ajax.post("al_wall.php",n,{onDone:function(l,i,a,n){if(n)return void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_error"),l);if(a){const i=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)(l,a,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_delete"),(function(){i.hide(),wall.deletePost(_,e,t,o,1)}),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("box_cancel"));return}Wall.postShowDeletedMessage(e,l),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(s,"reply")&&(cur.pgOffset--,cur.pgCount--,FullWall.repliesSummary(cur.pgCount));const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_publish_wrap"+e);if(r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(r,"suggest")&&(void 0===cur.suggestedDeletedCount&&(cur.suggestedDeletedCount=0),cur.suggestedDeletedCount++),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(s,"suggest"))Wall.suggestUpdate(-1);else if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(s,"postponed")){var d,E;if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsFixEnabled)())null==(d=Wall.postponedPosts)||d.removePost(),wall.postponeUpdateCount(null==(E=Wall.postponedPosts)?void 0:E.getPostsSize());else wall.postponeUpdateCount()}else"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(s,"own")&&++cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(s,"all")&&++cur.deletedCnts.all,Wall.isArchiveWall()&&++cur.deletedCnts.archive,Wall.update())},showProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.lock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(a,"post_actions_progress")},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockActionsMenuItem)(_):_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.isFlatButton(_)?_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.unlock(_):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(a,"post_actions_progress")}});const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("delete_post"+e);r&&r.tt&&r.tt.el&&r.tt.destroy()},markAsSpam:function(_,e,t,o,l){if(this.isAdPostMarkingAsSpam(e))return void this.markAdAsSpam(t,e,o,l);const[i,s]=e.split("_");(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_43__.showReportForm)(_,i,s,(()=>{const _=document.querySelector(`#post${i}_${s}`);null!==_?_.innerHTML=`<div class="dld">${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_report_sent")}</div>`:(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__.debugLog)("unable to find wall item")}))},isAdPostMarkingAsSpam:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);return!!e&&null!==e.getAttribute("data-ad")},markAdAsSpam:function(el,post,hash,inline){const adDataPost=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+post),adData=adDataPost.getAttribute("data-ad");ajax.post("al_wall.php",{act:"spam",post,ad_data:adData,hash,from:inline?"inline":""},{onDone:function(msg,js,js2){if("string"!=typeof js&&js2&&(js=js2),inline)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(el).replaceChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{innerHTML:msg}),el);else{const postSelector=`#post${post}`,r=el.closest(postSelector)||document.querySelector(postSelector),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_post_content",r)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("feedback_row_t",r);(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_19__.revertLastInlineVideo)(r);const pd=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_del"+post);if(pd?(pd.innerHTML=msg,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(pd)):r.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{id:"post_del"+post,innerHTML:msg})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(t),js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__.logEvalError)(_,js)}adData&&Wall._setAdReportHandler(post,adData,hash)}},showProgress:function(){el&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(el,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockActionsMenuItem)(el):inline&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(el)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(el).appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("span",{className:"progress_inline"}))))},hideProgress:function(){el&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(el,"ui_actions_menu_item")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockActionsMenuItem)(el):inline&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(el)))},stat:[window.jsc("web/privacy.js"),"privacy.css"]});const btn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("delete_post"+post);btn&&btn.tt&&btn.tt.el&&btn.tt.destroy()},_setAdReportHandler(_,e,t){const o="ad_report_"+_,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(o+"_send");if(!l)return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("radiobtn",o),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("radiobtn on",o);window.radioBtns[o]={val:s.dataset.value||1,els:i};const a=()=>{const[i,s]=_.split("_"),n=window.radioBtns[o].val;ajax.post("reports.php",{act:"report_ad_common",type:"ad",oid:i,item_id:s,hash:t,reason:n,ad_data:e},{onDone:()=>{delete window.radioBtns[o],l.removeEventListener("click",a),window.closeChosenReportReasonBlock(i,s),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("reports_warning_sent"))},onFail:_=>((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(_),!1),showProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.lock(l),hideProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.unlock(l)})};l.addEventListener("click",a)},showIgnoreItemReasons:function(_,e,t,o,l,i,s){const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e);if(!a)return;const n=a.getAttribute("data-ad");(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_19__.revertLastInlineVideo)(a),ajax.post("/al_wall.php?misc",{act:"get_ignore_reasons",post_raw:e,feed_raw:t,caption_type:l,uids:i,hash:o,ad_data:n,mode:s},{onDone:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(a,_);const n="ad_hide_"+e,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(n+"_send");if(!r)return;const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("radiobtn",n),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("radiobtn on",n);window.radioBtns[n]={val:E.dataset.value||1,els:d},r.addEventListener("click",(()=>{_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.lock(r);const _=window.radioBtns[n].val;("feed"===s?window.feed.ignoreItem:wall.ignoreAdsItem)(e,t,o,l,i,_).then((()=>{Wall.triggerAdStat(a,"hide"),delete window.radioBtns[n]})).catch((()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.unlock(r)))}))},showProgress:function(){_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"ui_actions_menu_item")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockActionsMenuItem)(_)},hideProgress:function(){_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"ui_actions_menu_item")&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockActionsMenuItem)(_)}})},ignoreAdsItem:function(_,e,t,o,l,i=0){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_),a=s.getAttribute("data-ad"),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_actions_menu_wrap",s);if(s)return n&&uiActionsMenu.toggle(n,!1),(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_19__.revertLastInlineVideo)(s),new Promise(((o,l)=>{ajax.post("/al_feed.php?misc",{act:"a_ignore_item",post_raw:_,feed_raw:e,hash:t,ad_data:a,no_html:1,reason_id:i},{onDone:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(s),o()},onFail:l})}))},ignoreAdsOwner:function(_,e,t,o){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);l&&ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:_,owner_id:e,hash:t,list:0,no_html:1},{onDone:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(l)},showProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton.pbind(o),hideProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton.pbind(o)})},markAsAds:function(_,e,t,o){ajax.post("al_wall.php",{act:"mark_as_ads",post:_,hash:e,full:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(o)},{onDone:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("ui_actions_menu_item_mark_as_ads"+_).innerHTML=e}})},restorePost:function(_,e,t){return(cur.wallLayer?wkcur:cur).wallMyDeleted[_]=0,ajax.post("al_wall.php",{act:"restore",post:_,hash:e,root:t?1:0},{onDone:function(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)("post_del_btn"+_),!Wall.postHideDeletedMessage(_))return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);if("full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"reply")&&(cur.pgOffset++,cur.pgCount++,FullWall.repliesSummary(cur.pgCount)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"suggest"))Wall.suggestUpdate(1);else if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"postponed")){var o,l;if((0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsFixEnabled)())null==(o=Wall.postponedPosts)||o.restorePost(),wall.postponeUpdateCount(null==(l=Wall.postponedPosts)?void 0:l.getPostsSize());else wall.postponeUpdateCount()}else"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"own")&&--cur.deletedCnts.own,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"all")&&--cur.deletedCnts.all,Wall.isArchiveWall()&&--cur.deletedCnts.archive,Wall.update())}}),!1},blockPostApp:function(_,e,t,o){ajax.post("al_wall.php",{act:"block_post_app",aid:_,from:e,hash:t},{onDone:function(_){o.parentNode.parentNode.innerHTML=_},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockButton.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockButton.pbind(o)})},checkPostClick:function(_,e,t){if(e=e||window.event,!_||!e)return!0;let o=e.target||e.srcElement,l=8,i=!1,s=/wall_post_text|published_comment|post_media|page_event_share|page_public_share|page_group_share|feed_friends|feed_videos|feed_explain_list|explain|feed_photos|feedback_row/;do{if(!o||o==_||o.onclick||o.onmousedown||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(o.tagName,["A","IMG","TEXTAREA","EMBED","OBJECT"])||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(o.className,["play_new","video_box_wrap"])||(i=o.className.match&&o.className.match(s)))break}while(l--&&(o=o.parentNode));if(!i)return!1;if(cur.postClicked||(cur.postClicked={}),!t||!cur.postClicked[_]){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString()))return!1;t&&(cur.postClicked[_]=!0,setTimeout((function(){cur.postClicked[_]=!1}),2e3))}return o||!0},postClick:function(_,e,t){var o,l,i;t=t||{};const s=(_||"").match(/^(-?\d+)_(wall)?(\d+)$/),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);let n;if(null==(i=window)||null==(l=i.searcher)||null==(o=l.onPostClick)||o.call(l,e.target),n=!!t.skipCheck||Wall.checkPostClick(a,e),!n)return;if(!0!==n){if(!n.querySelector(".PostTextMore[data-open-post]")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wall_post_more",n,"a");if(_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(_))return _.onclick(),void(s||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(a,"wall_post_over"));const e=n.querySelector("button.PostTextMore");if(e)return e.click(),void e.remove()}}if(!s)return;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(a,"suggest")||cur.onepost)return;const r=a&&a.getAttribute("data-ad"),d=a&&a.getAttribute("data-ad-block-uid"),E="/wall"+s[1]+"_"+s[3];if(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile&&e){const _={};r&&d&&(_.params={_post_ad_data:r,_post_ad_block_unique_id:d}),nav.go(E,null,_)}else(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.checkEvent)(e)?window.open(E,"_blank"):(r&&d&&(t.ads_params={post_ad_data:r,ad_block_unique_id:d}),Wall.hideEditPostReply(),Wall.postFull("wall"+s[1]+"_"+s[3],!1,t))},postClickStat:function(_){const e=(_=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.normEvent)(_)).currentTarget,t=[];e.getAttribute("data-ad-view")&&(t.push(Wall.postsGetRaws(e)),Page.postsSeen(t));const o=_.target;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(o.getAttribute("data-post-click-type"),["post_owner_img","post_owner_link"])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"author")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"post_image")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"post_img")?Wall.triggerAdStat(e,"click_post_owner"):("A"==_.target.nodeName&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wall_post_text",_.target,e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("page_media_thumbed_link",_.target,e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_.target,"lnk")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("lnk",_.target,e))&&Wall.triggerAdStat(e,"click_post_link")},adBlockClickStat:function(_,e){const t="_ads_block_data_w";let o=(_=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.normEvent)(_)).currentTarget;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,t)||(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)(t,o));const l=[];o.getAttribute("data-ad-view")&&(l.push(Wall.postsGetRaws(o)),Page.postsSeen(l)),Wall.triggerAdStat(o,e)},getAdsEvents:function(){return _shared_lib_ls__WEBPACK_IMPORTED_MODULE_13__.multiAccountLs.get(Wall.LS_ADS_EVENTS)||{}},setAdsEvents:function(_){_shared_lib_ls__WEBPACK_IMPORTED_MODULE_13__.multiAccountLs.set(Wall.LS_ADS_EVENTS,_)},cleanAdsEvents:function(){const _=Wall.getAdsEvents(),e=(new Date).getTime()/1e3|0;let t=!1;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(_,(function(o,l){e-l>=3600&&(delete _[o],t=!0)})),t&&Wall.setAdsEvents(_)},triggerAdPostStat:function(_,e){Wall.triggerAdStat(_,e)},triggerAdStat:function(elIdOrEl,event){const el="string"==typeof elIdOrEl?Wall.domPost(elIdOrEl):elIdOrEl;let pixels=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(el,"ad-stat-"+event);for(;pixels;){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(el,"ad-block-uid"),e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(event,["load","impression","impression_long","video_start","video_play_3s","video_play_10s","video_play_25","video_play_50","video_play_75","video_play_95","video_play_100"]);if(e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(el,"ad-disabled-stat-"+event,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(el,"ad-stat-"+event)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(el,"ad-stat-"+event,null)),_&&e)try{const e=(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_25__.hashCode)(""+event+_),t=Wall.getAdsEvents();if(t[e])break;const o=(new Date).getTime()/1e3|0;t[e]=o,Wall.setAdsEvents(t)}catch(_){try{console.log(_.message)}catch(_){}}pixels=pixels.split("$$$"),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(pixels,(function(_,e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.vkImage)().src=e}));break}const statHtml=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(el,"ad-stat-html-"+event);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(el,"ad-stat-html-"+event,null),statHtml){const statElemWrap=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{innerHTML:statHtml});let elem;for(;elem=statElemWrap.firstChild;)if(el.appendChild(elem),"SCRIPT"===elem.tagName)try{eval(elem.innerHTML)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__.logEvalError)(_,elem.innerHTML)}}},copyHistory:function(_,e,t,o){let l=(_=_||window.event).target||_.srcElement,i=8,s=!1,a=/published_a_quote/;do{if(!l||(s=l.className.match(a))||l.onclick||l.onmousedown||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(l.tagName,["A","IMG"]))break}while(i--&&(l=l.parentNode));if(!s)return;return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString())?void 0:(ajax.post("al_wall.php",{act:"copy_history",post:t,offset:o,from:cur.module},{onDone:function(_){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(e))return;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(e),!_)return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(e),"published_by_quote")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(e):e;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(t).insertBefore((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.cf)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(t)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isAncestor)(t,"im_rows")?IM.updateScroll(!0):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isAncestor)(t,"wl_post")&&WkView.wallUpdateReplies()}}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_))},postFull:function(_,e,t){if(_.match(/^wall-?\d+_\d+$/)&&!(t||{}).nolist&&(!cur.pgParams||!cur.pgParams.owners_only&&!cur.pgParams.q))switch(cur.wallType){case"all":case"full_all":_+="/all"}return(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_8__.showWiki)({w:_},!1,e,t)},checkReplyClick:function(_,e){if(e=e||window.event,!_||!e)return!1;let t=e.target||e.srcElement,o=8,l=!1;do{if(!t||t==_||t.onclick||t.onmousedown||"A"==t.tagName&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"_reply_lnk")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(t.tagName,["IMG","TEXTAREA","EMBED","OBJECT"])&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"emoji")||"wpe_cont"==t.id||(l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"_reply_content")))break}while(o--&&(t=t.parentNode));if(!l)return!0;return!!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString())},replyClick:function(_,e,t,o){var l;if(null==(l=t)?void 0:l.target.classList.contains(_web_Badges_constants__WEBPACK_IMPORTED_MODULE_54__.BADGE_COMMENT_SELECTOR))return;const i=_.split("_"),s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(i[0]),a=i[1].replace(/-?\d+$/,""),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+s+a+"_"+e);let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(r,"closed_comments")||!cur.stickerClicked&&Wall.checkReplyClick(n,t))return;(t||{}).cancelBubble=!0;const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wall_reply_more",n,"a");if(d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(d))return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(n,"reply_moreable"),void d.onclick();if(o){r=cur.wallLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post"):r;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(r,"deep_active"),{packId:i,clickData:s}=cur.stickerClicked||{};let a=_;if(l){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("replies_wrap_deep",n);a=_?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"post-id"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(n,"post-id")}const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+a);cur.stickerClicked=null,!i||d&&d.emojiInited||(cur.afterEmojiInit=cur.afterEmojiInit||{},cur.afterEmojiInit[a]=function(){Emoji.clickSticker(i,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+a),t,s)}),Wall.replyTo(a,e,o,t),i&&d&&d.emojiInited&&Emoji.clickSticker(i,d,t,s)}},stickerClick:function(_,e,t,o){return t&&(t.cancelBubble=!0),window.Emoji?e?(Emoji.getStickerPack(_).then((l=>{var i;if(Boolean(null==(i=l)?void 0:i[Emoji.PACK_FIELD_IS_ACTIVE])){var s;const t=e.closest(".reply");(null==(s=t)?void 0:s.onclick)&&(cur.stickerClicked={packId:_,clickData:o},t.onclick())}else Emoji.clickSticker(_,null,t,o)})),!1):(Emoji.clickSticker(_,null,t,o),!1):(window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){Wall.stickerClick(_,e,t,o)})),!1)},domPost:function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_)},formatCount:function(_,e){return e=e||{},(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.formatCount)(_,e)},likeFullUpdate:function(_,e,t){const o=e.match(/^(wall|photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(-?\d+_)(\d+)/);Likes.update(o?(o[1]||"wall")+o[2]+o[3]:e,t)},likeUpdate:function(_,e,t,o,l,i,s){s||(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(o)),!1===_&&cur.wallLayer===e&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post_body"));const a=e.match(/(-?\d+)(_?)(photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),n=a[1]+"_"+a[4],r=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",_))||wall.domPost(n),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(r,s?"_views_wrap":i?"_share_wrap":"_like_wrap"),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(d,"_count");if(!E)return;if(!s&&!i){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(r,"_views_wrap"),l=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(t,"_count");!l||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"_auto_update")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(l)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(l)!=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(E)||wall.likeUpdate(_,e,0,this.formatCount(o),void 0,void 0,1)}const c=d.tt||{},b=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clone)(c.opts||{}),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(c.container,"_value"),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(c.container,"_content"),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(c.container,"_title");l&&p&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(p,l),c&&(c.likeInvalidated=!0),P&&(P.value=o),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_18__.animateCount)(E,s?o:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_20__.langNumeric)(o,"%s",!0),{str:"auto",noWrapWidth:!!s}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(d,i?"my_share":"my_like",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(d,s?"no_views":i?"no_shares":"no_likes",!o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(u,"me_hidden",!t&&!s),o?c.el&&(!1===l?c.destroy&&c.destroy():(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(c.container)||l||!1===l||tooltips.show(c.el,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(b,{showdt:0}))):c.el&&c.hide();const D=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_20__.langNumeric)(o,"%s",!0);if(s){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("feedback_views",r);let e=0;e=o.match(/^\d+$/)?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(o):5,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(_,"<em>"+o+"</em> "+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_X_post_views",e,!0))}else if(i){let _="";o>0&&(_="<em>"+D+"</em> "+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_X_shared",o,!0)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("feedback_share",r),_)}else{let _="";o>0&&(_="<em>"+D+"</em> "+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_like")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("feedback_like",r),_)}},likeShareUpdate:function(_,e,t,o,l){return Wall.likeUpdate(_,e,t,o,l,!0)},like:function(_,e){if(!vk.id||cur.viewAsBox)return;const t=wall.domPost(_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(t,"_like_wrap"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(o,"_icon"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(o,"_count"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(l,"fw_like_icon")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(l,"fw_my_like"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"my_like"),a=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),n=(a[3]||"wall")+a[1]+"_"+a[4];let r=cur.module;cur.wallType&&(r="feed"==cur.wallType?"feed_"+("news"==cur.section&&cur.subsection?cur.subsection:cur.section):"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full")),ajax.post("like.php",{act:"a_do_"+(s?"un":"")+"like",object:n,hash:e,wall:2,from:r},{onDone:Wall.likeFullUpdate.pbind(!1,_)});const d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(i);Wall.likeUpdate(!1,_,!s,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(d)+(s?-1:1)),cur.onWallLike&&cur.onWallLike()},bookmark:function(_,e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(_,"bookmarked")},likeShare:function(_,e){if(!vk.id||cur.viewAsBox)return;const t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4],l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("like_share_"+o),i=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)(l);let s=cur.wallType?"feed"==cur.wallType?"feed_"+cur.section:"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module;"top"==cur.wallType&&(s="wall_top"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.checkbox)(l),ajax.post("like.php",{act:"a_do_"+(i?"un":"")+"publish",object:o,hash:e,wall:2,ref:s},{onDone:Wall.likeFullUpdate.pbind(!1,_)});const a=wall.domPost(_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(a,"_like_wrap"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(n,"_icon"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(a,"_count")),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(r,"fw_like_icon")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(r,"fw_my_like"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(n,"my_like");Wall.likeUpdate(!1,_,!0,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(d)+(E?0:1))},likeShareCustom:function(_,e){const t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4];(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showBox)("like.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({act:"publish_box",object:o},e))},likeShareCheckLen:function(_,e,t){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(e),t=t||255;const o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(_)).replace(/\n\n\n+/g,"\n\n");if(_.lastLen===o.length)return;const l=_.lastLen=o.length,i=l-o.replace(/\n/g,"").length;l>t-50||i>4?(l>t?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("text_exceeds_symbol_limit",l-t)):i>4?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_recommended_lines",i-4)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("text_N_symbols_remain",t-l)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(e)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(e)},showLikesPage:function(_,e,t){cur.likesBox.loadTabContent("like.php",{act:"a_get_members",object:_,published:e,offset:t,wall:1},e)},clearLikesCache:function(_,e){const t="^/like.php#"+(0,_shared_lib_convert__WEBPACK_IMPORTED_MODULE_21__.toQueryString)({act:"a_get_members",object:_,published:e,offset:12345,wall:1,tab:e,only_content:1}).replace("12345","\\d+")+"$",o=new RegExp(t,"i");for(const _ in ajaxCache)o.test(_)&&delete ajaxCache[_]},subscribeByButton:_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__.subscribeByButton,subscribeByAction:_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__.subscribeByAction,subscribeToAuthor:_web_wall_post_subscribe_action_post_subscribe_action__WEBPACK_IMPORTED_MODULE_4__.subscribeToAuthor,showPhoto:function(_,e,t,o,l){return!(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showBox)("al_photos.php",{act:"photo_box",to_id:_,photo:e,hash:t},{cache:1},!!o.href&&l)},domFC:function(_){for(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(_);_&&_.id.match(/page_wall_count_/);)_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_);return _},domPS:function(_){for(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPS)(_);_&&_.id.match(/page_wall_count_/);)_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPS)(_);return _},initScrollChecking(_){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"scroll",Wall.scrollCheck),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"resize",Wall.scrollCheck),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_73__.pushNavDestroy)((()=>{(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"scroll",Wall.scrollCheck),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"resize",Wall.scrollCheck)})),window.cur.wallAutoMore=_.automore,setTimeout((()=>{Wall.scrollCheck()}),200)},scrollCheck:function(_,e,t){const o=null==e?(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)():e;let l,i=0;const s=[],a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;if(window.scrollAnimation)return!1;if(Wall.repliesSideUpdate(o),cur.wallPage){let _;if(_="suggested"==cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_suggested_posts"):"top"==cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_top_posts"):"donut"===cur.wallTab?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_donut_posts"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_posts"),((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(cur.topRow)!=_||((cur.topRow||{}).id||"").match(/page_wall_count_/))&&(cur.topRow=Wall.domFC(_)),vk.id&&cur.topRow&&!cur.topRow.id.match(/page_wall_count_/)&&!((window.curNotifier||{}).idle_manager||{}).is_idle){const _=[];for(let e=Wall.domPS(cur.topRow);e;e=Wall.domPS(e))cur.topRow.offsetTop>o&&(cur.topRow=e),e.unseen||(e.unseen=!0,_.push(Wall.postsGetRaws(e)));Page.postsUnseen(_);for(let _=cur.topRow;_;_=l){LongView&&LongView.register(_,"Wall");const e=i||_.offsetTop;if(e>=o+a)break;l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(_),((l||{}).id||"").match(/page_wall_count_/)&&(l=null),i=l?l.offsetTop:e+_.offsetHeight,i<o&&l&&(cur.topRow=l);let t=_.bits||0;t>=3||(t|=(e>=o&&e<o+a?1:0)|(i>=o&&i<o+a?2:0))&&(_.bits=t,3==t&&s.push(Wall.postsGetRaws(_)))}LongView&&LongView.onScroll(o,a),Page.postsSeen(s)}}if(!cur.wallAutoMore||cur.wallLoading||cur.viewAsBox)return;const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_more_link");if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(n))return;o+(window.lastWindowHeight||window.innerHeight)+1500>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(n)[1]&&n.onclick()},postsGetRaws:function(_){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.indexOf)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_).children,_);let t;const o={};if(!_)return o;o.module=cur.module,o.index=e;const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"_ads_promoted_post"),i=_.getAttribute("data-ad-view");i&&(o["ad_"+i]=1,l&&(o.module+="_ads_promoted_post"));const s=_.getAttribute("post_view_hash");if(s&&(o.hash=s),"block_"===_.id.substr(0,6)){o[_.id]=1,o.block=_.id.substr(6);let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.attr)(_,"data-contain");e&&(e=e.split(","),e.forEach((function(_){_=_.split(":"),o[_[0]]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(_[1])||1})))}else(t=_.id.match(/^post(-?\d+_\d+)$/))&&(o[t[1]]=1,(t=(_.getAttribute("data-copy")||"").match(/^(-?\d+_\d+)$/))&&(o[t[1]]=-1));return o},votingExtendParams:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"fixed")&&(_.is_fixed=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"preview")&&(_.is_preview=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"board")&&(_.is_board=1),vk.widget&&(_.is_widget=1,_.width=cur.widgetWidth,_.url=cur.url),cur.voteHash&&(_.vote_hash=cur.voteHash);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"id");t&&(_.voting_id=t);const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"ref");o&&(_.ref=o);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"hash");l&&(_.hash=l);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"material");return!i||_.is_board||_.is_widget||(_.material=i),_},votingRevote:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"id");if(this.votingIsLocked(_))return;const t=this.votingExtendParams({act:"revote"},e);ajax.post("al_voting.php",t,{onDone:this.votingUpdateFull.bind(this,_),showProgress:this.votingLock.bind(this,_),hideProgress:this.votingUnlock.bind(this,_)})}},votingIsLocked:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_media_voting"+_);let t=!1;return e.forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"media_voting_locked")&&(t=!0)})),t},votingLock:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_media_voting"+_).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"disabled")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"queue")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(_,"media_voting_locked")}))},votingUnlock:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_media_voting"+_).forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(_,"media_voting_locked")}))},votingUpdate:function(_,e){ajax.post("al_voting.php",{act:"get_layout",voting_id:_},{onDone:t=>{(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(e)&&!1===e(t)||(this.votingUpdateFull(_,t),this.votingUnlock(_))},onFail:()=>this.votingUnlock(_),showProgress:()=>this.votingLock(_)})},votingUpdateFull:function(_,e){if(_&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isString)(e)){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_media_voting"+_);t.length&&(t.forEach((_=>{if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"disabled")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"queue"))if(""===e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(_);else{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.cf)(e);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"media_voting_can_vote")){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(t);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(e,"media_voting_just_voted"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domReplaceEl)(_,t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClassDelayed)(e,"media_voting_just_voted")}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domReplaceEl)(_,t)}})),window.IMBRIDGE&&setTimeout(IMBRIDGE.syncHistory.bind(IMBRIDGE),0),vk.widget&&window.WPoll&&window.WPoll.resizeWidget())}},votingUpdatePartly:function(_,e){if(!_||!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isObject)(e)||this.votingIsLocked(_))return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_media_voting"+_);if(!t.length)return;const o=e.answers.reduce(((_,e)=>Math.max(_,e.rate)),0),l={};e.answers.forEach((_=>{_.isLeader=_.rate===o,l[_.id]=_})),t.some((t=>{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"disabled"))return;if(t.classList.contains("media_voting_voted")&&!e.votes)return this.votingUpdate(_),!0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("media_voting_option_wrap",t).forEach((_=>{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"id"),o=l[t];if(_.tt&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isFunction)(_.tt.destroy)&&_.tt.destroy(),!o)return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("media_voting_option_bar",_),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("media_voting_option_percent",_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("media_voting_option_count",_),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("media_voting_option_counter",_),r=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_20__.langNumeric)(o.votes,"%s",!0),d=new Array((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.cf)(r).textContent.split("").length+2).join("0");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domLC)(a),d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domLC)(n),r),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(s,e.votes?o.rate:""),i.style.transform=`scaleX(${.01*o.rate})`,i.style.oTransform=`scaleX(${.01*o.rate})`,o.votes?a.classList.remove("media_voting_option_count_hidden"):(a.classList.add("media_voting_option_count_hidden"),_.classList.remove("media_voting_option_voted")),o.isLeader?_.classList.add("media_voting_option_leader"):_.classList.remove("media_voting_option_leader")}));const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_media_voting_footer_voted_text",t);if(o){let _;_=e.votes?vk.widget?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("voting_x_voted_short",e.votes,!0):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("voting_x_voted",e.votes,!0):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("voting_nobody_voted",e.votes,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(o,_);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("media_voting_footer_voted_friend",t);l.length>e.votes&&l.forEach((_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(_)}))}})),window.IMBRIDGE&&window.IMBRIDGE.syncHistory(),vk.widget&&window.WPoll&&window.WPoll.resizeWidget()},votingUpdateByPostRaw:function(_){if(vk.id){_=_.split("_");const e=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.positive)(_[1]),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(_[0]),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_post_media_voting"+t+"_"+e);if(o&&o.length){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("media_voting",o[0]);if(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"id");this.votingUpdate(e)}}}},votingVote:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"id");if(!this.votingIsLocked(t)&&vk.id){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"queue"))return this.votingUpdate(t,(_=>{if(_&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isString)(_)){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.cf)(_));if(t&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"queue")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"disabled"))return this.votingVote(t,e,!0),!1}}));if(e.length){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(_),"wk_voting_box"),l=this.votingExtendParams({act:"vote",option_ids:e.join(",")},_);ajax.post("al_voting.php",l,{onDone:(_,e)=>{o?nav.reload():(vk.widget&&window.WPoll&&window.WPoll.updateShareMessage(e),this.votingUpdateFull(t,_))},showProgress:this.votingLock.bind(this,t),hideProgress:()=>{o||this.votingUnlock(t)}})}}else vk.widget&&Widgets.oauth()},votingButtonVote:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);if(e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"media_voting_multiple")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("media_voting_option_selected",e),t=[];_.forEach((function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"id");e&&t.push(e)})),this.votingVote(e,t)}},votingOptionVote:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);if(t){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"media_voting_multiple")){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"id");if(this.votingIsLocked(e)||!vk.id)return void(vk.widget&&Widgets.oauth());(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(_,"media_voting_option_selected");const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("media_voting_option_selected",t).length;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(t,"media_voting_has_selected_options",o)}else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"id");this.votingVote(t,[e])}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)}},votingOptionVoteAttempt:function(_,e,t,o){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);if(l){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"ref");(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.statlogsValueEvent)("voting_vote_attempt",_,t,o)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)},votingOptionTooltip:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);if(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"owner-id"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"board");(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(_,{url:"al_voting.php",params:{act:"option_tt",option_id:t,owner_id:o,is_board:i,voting_id:l},slide:15,ajaxdt:100,showdt:400,hidedt:200,dir:"auto",shift:[0,10,10],typeClass:"voting_tt"})}},votingLayer:function(_,e){const t=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"media_voting_option_wrap")&&_,o=t?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"id"):0,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"media_voting")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);if(l){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"id"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"owner-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"board"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"ref"),a={w:(i?"board_poll":"poll")+t+"_"+_};if(o&&(a.opt_id=o),vk.widget)window.open(location.origin+"/"+a.w,"poll");else{const _={queue:1,noloader:!!(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.curBox)()};"story"===s&&(_.customRef="story"),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_8__.showWiki)(a,!1,void 0,_)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)}},votingExport:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);if(e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"board")){const _=this.votingExtendParams({act:"export_box"},e);(vk.widget?window.showBox:_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showBox)("al_voting.php",_,{onDone:function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.curBox)().setOptions({width:500})}})}},votingOnMain:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);if(t){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"id");if(this.votingIsLocked(_))return;const o=this.votingExtendParams({act:"onmain",state:e?1:0},t);ajax.post("al_voting.php",o,{onDone:this.votingUpdateFull.bind(this,_),showProgress:this.votingLock.bind(this,_),hideProgress:this.votingUnlock.bind(this,_)})}},votingClosed:function(_,e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);if(t){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"id");if(this.votingIsLocked(_))return;const o=this.votingExtendParams({act:"closed",state:e?1:0},t);ajax.post("al_voting.php",o,{onDone:this.votingUpdateFull.bind(this,_),showProgress:this.votingLock.bind(this,_),hideProgress:this.votingUnlock.bind(this,_)})}},votingNarrowAction:function(votingId,hash,action){let act,state;switch(action){case 101:act="closed",state=0;break;case 102:act="closed",state=1;break;case 103:act="onmain",state=0;break;case 104:act="onmain",state=1}act&&!cur.votingNarrowActionProgress&&ajax.post("al_voting.php",{act,voting_id:votingId,is_fixed:1,state,narrow:1,hash},{onDone:function(html,js){let votingModuleEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("group_voting");if(votingModuleEl&&(votingModuleEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)(votingModuleEl),html?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domReplaceEl)(votingModuleEl,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.cf)(html)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(votingModuleEl)),js)try{eval(js)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__.logEvalError)(_,js)}},showProgress:function(){cur.votingNarrowActionProgress=!0},hideProgress:function(){cur.votingNarrowActionProgress=!1}})},showReportVotingForm:function(_){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.actionsMenuItemLocked)(_))return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("media_voting",_);null===e&&(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__.debugLog)("Unable to show report voting form because there is no .media_voting element");const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"id");if(this.votingIsLocked(t))return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"board")?"board_poll":"poll";(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_43__.showReportForm)(o,0,t,(()=>{const _=e.querySelector("._report_voting_button");null!=_?(_.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_report_sent"),_.onclick=null):(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_23__.debugLog)("Unable to disable report voting button, because it cannot be found")}))},foTT:function(_,e,t){t&&t.oid&&(e=t.oid==vk.id?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_my_friends_only"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("wpfo"+t.pid)),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTitle)(_,e)},update:function(){if(cur.wallLayer)return void WkView.wallUpdateReplies();const _="top"===cur.wallType,e="archive"===cur.wallType,t="donut"===cur.wallType;if("all"!==cur.wallType&&"own"!==cur.wallType&&!_&&!e&&!t||"all"!==cur.wallTab&&"own"!==cur.wallTab&&"top"!==cur.wallTab&&"archive"!==cur.wallTab&&"donut"!==cur.wallTab)return;const o=e?"all":_||t?"own":cur.wallType,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_more_link"),i=Wall.getPostsWrap(cur.wallType),s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(cur.deletedCnts[o]),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)(o,i).length-s;let n=!1;if((_||e||t)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("no_posts",i))||_&&cur.wallTopFinished===cur.oid||e&&cur.wallArchiveFinished===cur.oid||t&&(cur.wallDonutFinished===cur.oid||Wall.cantAccessDonutPosts())))n=!0;else{let l;if(l=e?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_archive")):_?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_top")):t?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_donut")):"own"===o?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_own")):(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_all")),"suggested"!==cur.wallTab){let _=l;_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(cur.oid)&&cur.options.fixed_post_id&&(_-=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_posts_count",_?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_20__.langNumeric)(_,cur.options.wall_counts):cur.options.wall_no)}let i=a;!_&&!e&&cur.options.fixed_post_id&&_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(cur.options.wall_oid)&&(i+=1),n=i>=l-s}n?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(l):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(l),l.onclick=Wall.showMore.pbind(a)),cur.wallTab==cur.wallType&&((0,_web_lib_market__WEBPACK_IMPORTED_MODULE_2__.shortCurrency)(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler())},getAbsDate:function(_,e){e=e||window.cur;const t=new Date(_||Date.now());let o,l=t.getHours(),i=t.getMinutes(),s="";return e.wallTpl.time_system&&(s=e.wallTpl.time_system[l>11?1:0],l=l%12||12),o=l>9?l:"0"+l,i=i>9?i:"0"+i,e.wallTpl.date_format.replace("{am_pm}",s).replace("{hour}",l).replace("{num_hour}",o).replace("{minute}",i)},getNowRelTime:function(_){_=_||window.cur;const e=Date.now();return'<span class="rel_date rel_date_needs_update" time="'+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e/1e3-(_.tsDiff||0))+'" abs_time="'+Wall.getAbsDate(e,_)+'">'+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("profile_status_word_secs_ago",1)+"</span>"},getNewPostHTML:function(_,e,t,o){var l,i,s;const a=(o=o||window.cur).wallTpl.post;if(!a)return void console.error(new Error("Missing wall post template"));const n=[],r=_[2],[d]=r.split("_");let E="";const c=_[4].split("|");let b,P=Wall.getNowRelTime(o);const u="1"===_[8];u?E=o.wallTpl.reply_link||"":d!=vk.id&&(E=o.wallTpl.own_reply_link||"");let p=_[3].replace("mem_link","author").replace("memLink","author"),D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(p),w=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.unclean)(D.innerText||D.textContent||""));-1!=_[6].indexOf('id="wpfo')&&(P+=`<span class="page_friends_only inl_bl dvd PostHeaderSubtitleDivider">${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_post_privacy_friends")}</span>`);const M=(0,_web_Badges_helpers__WEBPACK_IMPORTED_MODULE_63__.updateNewPostHTMLForBadges)(n,o,_);o.wallTpl.custom_del&&(e>(_[9]==d?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER)||d==vk.id||_[9]==vk.id||_[2].split("_")[0]!=_[4])&&n.push(o.wallTpl.custom_del),e>(_[9]==d?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER)||d==vk.id||_[9]==vk.id?n.push(o.wallTpl.del):_[2].split("_")[0]!=_[4]&&n.push(o.wallTpl.spam);const O=e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR&&_[9]==d||d==vk.id||_[9]==vk.id;O&&"rss"!==_[13]&&n.push(o.wallTpl.edit);let m=_[6];_[15]&&window.vk.pe.obscene_text_filter&&(m=_[15]),d!=vk.id&&_[9]!=vk.id||!m||(_[6]=_[6].replace("vk2017_snippet_show_layer_button","vk2017_snippet_show_layer_button_hidden"));const C=_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(d)&&_[9]==d&&e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR,g=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_28__.getReactionsButtonPostTemplate)(_,o);let T="";return(0,_web_Badges_helpers__WEBPACK_IMPORTED_MODULE_63__.isBadgesDisabledForOwner)(_)&&(T+=" "+_web_Badges_helpers__WEBPACK_IMPORTED_MODULE_63__.BADGES_RESTRICTED_CLASS_SELECTOR_FOR_POST),b=(0,_swc_helpers_extends__WEBPACK_IMPORTED_MODULE_74__._)({oid:d,name:p,actions:n.length&&(null==(l=o.wallTpl)?void 0:l.post_actions)?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(o.wallTpl.post_actions,{actions:n.join("")}):"",replies:"",reply_link:E,own_reply_link:o.wallTpl.own_reply_link,reply_box:u&&o.wallTpl.reply_box?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(o.wallTpl.reply_box,{actions:"",class:C?" reply_fakebox_with_official":""}):"",photo:c[0],link:_[5],text:m,date:P,post_id:_[2],post_class:T,poll_hash:o.wallTpl.poll_hash,date_postfix:"",user_image:"",post_url:"/wall"+r.replace("_wall_reply","_"),can_reply_as_group:C?1:"",owner_photo:C?c[1]||c[0]:"",owner_href:C?_[5]:"",owner_name:C?w:"",online_class:_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(d)?" online":"",likes:Likes.makeTemplate(o.wallTpl.post_likes,{buttons_prepend:null==(i=g)?void 0:i.template,like_class_name:null==(s=g)?void 0:s.likeClassName,object_raw:_[2]}),class:""},M),t&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(b,t(b,_)),O&&o.wallTpl.author_data&&(b.date=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(o.wallTpl.author_data,{date:b.date,post_id:r})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(a,b),b)},getNewReplyHTML:function(_,e,t,o){var l,i;const s=o||window.cur;let a=s.wallTpl.reply,n=[];const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_field"+_[2])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_fakebox"+_[2])||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("fwr_text");let d="",E="",c="",b=_[10]||"";const P=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_28__.getReactionsButtonReplyTemplate)(_,s);if(!a)return void console.error(new Error("Missing wall reply template"));if(e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER||!_[2].indexOf(vk.id+"_")||_[4]==vk.id?n.push(s.wallTpl.del_reply):_[2].split("_")[0]!=_[4]&&n.push(s.wallTpl.spam_reply),(e>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR&&_[4]==(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(_[2])||_[4]==vk.id)&&n.push(s.wallTpl.edit_reply),-1!=_[8].indexOf('class="wall_reply_more"')&&(d+="reply_moreable"),r){d+=" reply_replieable",E=s.wallTpl.reply_link_wrap;wall.getReplyNames()[_[4]]||wall.addReplyName(_[4],[_[11],_[12]])}d&&(c=" onclick=\"Wall.replyClick('%post_id%', %reply_msg_id%, event, %reply_uid%)\""),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(s.wallTpl.reply_actions,{actions:n.join("")});let u=_[8];_[15]&&window.vk.pe.obscene_text_filter&&(u=_[15]);const p=_[5].replace("mem_link","author"),D=_[7],w=_[4]||"false",M={name:p,photo:_[6],reply_image:(0,_shared_components_avatar_renderAvatarToString__WEBPACK_IMPORTED_MODULE_53__.renderAvatarToString)(_[6],_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.REPLY_IMAGE_DEFAULT_SIZE,D,"reply_image",null,_[7],!1,void 0,p,_[_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.EVENT_REPLY_FIELD_IS_NFT_INDEX]),link:D,text:u,classname:d,actions:n,attr:c,date:Wall.getNowRelTime(s),to_link:b,answer_link:E,post_id:_[2],reply_id:_[3],like_id:_[3].replace("_","_wall_reply"),reply_msg_id:_[3].split("_")[1],reply_uid:w,object_full:(0,_web_likes_helpers__WEBPACK_IMPORTED_MODULE_75__.likeReplyObjectId)(_[3]),likes:Likes.makeTemplate(s.wallTpl.reply_likes,{buttons_prepend:null==(l=P)?void 0:l.template,like_class_name:null==(i=P)?void 0:i.likeClassName,object_raw:_[2]})};return t&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(M,t(M)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(a,M)},updatePostImages:function(_){return _.replace(/<img[^>]+>/g,(function(_){return _.match(/class=/)?_.replace("src=","data-src=").replace('class="','class="__need_img '):_}))},loadPostImages:function(_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("__need_img",_,"img"),(function(){const _=this.getAttribute("data-src");_&&(this.src=_,this.removeAttribute("data-src")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(this,"__need_img")}))},openNewComments:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_),t=e.nextSibling;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wr_header",e,"a"),l=0,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("reply",e,"div").length,s=i,a=t.newCnt;Wall.loadPostImages(e),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clone)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("new_reply",e,"div")),(function(){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(this,"new_reply"),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.highlightUpdatedReply)(this),l++,100==l)return!1})),o&&(s=l+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(o.getAttribute("offs").split("/")[1])),i+=-a+l,(s>3||i<s)&&(o||e.insertBefore(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("a",{className:"wr_header"}),e.firstChild),Wall.updateRepliesHeader(_,o,i,s)),cur.wallMyOpened[_]=1,t&&"replies_open"==t.className&&(a>100?(t.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("news_x_new_replies_more",Math.min(100,a-l)),t.newCnt-=l):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(t)),Wall.repliesSideSetup(_)},langWordNumeric:function(_,e,t){return(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_20__.langWordNumeric)(_,e,t)},updateTimes:function(_){let e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(Date.now()/1e3);const t=[];e-=cur.tsDiff,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("rel_date_needs_update",_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_posts"),"span"),(function(_,o){if(!o)return;const l=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(o.getAttribute("time")),i=e-l;let s=(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_38__.getFormattedDiffTimeText)(i);s||(s=o.getAttribute("abs_time"),t.push(o)),o.innerHTML=s})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(t,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(this,"rel_date_needs_update")}))},updateRepliesHeader:function(_,e,t,o){if(cur.onepost)return;let l,i,s=e.href,a=3,n=0;if(!s&&(i=_.match(/^(-?\d+)_(photo|video|note|topic|video|)(\d+)$/))){const _=i[2]||"wall";switch(s="/"+_+i[1]+"_"+i[3],_){case"topic":s+="?offset=last&scroll=1";break;case"wall":s+="?offset=last&f=replies"}e.href=s}o>t?t<100?(l=o>100?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_show_n_last_replies",100):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_show_all_n_replies",o),a=!1):l=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_hide_replies"):(l=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_hide_replies"),n=1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(e,"wrh_all",n),e.innerHTML=l,e.onclick=Wall.showReplies.pbind(_,a,!1),e.setAttribute("offs",t+"/"+o)},processQueueEvent(_){if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isObject)(_)&&_.entity_type&&"voting"===_.entity_type)this.votingUpdatePartly(_.data.id,_.data)},updated:function(_,e,t){const o=_?window.wkcur:window.cur;if(!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(o.wallQueues)||!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(t.events)||!t.events.length)return;const l=o.wallQueues.filter((_=>_.key===e)).pop();if(!l)return;if(t.failed)return void(o.wallQueues=!1);l.ts=t.ts;const i=_?wkLayerWrap.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollGetY)();let s=i;const a=!(o.wallType||"").indexOf("full"),n=o.onepost,r=!!_,d=_;a&&(nav.objLoc.q||nav.objLoc.search||nav.objLoc.day)||((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(t.events,(function(){if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isObject)(this))return Wall.processQueueEvent(this);const e=this.split("<!>"),t=e[0];let l=e[1];const i=e[2];let E=0,c=0,b=_&&window.cur.wallLayer==i&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post");if(b&&"del_reply"!=l||(b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isAncestor)(b,_?wkLayerWrap:pageNode)||(b=null)),t==o.options.qversion){switch((Wall.isArchiveWall()?"archive_post"===l:"reveal_post"===l)&&(l="res_post"),(Wall.isArchiveWall()?"reveal_post"===l:"archive_post"===l)&&(l="del_post"),l){case"new_post":{if(b)break;if(a&&o.pgStart>0){o.pgOffset++;break}if(o.oid==vk.id&&vk.id==e[9]&&window.curNotifier&&curNotifier.idle_manager.is_idle&&Wall.clearInput(),"own"!==o.wallType&&"all"!==o.wallType&&!Wall.hasPosts("own"))break;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_wall_posts");let t=_.lastChild;const l=!!a&&FullWall.addTetaTet,s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e[e.length-1]),n=void 0!==o.options.is_admin?o.options.is_admin:_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(o.options.wall_oid)?8&s?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.EDITOR:2&s?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER,r=Wall.getNewPostHTML(e,n,l,o);if(!r)break;const P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(r);let u=_.firstChild;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+i))break;for(t&&t!=P?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(t):t=!1,a?t||o.pgOffset++:((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_all"))+1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(P,"all"),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e[10])&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_own"))+1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(P,"own"))),0==e[8]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(P,"closed_comments"),o.deepRepliesActive&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(P,"deep_active");u&&("INPUT"==u.tagName||1!=u.nodeType||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(u,"post_fixed"));)u=u.nextSibling;_.insertBefore(P,u),Wall.votingUpdateByPostRaw(i),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_41__.updateNarrativeSnippetsFromQueueByPost)(P),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_42__.updateArticleSnippetsFromQueueByPost)(P),E=P.offsetHeight+15,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(P,d)[1],(0,_web_wall_post_update_view_utils__WEBPACK_IMPORTED_MODULE_76__.highlightUpdatedPost)(P),(0,_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_22__.updateAriaElements)(),Wall.updateMentionsIndex(),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_0__.AudioUtils.updateQueueReceivedPost(P);break}case"edit_post":{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wpt"+i);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(b)||!_)break;let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wall_post_more",_);t&&(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(t))),E=-_.offsetHeight,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(_,d)[1];let l=e[3];e[6]&&window.vk.pe.obscene_text_filter&&(l=e[6]);let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(l,{poll_hash:o.wallTpl.poll_hash});const a=o.videoInlinePlayer&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isAncestor)(window._videoLastInlined[0],_),n=a&&"playing"==o.videoInlinePlayer.getState();if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(_,s),a){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("page_post_sized_thumbs",_);1==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domChildren)(e).length&&(e.innerHTML="",e.appendChild(window._videoLastInlined[1]),e.appendChild(window._videoLastInlined[0]),n&&setTimeout((function(){o.videoInlinePlayer.play()}),0))}t&&(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wall_post_more",_),t&&t.onclick()),Wall.votingUpdateByPostRaw(i),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_41__.updateNarrativeSnippetsFromQueueByPost)(_),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_42__.updateArticleSnippetsFromQueueByPost)(_),E+=_.offsetHeight,(0,_web_wall_post_update_view_utils__WEBPACK_IMPORTED_MODULE_76__.highlightUpdatedPostContent)(_),Wall.updatePostAuthorData(i);break}case"edit_reply":{const _=e[3],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wpt"+_);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)("post"+_)||!t)break;let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wall_reply_more",t);o&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domNS)(o)));let l=e[4];e[5]&&window.vk.pe.obscene_text_filter&&(l=e[5]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(t,l),E=-t.offsetHeight,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(t,d)[1],o&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wall_reply_more",t),o&&o.onclick()),E+=t.offsetHeight,(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_41__.updateNarrativeSnippetsFromQueueByPost)(t),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_42__.updateArticleSnippetsFromQueueByPost)(t),(0,_web_stickers_utils__WEBPACK_IMPORTED_MODULE_49__.updateStickersFromQueue)(t),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.highlightUpdatedReplyContent)(t);break}case"post_parsed_link":{if(!b)break;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wall_postlink_preview_btn_disabled",b);if(!_)break;const t=e[3];if("1"===t)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(_,"wall_postlink_preview_btn_disabled"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(_,"button_disabled");else if("0"===t)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(_);else if(t){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("a",{href:t,className:"flat_button",innerHTML:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_preview_link")});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domReplaceEl)(_,e)}break}case"del_post":b&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(b)&&!o.wallMyDeleted[i]&&!n&&(E-=b.offsetHeight+15,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(b,d)[1],(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_19__.revertLastInlineVideo)(b),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(b,"unshown"),a||r||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_all"))-1),e[3]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_own"))-1),Wall.isArchiveWall()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_archive",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_archive"))-1)));break;case"res_post":b&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(b)&&((o.wallRnd==e[4]||Wall.isArchiveWall())&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(b,"unshown"),a?o.pgOffset++:((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_all",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_all"))+1),e[3]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_own",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_own"))+1),Wall.isArchiveWall()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_archive",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)("page_wall_count_archive"))+1)));break;case"new_reply":{if(!b||o.wallMyReplied[i]||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e[3])||n&&o.pgOffset<o.pgCount||r&&(o.reverse?o.offset:o.offset+o.loaded<o.count))break;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(r?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+i),"deep_active")){const _=wall.addNewReply(e);E+=_[0],c=_[1];break}const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+i),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap"+i),s=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e[e.length-1]),a=void 0!==o.options.is_admin?o.options.is_admin:_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(o.options.wall_oid)?8&s?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.EDITOR:2&s?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER,P=Wall.getNewReplyHTML(e,a,!1,o);if(!P)break;const u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(P),p=r?t.offsetHeight:b.offsetHeight;let D,w=!1;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(t)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(l)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)("reply_link"+i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("wall_fixed",l)){D=t.nextSibling;let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("new_reply",t,"div").length+1;if(r||n||o.wallMyOpened[i]){if(!n){D&&"replies_open"==D.className&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(D),w=!0;let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wr_header",t,"a");const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("reply",t,"div").length+1;let o=e;_&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(_.getAttribute("offs").split("/")[1])+1),(o>5||e<o)&&(_||t.insertBefore(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("a",{className:"wr_header"}),t.firstChild),Wall.updateRepliesHeader(i,_,e,o))}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(u,"new_reply"),D&&"replies_open"==D.className||(D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(i),role:"button",tabIndex:0}),t.parentNode.insertBefore(D,t.nextSibling)),D.innerHTML=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_x_new_replies_more",Math.min(100,_)),D.newCnt=_}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)("reply_link"+i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(l,t),w=!0;_&&o.reverse&&t.firstChild?t.insertBefore(u,t.firstChild):t.appendChild(u),w&&(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.highlightUpdatedReply)(u),r?(o.count++,o.loaded++,WkView.wallUpdateReplies(),E=t.offsetHeight-p,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(u,d)[1]):(n&&(FullWall.repliesSummary(e[13]),o.pgOffset++,o.pgCount++,FullWall.repliesSummary(o.pgCount),Pagination.pageReady(!1),FullWall.onePostOnScroll(!1,!1,!0)),E=b.offsetHeight-p,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(w?u:D)[1],Wall.repliesSideSetup(i)),(0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_41__.updateNarrativeSnippetsFromQueueByPost)(u),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_42__.updateArticleSnippetsFromQueueByPost)(u),(0,_web_stickers_utils__WEBPACK_IMPORTED_MODULE_49__.updateStickersFromQueue)(u),Wall.updateMentionsIndex(),Likes.update("wall"+i,{comment_num:e[13]});break}case"del_reply":{if(o.wallMyDeleted[i]||!b)break;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",b)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",b);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"deep_active")){const _=wall.removeDeepReply(e);E+=_[0],c=_[1];break}if(E-=b.offsetHeight,c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(b,d)[1],(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_19__.revertLastInlineVideo)(b),o.layerpost)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(b),o.count--,o.loaded--;else{n&&(o.pgOffset--,o.pgCount--,FullWall.repliesSummary(o.pgCount));const _=b.parentNode.id.match(/replies(-?\d+_\d+)/);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(b),_&&Wall.repliesSideSetup(_[1])}break}case"view_post":Wall.likeUpdate(!1,i,0,Wall.formatCount((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e[3])),void 0,void 0,1);break;case"like_post":case"like_reply":{if(!b)break;const _="like_reply"==l?"wall_reply"+i:i,t=b&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(b,"_like_wrap"),o=b&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(b,"_share_wrap"),s=(0,_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_28__.likeDataReactionsFields)(e);wall.likeFullUpdate(t,_,(0,_swc_helpers_extends__WEBPACK_IMPORTED_MODULE_74__._)({isQueueUpdate:!0,like_my:t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"my_like"),like_num:e[3],like_title:!1,share_my:o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(o,"my_share"),share_num:e[4],share_title:!1},s));break}case"upd_ci":{let _=e[2],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("current_info"),l=t||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_current_info");const i=(0,_web_profile_profile_utils__WEBPACK_IMPORTED_MODULE_52__.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module;if(!l&&!i)break;switch(e[3]){case"audio":{if(i){var P;let t;var u;if(e[4]&&"string"==typeof e[4])t=null==(u=e[4].split(","))?void 0:u[1];return void(null==(P=window.Profile)||P.updateBroadcastAudioStatus(_,t))}const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("current_audio_cnt_wrap");s&&s.tt&&s.tt.hide();const a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e[5]||""),n=a?"":" hidden";let r="";t||(r+=" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAudioTip+"', black: 1, shift: [14, 5, 5]})\" onclick=\"Page.playCurrent(this, '"+e[4]+"')\""),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(o.options.ciAudioTpl,{text:_,attrs:r,count:a,cnt_class:n}),wall.updateOwnerStatus(_,l,e,t);break}case"app":{const i=e[6]?"[12, 5, 5]":"[15, 5, 5]",s=e[6]?" current_app_icon":"";let a=t?' onclick="cur.ciApp = '+e[4]+'"':" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAppTip+"', black: 1, shift: "+i+'})" href="'+e[5]+'?ref=14" onclick="return showApp(event, '+e[4]+', 1, 14, cur.oid)"';e[6]&&(a+=" style=\"background-image: url('"+e[6]+"'); background-size: 16px 16px;\""),_='<a class="current_app'+s+'"'+a+">"+_+"</a>",wall.updateOwnerStatus(_,l,e,t);break}default:var p;if(i)return void(null==(p=window.Profile)||p.resetActiveBroadcastAudioStatus());window.stManager.add([window.jsc("web/emoji.js")],(function(){_=_?'<span class="current_text">'+Emoji.emojiToHTML(_,!0)+"</span>":_,wall.updateOwnerStatus(_,l,e,t)}))}break}case"upd_ci_cnt":{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("current_info"),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(e[2]),o=_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_current_info"),l=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("current_audio_cnt_wrap",o);l&&(l.tt&&l.tt.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(l,"hidden",0==t),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_18__.animateCount)(document.querySelector(".current_audio_cnt"),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_20__.langNumeric)(t,"%s",!0),{str:"auto"}));break}case"cover_updated":{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_page_cover");if(_&&e[2]){const t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.vkImage)(),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.isRetina)()?e[3]:e[2];t.src=o,t.onload=function(){_.style.backgroundImage="url('"+o+"')",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(t)}}break}}E&&(_?c<0:s+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)("page_header_cont")[1]>c)&&(s+=E)}})),s!=i&&i>100&&!o.onepost&&(_?wkLayerWrap.scrollTop=s:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)(s,0,!1,!0)),Wall.update())},updateOwnerStatus:function(_,e,t,o){if(o){_='<span class="'+(_?"my_current_info":"no_current_info")+'">'+(_||_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("change_current_info"))+"</span>",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e.parentNode.nextSibling,_),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)("currinfo_editor")&&_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(cur.oid)&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggle)("currinfo_audio","app"!=t[3]),t[2]&&"app"!=t[3]&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.checkbox)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("currinfo_audio"),Boolean(t[2])),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggle)("currinfo_app","app"==t[3]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)("currinfo_app","on"))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e,_)},updateMentionsIndex:function(_){if(clearTimeout(cur.wallUpdateMentionsIndexTO),!_)return void(cur.wallUpdateMentionsIndexTO=setTimeout(wall.updateMentionsIndex.pbind(!0),300));const e={},t=[],o=new RegExp(`^(https?://(${_shared_lib_site__WEBPACK_IMPORTED_MODULE_3__.VK_HOST_REGEX_GROUP_UNSAFE.source}|${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.escapeRE)(location.host)}))?/?`);let l=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("author",document.body,"a"),(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(this),l=this.href.replace(o,"");if(void 0!==e[l])return;const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(this.getAttribute("data-from-id"));i&&i!=vk.id&&(e[l]=t.length,t.push([i,_,"@"+l,"/images/camera_c.gif"]))})),l=l.concat(Array.from(document.querySelectorAll("a.post_image, a._post_image")),Array.from(document.querySelectorAll("a.reply_image, a._reply_image"))),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(l,(function(){const _=this.href.replace(o,""),l=e[_];if(void 0===l)return;const i=(0,_web_wall_wall_post_elem_utils__WEBPACK_IMPORTED_MODULE_77__.replyUserImageImg)(this);i&&(t[l][3]=i.getAttribute("src"),delete e[_])})),cur.wallMentions=t},initUpdates:function(_,e=!1){if(_&&_.length&&window.Notifier){const t=e?window.wkcur:window.cur,o=()=>{t.wallQueues&&t.wallQueues.forEach((_=>{Notifier.addKey(_,((_,t)=>{Wall.updated(e,_,t)}))}))};if(!t.wallQueues){const _=setInterval(o,1e4);e?t._hide.push((()=>clearInterval(_))):t.destroy.push((()=>clearInterval(_)))}t.wallQueues=_,o()}},initWallOptions:function(_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(cur,{wallCheckComments:_.check_comments,wallType:_.wall_type,wallTpl:_.wall_tpl,wallMyDeleted:{},tsDiff:_.wall_tpl&&_.wall_tpl.abs_timestamp?900*Math.round((Date.now()/1e3-_.wall_tpl.abs_timestamp)/900):0,wallMyOpened:{},wallMyReplied:{},wallMentions:[],wallMyRepliesCnt:0,wallUploadOpts:_.upload,wallUploadVideoOpts:_.upload_video,hasGroupAudioAccess:_.hasGroupAudioAccess}),_.wall_tpl&&_.wall_tpl.lang&&(cur.lang=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(cur.lang||{},_.wall_tpl.lang)),window.Notifier&&Notifier.addRecvClbk("wall_reply_multiline","wall",(function(_){Wall.onReplySubmitChanged(_.value,1)}),!0)},onPostLoaded:function(_,e){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)(_),Wall.onAdBlockLoaded(_,e),e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"_post")&&(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_post",_)),_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"_post")&&cur.onPostLoaded&&cur.onPostLoaded(_)},onAdBlockLoaded:function(_,e){let t;const o="_ads_block_data_w";(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"_ads_promoted_post_data_w")?t=_:e&&(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)(o,_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_ads_promoted_post_data_w",_)),t&&Wall.triggerAdStat(t,"load")},init:function(_){var e;Wall.initEmoji(),Wall.initWallOptions(_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(cur,{wallInited:!0,postField:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_field"),sendPostBtn:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("send_post"),wallSearch:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wall_search"),wallPage:document.getElementById("profile_redesigned")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("profile")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("group")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("public"),wallPageNarrow:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("narrow_column"),wallUploadOpts:_.upload||!1,wallOnClearInput:[],deletedCnts:{own:0,all:0,archive:0},posterFeatureTooltip:_.poster_feature_tooltip,posterFeatureTooltipHash:_.poster_feature_tooltip_hash,postCopyrightFeatureTooltip:_.post_copyright_feature_tooltip,postCopyrightFeatureTooltipHash:_.post_copyright_feature_tooltip_hash,isUrlsRecognitionDisabled:_.is_urls_recognition_disabled,isYoulaProductPublishedWebFlashMessageEnabled:_.is_youla_product_published_web_flash_message_enabled}),window.cur.classifiedsWallForm=new _web_ecomm_classifieds_legacy_injects_ClassifiedsWallForm__WEBPACK_IMPORTED_MODULE_48__.ClassifiedsWallForm({interval:_.classifieds_auto_recognition_check_interval,isNativeFormEnabled:_.is_classifieds_form_enabled,isFormAutoRecognitionEnabled:_.is_classifieds_form_auto_recognition_enabled,isClassifiedsAutoRecognitionPostBarEnabled:_.is_classifieds_auto_recognition_post_bar_enabled,ownerId:cur.oid});let t=null;(0,_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.isPostponedPostsFixEnabled)()&&(Wall.postponedPosts=_web_page_postponed_posts_postponed_posts__WEBPACK_IMPORTED_MODULE_64__.PostponedPosts.new(),t=Wall.initPostponedSort()),cur.destroy.push((function(_){var e;(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceWallUsers),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceWallGroups),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.removeSearchPositionTracker)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.serviceNews),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.cleanElems)(_.postField),null==(e=Wall.postponedPosts)||e.cleanUpOnNavigation(),uiTabs.hideSort(),t&&t()}));const o=_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent.pbind(document,"click",Wall.hideEditPostReply);cur._back?(cur._back.hide.push(o),cur._back.show.push(o),cur._back.show.push(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent.pbind(document,"click",Wall.hideEditPostReply))):cur.destroy.push(o),cur.wallTab=cur.wallType,Wall.update(),Wall.initUpdates(_.add_queues),_.wall_tpl&&(cur.timeUpdateInt=setInterval((function(){Wall.updateTimes(_.wallCont)}),1e4),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_73__.pushNavDestroy)((()=>{clearInterval(cur.timeUpdateInt)}))),Wall.initScrollChecking(_);let l,i=!1;if((null==(e=cur.options)?void 0:e.no_draft)||(i=_.draft||cur.oid!=vk.id&&Wall.getOwnerDraft(cur.oid)),Wall.initPostEditable(i),cur.wallSearch&&(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_24__.placeholderInit)(cur.wallSearch),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(document,"click",Wall.hideEditPostReply),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(document,"click",Wall.hideEditPostReply),_.poster_options&&Wall.initPosterEditor(_.poster_options),cur.options.max_post_full_length&&Wall.initPostWarningField(),_.media_types){let s=4;_.media_types.find((_=>{var e;return"article"===(null==(e=_)?void 0:e[0])}))&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_44__.partConfigEnabled)("inline_attaches_icons")&&s++;const a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({onAddMediaChange:(_,e,t)=>{cur.postCopyrightFeatureTT&&cur.postCopyrightFeatureTT.hide(),Wall.hidePosterFeatureTooltip(),Wall.postChanged(10,_),["poll","postpone",_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_29__.MEDIA_SELECTOR_PRODUCT,_web_donut__WEBPACK_IMPORTED_MODULE_26__.MEDIA_TYPE_DONUT_DURATION].includes(_)||wall.focusOnEnd(),cur.oid!=vk.id&&Wall.saveOwnerDraftMedia(cur.oid,_,e,t),setTimeout(Wall.checkPosterAvailability)},onChangedSize:()=>{setTimeout((()=>{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_box"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("VideoRestriction",_);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(e,((_,e)=>{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(e)[1],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(e)[0];(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(e,"VideoRestriction--onlyIcon",o<200),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(e,"VideoRestriction--small",o>=200&&o<300&&o>t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(e,"VideoRestriction--medium",o>=300&&o<400)}))}))},onMediaChange:()=>{Wall.postChanged()},onMediaAdd:_=>{var e;(null==(e=window.cur.classifiedsWallForm)?void 0:e.isAutoRecognitionEnabled())&&Wall.getMessage()&&window.cur.classifiedsWallForm.onMediaAdd(_)},onMediaRemove:_=>{var e;(null==(e=window.cur.classifiedsWallForm)?void 0:e.isAutoRecognitionEnabled())&&window.cur.classifiedsWallForm.onMediaRemove(_)},onMediaUploadStarted:()=>{Wall.postChanged()},onIndexChanged:(_,e)=>{window.cur.addPostData=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.moveThumbsInData)(_,e,window.cur.addPostData)},onDelete:_=>{window.cur.addPostData=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.deleteThumbInData)(_,window.cur.addPostData)},onDataDelete:({type:_,id:e,isReset:t})=>{var o;const l=a.getIsCarouselAllowed();window.cur.addPostData=null==(o=window.cur.addPostData)?void 0:o.filter((([t,o])=>!(_===t&&e===o))),t||!l||cur.wallAddMedia.getAttachView()!==_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__.ATTACHMENT_PRIMARY_MODE.carousel||a.getIsCarouselAllowed()||(cur.wallAddMedia.setAttachView(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__.ATTACHMENT_PRIMARY_MODE.grid),a.setAttachViewControlValue(_web_attachments_view_selector_constants__WEBPACK_IMPORTED_MODULE_62__.ATTACHMENT_PRIMARY_MODE.grid))},editable:1,from:"ads"===cur.module?"ads":"post",sortable:1,poster:cur.poster,maxShown:s,hideAfterCount:5,initialAttachView:(0,_web_attachments_view_selector_utils__WEBPACK_IMPORTED_MODULE_58__.getAttachmentsPrimaryModeDefaultValue)()},_.media_opts||{});a.getIsCarouselAllowed=({skipClipsCheck:_=!1}={})=>(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.isCarouselAllowed)(window.cur.addPostData,{skipClipsCheck:_}),a.setAttachViewControlValue=_=>{var e;null==(e=l)||e.setOption(_)},"supp"!==cur.wallType&&(a.getThumbsCount=()=>(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.getThumbsCount)(window.cur.addPostData)),cur.wallAddMedia=new window.MediaSelector((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_add_media"),"media_preview",_.media_types,a);const{wallAddMedia:n}=cur;n.emitter.on(n.eventTypes.choosenMedia,(_=>{var e;window.cur.addPostData=null!=(e=window.cur.addPostData)?e:[],window.cur.addPostData=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.addThumbsInData)(_,window.cur.addPostData)}));let r=()=>{};n.emitter.on(n.eventTypes.viewChanged,(()=>{r(),Wall.drawMedia({skipPoll:!0})}));const d=(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_5__.debounce)((0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_65__._)((function*(_){r();const{renderCarouselPromise:e,abort:t}=(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.renderCarousel)({attachments:(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.mediaDataToAttachments)(window.cur.addPostData),oid:cur.oid,photoClickHandlers:(0,_web_posting_carousel_posting_carousel__WEBPACK_IMPORTED_MODULE_60__.mediaDataToClickHandlers)(window.cur.addPostData),onDelete:_=>{var e;const[t,o]=null!=(e=(0,_shared_attachments_utils_sharedUtils__WEBPACK_IMPORTED_MODULE_59__.getThumbByIndex)(_,window.cur.addPostData))?e:[];t&&o&&n.unchooseMediaByTypeAndId(t,o)}},_);r=t,yield e,n.emitViewDraw()})),0);if(n.emitter.on(n.eventTypes.carouselRedrawNeeded,(_=>{d(_)})),window.cur.destroy.push((()=>{r()})),cur.wallAddMedia.menu){const E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast"),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("official");E&&c&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("_submit_post_box",c),"from-oid")!=cur.postTo&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(E)}}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_44__.partConfigEnabled)("attachments_primary_mode_web_feature")){const b=cur.wallAddMedia&&cur.wallAddMedia.id||"";l=(0,_web_attachments_view_selector_init_view_ui_selector__WEBPACK_IMPORTED_MODULE_57__.initAttachmentsViewSelector)(String(b),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_actions_btns"),cur.wallAddMedia),l&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(l.onClear)}if(Wall.initPostVisibilitySelector(cur.wallAddMedia),(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_30__.isPostTopicSettingEnabled)(window.cur)){const P=cur.wallAddMedia&&cur.wallAddMedia.id||"",u=(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_30__.initPostTopicCreatingSelector)(String(P),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_actions_btns"),(_=>{var e;return-1!==_&&(null==(e=window.cur.classifiedsWallForm)?void 0:e.disable())}));u&&(window.cur.destroy.push(u.onDestroy),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(u.clearSelection))}if(cur.withUpload=window.WallUpload&&!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.inArray)(cur.wallType,["all","own","feed","full_all","ads_promoted_stealth"])&&Wall.withMentions&&cur.wallUploadOpts,cur.withUpload&&WallUpload.checkDragDrop()){let p=!1,D=!1;const w=function(_){if(!1!==p&&(clearTimeout(p),p=!1),cur.uploadInited)return M(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_);switch(_.type){case"drop":D=!1,delete cur.wallUploadFromDrag,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("post_upload_dropbox");break;case"dragleave":p=setTimeout((function(){D=!1,delete cur.wallUploadFromDrag,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)("post_upload_dropbox")}),100);break;case"dragover":case"dragenter":D||(D=!_.target||"IMG"!=_.target.tagName&&"A"!=_.target.tagName?2:1,2==D&&setTimeout(WallUpload.initCallback,0)),2==D&&(cur.wallUploadFromDrag=1)}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_)};function M(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(document,"dragover dragenter drop dragleave",w)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(document,"dragover dragenter drop dragleave",w),cur.destroy.push(M)}if(Wall.updateMentionsIndex(),(0,_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_35__.wallPostRenderInit)(),nav.objLoc.new_post){Wall.showEditPost();const O=nav.objLoc.post_privacy;"friends_only"===O?Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.VISIBILITY_ACCESS_OPTIONS.ONLY_FRIENDS,"",!0):"best_friends_only"===O&&Wall.togglePostVisibilityAccess((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("best_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_27__.VISIBILITY_ACCESS_OPTIONS.ONLY_BEST_FRIENDS,"",!0),delete nav.objLoc.new_post,delete nav.objLoc.post_privacy,nav.setLoc(nav.objLoc)}},initPosterEditor:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)('<div class="page_block"></div>'),t=Wall.getMainPostBlock();"feed"===cur.module&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(e,"feed_post_field_wrap");const o=function(){return!1},l=function(){Wall.closeFancyTooltipsInPost(),Wall.openPosterEditor(),cur.poster.sendStatsInfo("open")},i={onPreOpen:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertAfter)(e,t)},onPostOpen:function(){const _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onPreHide:function(){Wall.saveCaretPositionForPoster(cur.poster.getTextInputEl()),Wall.closeFancyTooltipsInPost();const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_error"),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_box"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_actions_btns"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(t,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(_)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertAfter)(_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(e))},onPostHide:function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_settings_btn"),o=cur.options.suggesting&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("check_sign");_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(_,cur.openPosterBtn),o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(o,cur.openPosterBtn),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(t);let l=cur.poster.getTextAsHtml();l&&l.match(Emoji.emojiRegex)&&(l=l.replace(Emoji.emojiRegex,Emoji.emojiReplace)),cur.postField.innerHTML=l,Wall.restoreCaretPositionForPoster(cur.postField),setTimeout((function(){Composer.updateArticleConvertSuggest((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(cur.postField,"composer"))})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(e)},onPreUploaderOpen:function(){const _=cur.poster.getTextInputEl();Wall.saveCaretPositionForPoster(_)},onPostUploaderClose:function(){const _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onOverTextLimit:function(){Wall.disablePoster(!0),cur.poster.closeEditor(),cur.poster.sendStatsInfo("auto_disable"),cur.poster.state.toggled=!0},onChangeData:Wall.postChanged,onSend:function(_){Wall.sendPost({skipLocked:!0,posterSendParams:_})},onDestroy:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(e)},getPostOwnerId:function(){return+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_box"),"from-oid")},width:Wall.getMainPostBlock().clientWidth,containerClasses:"poster_wall-creating",placeholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.attr)(cur.postField,"placeholder"),appendToElem:e};cur.openPosterBtn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_poster_btn"),cur.poster=new Poster(_.poster_config,i),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(cur.openPosterBtn,"click",l),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(cur.openPosterBtn,"mousedown",o),(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_73__.pushNavDestroy)((()=>{(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(cur.openPosterBtn,"click",l),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(cur.openPosterBtn,"mousedown",o)}))},openPosterEditor:function(_){if(cur.viewAsBox)return cur.viewAsBox();if(!cur.poster||cur.poster.state.disabled||cur.poster.state.opened)return;_=_||{},cur.posterFeatureTT&&cur.posterFeatureTT.hide();const e=Wall.getMainPostBlock(),t=_.bkgId,o=window.browser.windows7||window.browser.windowsVista||window.browser.windowsXp;Wall.saveCaretPositionForPoster(cur.postField);let l=_.text||cur.postField.innerHTML;if(l=l.replace(/\n/g,"<br/>"),l=l.replace(/<img[^>]*>/g,(function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{innerHTML:_}).firstChild,t=Emoji.getCode(e);return t?o?" ":Emoji.codeToChr(t):_})),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(e))return cur.poster.setBkg(t,!0),void cur.poster.setText(l);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(e);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_settings_btn"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_error"),a=cur.options.suggesting&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("check_sign"),n=cur.poster.getPostOptionsWrapperEl();if(i&&n.appendChild(i),a&&n.appendChild(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(s)){const _=cur.poster.getErrorWrapperElement();_.innerHTML="",_.appendChild(s)}const r=cur.poster.getBtnsWrapper(),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_actions_btns");d&&(r.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(d,r.firstChild):r.appendChild(d),d.children.length||r.children.length>1?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)(r):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(r)),cur.poster.openEditor(),cur.poster.setBkg(t,!0),cur.poster.setText(l)},checkPosterAvailability:function(){if(!cur.poster)return;const _=cur.wallAddMedia?cur.wallAddMedia.getMedias():[],e=cur.poster.isTextFieldValid(cur.postField),t=Wall.checkAttachesForPoster(_),o=e&&t;!o!==cur.poster.state.disabled&&Wall.disablePoster(!o),o&&cur.poster.state.toggled&&(Wall.openPosterEditor(),cur.poster.sendStatsInfo("auto_enable"),cur.poster.state.toggled=!1)},checkAttachesForPoster(_){if(!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(_))return!1;if(!_.length)return!0;let e=0;return _.some((_=>{if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_31__.isArray)(_)){const[t]=_;["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_26__.MEDIA_TYPE_DONUT_DURATION].includes(t)||++e}})),0===e},disablePoster:function(_){cur.poster&&(void 0===_&&(_=!0),cur.poster.state.disabled=_,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(cur.openPosterBtn,"_disable",_))},isPosterEditorOpen:function(){return cur.poster&&cur.poster.isOpen()},saveCaretPositionForPoster:function(_){if(document.activeElement!==_)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("span"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("span");e.classList.add("poster__marker","poster__marker_start"),t.classList.add("poster__marker","poster__marker_end");let o=getSelection().getRangeAt(0);o=o.cloneRange(),o.insertNode(e),o.collapse(!1),o.insertNode(t)},restoreCaretPositionForPoster:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("poster__marker_start",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("poster__marker_end",_);if(!e||!t)return void wall.focusOnEnd(_);const o=document.createRange();o.setStartBefore(e),o.setEndBefore(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(t);const l=window.getSelection();l.removeAllRanges(),l.addRange(o)},getMainPostBlock:function(){let _=cur.mainPostBlock;return _||(_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_box")),cur.mainPostBlock=_),_},changeAuthorInPoster:function(_){cur.poster&&_&&cur.poster.changeBkgAuthor({authorName:_.authorName,authorUrl:_.authorUrl})},closeFancyTooltipsInPost:function(){const _=cur.wallAddMedia.lnkId;cur["postPostponeTT"+_]&&cur["postPostponeTT"+_].hide(),cur["post_action_btn"+_]&&cur["post_action_btn"+_].hide(),(0,_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_30__.topicUISelectorHide)(_)},switchOwner:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_ui_toggler",_),"on"),uiSearch.showProgress("wall_search"),cur.options.params.owners_only=cur.options.params.owners_only?null:1,nav.change({owners_only:cur.options.params.owners_only,offset:null})},fakeReplyAsGroupOver:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("reply_fakebox_with_official",_)&&wall.replyAsGroupOver(_)},fakeReplyAsGroupCheck:function(_,e,t){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("reply_fakebox_with_official",_))return window.tooltips&&window.tooltips.hide(_),Wall.showEditReply(e,null,!1,!1,!0,(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_as_group"+e);_&&(_.focus(),_.click())})),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t)},setReplyAsGroup:function(_,e){if(!_)return!1;if(_.hasAttribute("data-reinit-ads-needs-confirmation")&&window.AdsEdit&&!e.reinitConfirmed&&AdsEdit.reinitCreatingPostFormNeeded())return AdsEdit.reinitCreatingPostFormConfirm(wall.setReplyAsGroup.pbind(_,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({},e||{},{reinitConfirmed:!0}))),!1;let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("_submit_post_box",_),o=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("signed"),l=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("close_comments"),i=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("mute_notifications"),s=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("official"),a=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("mark_as_ads"),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"tt"),r=e.from||(e.fromGroup?cur.oid:vk.id),d=r==vk.id?wall.replyAsProfileData():window.replyAsData&&window.replyAsData[r]||wall.replyAsGroupDomData(_);d||(d=[]);const[E,c,b,P,,u]=d;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"from-oid")==r||E!=r)return!1;const p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("submit_post_box"),D=!t&&cur.poster&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domClosest)("poster",_),w=t===p;D&&(t=p,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("signed"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("mark_as_ads"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("close_comments"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("mute_notifications"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("official")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"from-oid",r),wall.replyAsAnimate(t,b,c,u),cur.poster&&(w||D)&&Wall.changeAuthorInPoster({authorName:P,authorUrl:b}),n&&n.rows&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(n.rows,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(this,"active",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(this,"from-oid")==r)})),o&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.disable)(o,_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(r)),a&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.disable)(a,_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(r)),l&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.disable)(l,_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(r)),i&&((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.isChecked)(a)?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(i,"on"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.disable)(i,1)):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.disable)(i,_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isUserId(r))),s&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.checkbox)(s,r!==vk.id),_.setAttribute("aria-label",_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(r)?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_reply_as_group"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_reply_as_user")),_.hasAttribute("data-replace-owner-name")&&(_.innerHTML=P,"A"===_.tagName&&(_.href=b)),_.hasAttribute("data-replace-post-to")&&(cur.postTo=E),_.hasAttribute("data-replace-oid")&&(cur.oid=E),_.hasAttribute("data-reinit-ads-post-editor")&&window.AdsEdit&&(e.withoutRedraw?AdsEdit.reinitCreatingPostFormBoundWithoutRedraw():AdsEdit.reinitCreatingPostFormBound()),"official"==_.id&&Wall.postChanged(!0);const M=cur.wallAddMedia&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(cur.wallAddMedia.menu.menuNode,"_type_podcast");if(M){let _=cur.postTo==r;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(cur.wallAddMedia.getMedias()||[],(function(e,t){if("podcast"===t[0])return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(t[2],"attach_disabled",!_),_=!1,!1})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggle)(M,_)}return _.id&&Wall.hideCheckTimer(_.id.replace("reply_as_group",""),"editing"),cur.wallAddMedia&&cur.wallAddMedia.donutUpdateVisibility(t),!1},replyAsAnimate:function(_,e,t,o){var l,i,s,a;const n=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_44__.partConfigEnabled)("avatar_component_refactor_web"),r=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_post_field_author",_),d=r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_post_field_image",r),E=_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_post_field_official",_),c=E&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_post_field_image",E),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"author_secondary"),P=b?0:1,u=null==(i=d)||null==(l=i[P])?void 0:l.offsetWidth,p=null==(a=c)||null==(s=a[P])?void 0:s.offsetWidth;if(r&&d&&d[P])if(r.href=e,n){const _=(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_47__.getPostAvatarString)(t,"post_field_user_image",u,!1,b?void 0:"post_field_image_secondary");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domReplaceEl)(d[P],_)}else d[P].src=t;if(c&&c[P])if(n){const _=(0,_web_page_wall_utils__WEBPACK_IMPORTED_MODULE_47__.getPostAvatarString)(t,"post_field_choose_image",p,!1,b?void 0:"post_field_choose_secondary");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domReplaceEl)(c[P],_)}else c[P].src=t;(0,_shared_utils_reflow__WEBPACK_IMPORTED_MODULE_78__.reflow)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(_,"author_secondary")},replyAsGroupOver:function(_){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"checkbox_official")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"reply_fakebox_wrap_image")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"disabled"))return!1;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_submit_post_box",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("deep_active",_);let o;if(o=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("replies_wrap_deep",_)?[7,8,8]:t?[2,8,8]:[9,8,8],(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(_,{text:function(){return _shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"from-oid")||vk.id)?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_on_behalf_group"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_on_behalf_me")},black:1,shift:o,noZIndex:!0}),!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"reply_fakebox_wrap_image")&&(wall.isWallReply(_)||wall.isAdsCreatingPost(_))){let e="/al_groups.php",t="get_editor_clubs";wall.isAdsCreatingPost(_)&&(e="/ads_edit.php",t="a_get_promoted_post_stealth_groups"),ajax.post(e,{act:t},{cache:1})}},replyAsGroupFocus:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"tt");e&&e.isShown()||wall.replyAsGroupOver(_)},replyAsGroup:function(_,e,t){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"checkbox_official")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"disabled"))return t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t);if(!((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"can_reply_as_any_group")>0)&&wall.isWallReply(_))return wall.replyAsGroupTT(_,e,[]),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t);if(!wall.isWallReply(_)&&!wall.isAdsCreatingPost(_)||cur.replyAsLoaded)wall.showReplyAsGroupTooltip(_,e);else{let t="/al_groups.php",o="get_editor_clubs";wall.isAdsCreatingPost(_)&&(t="/ads_edit.php",o="a_get_promoted_post_stealth_groups"),ajax.post(t,{act:o},{cache:1,onDone:function(t){cur.replyAsLoaded=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.isVisible)(_)&&wall.showReplyAsGroupTooltip(_,e)}})}return t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t)},showReplyAsGroupTooltip(_,e){const t=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("can_reply_only_verified",_),o=(cur.replyAsLoaded||[]).filter((_=>!t||_[0]>0||_[4]));wall.replyAsGroupTT(_,e,o)},replyAsGroupDomData:function(_){let e,t,o,l,i,s;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("replies_wrap_deep",_)){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",_),"post-id");o&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_fakebox"+o),t=o.split("_")[0])}else e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_submit_post_box",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"oid");return e&&(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"owner-photo"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"owner-href"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"owner-name"),s=(0,_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_70__.replyBoxOwnerIsNftFromAttr)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"owner-is-nft"))),t&&o&&l&&i&&[t,o,l,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.unclean)(i)),null,s]||cur.wallTpl&&cur.wallTpl.ownerData||!1},isWallReply:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_submit_post_box",_);return e&&e.id.match(/reply_box(-?\d+)_(\d+)/)},isAdsCreatingPost:function(_){return!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("ads_edit_ad_submit_post_header",_)},replyAsProfileData:function(){return window.cur&&cur.wallTpl&&cur.wallTpl.profileData||window.wkcur&&wkcur.wallTpl&&wkcur.wallTpl.profileData||window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData},replyAsGroupList:function(_,e){const t=_.hasAttribute("data-disallow-profile")?[]:[wall.replyAsProfileData()],o=wall.replyAsGroupDomData(_);return o&&t.push(o),(wall.isWallReply(_)||wall.isAdsCreatingPost(_))&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(window.replyAsList,(function(){this[0]!=e&&t.push(this)})),t},replyAsGroupTT:function(_,e,t){window.replyAsList=t||[],window.replyAsData={},(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(window.replyAsList,(function(){window.replyAsData[this[0]]=this}));let o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"tt"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_submit_post_box",_),i=l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"from-oid");if(!wall.replyAsProfileData())return!1;if(!o){const t=wall.replyAsGroupList(_,e);let l="";_.hasAttribute("data-enable-search")&&(l+='<div class="post_from_tt_row_search_wrap"><input class="clear_fix post_from_tt_row post_from_tt_row_search" value="" placeholder="'+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_search")+'" /><div class="post_from_tt_row_search_progress"></div></div>');const s=function(_,e,t,o,l){return'<a id="_post_from_tt_row_oid_'+e+'" class="clear_fix post_from_tt_row _post_from_tt_row_searchable'+_+'" data-from-oid="'+e+'" href="'+t+'"><img class="post_from_tt_image" src="'+o+'" aria-label="'+l+'">'+l+"</a>"};(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(t,(function(){const _=i==this[0]?" active":"";l+=s(_,this[0],this[2],this[1],this[3])}));const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("deep_active",_);o=new ElementTooltip(_,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+l+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"bottom",offset:function(){return wall.isAdsCreatingPost(_)?[_.offsetWidth/2+8.5,-2]:a?[1,-5]:[-10,-5]},onFirstTimeShow:function(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("post_from_tt_row",e);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(t,(function(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"post_from_tt_row_search")||(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(t,"click",wall.setReplyAsGroup.pbind(_,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(this,"from-oid")}))}));const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post_from_tt_row_search",e);if(l){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_post_from_tt_row_searchable",e);const i=_.getAttribute("data-search-url"),a={};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(l,"keyup valueChanged",(function(){const n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(l)).toLowerCase();if(i&&n){_.searchRequestTimeout&&(clearTimeout(_.searchRequestTimeout),delete _.searchRequestTimeout);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post_from_tt_row_search_progress",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("pr",l)||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.showProgress)(l),_.searchRequestTimeout=setTimeout((function(){a[n]?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.hideProgress)(l):ajax.plainpost(i,{str:n},(function(i){a[n]=!0,i=JSON.parse(i),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(i,(function(){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("_post_from_tt_row_oid_"+this[0])){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(s("",this[0],this[2],this[1],this[3]));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ui_scroll_content",e).appendChild(t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(t,"click",wall.setReplyAsGroup.pbind(_,{from:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"from-oid")})),window.replyAsData[this[0]]||(window.replyAsData[this[0]]=this)}})),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_post_from_tt_row_searchable",e),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.hideProgress)(l)}),(function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.hideProgress)(l)}))}),500)}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.each)(t,(function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggle)(e,""===n||-1!==e.innerText.toLowerCase().indexOf(n))}))}))}this.rows=t,this.scroll=new uiScroll((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("_post_scroll_wrap",e)),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0)},onShow:function(_){setTimeout((function(){if(!o.scroll)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("active",_),t=e?e.offsetTop-(o.scroll.data.viewportHeight-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(e)[1])/2:0;o.scroll.scrollTop(t);const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post_from_tt_row_search",_);l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.elfocus)(l)}),0)},onHide:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post_from_tt_row_search",_);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e,"")}}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"tt",o)}e&&o.isShown()&&!_.hasAttribute("data-disallow-profile")&&wall.setReplyAsGroup(_,{from:i==vk.id?e:vk.id}),_.tt&&_.tt.hide&&_.tt.hide(),o.isShown()||o.show()},reportPost:function(_,e,t){window.stManager.add([window.jsc("web/privacy.js"),"privacy.css"],(function(){return Privacy.show(_,e,"report_"+t)}))},parsePostId:_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_36__.parseObjectPostId,likeIt:function(_,e,t,o){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.stopEvent)(o),!vk.id)return!1;if(cur.viewAsBox)return cur.viewAsBox(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(o);const l=wall.parsePostId(e),i=l.type,s=l.id,a=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",_))||wall.domPost(s),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(a,"_like_wrap"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(n,"_count"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(n,"my_like");let E;E=e==cur.wallLayer?"wkview":cur.wallType?"feed"==cur.wallType?"news"==cur.section?"feed_"+(cur.subsection?cur.subsection:cur.section):"recommended"==cur.section?"feed_recommended"+("recent"!=cur.subsection?"_"+cur.subsection:""):"friends"==cur.section||"groups"==cur.section||"videos"==cur.section||"photos"==cur.section?"feed_"+cur.section+(cur.subsection?"_"+cur.subsection:""):"feed_"+cur.section:"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module,ajax.post("like.php",{act:d?"a_do_unlike":"a_do_like",object:i+s,hash:t,wall:2,from:E},{onDone:Wall.likeFullUpdate.pbind(_,e),onFail:function(){return!0}});const c=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.stripHTML)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(r)).replace(/(\s|,)/g,"");return Wall.likeUpdate(_,e,!d,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(c)+(d?-1:1)),"wall"==i&&window.cur.onLike&&window.cur.onLike(_,i,e,d),cur.onWallLike&&cur.onWallLike(),"wall"==i&&Wall.triggerAdStat(s,"like_post"),!1},likesShow:function(_,e,t){if(_.postDontShowLikes)return;t=t||{};const o=wall.parsePostId(e),l=o.type,i=o.id,s=l+i,a=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",_))||wall.domPost(i),n=t.views?"_views_wrap":t.share?"_share_wrap":"_like_wrap",r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(a,n),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"_feedback_info_item")?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(r,"_icon"),E=a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(a,"_share_wrap");if(!d||cur.viewAsBox)return;let c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(r)[0],b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(d)[0],P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(d,!0)[0],u=b+P/2-c-41;const p=t.views?{views:1}:t.share?{published:1}:{};if(t.listId&&(p.list=t.listId),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(d,"_feedback_info_item")){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByTag1)("em",d);u=-40,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(d,"feedback_share")&&(u+=7),u+=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(_)[0]/2}const D=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(d,"_feedback_info_item")?d:d.parentNode;(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(D,{url:"/like.php",params:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({act:"a_get_stats",object:s,has_share:E?1:""},p),slide:15,shift:[-u,t.views?2:"wall_reply"==l?-3:7],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",checkLeft:!0,reverseOffset:80,noZIndex:!0,tip:{over:function(){Wall.likesShow(_,e,t)}},onShowStart:function(){const e=D.tt.container;setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.setStyle)(e,{left:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.floatval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getStyle)(e,"left"))+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(d)[0]-b})}),10),(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_16__.statlogsValueEvent)("likes_show",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"shown"))},typeClass:"like_tt",className:t.cl||""})},likesShowList:function(_,e,t){t=t||{};const o=wall.parsePostId(e),l=o.type,i=o.id,s=l+i,a=_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_post_content",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",_))||wall.domPost(i),n=t.share?"_share_wrap":"_like_wrap",r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(a,n);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domByClass)(r,"_icon")&&!cur.viewAsBox&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_8__.showWiki)({w:(t.views?"views":t.share?"shares":"likes")+"/"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)(s)},!1,!1,{queue:1})},sharesShow:function(_,e,t){Wall.likesShow(_,e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(t,{share:1}))},sharesShowList:function(_,e,t){Wall.likesShowList(_,e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(t,{share:1}))},viewsShowList:function(_,e,t){Wall.likesShowList(_,e,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)(t,{views:1}))},viewsUpdate:function(_,e){const t=wall.parsePostId(e),o={act:"a_get_stats",object:t.type+t.id,views:1};ajax.post("/like.php",o,{cache:1,onDone:function(t,l){Wall.likeUpdate(!1,e,!1,t,void 0,void 0,1);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{innerHTML:l});_.setAttribute("title",i.innerText||i.textContent),setTimeout(ajax.invalidate.pbind("/like.php",o),3e3)}})},sharesOpen:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_);if(!vk.id)return!1;(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.stopEvent)(_);const o=wall.parsePostId(e),l=o.type,i=o.id,s=l+i;return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showBox)("/like.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({act:"publish_box",object:s},t)),"wall"==l&&Wall.triggerAdStat(i,"share_post"),!1},customCur:function(){return window.wkcur&&wkcur.shown?wkcur:window.mvcur&&mvcur.mvShown?mvcur:window.pvcur&&cur.pvShown?pvcur:cur},processPostReplyActions:function(_){},updatePostAuthorData:function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("_post_author_data_"+_).forEach((function(_){_.post_author_data_update=!0}))},closeComments:function(_,e,t,o,l){const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"closed"))?0:1;ajax.post("al_wall.php",{act:"close_comments",owner_id:e,post_id:t,close:i,hash:o},{onDone:function(){if(l)l(i);else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",_);Wall.onCloseComments(i,e)}}})},onCloseComments:function(_,e,t){if(!e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"postponed")||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"post")||vk.widget)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("comment",e),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("reply_box_inner_wrap",e),i=cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"Post--with_closed_comments_donut");if(!(t||s||o&&l)){const t=e.id.replace("post","").split("_");return void ajax.post("al_wall.php",{act:"comment_box",owner_id:t[0],post_id:t[1]},{onDone:function(t,o){if(!i){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("comment",e),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("reply_box_inner_wrap",e);if(!_&&t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("PostButtonReactionsContainer",e).after((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(t))}if(!l&&o){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("replies_list",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertAfter)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(o),_)}}Wall.onCloseComments(_,e,!0)}})}i||s||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(e,"closed_comments",_);const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("action_closing_comments",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"closed",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(a,_?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_open_comments"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_closing_comments"))},showPostEditedTime:function(_){const e=(cur.lang||{}).wall_changed;if(!e)return;const t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"time")),o=60*((new Date).getTimezoneOffset()+180);t&&(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(_,{text:e.replace("{time}",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_20__.getDateText)(t,o)),black:1,shift:[0,4]})},showPostAuthorData:function(_,e){const t=_.className.match(/_post_author_data_(-?\d+_\d+)/)[1]||"",o=e?e.target:window.event.srcElement;!t||o!=_&&o.onmouseover||(_.post_author_data_update&&(delete _.post_author_data_update,_.post_author_data_tt&&(_.post_author_data_tt.destroy(),_.post_author_data_tt=!1)),_.post_author_data_tt||ajax.post("al_page.php",{act:"post_author_data_tt",raw:t},{onDone:function(e){const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("post_link",_)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(_);if(!e||!o)return void(_.post_author_data_tt=!0);const l={content:e,arrowSize:"mini",cls:"post_author_data",defaultSide:"bottom",align:"left",id:"author_tt_"+t},i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("_im_mess_stack",_);i?l.appendTo=i:l.appendToParent=!0,vk.widget&&(l.offset=[0,-2],l.forceSide="bottom"),_.post_author_data_tt=new ElementTooltip(o,l),_.post_author_data_tt.show()}}))},createPostTooltip:_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_32__.createPostTooltip,hidePostCopyrightFeatureTooltip:function(){cur.postCopyrightFeatureTooltip&&cur.postCopyrightFeatureTooltipHash&&(cur.postCopyrightFeatureTooltip=!1,cur.postCopyrightFeatureTT.hide(),setTimeout((()=>{cur.postCopyrightFeatureTT.destroy()}),ElementTooltip.FADE_SPEED),ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"}))},showPostCopyrightFeatureTooltip:function(){if(!cur.postCopyrightFeatureTooltip||cur.postCopyrightFeatureTT)return;const _=setTimeout((()=>{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_settings_btn");_&&cur.postCopyrightFeatureTooltip&&(cur.postCopyrightFeatureTT=new ElementTooltip(_,{content:`<div class="feature_tooltip__close" onclick="Wall.hidePostCopyrightFeatureTooltip();"></div>${_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_post_copyright_feature_text")}`,cls:"feature_intro_tt feature_info_tooltip",forceSide:"bottom",autoShow:!1,noOverflow:!1,noHideOnClick:!0,appendToParent:!0,offset:[-6.5,-8],onShow:()=>{ajax.post("al_index.php",{act:"show_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"})},onWindowClick:()=>{cur.postCopyrightFeatureTT&&(cur.postCopyrightFeatureTT.hide(),cur.postField.blur())}}),cur.postCopyrightFeatureTT.show())}),800);cur.destroy.push((()=>clearTimeout(_)))},showPostGearIconOrdTooltip:function(_){if(!_)return;const e=_.querySelector("#post_button_gear_settings");if(e&&e.hasAttribute("data-disable-show-post-ord-tooltip"))return;let t;var o;o=()=>{const o=_.querySelector("#post_icon_gear_settings");if(!o)return;const l=()=>{t&&(t.hide(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(e,"mouseover",l))};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(e,"mouseover",l),t=new ElementTooltip(o,{content:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("intro_hint_title_posting_editor_ord_ad"),cls:"eltt_fancy poster_feature_tt",defaultSide:"top",autoShow:!1,appendToParent:!0,onHide:()=>(e&&e.setAttribute("data-disable-show-post-ord-tooltip","true"),(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_79__.ensureAccountHelpHintsService)().hideHelpHint(_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_80__.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_ORD_AD),t&&t.destroy(),void(t=null))}),t.show()},(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_79__.ensureAccountHelpHintsService)().canShow(_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_80__.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_ORD_AD)&&o()},hidePosterFeatureTooltip:function(){cur.posterFeatureTooltip=!1,cur.posterFeatureTT&&cur.posterFeatureTooltipHash&&(cur.posterFeatureTT.destroy(),cur.posterFeatureTT=null,ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.posterFeatureTooltipHash,type:"poster_new_year"}))},showPosterFeatureTooltip:function(){if(!cur.posterFeatureTooltip)return;const _=setTimeout((function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domQuery1)(".poster__open-btn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("page_poster_btn"));if(!_||!cur.posterFeatureTooltip)return;const e='<div class="poster_feature_tt__layout" onclick="cur.posterFeatureTT.hide(); cancelEvent(event);"><div class="poster_feature_tt__close"></div><div class="poster_feature_tt__info">'+_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_new_posters_new_year")+"</div>";cur.posterFeatureTT=new ElementTooltip(_,{content:e,forceSide:"bottom",cls:"eltt_fancy poster_feature_tt",autoShow:!1,noOverflow:!1,align:"left",centerShift:-28,noHideOnClick:!0,appendToParent:!0,offset:[0,-8],onHide:Wall.hidePosterFeatureTooltip,onWindowClick:function(){cur.posterFeatureTT.hide(),cur.postField.blur()}}),cur.posterFeatureTT.show(),cur.poster&&cur.poster.sendStatsInfo("new_bkg_tooltip_show")}),800);(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_73__.pushNavDestroy)((()=>{clearTimeout(_)}))},replyEditPhoto:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!1,(function(){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_more_attaches"+e);if(t){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ms_item_photo",t);tooltips.hide(_),e&&e.click()}})),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t)},replyMoreAttachShow:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!0,(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("ms_items_more_wrap",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_more_attaches"+e));_&&(_.focus(),_.click())})),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t)},replyFakeEmojiOver:function(_){wall.initEditReply(_,!1,!0,(function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_smile"+_);if(e){var t,o;null==(t=(o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("emoji_smile",e)).onmouseenter)||t.call(o)}}))},hideDeepReplies:function(_){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"reply")&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",e),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"post-id"));const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"replies-offset")||0,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"replies-limit")||3,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(cur.wallTpl.reply_deep_next,{post_id:_,reply_id:_,offset:t,count:o,text:"",class:" replies_next_main"}));l.innerHTML="",l.appendChild(i),(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_17__.scrollToY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(l)[1]-100,0,null,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(i,"collapse",!0),i.click(),cur.wallMyOpened[_]=0},addNewReply:function(_){const e=_[2],t=(_[10]||"").match(/wall.showReply\([^-)0-9]*(-?[_0-9]+)[^-)0-9]*(-?[_0-9]+)[^-)0-9]*\)/),o=t&&t[2]||"",l=o&&o!==e,i=cur.wallLayer&&cur.wallLayer===e,s=i?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+e):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e),a=s.offsetHeight;let n,r=0,d=0;n=l?wall._addDeepReply(_,o):wall._addRootReply(_);const E=i?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("wl_post"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e);return wall.incReplyCounter(E,1,_[13]),i?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("wl_replies_wrap",E)),cur.count++,cur.loaded++):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.show)("replies_wrap"+e),Wall.repliesSideSetup(e)),Wall.updateMentionsIndex(),n&&((0,_web_stories_narrative_utils__WEBPACK_IMPORTED_MODULE_41__.updateNarrativeSnippetsFromQueueByPost)(n),(0,_web_articles_article_utils__WEBPACK_IMPORTED_MODULE_42__.updateArticleSnippetsFromQueueByPost)(n),(0,_web_stickers_utils__WEBPACK_IMPORTED_MODULE_49__.updateStickersFromQueue)(n),r=s.offsetHeight-a,d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(n,i)[1]),[r,d]},_addDeepReply:function(_,e){const t=_[2],o=_[10]||"",l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(o);let i=l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"root-id")||e,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+i);const a=s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("replies_wrap_deep",s),n=cur.wallLayer&&cur.wallLayer===t?wkcur:cur;let r;if(a&&(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"post-id"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+i)),!s)return null;let d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+i);if(!d){wall.addDeepRepliesBlock(i);const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_fakebox"+i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+i);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hide)(_),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+i),r=d}if(!d)return null;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("reply",d).length){const _=wall._addNewReplyShowMore(t,i,d,"replies_next_deep");r=r||_}else{let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_short_deep"+i);const o=wall.isDescRepliesOrder(t);if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("replies_short_text_count",e),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(_).replace(/[^0-9]/g,""))||0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(_,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_replied_to_reply_count",t+1))}else{e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(n.wallTpl.reply_deep_short,{post_id:t,reply_id:i,reply_msg_id:i.split("_")[1],img_src:_[6]||"",name:_[5]||"",count:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("global_replied_to_reply_count",1)}));const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(d);if(l)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(e,l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(l,"replies_next_deep")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.toggleClass)(l,"replies_prev",o);else{d.appendChild(e);const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(n.wallTpl.reply_deep_next,{post_id:t,reply_id:i,offset:0,count:1,text:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_next_n_replies",1),class:" replies_next_deep"+(o?" replies_prev":"")}));d.appendChild(_)}}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(a,"replies_deep_has_short"),r=e}return wall.updateCollapseDeepReplies(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.removeClass)(a,"replies_deep_empty_list"),r},_addRootReply:function(_){const e=_[2],t=cur.wallLayer&&cur.wallLayer===e,o=t?wkcur:cur,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domChildren)(l).length,s="full"===o.wallType,a=!i||i<3&&(t||s),n=wall.isDescRepliesOrder(e);if(a){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.intval)(_[_.length-1]),t=void 0!==o.options.is_admin?o.options.is_admin:_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(o.options.wall_oid)?8&e?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.EDITOR:2&e?_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.MODERATOR:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER:_shared_groups_constants__WEBPACK_IMPORTED_MODULE_50__.GroupAdminLevel.USER,i=Wall.getNewReplyHTML(_,t,!1,o);if(!i)throw new Error("Failed to add root reply");const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)(i);return(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.highlightUpdatedReply)(s),n&&l.firstChild?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(s,l.firstChild):l.appendChild(s),s}return wall._addNewReplyShowMore(e,e,l,"replies_next_main",n)},_addNewReplyShowMore:function(_,e,t,o,l){const i=cur.wallLayer&&cur.wallLayer===_?wkcur:cur,s=i.options.replies_page_count||20,a=l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domFC)(t):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domLC)(t);let n,r;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(a,"replies_next"))return n=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"count")||0,n<s?(n++,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"count",n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(a,l?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_prev_n_replies",n):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_next_n_replies",n))):l&&(r=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"offset")||0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(a,"offset",r+1)),a;{if(l)r=0;else{const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)(o,t),e=_[_.length-1],l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domChildren)(t);if(e){const _=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"count")||s,t=+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"offset")||0;let o=l.indexOf(e);o=(o>=0?o:0)+1;r=t+_+l.slice(o).filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"reply")})).length}else r=l.filter((function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(_,"reply")})).length}const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(i.wallTpl.reply_deep_next,{post_id:_,reply_id:e,offset:r,count:1,text:l?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_prev_n_replies",1):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_next_n_replies",1),class:" "+(l?" replies_prev":"")+(o?" "+o:"")}));return l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertBefore)(a,t.firstChild):t.appendChild(a),(0,_web_wall_reply_update_view__WEBPACK_IMPORTED_MODULE_34__.loadRepliesLinkShow)(a),a}},removeDeepReply:function(_){const e=_[2],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+e);let o=0,l=0;if(cur.wallMyDeleted[e]||!t)return[o,l];l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getXY)(t,cur.layerpost)[1],(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_19__.revertLastInlineVideo)(t);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",t)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",t),s=i?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(i,"post-id"):"",a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("replies_wrap_deep",t);if(a)o=-t.offsetHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.getSize)(a)[1]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(a,"replies_deep_empty_list"),wall.updateCollapseDeepReplies(e);else{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap_deep"+e)){const _=cur.wallLayer&&cur.wallLayer===s?wkcur:cur,l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("reply_date",t),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("reply_link_wrap",t);let a="";const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.attr)(t,"onclick");n&&(a+=' onclick="'+n+'"');const r=e.split("_")[0],d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(_shared_ranges__WEBPACK_IMPORTED_MODULE_56__.Ranges.isGroupId(r)?_.wallTpl.reply_deleted_group:_.wallTpl.reply_deleted_user,{reply_id:e,date:l?l.innerHTML:"",answer:i?i.outerHTML:"",class:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"reply_replieable")?" reply_replieable":"",attr:a})),E=t.offsetHeight;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domReplaceEl)(t,d),o=d.offsetHeight-E}else o=-t.offsetHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.re)(t)}return cur.layerpost&&(cur.count--,cur.loaded--),i&&(wall.repliesSideSetup(s),wall.incReplyCounter(i,-1)),[o,l]},addDeepRepliesBlock:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post"+_);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(e,"reply"))return;const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("wl_post",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("post",e);if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.hasClass)(t,"deep_active"))return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(t,"post-id");let l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies_wrap_deep"+_);const i=(cur.wallLayer?wkcur:cur).wallTpl;l||(l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(i.reply_deep,{post_id:o,reply_id:_,reply_msg_id:_.split("_")[1],text:"",offset:0,class:" replies_next_deep"})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domInsertAfter)(l,e));const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_fakebox"+_),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+_);if(!s&&!a){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_fakebox"+o)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("reply_box"+o),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("checkbox_official",e)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.gpeByClass)("reply_fakebox_with_official",e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(i.reply_box,{post_id:_,owner_name:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.clean)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"owner-name")||""),owner_photo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"owner-photo")||"",owner_href:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"owner-href")||"",owner_is_nft:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"owner-is-nft")||"",can_reply_as_group:t||"",class:t?" reply_fakebox_with_official":""}));l.appendChild(s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.addClass)(l,"replies_deep_has_field")}},addReplyName:function(_,e){const t={};t[_]=e,wall.addReplyNames(t)},addReplyNames:function(_){const e=cur.wallLayer?wkcur:cur;e.options||(e.options={}),e.options.reply_names=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_14__.extend)({},e.options.reply_names,_)},getReplyNames:function(){return(cur.wallLayer?wkcur:cur).options.reply_names||{}},getReplyName:function(_){if(cur.pvShown&&cur.pvReplyNames)return cur.pvReplyNames[_]||[];if(window.mvcur&&mvcur.mvShown&&!mvcur.minimized)return mvcur.mvReplyNames[_]||[];return wall.getReplyNames()[_]||[]},showReorderRepliesTooltip:function(_,e){const t=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;if(!t["postRepliesReorderTT"+e]&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.data)(_,"ett")){var o;const l=_.closest(".post_replies_reorder_wrap");let i;i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"hide-smart")||!1?t.wallTpl.replies_reorder_tooltip:t.wallTpl.replies_reorder_tooltip_with_smart;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(i||"",{postId:e})),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("radiobtn",s),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"order")||"asc",r="post_replies_reorder"+e;radioBtns[r]={val:n,els:a},a.some((function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"order")===n)return(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_32__.updatePostTooltipActionRadioBtn)(_,!0,r),!0}));const d=new ElementTooltip(_,{appendTo:null==(o=l)?void 0:o.parentNode,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-10,0],content:s,align:"left"});t["postRepliesReorderTT"+e]=d,(0,_shared_lib_nav_helpers__WEBPACK_IMPORTED_MODULE_73__.pushNavDestroy)((()=>{d&&d.destroy()})),d.show()}},reorderReplies:function(_,e,t){var o;const l=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;t=t||"asc",(0,_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_32__.updatePostTooltipActionRadioBtn)(_,t,"post_replies_reorder"+e);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_replies_reorder"+e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"label")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(_),a=null==(o=i)?void 0:o.querySelector(".post_replies_reorder");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(a,s),i&&(i.setAttribute("aria-label",s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(i,"order",t)),l["postRepliesReorderTT"+e]&&l["postRepliesReorderTT"+e].hide(),wall.moreReplies(e,0,0,{deep:!0,clear:!0,order:t,onDone:function(_,t,o){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("replies"+e);if(o.count>o.offset+o.num){const _=cur.wallLayer&&cur.wallLayer===e?wkcur:cur,t=_.options.replies_page_count||20,i=Math.min(t,o.count-o.offset-o.num),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(_.wallTpl.reply_deep_next,{post_id:e,reply_id:e,offset:o.offset+o.num,count:i,text:_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_next_n_replies",i),class:" replies_next_main"}));l.appendChild(s)}o.top_reply_ids&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(l,"top-ids",o.top_reply_ids.join(",")),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[e]=1,wall.repliesSideSetup(e)}})},getRepliesOrder:function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ge)("post_replies_reorder"+_);return(e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(e,"order"):"")||"asc"},isDescRepliesOrder:function(_,e){return"desc"===(e=e||wall.getRepliesOrder(_))},postEventChangeStatus:function(_,e,t,o){const l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.domData)(_,"context"),i=()=>document.querySelectorAll(".post_event_action_btn"+e);return window.stManager.add([window.jsc("web/groups.js")],(()=>{Groups.enter(_,e,t,l,((_,t,o)=>{const s=l.split("_"),a=!s[1],n=s[0]+"_"+(a?"decline":""),r=a?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("events_snippet_will_participate_active"):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("events_snippet_cant_participate_active");o=o||{},i().forEach((_=>{_.dataset.context=n,_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.setAppearance(_,_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButtonAppearance.SECONDARY),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.setLabel(_,r)})),o.members&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass)("page_media_event"+e).forEach((_=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.geByClass1)("page_media_event_members",_);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.val)(e,o.members)}))}),{showProgress:()=>{i().forEach((_=>{_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.lock(_)}))},hideProgress:()=>{i().forEach((_=>{_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_46__.FlatButton.unlock(_)}))}})})),o&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(o)},showEventFriends:function(_,e){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_10__.showTooltip)(_,{url:"/al_groups.php",params:{act:"a_event_friends_tt",owner_id:e},ajaxdt:100,showdt:400,hidedt:200,dir:"auto",noZIndex:!0,typeClass:"like_tt"})},updateRepliesOnScroll:function(){cur.wallLayer?WkView.wallUpdateRepliesOnScroll():"full"===cur.wallType&&FullWall.onePostOnScroll()},updateConvertedClassifiedPost:function({postId:_,ownerId:e}){ajax.post("al_wall.php",{act:"s_one",post_id:_,owner_id:e,render_context:"wall",only_post:!0},{onDone:t=>{const o=Wall.domPost(`${e}_${_}`);if(o&&t){const _=document.createElement("div");_.innerHTML=t,o.querySelector(".post_info").innerHTML=_.querySelector(".post_info").innerHTML}}})},updatePost:function(_,e,t,o,l,i,s){const[a,n]=e.split("_");let r;_&&a&&n&&ajax.post("al_wall.php",{act:"s_one",lang:"to_original"!==o?t:"",post_id:n,owner_id:a,render_context:l||"wall",ref:i||"",loc_context:s||"",only_post:!0},{onDone:_=>{Wall.sendTranslationClickStats(e,o,t);const l=Wall.domPost(e);if(l&&_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.ce)("div",{innerHTML:_});l.querySelector(".wall_text").innerHTML=e.querySelector(".wall_text").innerHTML}},onFail:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.setStyle)(_,{"pointer-events":null}),_.querySelector(".PostTranslationButton__text").innerText=r},showProgress:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.setStyle)(_,{"pointer-events":"none"}),r=_.querySelector(".PostTranslationButton__text").innerText,_.querySelector(".PostTranslationButton__text").innerText=_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("pages_translation_translation_loading")}})},sendTranslationClickStats(_,e,t){(0,_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_45__.saveStatlogEvents)({name:"translation_click",value:0,keys:[_,e,t]})},sendFakeNewsMark:function(_,e,t,o,l){const i="data-mark-exists",s={post_id:t,owner_id:o,mark:1===parseInt(_.getAttribute(i))?0:1,hash:l},a={onDone(e,t){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(e),_.innerHTML=t,_.setAttribute(i,s.mark)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_25__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockActionsMenuItem)(_)};ajax.post(e,s,a)},sendToObsceneCheck:function(_,e,t,o,l){const i={post_id:t,owner_id:o,hash:l},s={onDone(_){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(_)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_25__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockActionsMenuItem)(_)};ajax.post(e,i,s)},openMarkAsAdsOrdMiniApp:function(_){const e='[name="ord_pred_id"]',t='[name="erid"]',o=(_,e,t)=>{_&&(t?_.classList.contains(e)||(_.classList.add(e),_.classList.add("on")):_.classList.contains(e)&&(_.classList.remove(e),_.classList.remove("on")))},l=(()=>{const o=_.querySelector(e),l=_.querySelector(t),i=_.classList.contains("on"),s=o&&o.value;return{is_ad:i,erid:l&&l.value,ord_pred_id:s}})();(0,_web_ord_utils__WEBPACK_IMPORTED_MODULE_61__.handleOrdMiniappOpen)(l,(l=>(l=>{const i=l.is_ad,s=_.closest(".PostSettings"),a=s&&s.querySelector("#post_icon_gear_settings"),n=_.querySelector(e),r=_.querySelector(t);o(a,"PostOption__iconWrapperApplied",i),o(_,"PostOption__withMarkAdsOrdMiniApp",i),n&&(n.value=l.ord_pred_id),r&&(r.value=l.erid)})(l)),{isSnackbar:!0,edit:!1})},toggleDowngradeState:function(_,e,t,o,l){const i="data-downgraded",s={post_id:t,owner_id:o,set:1===parseInt(_.getAttribute(i))?0:1,hash:l},a={onDone(e,t){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_15__.showDoneBox)(e),_.innerHTML=t,_.setAttribute(i,s.set)},onFail:_=>(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_25__.showErrorBox)(_),showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.lockActionsMenuItem)(_),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_12__.unlockActionsMenuItem)(_)};ajax.post(e,s,a)},initPostWarningField(){var _;if(window.cur.postWarningField)return;window.cur.postWarningField=document.createElement("span"),window.cur.postWarningField.classList.add("post_field_warning");const e=null==(_=window.cur.postField)?void 0:_.parentElement;e&&e.appendChild(window.cur.postWarningField)},handleClassifiedsFlashMessageState(_){var e;const t=null==(e=cur.editingPost)?void 0:e[0];if(!t)return;const[,o]=t.split("_"),l=document.getElementById("classifieds-flash-message-"+o);if(l)switch(_){case"hide":l.classList.add("ClassifiedsGroupPostFlashMessage--hidden");break;case"show":l.classList.remove("ClassifiedsGroupPostFlashMessage--hidden")}},showPostGeoBanBox(_,e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showBox)("groups_wall_posts_geoban.php",{act:"manage_geoban_box",gid:_,post_id:e})},initPostGeoBan(_,e,t){this.geoBlockCountryElement=document.getElementById("post_geoban_country"),this.geoBlockCountries=e.values,this.geoBlockCommentField=document.getElementById("post_geoban_comment"),this.geoBlockComments=e.comments,this.geoBlockDoAction=t=>{ajax.post("groups_wall_posts_geoban.php",{act:"a_set_post_geoban",status:t,comment:this.geoBlockCommentField.value,country:this.geoBlockCountry.val(),post_id:_,hash:e.hash},{onDone:()=>{window.nav.reload()},onFail:_=>(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_11__.showFastBox)("Ошибка",_)})},this.geoBlockBanAction=()=>{this.geoBlockDoAction(1)},this.geoBlockUnbanAction=()=>{this.geoBlockDoAction(0)},this.geoBlockCountryChange=()=>{const _=this.geoBlockCountry.val();this.geoBlockComments[_]?(this.geoBlockCommentField.value=this.geoBlockComments[_],this.geoBlockCommentField.disabled=!0,t.setButtons("Разблокировать",this.geoBlockUnbanAction)):(this.geoBlockCommentField.value="",this.geoBlockCommentField.disabled=!1,t.setButtons("Заблокировать",this.geoBlockBanAction))},this.geoBlockCountry=new Dropdown(this.geoBlockCountryElement,this.geoBlockCountries,{big:1,selectedItems:[],onChange:this.geoBlockCountryChange}),this.geoBlockCountryChange(),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_51__.autosizeSetup)("post_geoban_comment",{minHeight:60})},getLastReplies(_,e=4){var t;const o=wall.isDescRepliesOrder(_),l=wall.getRepliesOrder(_),i="smart"===l,s=(null==(t=cur)?void 0:t.wallLayer)===_?wkcur:cur;const a={clear:!0,deep:i,rev:o?1:0,order:l};wall.moreReplies(_,null,e,(0,_swc_helpers_extends__WEBPACK_IMPORTED_MODULE_74__._)({},a,{onDone:function(e,t,l){const a=document.querySelector(`#replies${_}`);if(!a)return;if(l.count>l.offset+l.num){const e=s.options.replies_page_count||20,t=Math.min(e,l.count-l.offset-l.num),n=o||i,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_7__.rs)(s.wallTpl.reply_deep_next,{post_id:_,reply_id:_,offset:l.offset+l.num,count:t,text:n?_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_next_n_replies",t):_shared_lib_langs__WEBPACK_IMPORTED_MODULE_6__.getLang("wall_prev_n_replies",t),class:n?" replies_next replies_next_main":" replies_prev"}));n?a.appendChild(r):a.insertBefore(r,a.firstChild)}const n=a.parentNode;n&&e&&(n.style.display=""),l.top_reply_ids&&(a.dataset.topIds=l.top_reply_ids.join(",")),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[_]=1,wall.repliesSideSetup(_)}}))}},__WEBPACK_DEFAULT_EXPORT__=Wall},555510:(_,e,t)=>{t.d(e,{EVENT_REPLY_FIELD_IS_NFT_INDEX:()=>a,MIN_NFT_IMAGE_SIZE:()=>l,REPLY_IMAGE_DEFAULT_SIZE:()=>i,REPLY_IMAGE_SMALL_SIZE:()=>s,VISIBILITY_ACCESS_OPTIONS:()=>o});const o={PUBLIC:0,ONLY_FRIENDS:1,ONLY_BEST_FRIENDS:2},l=29,i=34,s=24,a=16}}]);try{stManager.done("dist/46b19e29d7cd846b8b1c94b509ac4ce6.167e07300a54f73b10f1.js")}catch(_){}