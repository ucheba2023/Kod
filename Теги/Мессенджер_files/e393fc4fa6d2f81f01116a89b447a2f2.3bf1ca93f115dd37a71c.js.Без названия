/*! For license information please see e393fc4fa6d2f81f01116a89b447a2f2.3bf1ca93f115dd37a71c.js.LICENSE.txt */
"use strict";(self.webpackChunkvk=self.webpackChunkvk||[]).push([[73462],{20403:(e,t,n)=>{n.d(t,{Icon12Favorite:()=>o});var o=(0,n(28178).makeIcon)("Icon12Favorite","favorite_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="favorite_12"><path d="m4.559 2.876-.277.653a.337.337 0 0 1-.044.086.15.15 0 0 1-.048.037.322.322 0 0 1-.093.02l-.403.059c-1.136.163-1.703.245-1.942.516a1.015 1.015 0 0 0-.233.866c.07.357.518.723 1.412 1.454l.153.124c.04.033.06.05.074.07.011.02.019.04.022.062a.344.344 0 0 1-.011.103l-.046.245c-.25 1.347-.375 2.02-.178 2.35.17.285.47.465.796.479.378.016.895-.423 1.93-1.3l.177-.15a.351.351 0 0 1 .111-.077.146.146 0 0 1 .082 0c.03.008.057.031.111.077l.178.15c1.034.877 1.55 1.316 1.929 1.3a.979.979 0 0 0 .796-.479c.197-.33.072-1.003-.178-2.35l-.046-.245a.344.344 0 0 1-.01-.103.154.154 0 0 1 .021-.061.339.339 0 0 1 .074-.07l.153-.125c.894-.731 1.342-1.097 1.412-1.454.06-.31-.025-.631-.233-.866-.239-.27-.806-.353-1.942-.516l-.403-.058c-.048-.007-.072-.01-.093-.02a.15.15 0 0 1-.048-.038c-.015-.018-.024-.04-.044-.086l-.277-.653c-.455-1.071-.682-1.607-1-1.77a.965.965 0 0 0-.881 0c-.319.163-.546.699-1.001 1.77Z" /></symbol>',12,12,!1,void 0)},354768:(e,t,n)=>{n.d(t,{Icon12Verified:()=>o});var o=(0,n(28178).makeIcon)("Icon12Verified","verified_12","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="verified_12"><path fill="currentColor" d="M4.5 9.586 2.957 8.043a1 1 0 0 0-1.414 1.414l2.25 2.25a1 1 0 0 0 1.414 0l5.25-5.25a1 1 0 0 0-1.414-1.414z" /></symbol>',16,16,!1,void 0)},600820:(e,t,n)=>{n.d(t,{Icon12VerifiedAlt:()=>o});var o=(0,n(28178).makeIcon)("Icon12VerifiedAlt","verified_alt_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="verified_alt_12"><path d="M4.5 7.586 2.957 6.043a1 1 0 0 0-1.414 1.414l2.25 2.25a1 1 0 0 0 1.414 0l5.25-5.25a1 1 0 0 0-1.414-1.414L4.5 7.586Z" /></symbol>',12,12,!1,void 0)},742783:(e,t,n)=>{n.d(t,{Icon16Pin:()=>o});var o=(0,n(28178).makeIcon)("Icon16Pin","pin_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="pin_16"><path fill="currentColor" d="m10.235 2.106 3.657 3.663c.225.226.064.633-.263.633h-.523a.895.895 0 0 0-.633.263L10.758 8.38a.896.896 0 0 0-.262.633v2.996c0 .554-.7.858-1.1.456l-2.301-2.3-3.57 3.57a.893.893 0 1 1-1.264-1.263L5.83 8.898l-2.29-2.29c-.391-.392-.109-1.102.456-1.102H6.99a.895.895 0 0 0 .633-.262L9.338 3.53a.896.896 0 0 0 .263-.634V2.37c0-.32.403-.495.634-.263z" /></symbol>',16,16,!1,void 0)},29157:(e,t,n)=>{n.d(t,{Icon20CheckCircleOff:()=>o});var o=(0,n(28178).makeIcon)("Icon20CheckCircleOff","check_circle_off_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" viewBox="0 0 20 20" id="check_circle_off_20"><defs><path id="check_circle_off_20_a" fill="currentColor" fill-rule="evenodd" d="M10 20c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Zm0-1a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z" clip-rule="evenodd" /></defs><use xlink:href="#check_circle_off_20_a" fill-rule="evenodd" clip-rule="evenodd" /><use xlink:href="#check_circle_off_20_a" fill-rule="evenodd" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},385228:(e,t,n)=>{n.d(t,{Icon20More:()=>o});var o=(0,n(28178).makeIcon)("Icon20More","more_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="more_20"><path fill="currentColor" d="M15 8.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3z" /></symbol>',20,20,!1,void 0)},540246:(e,t,n)=>{n.d(t,{Icon56CommentsOutline:()=>o});var o=(0,n(28178).makeIcon)("Icon56CommentsOutline","comments_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="comments_outline_56"><path fill="currentColor" d="m27.234 42.143.965 1.149zm-10.09 8.477-.966-1.149zM8.5 15a1.5 1.5 0 0 0 0-3zm20.895 20.672-.965 1.148zm9.462 7.948.965-1.149zM5 36.5v-18H2v18zm9.5 3.5h-6v3h6zm2.5 9.854V42.5h-3v7.354zm9.27-8.86-10.092 8.477 1.93 2.297 10.091-8.476zm1.93 2.298c.223-.189.507-.292.8-.292v-3c-.999 0-1.966.352-2.73.995zM14 49.854c0 2.124 2.482 3.28 4.108 1.914l-1.93-2.297a.5.5 0 0 1 .822.383zM14.5 43a.5.5 0 0 1-.5-.5h3a2.5 2.5 0 0 0-2.5-2.5zM2 36.5A6.5 6.5 0 0 0 8.5 43v-3A3.5 3.5 0 0 1 5 36.5zm3-18A3.5 3.5 0 0 1 8.5 15v-3A6.5 6.5 0 0 0 2 18.5zM46.5 5h-28v3h28zM12 11.5v18h3v-18zm41 18v-18h-3v18zM41.5 36h5v-3h-5zm.5 6.854V35.5h-3v7.354zM18.5 36h7.679v-3H18.5zm9.93.82 9.462 7.948 1.93-2.297-9.463-7.948zM26.179 36a3.5 3.5 0 0 1 2.25.82l1.93-2.297A6.5 6.5 0 0 0 26.18 33zM39 42.854a.5.5 0 0 1 .822-.383l-1.93 2.297c1.626 1.366 4.108.21 4.108-1.914zM41.5 33a2.5 2.5 0 0 0-2.5 2.5h3a.5.5 0 0 1-.5.5zm8.5-3.5a3.5 3.5 0 0 1-3.5 3.5v3a6.5 6.5 0 0 0 6.5-6.5zm-38 0a6.5 6.5 0 0 0 6.5 6.5v-3a3.5 3.5 0 0 1-3.5-3.5zM18.5 5a6.5 6.5 0 0 0-6.5 6.5h3A3.5 3.5 0 0 1 18.5 8zm28 3a3.5 3.5 0 0 1 3.5 3.5h3A6.5 6.5 0 0 0 46.5 5z" /></symbol>',56,56,!1,void 0)},797074:(e,t,n)=>{n.d(t,{default:()=>o});const o={wrapper:"PinnedMessage-module__wrapper--qQdRp",container:"PinnedMessage-module__container--sQyXI",comment:"PinnedMessage-module__comment--uoqzs",pinIcon:"PinnedMessage-module__pinIcon--gRU1g",author:"PinnedMessage-module__author--i_tVF",authorWithBackground:"PinnedMessage-module__authorWithBackground--qBz9e",authorWithoutMargin:"PinnedMessage-module__authorWithoutMargin--gMc3J",moreAction:"PinnedMessage-module__moreAction--ynv5l"}},952464:(e,t,n)=>{n.d(t,{default:()=>o});const o={scroll:"VideoChat-module__scroll--1zGsq",in:"VideoChat-module__in--qeyRv"}},137363:(e,t,n)=>{n.d(t,{ANALYTICS_SCREEN_OTHER:()=>s,ANALYTICS_SCREEN_SETTINGS:()=>i,GroupAdminLevel:()=>o});const o={USER:0,MODERATOR:1,EDITOR:2,ADMINISTRATOR:3,HOST:4,EVENT_CREATOR:5,CREATOR:6,PSEUDO_LEVEL_ADVERTISER:100},i="settings",s="other"},270241:(e,t,n)=>{n.d(t,{VideoChatComponent:()=>d});var o,i,s,a=n(293579),r=n(918956),l=n(243859);(null==(i=window.vk)||null==(o=i.pe)?void 0:o.static_manager_dynamic_imports)&&(null==(s=window.vk)?void 0:s.stDomain)&&(n.p=window.vk.stDomain+"/dist/");let c;const d={init:function(e){c=(0,l.createReactInitiator)(r.VideoChat,(0,a.getReactRootEl)("VideoChat")),c.render(e)},destroy:function(){var e;null==(e=c)||e.unmount()}};try{window.stManager.done(window.jsc("web/video_chat_refactoring.js"))}catch(e){}},667794:(e,t,n)=>{n.d(t,{PinnedMessageComponent:()=>g});var o,i,s,a=n(434788),r=n(785893),l=n(786006),c=n(293579),d=n(973935),m=n(283452),u=n(321850);(null==(i=window.vk)||null==(o=i.pe)?void 0:o.static_manager_dynamic_imports)&&(null==(s=window.vk)?void 0:s.stDomain)&&(n.p=window.vk.stDomain+"/dist/");const h="PinnedMessage";try{window.stManager.done(window.jsc("web/video_pinned_message.js")),(0,c.registerReactApplication)(h,(e=>{const t=(0,c.getReactRootEl)(h);(0,u.pushNavDestroy)((()=>{t&&d.unmountComponentAtNode(t)})),d.render((0,r.jsx)(l.PinnedMessage,(0,a._)({},e)),t)})),(0,m.tq)().setStartupHandler("VideoPinnedMessage/init",(({payload:e})=>{p({ownerId:e.data.owner_id,commentId:e.data.comment_id,canUnpin:!!e.data.can_unpin,canDelete:!!e.data.can_delete,canReport:!!e.data.can_report,text:e.data.text||"",authorId:e.data.author_id,authorName:e.data.author_name||"",authorVerified:!!e.data.author_verified,authorHref:e.data.author_href||""})}))}catch(e){}function p(e){window.initReactApplication(h,e||{})}const g={init:p}},789222:(e,t,n)=>{n.d(t,{StickerManager:()=>a});var o=n(664988),i=n(211314),s=n(653870);class a{add(e,t=!1){if(this.stickers.length>8)return;const n=new Image;n.onload=()=>{this.stickers.push({img:n,id:e,x:t?this.likeStartX:this.stickerStartX,y:t?this.startY-60:this.startY,isLike:t,startTime:Date.now()+(0,o.irand)(0,600),speed:(0,o.irand)(2,3),size:t?20:64,scale:t?2:1,opacity:t?.8:0,rotateDegree:(0,o.irand)(0,4),rotateDirection:Math.random()<.5?-1:1}),this.drawNextFrame()},n.src=t?"data:image/svg+xml; charset=utf8, "+encodeURIComponent((0,s.getIcon20LikeCircleFillRed)().icon):i.Stickers.getStickerUrl(e,((0,o.isRetina)()?128:64)+"b")}drawSticker(e){if(e.startTime>Date.now()||!this.ctx)return;if(e.isLike&&(e.scale=2),e.y<=this.startY&&e.y>=this.startY-25){const t=e.opacity+.15;if(e.opacity=Math.min(t,1),!e.isLike){const t=e.scale+.04;e.scale=Math.min(t,1)}}else if(e.y>=this.endY&&e.y<=this.endY+25){const t=e.opacity-.15;e.opacity=Math.max(t,0)}const t=e.size*e.scale,n=1===e.scale?e.x:e.x+(e.size-t)/2;e.rotateDegree+=.1*e.rotateDirection,e.rotateDegree<0?(e.rotateDegree=0,e.rotateDirection*=-1):e.rotateDegree>4&&(e.rotateDegree=4,e.rotateDirection*=-1),e.y-=e.speed,this.ctx&&(this.ctx.globalAlpha=e.opacity),this.ctx.setTransform(e.scale,0,0,e.scale,n,e.y),this.ctx.rotate(e.rotateDegree*Math.PI/180),this.ctx.drawImage(e.img,n,e.y),this.ctx&&(this.ctx.globalAlpha=1)}drawNextFrame(){this.isRendering||(this.isRendering=!0,this.rAF=requestAnimationFrame(this.animate))}destroy(){this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null)}constructor(e){this.stickers=[],this.endY=32,this.isRendering=!1,this.scaleRatio=1,this.animate=()=>{this.ctx&&(this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvasWidth*this.scaleRatio,this.canvasHeight*this.scaleRatio),this.stickers=this.stickers.filter((e=>e.y>this.endY)),this.stickers.forEach((e=>{this.drawSticker(e)})),this.isRendering=!1,this.stickers.some((e=>e.y>this.endY))?this.drawNextFrame():(this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvasWidth*this.scaleRatio,this.canvasHeight*this.scaleRatio)))},this.ctx=e.getContext("2d"),this.canvasWidth=e.width,this.canvasHeight=e.height,this.stickerStartX=(this.canvasWidth-64)/2,this.likeStartX=this.canvasWidth-20-20,this.startY=this.canvasHeight-64,this.ctx&&(0,o.isRetina)()&&(this.scaleRatio=window.devicePixelRatio||1,this.ctx.canvas.width=this.canvasWidth*this.scaleRatio,this.ctx.canvas.height=this.canvasHeight*this.scaleRatio,this.ctx.canvas.style.width=`${this.canvasWidth}px`,this.ctx.canvas.style.height=`${this.canvasHeight}px`,this.ctx.scale(this.scaleRatio,this.scaleRatio))}}},786006:(e,t,n)=>{n.d(t,{PinnedMessage:()=>g});var o=n(785893),i=n(667294),s=n(600820),a=n(20403),r=n(742783),l=n(629932),c=n(86894),d=n(797074),m=n(659397),u=n(108705),h=n(82161),p=n(821103);const g=({ownerId:e,commentId:t,text:n,authorId:g,authorName:f,authorHref:_,authorVerified:v=!1,canUnpin:w,canDelete:y,canReport:S})=>{const M=(0,i.useRef)(null),[E,k]=(0,i.useState)(!1),C=(0,m.debounce)((()=>!E&&M.current?k(!0):null),500),b=g===e;if((0,i.useEffect)((()=>{const e=document.querySelector("#mv_chat_messages_wrap .ui_scroll_content");var n;e&&(e.style.paddingTop=t?`${(null==(n=M.current)?void 0:n.offsetHeight)||0}px`:"0")}),[t,M,E]),(0,i.useEffect)((()=>{var e,t;return null==(t=window.VideoChat)||null==(e=t.scroll)||e.scroller.addEventListener("scroll",C),()=>{var e,t;null==(t=window.VideoChat)||null==(e=t.scroll)||e.scroller.removeEventListener("scroll",C)}}),[]),!t)return null;const x=(0,o.jsxs)("a",{href:_,target:"_blank",onClick:e=>e.stopPropagation(),className:(0,m.classNames)(d.default.author,{[d.default.authorWithBackground]:b,[d.default.authorWithoutMargin]:b&&E}),children:[f,v&&(0,o.jsx)(s.Icon12VerifiedAlt,{}),b&&(0,o.jsx)(a.Icon12Favorite,{})]}),T=(0,h.getTemplate)("video_chat_pinned_message_actions_menu",{owner_id:e,comment_id:t,show_delete:!!y,show_report:!!S,show_unpin:!!w,show_hide:!w});return(0,o.jsx)("div",{id:`pinned_message${(0,u.joinFullId)(e,t)}`,className:d.default.wrapper,onClick:()=>{E||k(!0);const n=(0,p.getMsgElement)(e,t);n&&(window.VideoChat.scroll.scrollIntoView(n),n.classList.add("mv_chat_message_selected"),setTimeout((()=>{n.classList.remove("mv_chat_message_selected")}),1e3))},ref:M,children:(0,o.jsxs)("div",{className:d.default.container,children:[(0,o.jsx)(r.Icon16Pin,{className:d.default.pinIcon}),(0,o.jsx)("div",{className:d.default.comment,children:(0,o.jsxs)(c.Footnote,{weight:"2",children:[!E&&x,(0,o.jsxs)(l.TextClamp,{lines:E?1:5,children:[E&&x,(0,o.jsx)("span",{dangerouslySetInnerHTML:{__html:n}})]})]})}),(0,o.jsx)("div",{className:d.default.moreAction,dangerouslySetInnerHTML:{__html:T},onClick:e=>e.stopPropagation()})]})})}},918956:(e,t,n)=>{n.d(t,{VideoChat:()=>_});var o=n(785893),i=n(667294),s=n(906811),a=n(540246),r=n(354768),l=n(869048),c=n(331533),d=n(659397),m=n(86894),u=n(952464),h=n(29271),p=n(66450),g=n(338448),f=n(968986);const _=({messages:e})=>{const[t,n]=(0,i.useState)((0,d.decodeHTMLEntitiesDeep)(e)),[_,v]=(0,i.useState)(!1),[w,y]=(0,i.useState)(!1),S=(0,i.useRef)(null),M=e=>{e.scrollToIndex(1e3,{align:"end",behavior:"auto"}),y(!1),v(!1)},E=(0,s.useVirtualizer)({count:t.length,estimateSize:()=>36,getScrollElement:()=>S.current,onChange:e=>{const{isScrolling:t,scrollDirection:n,getTotalSize:o,scrollElement:i}=e;if(!i)return;const s=o(),a=i.clientHeight+i.scrollTop+30<s;w&&a&&window.VideoChat.toggleScrollBottomBtn(!0),t&&"backward"===n&&i.clientHeight+i.scrollTop!==s?v(!0):(i.clientHeight+i.scrollTop===s&&(v(!1),y(!1),window.VideoChat.toggleScrollBottomBtn(!1)),_||M(E))}});if((0,i.useEffect)((()=>{const e=e=>{const{eventType:o}=e.detail;switch(o){case p.CustomEventType.NEW_MESSAGES:const o=(0,d.decodeHTMLEntitiesDeep)(e.detail.data);n((e=>{let t=[...e,...o];t=(0,f.removeDuplicateById)(t);const n=Math.max(t.length-50,0);return n>0&&(t=t.slice(n)),t})),y(!0);break;case p.CustomEventType.DELETE_MESSAGE:const i=e.detail.data,s=t.findIndex((e=>e.id===i));if(-1!==s){let e=t;e.splice(s,1),n(e),_||M(E)}break;case p.CustomEventType.SCROLL_BOTTOM:M(E)}};return window.addEventListener(p.CustomEventName,e),()=>{window.removeEventListener(p.CustomEventName,e)}}),[t,_]),(0,i.useEffect)((()=>{t.length&&M(E)}),[]),!t.length)return(0,o.jsxs)("div",{className:"mv_chat_first_message_intro",children:[(0,o.jsx)(a.Icon56CommentsOutline,{}),h.getLang("video_first_message_intro")]});const k=E.getVirtualItems();return(0,o.jsx)(l.AppRootProvider,{children:(0,o.jsx)(m.CustomScrollView,{boxRef:S,className:u.default.scroll,children:(0,o.jsx)("div",{className:u.default.in,style:{height:E.getTotalSize()},children:(0,o.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${k[0].start}px)`},children:k.map((({key:e,index:n})=>{const{owner_href:i,owner_name:s,photo_url:a,is_verified:l,text:d,can_delete:m,can_report:u,can_pin:h}=t[n];return(0,o.jsxs)("div",{"data-index":n,ref:E.measureElement,className:"mv_chat_message",children:[(0,o.jsx)("a",{className:"mv_chat_message_author_thumb",href:i,target:"_blank",children:(0,o.jsx)("img",{loading:"lazy",className:"mv_chat_message_author_thumb_img",src:a})}),(0,o.jsxs)("div",{className:"mv_chat_message_content",children:[(0,o.jsxs)("a",{className:"mv_chat_message_author_name",href:i,target:"_blank",children:[s,l&&(0,o.jsx)("div",{className:"mv_page_verified",children:(0,o.jsx)(r.Icon12Verified,{})})]}),(0,o.jsx)(c.InnerHTML,{className:"mv_chat_message_text",Component:"div",children:d})]}),(m||h||u)&&(0,o.jsx)(g.VideoChatMessageActions,{message:t[n]})]},e)}))})})})})}},338448:(e,t,n)=>{n.d(t,{VideoChatMessageActions:()=>r});var o=n(785893),i=n(385228),s=n(29271),a=n(384627);const r=({message:e})=>{const{id:t,owner_id:n,author_id:r,owner_href:l,owner_name:c,is_verified:d,text:m,can_delete:u,can_report:h,can_pin:p,action_hash:g}=e;return(0,o.jsx)("div",{className:"mv_chat_message_actions",children:(0,o.jsx)(a.DropdownActionSheet,{placement:"bottom-start",content:(0,o.jsxs)(o.Fragment,{children:[p&&(0,o.jsx)(a.DropdownActionSheet.Item,{onClick:()=>{window.VideoChat.pinMessage(n,r,c,l,d,t,u,h,m)},children:s.getLang("video_pin_message")}),u&&(0,o.jsx)(a.DropdownActionSheet.Item,{onClick:()=>{window.VideoChat.deleteMessage(`${n}_${t}`,g)},children:s.getLang("global_delete")}),h&&(0,o.jsx)(a.DropdownActionSheet.Item,{onClick:()=>{window.VideoChat.showReportVideoChatCommentForm(n,t)},children:s.getLang("global_report_spam")})]}),children:(0,o.jsx)("div",{className:"mv_chat_message_action",children:(0,o.jsx)(i.Icon20More,{})})})})}},66450:(e,t,n)=>{n.d(t,{CustomEventName:()=>o,CustomEventType:()=>i});const o="VideoCustomEvent/CHAT_UPDATE";var i;!function(e){e.NEW_MESSAGES="NEW_MESSAGES",e.DELETE_MESSAGE="DELETE_MESSAGE",e.SCROLL_BOTTOM="SCROLL_BOTTOM"}(i||(i={}))},821103:(e,t,n)=>{n.d(t,{getMsgElement:()=>o});const o=(e,t)=>document.querySelector(`#mv_chat_msg${e}_${t}`)},618337:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 9.59 2.96 8.04a1 1 0 0 0-1.42 1.42L3.8 11.7a1 1 0 0 0 1.42 0l5.25-5.25a1 1 0 0 0-1.42-1.42z" fill="currentColor"/></svg>',name:"verified_12"}}n.d(t,{getIcon12Verified:()=>o})},653870:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><linearGradient id="like_circle_fill_red_20__a" gradientUnits="userSpaceOnUse" x1="-10" x2="10" y1="10" y2="30"><stop offset="0" stop-color="#ff5263"/><stop offset="1" stop-color="#ff3347"/></linearGradient><path d="M0 10a10 10 0 1 1 20 0 10 10 0 0 1-20 0z" fill="url(#like_circle_fill_red_20__a)"/><path d="M12.2 6.5c1.55 0 2.8 1.2 2.8 2.7 0 1.5-.63 2.24-3.28 4.23l-1.2.9a.86.86 0 0 1-1.03 0l-1.21-.9C5.63 11.44 5 10.69 5 9.19 5 7.7 6.25 6.5 7.8 6.5c.83 0 1.55.4 2.2 1.15.65-.75 1.37-1.15 2.2-1.15z" fill="#fff"/></svg>',name:"like_circle_fill_red_20"}}n.d(t,{getIcon20LikeCircleFillRed:()=>o})},211314:(e,t,n)=>{n.d(t,{Stickers:()=>s});var o=n(68003),i=n(404145);const s={getStickerUrl:function(e,t){let n=String(t);if(o.colorScheme.isDarkScheme()&&(n=n.replace(/b$/,"")+"b"),window.Emoji){var s,a,r;const t=null==(r=Emoji.stickersById)||null==(a=r[e])||null==(s=a.sticker[Emoji.STICKER_FIELD_IMAGES])?void 0:s[n];if(t)return t}const l={id:e,size:n};if((0,i.isMvk)()){if(window.stickers_cache){const t=window.stickers_cache.getStickerImage(e,n);if(t)return t}return window.store.stickers&&window.rs(window.store.stickers.url_template,{id:e,size:n})}return window.getTemplate("stickers_sticker_url",l)}}},809915:(e,t,n)=>{n.d(t,{VideoChat:()=>E});var o=n(795558),i=n(664988),s=n(96756),a=n(953908),r=n(82161),l=n(320422),c=n(40256),d=n(965109),m=n(29271),u=n(137363),h=n(618337),p=n(599809),g=n(839470),f=n(667794),_=n(821103),v=n(931917),w=n(789222),y=n(270241),S=n(66450),M=n(75272);const E={SCROLL_EDGE_BELOW_THRESHOLD:20,MAX_COMMENTS_NUM:(0,g.partConfigEnabled)("video_show_less_msg_in_live")?50:150,MAX_LIKES_PER_BATCH:5,MAX_STICKERS_PER_BATCH:5,init(e,t){E.block&&E.destroy(),e&&(E.block=e,E.options=(0,r.extend)({},t),E.messagesWrap=(0,o.domByClass)(e,"mv_chat_messages_wrap"),E.stickersWrap=(0,o.domByClass)(e,"mv_chat_stickers_wrap"),t.chatRefactoring?(y.VideoChatComponent.init({messages:t.messageData}),this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches):E.scroll=new uiScroll((0,o.domFC)(E.messagesWrap),{global:!0,hidden:t.scrollHidden,reversed:!0,preserveEdgeBelow:!0,preserveEdgeBelowThreshold:E.SCROLL_EDGE_BELOW_THRESHOLD,theme:"videoview",onupdate:E.onScrollUpdate}),this.scrollBottomBtnWrap=(0,o.domByClass)(e,"mv_chat_new_messages_btn_wrap"),E.replyForm=(0,o.domByClass)(e,"mv_chat_reply_form"),E.replyForm&&(E.replyInput=(0,o.domByClass)(e,"mv_chat_reply_input"),E.initReplyInput()),E.firstMsgIntro=(0,o.domByClass)(e,"mv_chat_first_message_intro"))},initReplyInput(){(0,s.placeholderInit)(E.replyInput,{editable:!0,global:!0}),window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){const e=Emoji.init(E.replyInput,{forceStickerPack:E.options.forceStickerPack,controlsCont:E.replyForm,noLineBreaks:1,noCtrlSend:1,noStickers:!!E.options.noStickers,ref:"video_chat",onSend:function(){E.sendMessage()},checkEditable:function(){E.checkFormHeight(),E.checkTextLen()},onStickerSend:function(e){E.sendSticker(e)}});(0,o.data)(E.replyForm,"optId",e)}))},checkFormHeight(){const e=E.replyForm,t=e.offsetHeight;if(e.lastHeight===t)return;if(e.lastHeight=t,(0,o.setStyle)(E.messagesWrap,{bottom:t+"px"}),E.options.chatRefactoring)return;!E.scroll.data.scrollBottom&&E.scroll.scrollBottom()},checkTextLen(e=E.replyInput){const t=(0,r.trim)(Emoji.editableVal(e));if(e.lastLen===t.length)return;if((e.lastLen=t.length)>mvcur.maxChatReplyLength){const t=cur.storyLayer?m.getLang("stories_live_chat_msg_too_long"):m.getLang("video_live_chat_msg_too_long");(0,l.showTooltip)(e,{black:1,text:t,shift:!!cur.storyLayer&&[-30,10]})}else window.tooltips&&tooltips.destroy(e)},stickerClick:(e,t,n)=>(window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.clickSticker(e,t,n)})),!1),onScrollUpdate(e){E.options.chatRefactoring||e.data.scrollBottom<E.SCROLL_EDGE_BELOW_THRESHOLD&&E.toggleScrollBottomBtn(!1)},getMessageAccessFlags(e,t){const{adminLevel:n,canDeleteComments:o,canPinComments:i}=Videoview.getMvData(),s=n>u.GroupAdminLevel.USER;let a=!1;window.replyAsList&&window.replyAsList.length&&(a=window.replyAsList.some((e=>e[0]===t)));return{canDeleteComment:s||!!o||e==vk.id||t==vk.id||a,canReportComment:e!=t&&t!=vk.id&&!a,canPinComment:!!i}},receiveMessage(e,t,n,o,i,s,a,l,c,d,m){if((0,r.intval)(c))return void E.appendSticker(c,n);const{canDeleteComment:u,canReportComment:p,canPinComment:f}=E.getMessageAccessFlags(e,n);if(E.options.chatRefactoring)return void E.appendMessageRefactoring({id:t,owner_id:Number(e),text:l,owner_href:s,photo_url:i,is_verified:m,owner_name:o,can_delete:!!u,can_report:!!p,can_pin:!!f,action_hash:E.options.chatActionHash});let _="";(0,g.partConfigEnabled)("video_live_pinned_message")&&f?_+=(0,r.getTemplate)("video_chat_message_actions_menu",{owner_id:e,author_id:n,author_name:o,author_href:s,author_verified:!!m,comment_id:t,show_delete:!!u,show_report:!!p}):(p&&(_+=(0,r.getTemplate)("video_chat_message_action_report",{video_owner_id:e,msg_id:t})),u&&(_+=(0,r.getTemplate)("video_chat_message_action_del",{video_owner_id:e,msg_id:t})));let v=o;m&&(v+='<div class="mv_page_verified">'+(0,h.getIcon12Verified)().icon+"</div>");const w=(0,r.getTemplate)("video_chat_message",{author_href:s,author_photo:i,author_name:v,message:l,video_owner_id:e,msg_id:t,actions:_,classes:n==e?"mv_chat_admin_message":""});E.appendMessage(w,t)},receiveDelete(e,t){if(E.options.chatRefactoring)return void E.sendCustomEvent(S.CustomEventType.DELETE_MESSAGE,t);const n="#mv_chat_msg"+mvcur.mvData.oid+"_"+t;let i=E._messagesBatch&&E._messagesBatch.querySelector(n);i?i.remove():(i=E.messagesWrap.querySelector(n),i&&!(0,o.hasClass)(i,"_deleted")&&E.scroll.updateBelow((function(){i.remove()})))},checkStickerFlood(e,t){const n=mvcur.queueBatchId;E._stickersLimits&&E._stickersLimits.batch==n||(E._stickersLimits={batch:n,like:0,sticker:0},E._stickersDelay=0);const o="like"==e?"like":"sticker",i="like"==o?E.MAX_LIKES_PER_BATCH:E.MAX_STICKERS_PER_BATCH;return!(++E._stickersLimits[o]>i&&t!=vk.id)},appendSticker(e,t,n=!0){if(!E.isHidden()&&!Videoview.isFS&&"hidden"!=document.visibilityState&&"animation"in document.body.style&&"onanimationend"in window&&!this.prefersReducedMotion){if(t==vk.id){const t=E.recentlySentSticker;if(t&&t.stickerId==e&&t.fromQueue!=n&&Date.now()-t.time<3e3)return;E.recentlySentSticker={stickerId:e,fromQueue:n,time:Date.now()}}else if(!E.checkStickerFlood(e,t))return;if(E.options.stickerRefactoring){if(!E.stickersCanvasWrap){const e=document.createElement("canvas");e.width=100,e.height=320,e.classList.add("mv_chat_stickers_wrap");const t=document.querySelector(".videoplayer");t&&(t.append(e),E.stickersCanvasWrap=e)}return E.stickerManager=E.stickerManager||new w.StickerManager(E.stickersCanvasWrap),void E.stickerManager.add(e,"like"==e)}if("like"==e){const e=(0,o.ce)("div",{className:"mv_chat_like"});s(e),(0,a.addEvent)(e,"animationend",c),l(e)}else{const t=(0,o.ce)("img",{className:"mv_chat_sticker",src:Stickers.getStickerUrl(e,((0,i.isRetina)()?128:64)+"b")});s(t),(0,a.addEvent)(t,"error animationend",c),(0,a.addEvent)(t,"load",l)}}function s(e){let n="",s=0,a=0,l=0,c=(0,r.intval)((E.getHeight()-80)/6);for(let e=0;e<=100;e+=20){e>0&&(s+=(0,i.irand)(-4,4),a-=c,l+=(0,i.irand)(-4,4),c=(0,r.intval)(.9*c));n+=`\n          ${e}% {\n            transform: translate(${s}px, ${a}px) rotate(${l}deg) scale(${e?1:.7});\n            opacity: ${0==e||100==e?0:1};\n          }\n        `}const d="mv_chat_sticker_animation_"+Date.now()+"_"+(0,i.irand)(0,1e9);n=`@keyframes ${d} {${n}}`,e.appendChild((0,o.ce)("style",{innerHTML:n}));const m=(0,i.irand)(1500,2500)+"ms",u=(t==vk.id?0:E._stickersDelay+=100)+"ms";(0,o.setStyle)(e,{animation:[d,m,u,"linear"].join(" ")})}function l(e){const t=e.currentTarget||e;(E._stickersBatch||(E._stickersBatch=document.createDocumentFragment())).appendChild(t),E._appendStickerTimeout||(E._appendStickerTimeout=setTimeout((function(){E.appendStickersBatch(),E._appendStickerTimeout=null}),0))}function c(e){const t=e.currentTarget||e;(0,a.removeEvent)(t),t.remove()}},appendStickersBatch(){var e;const t=E._stickersBatch;if(t&&(E._stickersBatch=null,!E.isHidden())){if(!E.stickersWrap){const e=document.createElement("div");e.classList.add("mv_chat_stickers_wrap");const t=document.querySelector(".videoplayer");t&&(t.append(e),E.stickersWrap=e)}null==(e=E.stickersWrap)||e.appendChild(t)}},removeStickers(){if(E.stickersWrap)for(let e;e=(0,o.domFC)(E.stickersWrap);)(0,a.removeEvent)(e),e.remove()},appendMessageRefactoring(e){E.isHidden()||window.Videoview.isFS||"hidden"===document.visibilityState||(E._messagesBatchData=E._messagesBatchData||[],E._messagesBatchData.push(e),E._messagesBatchData.length>E.MAX_COMMENTS_NUM&&(E._messagesBatchData=E._messagesBatchData.slice(Math.max(E._messagesBatchData.length-E.MAX_COMMENTS_NUM,0))),E._appendMessageTimeout||(E._appendMessageTimeout=setTimeout((()=>{E.sendCustomEvent(S.CustomEventType.NEW_MESSAGES,E._messagesBatchData),E._messagesBatchData=[],E._appendMessageTimeout=null}),0)))},sendCustomEvent(e,t={}){window.dispatchEvent(new CustomEvent(S.CustomEventName,{detail:{eventType:e,data:t}}))},appendMessage(e,t){const n=E._messagesBatch||(E._messagesBatch=document.createDocumentFragment()),o="#mv_chat_msg"+mvcur.mvData.oid+"_"+t;if(E.messagesWrap.querySelector(o)||n.querySelector(o))return;const i=(0,M.createElementFromHTML)(e);[...i.querySelectorAll(".mv_chat_message_show_action_false")].forEach((e=>{e.parentNode.removeChild(e)})),n.appendChild(i);const s=n.childNodes;for(;n.childNodes.length>E.MAX_COMMENTS_NUM;)s[0].remove();E.isHidden()||E._appendMessageTimeout||(E._appendMessageTimeout=setTimeout((function(){E.appendMessagesBatch(),E._appendMessageTimeout=null}),0))},appendMessagesBatch(){if(E.isHidden()||window.Videoview.isFS||"hidden"===document.visibilityState)return;const e=E._messagesBatch;if(!e)return;if(E._messagesBatch=null,E.firstMsgIntro&&(E.firstMsgIntro.remove(),E.firstMsgIntro=null),E.options.chatRefactoring)return;const t=E.scroll.content,n=t.childNodes;let o=t.childNodes.length+e.children.length-E.MAX_COMMENTS_NUM;if(n.length&&o>0)for(;o>0;)n[0].remove(),o--;E.scroll.updateBelow((function(){t.appendChild(e)})),E.scroll.data.scrollBottom>100&&E.toggleScrollBottomBtn(!0)},toggleScrollBottomBtn(e){(0,o.toggleClass)(this.scrollBottomBtnWrap,"hidden",!e)},scrollBottom(){if(E.options.chatRefactoring)return window.VideoChat.sendCustomEvent(S.CustomEventType.SCROLL_BOTTOM),void window.VideoChat.toggleScrollBottomBtn(!1);E.scroll.scrollBottom(0)},replyAsAnimate(e,t,n){const i=e&&(0,o.geByClass1)("mv_chat_reply_author_photo",e),s=i&&(0,o.geByClass)("mv_chat_reply_author_photo_img",i),a=(0,o.hasClass)(e,"mv_chat_author_secondary")?0:1;s&&s[a]&&(s[a].src=n),(0,o.toggleClass)(e,"mv_chat_author_secondary")},replyAsGroup(e,t){window.replyAsList?E.replyAsGroupTT(e,t):(window.replyAsList=[],window.replyAsData={},(0,o.domData)(e,"can_reply_as_any_group")?ajax.post("/al_groups.php?act=get_editor_clubs",{},{cache:1,onDone:function(n){window.replyAsList=n,(0,r.each)(n,(function(e,[t,n,o,i]){window.replyAsData[t]=this})),E.replyAsGroupTT(e,t)}}):E.replyAsGroupTT(e,t))},replyAsGroupList(e,t,n){const i=[n];let s=(0,o.domByClass)(e,"mv_chat_reply_group_data");if(s){let e=[(0,o.domData)(s,"group_id"),(0,o.domData)(s,"group_photo"),(0,o.domData)(s,"group_href"),(0,o.domData)(s,"group_name")];i.push(e),window.replyAsData[e[0]]=e}return(0,r.each)(window.replyAsList,(function(e,[n,o,s,a]){n!=t&&i.push(this)})),i},replyAsGroupOver(e){const t=(0,o.gpeByClass)("mv_chat_reply_form",e);(0,l.showTooltip)(e,{text:function(){return(0,o.domData)(t,"from-oid")<0?m.getLang("global_on_behalf_group"):m.getLang("global_on_behalf_me")},black:1,shift:[9,8,8]})},replyAsGroupTT(e,t){const n=E.replyAsProfileData(),i=(0,o.gpeByClass)("mv_chat_reply_form",e),s=i&&(0,o.domData)(i,"from-oid");let l=(0,o.data)(e,"tt");if(!n)return!1;if(!l){const i=E.replyAsGroupList(e,t,n);let c="";(0,r.each)(i,(function(e,[t,n,o,i]){c+=(0,r.getTemplate)("video_chat_message_author_select_row",{author_id:t,author_href:o,author_photo:n,author_name:i,classes:s==t?" active":""})})),l=new ElementTooltip(e,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+c+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"top",offset:function(){return[0,-5]},onFirstTimeShow:function(t){const n=(0,o.geByClass)("post_from_tt_row",t);(0,r.each)(n,(function(t,n){(0,a.addEvent)(n,"click",E.setReplyAsGroup.pbind(e,{from:(0,o.domData)(this,"from-oid")}))})),this.rows=n,this.scroll=new uiScroll((0,o.geByClass1)("_post_scroll_wrap",t)),setTimeout((function(){l.scroll.update(),l.updatePosition()}),0)},onShow:function(e){setTimeout((function(){if(!l.scroll)return;const t=(0,o.geByClass1)("active",e),n=t?t.offsetTop-(l.scroll.data.viewportHeight-(0,o.getSize)(t)[1])/2:0;l.scroll.scrollTop(n)}),0)},onHide:function(e){}}),(0,o.data)(e,"tt",l)}t&&l.isShown()&&E.setReplyAsGroup(e,{from:s==vk.id?t:vk.id}),e.tt&&e.tt.hide&&e.tt.hide(),l.isShown()||l.show()},replyAsProfileData:()=>window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData,setReplyAsGroup(e,t){if(!e)return!1;const n=(0,o.domClosest)("mv_chat_reply_form",e),i=(0,o.data)(e,"tt"),s=t.from||(t.fromGroup?cur.oid:vk.id),a=s==vk.id?E.replyAsProfileData():window.replyAsData&&window.replyAsData[s];return!((0,o.domData)(n,"from-oid")==s||!a||a[0]!=s)&&((0,o.domData)(n,"from-oid",s),E.replyAsAnimate(n,a[2],a[1]),i&&i.rows&&(0,r.each)(i.rows,(function(){(0,o.toggleClass)(this,"active",(0,o.domData)(this,"from-oid")==s)})),e.setAttribute("aria-label",v.Ranges.isGroupId(s)?m.getLang("wall_reply_as_group"):m.getLang("wall_reply_as_user")),!1)},sendMessage(){if(E.messageSending)return;const e={Message:(0,r.trim)(Emoji.val(E.replyInput))};if(!e.Message)return void(0,o.elfocus)(E.replyInput);if(Date.now()-E.lastMsgSent<1e3)return window.tooltips&&tooltips.destroy(E.replyInput),void(0,l.showTooltip)(E.replyInput,{text:m.getLang("video_live_chat_too_fast"),black:1});const t=Videoview.getMvData(),n=(0,o.geByClass1)("mv_chat_reply_form",this.block);n&&(0,o.domData)(n,"from-oid")&&(e.from_oid=(0,o.domData)(n,"from-oid")),ajax.post("al_video.php?act=post_comment",(0,r.extend)(e,{video:t.videoRaw,hash:t.hash,videoviewer_chat:1,item_access_hash:mvcur.mvData.itemAccessHash}),{onDone:function(e,t,n){var o;E.messageSending=!1,E.options.chatRefactoring&&(null==(o=n)?void 0:o[0])?E.appendMessageRefactoring(n[0]):e&&t&&E.appendMessage(e,t),Emoji.val(E.replyInput,""),E.checkFormHeight(),E.options.chatRefactoring||E.scroll.data.scrollBottom&&E.scrollBottom(),E.lastMsgSent=Date.now(),mvcur.player&&mvcur.player.vars.stats_tmr&&(0,c.tmrTrackCustomGoal)("comment_in_sport_broadcast")},onFail:function(e){if(E.messageSending=!1,E.replyInput)return window.tooltips&&tooltips.destroy(E.replyInput),(0,l.showTooltip)(E.replyInput,{text:e,showdt:200,forcetodown:0,slide:15,black:1}),(0,o.elfocus)(E.replyInput),!0}}),E.messageSending=!0},sendSticker(e){const t=Videoview.getMvData();ajax.post("al_video.php?act=live_send_sticker",{sticker_id:e,owner_id:t.oid,video_id:t.vid,hash:t.hash,item_access_hash:mvcur.mvData.itemAccessHash},{onDone(){E.appendSticker(e,vk.id,!1)}})},showActionsMenu(e,t){var n;(null==(n=(0,_.getMsgElement)(e,t))?void 0:n.querySelector(".mv_chat_message_actions")).style.visibility="visible"},hideActionsMenu(e,t){var n;(null==(n=(0,_.getMsgElement)(e,t))?void 0:n.querySelector(".mv_chat_message_actions")).style.visibility=""},hidePinnedMessage(){f.PinnedMessageComponent.init()},showPinnedMessage(e,t,n,o,i,s,a=!1,r=!1,l=!1,c=""){if(!c){var d,m;c=null==(m=null==(d=(0,_.getMsgElement)(e,s))?void 0:d.querySelector(".mv_chat_message_text"))?void 0:m.innerHTML}f.PinnedMessageComponent.init({ownerId:e,commentId:s,text:c||"",authorId:t,authorName:n,authorHref:o,authorVerified:i,canUnpin:a,canDelete:r,canReport:l})},deleteMessage(e,t){let n;if(!E.options.chatRefactoring){if(n=document.querySelector(`#mv_chat_msg${e}`),!n)return;n.classList.add("_deleted")}ajax.post("al_video.php?act=delete_comment",{comment:e,hash:t,videoview_chat:1},{onDone(t){if(E.options.chatRefactoring){const[,t]=e.split("_");t&&E.sendCustomEvent(S.CustomEventType.DELETE_MESSAGE,t)}else if(n){n.classList.add("_show_deleted_stub");const e=n.querySelector(".mv_chat_message_content");e&&(e.innerHTML=t)}document.querySelector(`#pinned_message${e}`)&&E.hidePinnedMessage()}})},showReportVideoChatCommentForm(e,t){(0,d.showReportForm)("video_comment",e,t,(()=>{const n=(0,_.getMsgElement)(e,t);n&&(n.classList.add("_deleted"),n.classList.add("_show_deleted_stub"),(0,o.val)((0,o.domByClass)(n,"mv_chat_message_content"),m.getLang("global_report_sent")))}))},pinMessage(e,t,n,o,i,s,a,r,l){(0,p.api)("video.pinComment",{owner_id:e,comment_id:s}).then((()=>{E.showPinnedMessage(e,t,n,o,i,s,!0,a,r,l)}))},unpinMessage(e,t){(0,p.api)("video.unpinComment",{owner_id:e,comment_id:t}).then((()=>{E.hidePinnedMessage()}))},isHidden(){return!!this.hidden||Videoview.isMinimized()},setHidden(e){this.hidden=e},toggle(){const e=E.isHidden();this.setHidden(!e),E.toggleStateClasses(),e&&E.scroll&&(E.appendMessagesBatch(),E.updateScroll()),e||E.removeStickers(),e&&window.Videoview.queueReconnect()},onFullscreenChange(e){window.VideoChat.onResize(),window.VideoChat.updateScroll(),e||window.Videoview.queueReconnect()},toggleStateClasses(){const e=!!this.block,t=E.isHidden(),n=Videoview.isMinimized();(0,o.toggleClass)("mv_box","_has_chat",e&&!n),(0,o.toggleClass)("mv_box","_hide_chat",e&&!n&&t);let i="";e&&(E.appendMessagesBatch(),i=t?m.getLang("video_aria_expand_chat"):m.getLang("video_aria_minimize_chat"));(0,o.ge)("mv_top_pl_toggle")&&(0,o.attr)("mv_top_pl_toggle","aria-label",i)},updateScroll(){E.options.chatRefactoring||(E.scroll.update(),E.scroll.scrollBottom(),E.toggleScrollBottomBtn(!1))},onResize(){E.block&&(E._chatHeight=E.block.offsetHeight)},getHeight:()=>E.block?E._chatHeight||(E._chatHeight=E.block.offsetHeight):0,destroy(){if(E.block){if(E.scroll&&(E.scroll.destroy(),E.scroll=null),E.replyForm){const e=(0,o.data)(E.replyForm,"optId");void 0!==e&&Emoji.destroy(e),(0,o.removeData)(E.replyForm),(0,o.removeData)(E.replyInput),E.replyForm=E.replyInput=null}E.removeStickers(),(0,o.removeData)(E.block),E.block.remove(),E.block=null,E.messagesWrap=null,E.stickersWrap=null,E.options.chatRefactoring&&y.VideoChatComponent.destroy(),E.options=null,clearTimeout(E._appendMessageTimeout),clearTimeout(E._appendStickerTimeout),E._appendMessageTimeout=null,E._appendStickerTimeout=null,E._messagesBatch=null,E.firstMsgIntro=null,E.messageSending=!1,E.toggleStateClasses()}}}},535727:(e,t,n)=>{n.d(t,{usePatchChildrenRef:()=>a});var o=n(667294),i=n(488543);const s=e=>"string"==typeof e.type,a=e=>{var t;const n=(0,o.isValidElement)(e)&&(s(e)?e.ref:e.props.getRootRef),a=(0,i.useExternRef)(n);return(0,o.useEffect)((()=>{a.current||console.error("Кажется, в children передан компонент, который не поддерживает свойство getRootRef. Мы не можем получить ссылку на корневой dom-элемент этого компонента")}),[null==(t=e)?void 0:t.type,a]),[a,(0,o.isValidElement)(e)?(0,o.cloneElement)(e,{[s(e)?"ref":"getRootRef"]:a}):e]}},968986:(e,t,n)=>{n.d(t,{removeDuplicateById:()=>o});const o=e=>{const t=new Set;return e.reduce(((e,n)=>{const o=n.id;return t.has(o)||e.push(n),t.add(o),e}),[])}},834347:(e,t,n)=>{function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}n.d(t,{extends:()=>o})},906811:(e,t,n)=>{n.d(t,{useVirtualizer:()=>l});var o=n(834347),i=n(667294),s=n(945032),a="undefined"!=typeof document?i.useLayoutEffect:i.useEffect;function r(e){var t=i.useReducer((function(){return{}}),{})[1],n=(0,o.extends)({},e,{onChange:function(n){t(),null==e.onChange||e.onChange(n)}}),r=i.useState((function(){return new s.Virtualizer(n)}))[0];return r.setOptions(n),i.useEffect((function(){return r._didMount()}),[]),a((function(){return r._willUpdate()})),r}function l(e){return r((0,o.extends)({observeElementRect:s.observeElementRect,observeElementOffset:s.observeElementOffset,scrollToFn:s.elementScroll},e))}},148849:(e,t,n)=>{function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}n.d(t,{extends:()=>o})},945032:(e,t,n)=>{n.d(t,{Virtualizer:()=>p,defaultRangeExtractor:()=>a,elementScroll:()=>h,observeElementOffset:()=>c,observeElementRect:()=>r,observeWindowOffset:()=>d,observeWindowRect:()=>l,windowScroll:()=>u});var o=n(148849),i=n(301257),s=function(e){return e},a=function(e){for(var t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),o=[],i=t;i<=n;i++)o.push(i);return o},r=function(e,t){var n=e.scrollElement;if(n){var o=function(e){var n=e.width,o=e.height;t({width:Math.round(n),height:Math.round(o)})};o(n.getBoundingClientRect());var i=new ResizeObserver((function(e){var t=e[0];if(null!=t&&t.borderBoxSize){var i=t.borderBoxSize[0];if(i)return void o({width:i.inlineSize,height:i.blockSize})}o(n.getBoundingClientRect())}));return i.observe(n,{box:"border-box"}),function(){i.unobserve(n)}}},l=function(e,t){var n=e.scrollElement;if(n){var o=function(){t({width:n.innerWidth,height:n.innerHeight})};return o(),n.addEventListener("resize",o,{passive:!0}),function(){n.removeEventListener("resize",o)}}},c=function(e,t){var n=e.scrollElement;if(n){var o=function(){t(n[e.options.horizontal?"scrollLeft":"scrollTop"])};return o(),n.addEventListener("scroll",o,{passive:!0}),function(){n.removeEventListener("scroll",o)}}},d=function(e,t){var n=e.scrollElement;if(n){var o=function(){t(n[e.options.horizontal?"scrollX":"scrollY"])};return o(),n.addEventListener("scroll",o,{passive:!0}),function(){n.removeEventListener("scroll",o)}}},m=function(e,t,n){if(null!=t&&t.borderBoxSize){var o=t.borderBoxSize[0];if(o)return Math.round(o[n.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[n.options.horizontal?"width":"height"])},u=function(e,t,n){var o,i,s=t.adjustments,a=void 0===s?0:s,r=t.behavior,l=e+a;null==(o=n.scrollElement)||null==o.scrollTo||o.scrollTo(((i={})[n.options.horizontal?"left":"top"]=l,i.behavior=r,i))},h=function(e,t,n){var o,i,s=t.adjustments,a=void 0===s?0:s,r=t.behavior,l=e+a;null==(o=n.scrollElement)||null==o.scrollTo||o.scrollTo(((i={})[n.options.horizontal?"left":"top"]=l,i.behavior=r,i))},p=function(e){var t,n,r=this;this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(t=null,n=function(){return t||("undefined"!=typeof ResizeObserver?t=new ResizeObserver((function(e){e.forEach((function(e){r._measureElement(e.target,e)}))})):null)},{disconnect:function(){var e;return null==(e=n())?void 0:e.disconnect()},observe:function(e){var t;return null==(t=n())?void 0:t.observe(e,{box:"border-box"})},unobserve:function(e){var t;return null==(t=n())?void 0:t.unobserve(e)}}),this.range={startIndex:0,endIndex:0},this.setOptions=function(e){Object.entries(e).forEach((function(t){var n=t[0];void 0===t[1]&&delete e[n]})),r.options=(0,o.extends)({debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:s,rangeExtractor:a,onChange:function(){},measureElement:m,initialRect:{width:0,height:0},scrollMargin:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1},e)},this.notify=function(){null==r.options.onChange||r.options.onChange(r)},this.cleanup=function(){r.unsubs.filter(Boolean).forEach((function(e){return e()})),r.unsubs=[],r.scrollElement=null},this._didMount=function(){return r.measureElementCache.forEach(r.observer.observe),function(){r.observer.disconnect(),r.cleanup()}},this._willUpdate=function(){var e=r.options.getScrollElement();r.scrollElement!==e&&(r.cleanup(),r.scrollElement=e,r._scrollToOffset(r.scrollOffset,{adjustments:void 0,behavior:void 0}),r.unsubs.push(r.options.observeElementRect(r,(function(e){var t=r.scrollRect;r.scrollRect=e,(r.options.horizontal?e.width!==t.width:e.height!==t.height)&&r.maybeNotify()}))),r.unsubs.push(r.options.observeElementOffset(r,(function(e){r.scrollAdjustments=0,r.scrollOffset!==e&&(null!==r.isScrollingTimeoutId&&(clearTimeout(r.isScrollingTimeoutId),r.isScrollingTimeoutId=null),r.isScrolling=!0,r.scrollDirection=r.scrollOffset<e?"forward":"backward",r.scrollOffset=e,r.maybeNotify(),r.isScrollingTimeoutId=setTimeout((function(){r.isScrollingTimeoutId=null,r.isScrolling=!1,r.scrollDirection=null,r.maybeNotify()}),r.options.scrollingDelay))}))))},this.getSize=function(){return r.scrollRect[r.options.horizontal?"width":"height"]},this.memoOptions=(0,i.memo)((function(){return[r.options.count,r.options.paddingStart,r.options.scrollMargin,r.options.getItemKey]}),(function(e,t,n,o){return r.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:o}}),{key:!1}),this.getFurthestMeasurement=function(e,t){for(var n=new Map,o=new Map,i=t-1;i>=0;i--){var s=e[i];if(!n.has(s.lane)){var a=o.get(s.lane);if(null==a||s.end>a.end?o.set(s.lane,s):s.end<a.end&&n.set(s.lane,!0),n.size===r.options.lanes)break}}return o.size===r.options.lanes?Array.from(o.values()).sort((function(e,t){return e.end-t.end}))[0]:void 0},this.getMeasurements=(0,i.memo)((function(){return[r.memoOptions(),r.itemSizeCache]}),(function(e,t){var n=e.count,o=e.paddingStart,i=e.scrollMargin,s=e.getItemKey,a=r.pendingMeasuredCacheIndexes.length>0?Math.min.apply(Math,r.pendingMeasuredCacheIndexes):0;r.pendingMeasuredCacheIndexes=[];for(var l=r.measurementsCache.slice(0,a),c=a;c<n;c++){var d=s(c),m=1===r.options.lanes?l[c-1]:r.getFurthestMeasurement(l,c),u=m?m.end:o+i,h=t.get(d),p="number"==typeof h?h:r.options.estimateSize(c),g=u+p,f=m?m.lane:c%r.options.lanes;l[c]={index:c,start:u,size:p,end:g,key:d,lane:f}}return r.measurementsCache=l,l}),{key:!1,debug:function(){return r.options.debug}}),this.calculateRange=(0,i.memo)((function(){return[r.getMeasurements(),r.getSize(),r.scrollOffset]}),(function(e,t,n){return r.range=function(e){var t=e.measurements,n=e.outerSize,o=e.scrollOffset,i=t.length-1,s=function(e){return t[e].start},a=g(0,i,s,o),r=a;for(;r<i&&t[r].end<o+n;)r++;return{startIndex:a,endIndex:r}}({measurements:e,outerSize:t,scrollOffset:n})}),{key:!1,debug:function(){return r.options.debug}}),this.maybeNotify=(0,i.memo)((function(){var e=r.calculateRange();return[e.startIndex,e.endIndex,r.isScrolling]}),(function(){r.notify()}),{key:!1,debug:function(){return r.options.debug},initialDeps:[this.range.startIndex,this.range.endIndex,this.isScrolling]}),this.getIndexes=(0,i.memo)((function(){return[r.options.rangeExtractor,r.calculateRange(),r.options.overscan,r.options.count]}),(function(e,t,n,i){return e((0,o.extends)({},t,{overscan:n,count:i}))}),{key:!1,debug:function(){return r.options.debug}}),this.indexFromElement=function(e){var t=r.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn("Missing attribute name '"+t+"={index}' on measured element."),-1)},this._measureElement=function(e,t){var n,o=r.indexFromElement(e),i=r.measurementsCache[o];if(i){var s=r.measureElementCache.get(i.key);if(!e.isConnected)return r.observer.unobserve(e),void(e===s&&r.measureElementCache.delete(i.key));s!==e&&(s&&r.observer.unobserve(s),r.observer.observe(e),r.measureElementCache.set(i.key,e));var a=r.options.measureElement(e,t,r),l=a-(null!=(n=r.itemSizeCache.get(i.key))?n:i.size);0!==l&&(i.start<r.scrollOffset&&r._scrollToOffset(r.scrollOffset,{adjustments:r.scrollAdjustments+=l,behavior:void 0}),r.pendingMeasuredCacheIndexes.push(o),r.itemSizeCache=new Map(r.itemSizeCache.set(i.key,a)),r.notify())}},this.measureElement=function(e){e&&r._measureElement(e,void 0)},this.getVirtualItems=(0,i.memo)((function(){return[r.getIndexes(),r.getMeasurements()]}),(function(e,t){for(var n=[],o=0,i=e.length;o<i;o++){var s=t[e[o]];n.push(s)}return n}),{key:!1,debug:function(){return r.options.debug}}),this.getVirtualItemForOffset=function(e){var t=r.getMeasurements();return(0,i.notUndefined)(t[g(0,t.length-1,(function(e){return(0,i.notUndefined)(t[e]).start}),e)])},this.getOffsetForAlignment=function(e,t){var n=r.getSize();"auto"===t&&(t=e<=r.scrollOffset?"start":e>=r.scrollOffset+n?"end":"start"),"start"===t||("end"===t?e-=n:"center"===t&&(e-=n/2));var o=r.options.horizontal?"scrollWidth":"scrollHeight",i=(r.scrollElement?"document"in r.scrollElement?r.scrollElement.document.documentElement[o]:r.scrollElement[o]:0)-r.getSize();return Math.max(Math.min(i,e),0)},this.getOffsetForIndex=function(e,t){void 0===t&&(t="auto"),e=Math.max(0,Math.min(e,r.options.count-1));var n=(0,i.notUndefined)(r.getMeasurements()[e]);if("auto"===t)if(n.end>=r.scrollOffset+r.getSize()-r.options.scrollPaddingEnd)t="end";else{if(!(n.start<=r.scrollOffset+r.options.scrollPaddingStart))return[r.scrollOffset,t];t="start"}var o="end"===t?n.end+r.options.scrollPaddingEnd:n.start-r.options.scrollPaddingStart;return[r.getOffsetForAlignment(o,t),t]},this.isDynamicMode=function(){return r.measureElementCache.size>0},this.cancelScrollToIndex=function(){null!==r.scrollToIndexTimeoutId&&(clearTimeout(r.scrollToIndexTimeoutId),r.scrollToIndexTimeoutId=null)},this.scrollToOffset=function(e,t){var n=void 0===t?{}:t,o=n.align,i=void 0===o?"start":o,s=n.behavior;r.cancelScrollToIndex(),"smooth"===s&&r.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r._scrollToOffset(r.getOffsetForAlignment(e,i),{adjustments:void 0,behavior:s})},this.scrollToIndex=function(e,t){var n=void 0===t?{}:t,o=n.align,s=void 0===o?"auto":o,a=n.behavior;e=Math.max(0,Math.min(e,r.options.count-1)),r.cancelScrollToIndex(),"smooth"===a&&r.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");var l=r.getOffsetForIndex(e,s),c=l[0],d=l[1];r._scrollToOffset(c,{adjustments:void 0,behavior:a}),"smooth"!==a&&r.isDynamicMode()&&(r.scrollToIndexTimeoutId=setTimeout((function(){if(r.scrollToIndexTimeoutId=null,r.measureElementCache.has(r.options.getItemKey(e))){var t=r.getOffsetForIndex(e,d)[0];(0,i.approxEqual)(t,r.scrollOffset)||r.scrollToIndex(e,{align:d,behavior:a})}else r.scrollToIndex(e,{align:d,behavior:a})})))},this.scrollBy=function(e,t){var n=(void 0===t?{}:t).behavior;r.cancelScrollToIndex(),"smooth"===n&&r.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r._scrollToOffset(r.scrollOffset+e,{adjustments:void 0,behavior:n})},this.getTotalSize=function(){var e;return((null==(e=r.getMeasurements()[r.options.count-1])?void 0:e.end)||r.options.paddingStart)-r.options.scrollMargin+r.options.paddingEnd},this._scrollToOffset=function(e,t){var n=t.adjustments,o=t.behavior;r.options.scrollToFn(e,{behavior:o,adjustments:n},r)},this.measure=function(){r.itemSizeCache=new Map,r.notify()},this.setOptions(e),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach((function(e){r.itemSizeCache.set(e.key,e.size)})),this.maybeNotify()},g=function(e,t,n,o){for(;e<=t;){var i=(e+t)/2|0,s=n(i);if(s<o)e=i+1;else{if(!(s>o))return i;t=i-1}}return e>0?e-1:0}},301257:(e,t,n)=>{function o(e,t,n){var o,i,s=null!=(o=n.initialDeps)?o:[];return function(){var o;n.key&&null!=n.debug&&n.debug()&&(o=Date.now());var a,r=e();if(!(r.length!==s.length||r.some((function(e,t){return s[t]!==e}))))return i;if(s=r,n.key&&null!=n.debug&&n.debug()&&(a=Date.now()),i=t.apply(void 0,r),n.key&&null!=n.debug&&n.debug()){var l=Math.round(100*(Date.now()-o))/100,c=Math.round(100*(Date.now()-a))/100,d=c/16,m=function(e,t){for(e=String(e);e.length<t;)e=" "+e;return e};console.info("%c⏱ "+m(c,5)+" /"+m(l,5)+" ms","\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl("+Math.max(0,Math.min(120-120*d,120))+"deg 100% 31%);",null==n?void 0:n.key)}return null==n||null==n.onChange||n.onChange(i),i}}function i(e,t){if(void 0===e)throw new Error("Unexpected undefined"+(t?": "+t:""));return e}n.d(t,{approxEqual:()=>s,memo:()=>o,notUndefined:()=>i});var s=function(e,t){return Math.abs(e-t)<1}}}]);try{stManager.done("dist/e393fc4fa6d2f81f01116a89b447a2f2.3bf1ca93f115dd37a71c.js")}catch(e){}