"use strict";(self.webpackChunkvk=self.webpackChunkvk||[]).push([[67546],{19447:(e,t,o)=>{o.d(t,{default:()=>i});const i={recommendationsContainer:"Recommendations-module__recommendationsContainer--N58kG"}},136902:(e,t,o)=>{o.d(t,{hydrateComponent:()=>a});var i=o(434788),r=o(785893),n=o(973935),d=o(293579);function a({component:e,descriptor:t}){const{data:o,target:a}=t.payload,{selector:s}=t;a&&a instanceof HTMLElement&&((0,d.registerReactApplication)(s,(t=>{n.render((0,r.jsx)(e,(0,i._)({},t)),a)})),window.initReactApplication(s,o))}},30536:(e,t,o)=>{o.d(t,{VideoModalRecommendationsClient:()=>b});var i=o(785893),r=o(667294),n=o(504190),d=o(881836),a=o(659397),s=o(19447),l=o(869048),c=o(399639),u=o(629932),v=o(563194),m=o(29271);const b=({ownerId:e,videoId:t})=>{const o=(0,r.useRef)(null),b=(0,n.useEvent)(d.videoModalRecommendationsService.getRecommendationsEvent),f=(0,n.useEvent)(d.videoModalRecommendationsService.abortRequestEvent);return(0,r.useEffect)((()=>(b({ownerId:e,videoId:t}),()=>f())),[e,t]),(0,i.jsx)(l.AppRootProvider,{children:(0,i.jsxs)("div",{className:(0,a.classNames)("js-video-modal-recommendations",s.default.recommendationsContainer),ref:o,children:[(0,i.jsx)(c.Header,{size:"regular",children:(0,i.jsx)(u.TextClamp,{children:m.getLang("video_modal_recommendations")})}),(0,i.jsx)(v.RecommendationsVideos,{ref:o})]})})}},939347:(e,t,o)=>{o.d(t,{hydrateVideoModalRecommendations:()=>l,unmountVideoModalRecommendations:()=>s});var i=o(283452),r=o(136902),n=o(321850),d=o(973935),a=o(30536);const s=e=>{e&&d.unmountComponentAtNode(e)},l=()=>{(0,i.tq)().setStartupHandler("VideoModalRecommendations/init",(e=>{(0,r.hydrateComponent)({descriptor:e,component:a.VideoModalRecommendationsClient});const{target:t}=e.payload;(0,n.pushNavDestroy)((()=>{s(t)}))}))}},125067:(e,t,o)=>{o.d(t,{RecommendationsVideo:()=>u});var i=o(434788),r=o(785893),n=o(667294),d=o(392594),a=o(168365),s=o(393223),l=o(507989),c=o(586606);const u=(0,n.memo)((({video:e})=>{const t=(0,l.useOwner)(e),o=(0,a.getVideoUrl)(e),n=(0,i._)({},(0,s.mapVideoFullToVideoCardItem)(e,t),{href:o});return(0,r.jsx)(d.VideoCard,{direction:"horizontal",isAvatarHidden:!0,size:"s",videoContainerWidth:c.VIDEO_RECOMMENDATIONS_VIDEO_CARD_WIDTH,video:n})}))},467661:(e,t,o)=>{o.d(t,{RecommendationsVideos:()=>l});var i=o(785893),r=o(667294),n=o(504190),d=o(881836),a=o(619453),s=o(158622);const l=(0,r.forwardRef)(((e,t)=>null===(0,n.useStore)(d.videoModalRecommendationsService.$videosIds)?(0,i.jsx)(s.RecommendationsVideosInitial,{}):(0,i.jsx)(a.RecommendationsVideosList,{recommendationsRef:t})))},158622:(e,t,o)=>{o.d(t,{RecommendationsVideosInitial:()=>s});var i=o(785893),r=o(504190),n=o(88409),d=o(881836),a=o(586606);const s=()=>(0,r.useStore)(d.videoModalRecommendationsService.$videosLoading)?(0,i.jsx)(n.HorizontalMiniVideoCardListSkeleton,{cardWidth:a.VIDEO_RECOMMENDATIONS_VIDEO_CARD_WIDTH}):null},619453:(e,t,o)=>{o.d(t,{RecommendationsVideosList:()=>m});var i=o(785893),r=o(551483),n=o(481244),d=o(108705),a=o(881836),s=o(504190),l=o(86894),c=o(662273),u=o(667294),v=o(125067);const m=({recommendationsRef:e})=>{const t=(0,s.useStore)(a.videoModalRecommendationsService.$videosIds),o=(0,s.useStore)(a.videoModalRecommendationsService.$videosFullyLoaded),m=(0,s.useStore)(a.videoModalRecommendationsService.$videosLoading),b=(0,s.useEvent)(a.videoModalRecommendationsService.fetchMoreRecommendationsVideosEvent),f=(0,r.useEntitiesStoreMap)(a.videoModalRecommendationsService.$recommendationsEntities,null!=t?t:[]);return(0,u.useEffect)((()=>{const t=document.getElementById("mv_layer_wrap"),o=(0,c.throttle)((()=>{e&&"function"!=typeof e&&e.current&&t.scrollTop>e.current.clientHeight-50&&b()}),34);return t.addEventListener("scroll",o),()=>t.removeEventListener("scroll",o)}),[]),(0,i.jsxs)(i.Fragment,{children:[f.map((e=>(0,n.isVideoVideoFullWithIds)(e)&&(0,i.jsx)(v.RecommendationsVideo,{video:e},(0,d.joinRawId)({itemId:e.id,ownerId:e.owner_id})))),m&&!o&&(0,i.jsx)(l.PanelSpinner,{})]})}},586606:(e,t,o)=>{o.d(t,{VIDEO_RECOMMENDATIONS_VIDEO_CARD_WIDTH:()=>i});const i=128},563194:(e,t,o)=>{o.d(t,{RecommendationsVideos:()=>i.RecommendationsVideos});var i=o(467661)},490678:(e,t,o)=>{o.d(t,{handleAddToCommunity:()=>i});const i=(0,o(11010)._)((function*(e,t){window.Videoview||(yield window.stManager.add([window.jsc("web/videoview.js")])),window.Videoview._onAddToCommunity(e,t)}))},253688:(e,t,o)=>{o.d(t,{handleCopyToClipboardVideoLink:()=>l});var i=o(659397),r=o(404145),n=o(222325),d=o(29271),a=o(800325),s=o(108705);const l=(e,t)=>{(0,i.copyTextToClipboard)(`https://${(0,r.getHostName)()}/video${(0,s.joinRawId)({ownerId:e,itemId:t})}`),(0,n.showSnackbarUnsafe)({text:`<span class="VideoNotification__title">${d.getLang("video_copied_to_clipboard")}</span>`,before:{content:(0,a.getIcon24CheckCircleOutline)().icon}})}},873397:(e,t,o)=>{o.d(t,{handleDeleteVideo:()=>i});const i=(0,o(11010)._)((function*(){window.Videoview||(yield window.stManager.add([window.jsc("web/videoview.js")])),window.Videoview._onDelete()}))},705897:(e,t,o)=>{o.d(t,{handleEditVideo:()=>i});const i=(0,o(11010)._)((function*(e,t){window.Videoview||(yield window.stManager.add([window.jsc("web/videoview.js")])),window.Videoview._onEdit(e,t)}))},542949:(e,t,o)=>{o.d(t,{handleExportVideo:()=>i});const i=(0,o(11010)._)((function*(e){window.Videoview||(yield window.stManager.add([window.jsc("web/videoview.js")])),window.Videoview._onExport(e)}))},179181:(e,t,o)=>{o.d(t,{handleExternalPlayerAddVideo:()=>i});const i=(0,o(11010)._)((function*(e){var t;window.Videoview||(yield window.stManager.add([window.jsc("web/videoview.js")]));null==(t=window.Videoview.getPlayerObject())||t.onExternalAdded(e)}))},273097:(e,t,o)=>{o.d(t,{handleSubscribeVideoAuthor:()=>r});var i=o(881836);const r=e=>{i.videoModalSubscribeService.toggleSubscribeEvent({authorId:e})}},905832:(e,t,o)=>{o.d(t,{handleToggleFavorite:()=>i});const i=(0,o(11010)._)((function*(e){var t;window.Videoview||(yield window.stManager.add([window.jsc("web/videoview.js")])),window.Videoview.bookmarkVideo(e,0);null==(t=window.Videoview.getPlayerObject())||t.onBookmarked()}))},467744:(e,t,o)=>{o.d(t,{handleToggleLike:()=>i});const i=(0,o(11010)._)((function*(){window.Videoview||(yield window.stManager.add([window.jsc("web/videoview.js")])),window.Videoview.like(null,!1)}))},714725:(e,t,o)=>{o.d(t,{handleViewVideoStatistic:()=>i});const i=(0,o(11010)._)((function*(){window.Videoview||(yield window.stManager.add([window.jsc("web/videoview.js")])),window.Videoview._onViewStats()}))},393410:(e,t,o)=>{o.d(t,{handleAddToCommunity:()=>i.handleAddToCommunity,handleCopyToClipboardVideoLink:()=>a.handleCopyToClipboardVideoLink,handleDeleteVideo:()=>r.handleDeleteVideo,handleEditVideo:()=>n.handleEditVideo,handleExportVideo:()=>d.handleExportVideo,handleExternalPlayerAddVideo:()=>v.handleExternalPlayerAddVideo,handleSubscribeVideoAuthor:()=>c.handleSubscribeVideoAuthor,handleToggleFavorite:()=>s.handleToggleFavorite,handleToggleLike:()=>l.handleToggleLike,handleViewVideoStatistic:()=>u.handleViewVideoStatistic});var i=o(490678),r=o(873397),n=o(705897),d=o(542949),a=o(253688),s=o(905832),l=o(467744),c=o(273097),u=o(714725),v=o(179181)},878904:(e,t,o)=>{o.d(t,{createRecommendationsService:()=>a});var i=o(798116),r=o(796615),n=o(46749),d=o(106203);const a=()=>{const e=(0,i.createDomain)("videoModal/recommendations"),t=(0,r.createEntitiesVideoService)({domain:e}),o=(0,n.createListsVideosRecommendationsService)({domain:e,entitiesVideoService:t}),[a,s]=(0,d.createAbortControllerField)(e),l=e.createStore(""),c=e.createEvent(),u=e.createEvent();(0,i.sample)({clock:c,fn:()=>{},target:o.resetVideosRecommendationsEvent}),(0,i.sample)({clock:c,fn:({ownerId:e})=>String(e),target:l}),(0,i.sample)({clock:c,source:a,fn:(e,{ownerId:t,videoId:o})=>({controller:e,entityKey:t,query:{video_id:o,count:10,owner_id:t}}),target:o.fetchVideosRecommendationsFx}),(0,i.sample)({clock:u,source:l,fn:e=>({entityKey:e}),target:o.fetchMoreVideosRecommendationsEvent});const v=o.selectStores(l);return{$ownerId:l,$recommendationsEntities:t.$entitiesVideo,$videosCount:v.$count,$videosError:v.$error,$videosFullyLoaded:v.$fullyLoaded,$videosIds:v.$listIds,$videosLoading:v.$loading,abortRequestEvent:s,getRecommendationsEvent:c,fetchMoreRecommendationsVideosEvent:u}}},968606:(e,t,o)=>{o.d(t,{createVideoModalAlbumsService:()=>v});var i=o(434788),r=o(798116),n=o(629260),d=o(838740),a=o(555888),s=o(759336),l=o(292063),c=o(393410),u=o(916207);const v=()=>{const e=(0,r.createDomain)("videoModal/playlists"),t=(0,d.createVideoGetAlbumsByVideoFx)({domain:e}),o=e.createEffect((e=>(0,c.handleExternalPlayerAddVideo)(e))),v=(0,d.createVideoAddToAlbumFx)({domain:e}),m=(0,d.createVideoRemoveFromAlbumFx)({domain:e}),b=e.createStore({}),f=e.createEffect((({controller:e,isAdded:t,query:o})=>{const i={controller:e,query:o};return t?m(i):v(i)})),w=e.createEvent(),p=(0,r.restore)(w,{}),g=e.createEvent(),y=e.createEvent(),h=e.createEvent(),S=(0,a.createEntitiesVideoAlbumService)({domain:e}),k=(0,s.createListsVideosAlbumsService)({domain:e,entitiesVideoAlbumService:S}),{$entitiesVideoAlbums:E}=S,{resetVideosAlbumsEvent:V}=k,_=e.createEvent(),A=(0,r.restore)(_,null),I=e.createEvent(),x=(0,r.restore)(I,null),F=e.createEvent(),L=(0,r.restore)(F,null),R=e.createEvent(),M=(0,r.restore)(R,!1),C=e.createEvent(),j=(0,r.restore)(C,null),O=e.createEvent(),$=(0,r.combine)(p,j,((e,t)=>!!t||Object.values(e).some((e=>e&&e.containsVideo))));(0,r.sample)({clock:f,filter:({query:{album_id:e}})=>(0,u.isMyVideoAlbum)(e),fn:({isAdded:e})=>!e,target:C}),(0,r.sample)({clock:[f.done,f.fail],filter:e=>{var t;return(0,u.isMyVideoAlbum)(null==(t=e)?void 0:t.params.query.album_id)&&("error"in e||!e.result)},fn:({params:{isAdded:e}})=>e,target:C});const D=(0,n.combineEvents)({events:{albumsByVideo:t.done,albums:k.fetchVideosAlbumsFx.done},reset:V});(0,r.sample)({clock:O,source:{ownerId:L},fn:({ownerId:e},t)=>Object.values(t).reduce(((t,o)=>{if((0,u.isServiceAlbumId)(o.id))return t;return t[(0,u.getFullAlbumId)({ownerId:e,albumId:o.id})]={id:o.id,title:o.title,containsVideo:o.added,isPrivate:1===o.private},t}),{}),target:w}),(0,r.sample)({clock:O,fn:e=>{const t=Object.values(e),o=t.findIndex((e=>(0,u.isMyVideoAlbum)(e.id)));return-1!==o&&t[o].added},target:C}),(0,r.sample)({clock:D,source:{videoEntities:E,ownerId:L},fn:({videoEntities:e,ownerId:t},{albumsByVideo:o})=>(0,u.mapAlbumsWithInclusionsToPlaylists)({albumsByVideo:o.result,albums:e,ownerId:t||0}),target:w});const{$listIds:q,$loading:T}=k.selectStores(L);return(0,r.sample)({clock:g,source:L,filter:e=>Boolean(e),fn:e=>({query:{owner_id:e||0,extended:1},controller:new AbortController,entityKey:e||0}),target:k.fetchVideosAlbumsFx}),(0,r.sample)({clock:g,source:[A,x,L],filter:e=>e.every(Boolean),fn:([e,t,o])=>({query:{video_id:e||0,owner_id:t||0,target_id:o||0},controller:new AbortController}),target:t}),(0,r.sample)({clock:V,fn:()=>({}),target:p}),(0,r.sample)({clock:y,source:[L,x,A],fn:([e,t,o],{album_id:i,isAdded:r})=>{const n=(0,u.getFullAlbumId)({albumId:i,ownerId:e});return{controller:new AbortController,fullId:n,query:{target_id:e||0,album_id:i,video_id:o||0,owner_id:t||0},isAdded:r}},target:f}),(0,r.sample)({clock:f,source:p,filter:(e,t)=>!(0,u.isMyVideoAlbum)(t.query.album_id),fn:(e,{query:t,isAdded:o})=>{const r=(0,i._)({},e),n=(0,u.getFullAlbumId)({albumId:t.album_id,ownerId:t.target_id}),d=e[n];return d&&(r[n]=(0,i._)({},d,{containsVideo:!o})),r},target:w}),(0,r.sample)({clock:f,source:b,fn:(e,{controller:t,fullId:o})=>{var r;return null==(r=e[o])||r.abort(),(0,i._)({},e,{[o]:t})},target:b}),(0,r.sample)({clock:[f.done,f.fail],source:p,filter:(e,t)=>("error"in t||!t.result)&&!(0,u.isMyVideoAlbum)(t.params.query.album_id),fn:(e,{params:{query:t,isAdded:o}})=>{const r=(0,i._)({},e),n=(0,u.getFullAlbumId)({albumId:t.album_id,ownerId:t.owner_id}),d=e[n];return d&&(r[n]=(0,i._)({},d,{containsVideo:o})),r},target:w}),(0,r.sample)({clock:y,source:{playlists:p,ownerId:L},fn:({playlists:e,ownerId:t},{isAdded:o,album_id:i})=>{var r;const n=(0,u.getFullAlbumId)({albumId:i,ownerId:t});(0,u.showPlaylistActionSnackbar)({ownerId:t||0,playlistId:i,playlistTitle:null==(r=e[n])?void 0:r.title,added:!o})}}),(0,r.sample)({source:$,target:o}),(0,r.sample)({clock:h,filter:({isAdded:e})=>!Boolean(e),fn:()=>!0,target:C}),(0,r.sample)({clock:h,filter:({isAdded:e})=>!Boolean(e),fn:({isAdded:e})=>({isAdded:!!e,album_id:l.MY_VIDEO_ALBUM_ID}),target:y}),(0,r.sample)({clock:h,filter:({isAdded:e})=>Boolean(e),fn:()=>!1,target:C}),(0,r.sample)({clock:h,source:{ownerId:L,videoOwnerId:x,playlists:p,videoId:A},filter:(e,{isAdded:t})=>Boolean(t),fn:({ownerId:e,videoOwnerId:t,playlists:o,videoId:i})=>({query:{target_id:e||0,owner_id:t||0,video_id:i||0,album_ids:Object.values(o).map((e=>{var t;return null==(t=e)?void 0:t.id})).join(",")},controller:new AbortController}),target:m}),(0,r.sample)({clock:h,source:{playlists:p},filter:(e,{isAdded:t})=>Boolean(t),fn:({playlists:e})=>{const t=(0,i._)({},e);return Object.keys(t).forEach((e=>{const o=t[e];o&&(t[e]=(0,i._)({},o,{containsVideo:!1}))})),t},target:w}),{setVideoId:_,setOwnerIdEvent:F,setVideoOwnerIdEvent:I,setAddedToMyEvent:C,setNeedsRefetch:R,setUpstreamPlaylists:O,togglePlaylistAddedEvent:y,playerAddEvent:h,fetchPlaylistsEvent:g,resetVideosAlbumsEvent:V,$needsRefetch:M,$addedToMy:j,$playlistEntityStore:p,$videoAlbumsListIds:q,$videoAlbumsLoading:T,$videoAdded:$}}},816133:(e,t,o)=>{o.d(t,{createVideoModalFaveService:()=>d});var i=o(434788),r=o(798116),n=o(22736);const d=({onAddFave:e,onDeleteFave:t})=>{const o=(0,r.createDomain)("videoModal/bookmarks"),d=o.createEvent(),a=(0,r.restore)(d,null),s=o.createEvent(),l=(0,r.restore)(s,null),c=o.createEvent(),{faveAddVideoFx:u,faveRemoveVideoFx:v}=(0,n.createEntitiesFaveVideoService)({domain:o}),m=o.createStore({}),b=o.createEffect((({controller:e,currentFave:t,query:o})=>{const i={controller:e,query:o};return t?v(i):u(i)}));return(0,r.sample)({clock:c,source:a,fn:(e,{ownerId:t,id:o})=>({controller:new AbortController,currentFave:!!e,query:{owner_id:t,id:o}}),target:b}),m.on(b,((e,{controller:t,query:o})=>{var r;const n=o.id;return null==(r=e[n])||r.abort(),(0,i._)({},e,{[n]:t})})),(0,r.sample)({clock:b,source:a,fn:e=>!e,target:d}),(0,r.sample)({clock:[b.done,b.fail],source:{isFavorite:a,abortController:m},filter:(e,t)=>{var o,i,r;return("error"in t||!t.result)&&!(null==(r=t.params)||null==(i=r.controller)||null==(o=i.signal)?void 0:o.aborted)},fn:({isFavorite:e})=>!e,target:d}),(0,r.sample)({clock:u.done,target:e}),(0,r.sample)({clock:v.done,target:t}),m.on([b.done,b.fail],((e,{params:t})=>{var o,r,n;if(null==(n=t)||null==(r=n.controller)||null==(o=r.signal)?void 0:o.aborted)return e;const d=t.query.id,a=(0,i._)({},e);return delete a[d],a})),{$isFavorite:a,$canAddToFavorite:l,setIsFavoriteEvent:d,setCanAddToFavorite:s,toggleFaveEvent:c}}},791497:(e,t,o)=>{o.d(t,{createVideoModalService:()=>d});var i=o(434788),r=o(798116),n=o(759658);const d=()=>{const e=(0,r.createDomain)("videoModal"),t=t=>{const o=e.createEvent(),i=e.createStore(t);return(0,r.sample)({clock:o,target:i}),[i,o]},[o,d]=t(null),[a,s]=t(null),l=e.createEvent(),{likesAddFx:c,likesDeleteFx:u}=(0,n.createEntitiesLikesService)({domain:e}),v=e.createStore({}),m=e.createEffect((({controller:e,currentIsLiked:t,query:o})=>{const i={controller:e,query:o};return t?u(i):c(i)})),b=e.createEvent(),[f,w]=t(null),[p,g]=t(""),[y,h]=t(null),[S,k]=t(null),[E,V]=t(null),[_,A]=t(null),[I,x]=t(null),[F,L]=t(null),[R,M]=t(null);(0,r.sample)({clock:b,fn:({isLiked:e})=>e,target:d}),(0,r.sample)({clock:b,fn:({numberOfLikes:e})=>e,target:s}),(0,r.sample)({clock:l,source:o,fn:(e,{params:t})=>({controller:new AbortController,currentIsLiked:!!e,query:t}),target:m}),v.on(m,((e,{controller:t,query:o})=>{var r;const n=o.item_id;return null==(r=e[n])||r.abort(),(0,i._)({},e,{[n]:t})}));const C=(e,t)=>{const o=null!=t?t:0;return Math.max(e?o-1:o+1,0)};return(0,r.sample)({clock:l,source:{isLiked:o,numberOfLikes:a},fn:({isLiked:e,numberOfLikes:t})=>({isLiked:!e,numberOfLikes:C(e,t)}),target:b}),(0,r.sample)({clock:[m.done,m.fail],source:{isLiked:o,numberOfLikes:a},filter:(e,t)=>{var o,i,r;return("error"in t||!t.result)&&!(null==(r=t.params)||null==(i=r.controller)||null==(o=i.signal)?void 0:o.aborted)},fn:({isLiked:e,numberOfLikes:t})=>({isLiked:!e,numberOfLikes:C(e,t)}),target:b}),v.on([m.done,m.fail],((e,{params:t})=>{var o,r,n;if(null==(n=t)||null==(r=n.controller)||null==(o=r.signal)?void 0:o.aborted)return e;const d=t.query.item_id,a=(0,i._)({},e);return delete a[d],a})),{$isLiked:o,$numberOfLikes:a,$title:f,$description:p,$canAddToGroups:y,$canViewStatistic:S,$canReport:E,$canEditVideo:_,$canDeleteVideo:I,$isShortVideo:F,$isActiveLive:R,setIsLikedEvent:d,setLikesEvent:b,toggleLikesEvent:l,setNumberOfLikesEvent:s,setTitleEvent:w,setDescriptionEvent:g,setCanAddToGroupsEvent:h,setCanViewStatisticEvent:k,setCanReportEvent:V,setCanEditVideoEvent:A,setCanDeleteVideoEvent:x,setIsShortVideoEvent:L,setIsActiveLiveEvent:M}}},321715:(e,t,o)=>{o.d(t,{createVideoModalSubscribeService:()=>s});var i=o(434788),r=o(798116),n=o(177479),d=o(203480),a=o(723062);const s=({onAddSubscribe:e,onDeleteSubscribe:t})=>{const o=(0,r.createDomain)("videoModal/subscribe"),s=o.createEvent(),l=(0,r.restore)(s,!1),c=o.createEvent(),u=(0,r.restore)(c,!1),v=o.createEvent(),{groupsJoinFx:m,groupsLeaveFx:b}=(0,n.createEntitiesGroupsSubscribeService)({domain:o}),{friendsDeleteFx:f,friendsAddFx:w}=(0,d.createEntitiesFriendsSubscribeService)({domain:o}),p=o.createStore({}),g=o.createEffect((({controller:e,currentSubscribe:t,query:o})=>{if("group_id"in o){const i={controller:e,query:o};return t?b(i):m(i)}const i={controller:e,query:o};return t?f(i):w(i)}));return(0,r.sample)({clock:v,source:l,fn:(e,{authorId:t})=>{const o={controller:new AbortController,currentSubscribe:!!e};return a.Ranges.isGroupId(t)?(0,i._)({},o,{query:{group_id:a.Ranges.convertGroupIdToOwnerId(t)}}):(0,i._)({},o,{query:{user_id:t}})},target:g}),p.on(g,((e,{controller:t,query:o})=>{var r;const n="group_id"in o?o.group_id:o.user_id;return null==(r=e[n])||r.abort(),(0,i._)({},e,{[n]:t})})),(0,r.sample)({clock:g,source:l,fn:e=>!e,target:s}),(0,r.sample)({clock:[g.done,g.fail],source:{isSubscribe:l,abortController:p},filter:(e,t)=>{var o,i,r;return("error"in t||!t.result)&&!(null==(r=t.params)||null==(i=r.controller)||null==(o=i.signal)?void 0:o.aborted)},fn:({isSubscribe:e})=>!e,target:s}),(0,r.sample)({clock:[m.done,w.done],target:e}),(0,r.sample)({clock:[b.done,f.done],target:t}),p.on([g.done,g.fail],((e,{params:t})=>{var o,r,n;if(null==(n=t)||null==(r=n.controller)||null==(o=r.signal)?void 0:o.aborted)return e;const d="group_id"in t.query?t.query.group_id:t.query.user_id,a=(0,i._)({},e);return delete a[d],a})),{$isSubscribe:l,$canSubscribe:u,setIsSubscribeEvent:s,setCanSubscribeEvent:c,toggleSubscribeEvent:v}}},881836:(e,t,o)=>{o.d(t,{videoModalAlbumsService:()=>u,videoModalFaveService:()=>l,videoModalRecommendationsService:()=>m,videoModalService:()=>c,videoModalSubscribeService:()=>v});var i=o(791497),r=o(968606),n=o(816133),d=o(321715),a=o(878904),s=o(114111);const l=(0,n.createVideoModalFaveService)({onAddFave:s.showFaveSnackbarFx,onDeleteFave:s.showUnfaveSnackbarFx}),c=(0,i.createVideoModalService)(),u=(0,r.createVideoModalAlbumsService)(),v=(0,d.createVideoModalSubscribeService)({onAddSubscribe:s.showSubscribeSnackbarFx,onDeleteSubscribe:s.showUnsubscribeSnackbarFx}),m=(0,a.createRecommendationsService)()},114111:(e,t,o)=>{o.d(t,{showFaveSnackbarFx:()=>r.showFaveSnackbarFx,showSubscribeSnackbarFx:()=>d.showSubscribeSnackbarFx,showUnfaveSnackbarFx:()=>i.showUnfaveSnackbarFx,showUnsubscribeSnackbarFx:()=>n.showUnsubscribeSnackbarFx});var i=o(907847),r=o(654619),n=o(491700),d=o(597462)},654619:(e,t,o)=>{o.d(t,{showFaveSnackbarFx:()=>d});var i=o(29271),r=o(222325),n=o(800325);const d=(0,o(798116).createEffect)((()=>{const e=(0,i.langLink)("/video/bookmarks",i.getLang("fave_video_added"));(0,r.showSnackbarUnsafe)({text:e,before:{content:(0,n.getIcon24CheckCircleOutline)().icon}})}))},597462:(e,t,o)=>{o.d(t,{showSubscribeSnackbarFx:()=>d});var i=o(29271),r=o(222325),n=o(800325);const d=(0,o(798116).createEffect)((()=>{(0,r.showSnackbarUnsafe)({text:i.getLang("video_modal_subscribe_to_author_snackbar"),before:{content:(0,n.getIcon24CheckCircleOutline)().icon}})}))},907847:(e,t,o)=>{o.d(t,{showUnfaveSnackbarFx:()=>d});var i=o(29271),r=o(222325),n=o(121263);const d=(0,o(798116).createEffect)((()=>{const e=i.getLang("video_deleted_from_my_bookmarks");(0,r.showSnackbarUnsafe)({text:e,before:{content:(0,n.getIcon24DeleteOutline)().icon}})}))},491700:(e,t,o)=>{o.d(t,{showUnsubscribeSnackbarFx:()=>d});var i=o(29271),r=o(222325),n=o(800325);const d=(0,o(798116).createEffect)((()=>{(0,r.showSnackbarUnsafe)({text:i.getLang("video_modal_unsubscribe_to_author_snackbar"),before:{content:(0,n.getIcon24CheckCircleOutline)().icon}})}))},459465:(e,t,o)=>{o.d(t,{HorizontalMiniVideoCardListSkeleton:()=>a});var i=o(434788),r=o(820224),n=o(785893),d=o(433509);const a=e=>{var{count:t=10}=e,o=(0,r._)(e,["count"]);return(0,n.jsx)(n.Fragment,{children:new Array(t).fill(null).map(((e,t)=>(0,n.jsx)(d.HorizontalMiniVideoCardSkeleton,(0,i._)({},o),t)))})}},190993:(e,t,o)=>{o.d(t,{HorizontalMiniVideoCardListSkeleton:()=>i.HorizontalMiniVideoCardListSkeleton});var i=o(459465)},879158:(e,t,o)=>{o.d(t,{HorizontalMiniVideoCardSkeleton:()=>a});var i=o(785893),r=o(545637),n=o(54929),d=o(444972);const a=({cardWidth:e,cardHeight:t=72,titleWidth:o=140,ownerNameWidth:a=120,additionalInfoWidth:s=140})=>(0,i.jsx)(r.Div,{mode:"vertical",paddingBottom:8,paddingTop:8,children:(0,i.jsx)(n.SimpleCell,{before:(0,i.jsx)(d.Skeleton,{borderRadius:10,height:t,width:e}),subtitle:(0,i.jsx)(r.Div,{mode:"horizontal",children:(0,i.jsx)(d.Skeleton,{borderRadius:4,height:12,width:s})}),extraSubtitle:(0,i.jsx)(r.Div,{mode:"horizontal",children:(0,i.jsx)(d.Skeleton,{borderRadius:4,height:12,width:a})}),disabled:!0,children:(0,i.jsx)(r.Div,{mode:"horizontal",children:(0,i.jsx)(d.Skeleton,{borderRadius:4,height:15,width:o})})})})},433509:(e,t,o)=>{o.d(t,{HorizontalMiniVideoCardSkeleton:()=>i.HorizontalMiniVideoCardSkeleton});var i=o(879158)},88409:(e,t,o)=>{o.d(t,{HorizontalMiniVideoCardListSkeleton:()=>i.HorizontalMiniVideoCardListSkeleton});var i=o(190993);o(433509)},507989:(e,t,o)=>{o.d(t,{useOwner:()=>n.useOwner,useRestrictedPlaylist:()=>i.useRestrictedPlaylist,useUnavailablePlaylist:()=>r.useUnavailablePlaylist});var i=o(905846),r=o(35233),n=o(660801)},660801:(e,t,o)=>{o.d(t,{useOwner:()=>d});var i=o(189475),r=o(723062),n=o(870990);const d=e=>{const t=(0,i.useEntitiesStore)(n.entitiesGroupsService.$entitiesGroups,r.Ranges.convertOwnerIdToGroupId(e.owner_id)),o=(0,i.useEntitiesStore)(n.entitiesUsersService.$entitiesUsers,e.owner_id);return r.Ranges.isGroupId(e.owner_id)&&t?t:r.Ranges.isUserId(e.owner_id)&&o?o:void 0}},905846:(e,t,o)=>{o.d(t,{useRestrictedPlaylist:()=>d});var i=o(504190),r=o(870990),n=o(916207);const d=()=>{const e=(0,i.useStore)(r.playlistService.$videosError);return(0,n.isAccessDenied)(e)}},35233:(e,t,o)=>{o.d(t,{useUnavailablePlaylist:()=>d});var i=o(504190),r=o(870990),n=o(916207);const d=()=>{const e=(0,i.useStore)(r.playlistService.$videosError);return(0,n.isIdInvalid)(e)||(0,n.isVideosEnabled)(e)}},393223:(e,t,o)=>{o.d(t,{mapVideoFullToVideoCardItem:()=>p});var i=o(434788),r=o(659397),n=o(295273),d=o(765069),a=o(552248),s=o(139654),l=o(362246),c=o(517890),u=o(43930);const v=e=>{var t;const{image:o=[]}=e;let i=o.filter((e=>!e.with_padding));return i.length||(i=o),null==(t=(0,r.getPhotoSize)(i,(0,a.getImageMinWidth)(240)))?void 0:t.url},m=e=>{if(!e)return;return{delete_outline:"delete",hide_outline:"hide",recent_outline:"recent",info_outline:"info",lock_outline:"block"}[e]},b=e=>{if(!e)return null;return{title:e.title,mode:1===e.blur?"blurred":"hidden",iconType:m(e.icon_name)}},f=e=>{const t=e.title||"",o=e.subtitle||"";return"music_video"===e.type?`${t} ${o}`:t},w=(e,t)=>{var o;if("music_video"===e.type&&(null==(o=e)?void 0:o.main_artists)){const t=e.main_artists[0];return(0,i._)({name:t.name||"",href:(0,d.getOwnerUrl)(t)},(0,s.getArtistPhotos)(t))}return t?(0,i._)({},t,{name:(0,n.getOwnerName)(t),href:(0,d.getOwnerUrl)(t,"/video/@"),verified:!!t.verified&&1===t.verified,is_nft:(0,c.checkOwnerIsNFT)(t)}):{name:"",href:""}},p=(e,t)=>{var o,r,n,d,a,c,m,p,g,y,h;return{title:f(e),owner:(0,i._)({},w(e,t),{badge:(0,u.getVerifiedBadge)(t)}),isPrivacyLocked:(r=e.privacy_view,!!r&&Boolean((e=>e.category&&!["all","any"].includes(e.category))(r)||(null==(n=r.excluded_category)?void 0:n.length)||(null==(a=r.lists)||null==(d=a.allowed)?void 0:d.length)||(null==(m=r.lists)||null==(c=m.excluded)?void 0:c.length)||(null==(g=r.owners)||null==(p=g.allowed)?void 0:p.length)||(null==(h=r.owners)||null==(y=h.excluded)?void 0:y.length))),isLive:(0,s.isLiveVideo)(e),duration:e.duration,viewedDuration:e.viewed_duration,platform:e.platform,trailerSrc:null==(o=e.trailer)?void 0:o.mp4_360,thumbSrc:v(e),restriction:b(e.restriction),additionalInfo:(0,l.getAdditionalInfo)(e),description:e.description}}},121263:(e,t,o)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M14.56 8.1a.9.9 0 0 1 .84.96l-.5 8a.9.9 0 0 1-1.8-.12l.5-8a.9.9 0 0 1 .96-.84Zm-5.12 0a.9.9 0 0 0-.84.96l.5 8a.9.9 0 1 0 1.8-.12l-.5-8a.9.9 0 0 0-.96-.84Z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M3 4.1a.9.9 0 1 0 0 1.8h1.18l1.16 12.32c.04.48.08.9.14 1.23.06.36.15.7.35 1.03a2.9 2.9 0 0 0 1.25 1.14c.34.16.7.23 1.05.25.35.03.76.03 1.25.03h5.24c.49 0 .9 0 1.25-.03.36-.02.71-.09 1.05-.25a2.9 2.9 0 0 0 1.25-1.14c.2-.32.29-.67.35-1.03.06-.34.1-.75.15-1.23L19.81 5.9H21a.9.9 0 1 0 0-1.8h-5.2a3.9 3.9 0 0 0-7.6 0H3Zm4.12 13.91c.05.53.09.87.13 1.13.04.26.09.36.13.42a1.1 1.1 0 0 0 .47.43c.06.03.17.07.43.09.26.02.6.02 1.13.02h5.18c.52 0 .87 0 1.13-.02.26-.02.37-.06.43-.09a1.1 1.1 0 0 0 .47-.43c.04-.06.08-.16.13-.41.04-.27.08-.6.13-1.13L18 5.9H6l1.13 12.12ZM12 2.9a2.1 2.1 0 0 0-1.9 1.2h3.8A2.1 2.1 0 0 0 12 2.9Z" clip-rule="evenodd"/></svg>',name:"delete_outline_24"}}o.d(t,{getIcon24DeleteOutline:()=>i})},771611:(e,t,o)=>{o.d(t,{createFriendsAddFx:()=>s,createFriendsDeleteBulkFx:()=>c,createFriendsDeleteFx:()=>l,createFriendsGetFriendsDeletionSuggestionsFx:()=>d,createFriendsGetFx:()=>n,createFriendsGetListsFx:()=>r,createFriendsGetRecommendationsFx:()=>a});var i=o(972051);const r=e=>(0,i.createApiEffect)("friends.getLists",e),n=e=>(0,i.createApiEffect)("friends.get",e),d=e=>(0,i.createApiEffect)("friends.getFriendsDeletionSuggestions",e),a=e=>(0,i.createApiEffect)("friends.getRecommendations",e),s=e=>(0,i.createApiEffect)("friends.add",e),l=e=>(0,i.createApiEffect)("friends.delete",e),c=e=>(0,i.createApiEffect)("friends.deleteBulk",e)},940788:(e,t,o)=>{o.d(t,{createLikesAddFx:()=>r,createLikesDeleteFx:()=>n});var i=o(972051);const r=e=>(0,i.createApiEffect)("likes.add",e),n=e=>(0,i.createApiEffect)("likes.delete",e)},551483:(e,t,o)=>{o.d(t,{useEntitiesStoreMap:()=>r});var i=o(504190);const r=(e,t)=>(0,i.useStoreMap)({store:e,keys:t,fn:(e,t)=>t.reduce(((t,o)=>(e[o]&&t.push(e[o]),t)),[])})},203480:(e,t,o)=>{o.d(t,{createEntitiesFriendsSubscribeService:()=>n});var i=o(771611),r=o(503147);const n=({domain:e})=>{const t=(0,i.createFriendsAddFx)({domain:e}),o=(0,i.createFriendsDeleteFx)({domain:e}),n=e.createStore({});return(0,r.sampleEntityUpdater)({store:n,fx:t,key:e=>String(e.params.query.user_id),fn:(e,t)=>Boolean(t.result)}),(0,r.sampleEntityUpdater)({store:n,fx:o,key:e=>String(e.params.query.user_id),fn:(e,t)=>Boolean(t.result)}),{$entitiesFriendsSubscribe:n,friendsAddFx:t,friendsDeleteFx:o}}},177479:(e,t,o)=>{o.d(t,{createEntitiesGroupsSubscribeService:()=>n});var i=o(924292),r=o(503147);const n=({domain:e})=>{const t=(0,i.createGroupsJoinFx)({domain:e}),o=(0,i.createGroupsLeaveFx)({domain:e}),n=e.createStore({});return(0,r.sampleEntityUpdater)({store:n,fx:t,key:e=>String(e.params.query.group_id),fn:(e,t)=>Boolean(t.result)}),(0,r.sampleEntityUpdater)({store:n,fx:o,key:e=>String(e.params.query.group_id),fn:(e,t)=>Boolean(t.result)}),{$entitiesGroupsSubscribe:n,groupsJoinFx:t,groupsLeaveFx:o}}},759658:(e,t,o)=>{o.d(t,{createEntitiesLikesService:()=>a});var i=o(434788),r=o(503147),n=o(940788);const d=e=>[e.type,e.item_id].join("_"),a=({domain:e})=>{const t=(0,n.createLikesAddFx)({domain:e}),o=(0,n.createLikesDeleteFx)({domain:e}),a=e.createStore({}),s=e.createEvent();return a.on(s,((e,t)=>(0,i._)({},e,{[t.key]:t.value}))),(0,r.sampleEntityUpdater)({store:a,fx:t,key:e=>d(e.params.query),fn:(e,t)=>({isLiked:!0,numberOfLikes:t.result.likes})}),(0,r.sampleEntityUpdater)({store:a,fx:o,key:e=>d(e.params.query),fn:(e,t)=>({isLiked:!1,numberOfLikes:t.result.likes})}),{$entitiesLikes:a,likesAddFx:t,likesDeleteFx:o,setLikeEvent:s}}},46749:(e,t,o)=>{o.d(t,{createListsVideosRecommendationsService:()=>a});var i=o(108705),r=o(838740),n=o(923018);const d=({id:e,owner_id:t})=>void 0===e||void 0===t?"":(0,i.joinRawId)({itemId:e,ownerId:t}),a=({domain:e,entitiesVideoService:t})=>{const o=(0,r.createVideoGetVideoDiscoverFx)({domain:e}),i=e.createEffect(o),a=(0,n.createFactoryLists)({$entitiesItems:t.$entitiesVideo,domain:e,fetchFx:i,getItemKey:d,getList:({items:e})=>e,getListCount:({count:e})=>e,getListKey:({entityKey:e})=>e,getEntityKey:d});return{resetVideosRecommendationsEvent:a.resetEvent,fetchMoreVideosRecommendationsEvent:a.fetchMoreEvent,fetchVideosRecommendationsFx:a.fetchFx,$videosRecommendationsFullyLoaded:a.$entitiesFullyLoaded,$videosRecommendationsLoading:a.$entitiesLoading,$videosRecommendationsIds:a.$entitiesListIds,$videosRecommendationsCount:a.$entitiesCount,$videosRecommendationsError:a.$entitiesError,selectStores:a.selectStores}}},503147:(e,t,o)=>{o.d(t,{sampleEntityUpdater:()=>r});var i=o(434788);const r=e=>{const{fx:t,key:o,store:r,fn:n}=e;return r.on(t.done,((e,t)=>{const r="function"==typeof o?o(t):t.params.query[o],d=e[r];return(0,i._)({},e,{[r]:n(d,t)})})),r}},481244:(e,t,o)=>{o.d(t,{isVideoVideoFullWithIds:()=>i});const i=e=>void 0!==e.id&&void 0!==e.owner_id},629260:(e,t,o)=>{o.d(t,{combineEvents:()=>d});var i=o(798116);function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function n(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function d(e){var{events:t,reset:o,target:d=(0,i.createEvent)({name:"target",sid:"aip3nf"},{name:"target",sid:"aip3nf"})}=e;return i.is.unit(d)||a("target should be a unit"),o&&!i.is.unit(o)&&a("reset should be a unit"),(0,i.withRegion)(d,(()=>{var e=Object.keys(t),a=Array.isArray(t)?[...e].fill(""):{},s=(0,i.createStore)(e.length,{and:{serialize:"ignore"},name:"$counter",sid:"-dby0v3"}),l=(0,i.createStore)(a,{and:{serialize:"ignore"},name:"$results",sid:"c60qbe"});s.reset((0,i.sample)({and:[{source:d}],or:{sid:"-8hxq8z"}})),l.reset(d),o&&(s.reset((0,i.sample)({and:[{source:o}],or:{sid:"3c6u5p"}})),l.reset(o));var c=function(e){var a=(0,i.createStore)(!1,{and:{serialize:"ignore"},name:"$isDone",sid:"uttu1j"}).on(t[e],(()=>!0)).reset(d);o&&a.reset(o),s.on(a,(e=>e-1)),l.on(t[e],((t,o)=>{var i=Array.isArray(t)?[...t]:function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},t);return i[e]=o,i}))};for(var u of e)c(u);(0,i.guard)({and:[{source:(0,i.sample)({and:[{source:l,clock:(0,i.merge)(Object.values(t),{name:"clock",sid:"-531esq"})}],or:{name:"source",sid:"uwap9g"}}),filter:s.map((e=>0===e)),target:d}],or:{sid:"ciyd7d"}})})),d}function a(e){throw new Error(e)}}}]);try{stManager.done("dist/0ee47cab2b824f4f5a29ca2e6c7c2c67.838cbb599e1c5c458d7a.js")}catch(e){}