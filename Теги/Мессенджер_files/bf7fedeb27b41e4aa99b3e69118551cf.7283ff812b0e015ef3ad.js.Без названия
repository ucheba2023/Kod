"use strict";(self.webpackChunkvk=self.webpackChunkvk||[]).push([[86210],{142087:(e,o,t)=>{t.d(o,{pickTrackCodeFromURL:()=>r});var i=t(434788),n=t(226386);const r=()=>{setTimeout((()=>n.TRACK_CODE_TYPES.some((e=>(e=>{const o=window.nav.objLoc[e];if(!o)return!1;const t=(0,i._)({},window.nav.objLoc);return delete t[e],window.nav.setLoc(t),history.replaceState((0,i._)({},history.state,{[e]:o}),""),!0})(e)))))}},685068:(e,o,t)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.6 6.41a.9.9 0 0 1-.1-1.8 12.22 12.22 0 0 1 10 4.9c.58.84.9 1.7.9 2.49 0 .94-.46 1.98-1.24 2.97a.9.9 0 1 1-1.42-1.12c.41-.52.86-1.17.86-1.85 0-.31-.14-.82-.59-1.48a8.43 8.43 0 0 0-1.94-1.96A10.24 10.24 0 0 0 11.6 6.4ZM4.84 16.89A12.35 12.35 0 0 0 12 19.4c1.97 0 3.93-.6 5.6-1.52l1.26 1.26a.9.9 0 0 0 1.28-1.28L6.64 4.36a.9.9 0 0 0-1.28 1.28l.69.68c-.42.25-.82.51-1.2.8-.97.72-1.79 1.55-2.36 2.39-.57.84-.89 1.7-.89 2.49 0 .79.32 1.65.9 2.5.56.83 1.37 1.66 2.35 2.39ZM10.4 12a1.6 1.6 0 0 0 2.59 1.26l-2.25-2.25a1.6 1.6 0 0 0-.34.99Zm1.6 3.4a3.4 3.4 0 0 1-2.54-5.66l-2.09-2.1c-.51.28-1 .58-1.44.92a8.4 8.4 0 0 0-1.94 1.96A2.84 2.84 0 0 0 3.4 12c0 .31.14.82.59 1.48A10.56 10.56 0 0 0 12 17.6c1.43 0 2.92-.4 4.26-1.06l-2-2a3.39 3.39 0 0 1-2.27.86Z" clip-rule="evenodd"/></svg>',name:"hide_outline_24"}}t.d(o,{getIcon24HideOutline:()=>i})},654268:(e,o,t)=>{function i(){return{icon:'<svg fill="none" height="28" viewBox="0 0 28 28" width="28" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M26.7 15.29a1 1 0 0 1 .1 1.32l-6.95 7.1a1 1 0 0 1-1.33.08L14.3 19.5a1 1 0 0 1 1.33-1.48l3.52 3.54 6.15-6.27a1 1 0 0 1 1.41-.01zM10 18a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm12-6a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm0-6a1 1 0 1 1 0 2H4a1 1 0 0 1 0-2z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"list_check_outline_28"}}t.d(o,{getIcon28ListCheckOutline:()=>i})},53454:(e,o,t)=>{function i(){return{icon:'<svg fill="none" height="56" viewBox="0 0 56 56" width="56" xmlns="http://www.w3.org/2000/svg"><path d="M37.74 6c3.57 0 4.86.37 6.17 1.07s2.32 1.72 3.02 3.02c.7 1.3 1.07 2.6 1.07 6.17v23.48c0 3.57-.37 4.86-1.07 6.17a7.27 7.27 0 0 1-3.02 3.02c-1.3.7-2.6 1.07-6.17 1.07H18.26c-3.57 0-4.86-.37-6.17-1.07-1.3-.7-2.32-1.72-3.02-3.02S8 43.3 8 39.74V16.26c0-3.57.37-4.86 1.07-6.17.7-1.3 1.72-2.32 3.02-3.02S14.7 6 18.26 6zm.32 3h-19.8c-2.8 0-3.77.19-4.75.71a4.27 4.27 0 0 0-1.8 1.8c-.5.95-.7 1.87-.7 4.43L11 39.74c0 2.8.19 3.77.71 4.75a4.27 4.27 0 0 0 1.8 1.8c.99.52 1.95.71 4.75.71h19.48c2.8 0 3.77-.19 4.75-.71a4.27 4.27 0 0 0 1.8-1.8c.52-.98.71-1.95.71-4.75V16.26c0-2.8-.19-3.77-.71-4.75a4.27 4.27 0 0 0-1.8-1.8c-.95-.5-1.87-.7-4.43-.7zM18.72 38c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13z" fill="currentColor"/></svg>',name:"video_outline_56"}}t.d(o,{getIcon56VideoOutline:()=>i})},662273:(e,o,t)=>{function i(e,o){let t,i,n=!1;return function r(){if(n)return t=arguments,void(i=this);e.apply(this,arguments),n=!0,setTimeout((function(){n=!1,t&&(r.apply(i,t),t=i=null)}),o)}}t.d(o,{throttle:()=>i})},23087:(e,o,t)=>{function i(e){const o=e.getBoundingClientRect();return o.top>=0&&o.left>=0&&o.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&o.right<=(window.innerWidth||document.documentElement.clientWidth)}t.d(o,{isElementInViewport:()=>i})},999128:(e,o,t)=>{t.d(o,{Video:()=>R});var i=t(795558),n=t(490093),r=t(652027),s=t(254667),c=t(221780),a=t(664988),d=t(514986),l=t(504867),u=t(320422),_=t(438221),h=t(584356),v=t(222325),g=t(82161),p=t(953908),f=t(725296),S=t(215066),m=t(142087),w=t(685068),E=t(654268),I=t(211138),b=t(53454),y=t(662273),C=t(20815),L=t(23087),V=t(362246),A=t(854099),P=t(822920),O=t(321850),T=t(839470),B=t(931917),D=t(292063),x=t(613202),M=t(561722);const R={VIDEO_SEARCH_TYPE:"search_videos",VIDEO_GLOBAL_SEARCH_TYPE:"search_global_videos",VIDEO_SEARCH_TOP_TYPE:"search_top_videos",ALBUM_SEARCH_TYPE:"search_albums",ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE:"search_promo_albums",SEARCH_FILTERS:["hd","notsafe","live","date","order","len"],AVAILABLE_TABS:["all","uploaded","albums"],VIDEOS_PER_PAGE:60,VIDEOS_PER_ROW:3,PLAYLIST_FIRST_CHUNK_SIZE:9,PLAYLIST_OBJECT_ID_INDEX:6,SEARCH_KEEP_FILTERS_DELAY:3e3,SEARCH_STATS_POSITION_FIELDS:["oid","vid","clicked","viewStarted","viewedParts","viewedSeconds"],USER_SYSTEMS_ALBUM_TYPES:["type_my_uploaded","type_my_added","type_my_lives","type_my_recorded_calls"],DAY_IN_MS:864e5,getLoc:function(){return cur.curLoc?cur.curLoc:cur.is_showcase&&!nav.objLoc.section&&cur.showcaseSection&&("playlist"===cur.section||(0,g.inArray)(cur.showcaseSection,R.USER_SYSTEMS_ALBUM_TYPES))?(nav.objLoc.section=cur.showcaseSection,nav.objLoc):((0,a.isEmpty)(nav.objLoc)||!nav.objLoc[0]||0!=nav.objLoc[0].indexOf("video"))&&cur.section&&(0,g.inArray)(cur.section,["catalog","all","uploaded","albums"])?{0:"catalog"===cur.section?"video":"videos"+cur.oid}:nav.objLoc},init:function(){cur.searchInputEl=(0,i.geByClass1)("video_search_input"),cur.videoRecentlyRemoved={},cur.videoShowWindow={},cur.found={},cur.silentLoaded={},cur.currentSortings={},cur._preloadedPages={},cur.videoSearchFilters={},cur.videoSearchStats=null,cur.videoSearchPos=null,cur.videoSearchTrackCodeForQID="",cur.module="video",cur.albumsPreload=cur.albumsPreload||{},cur.albumsShowingAll={},cur.curLoc=!!cur.query&&nav.fromStr(cur.query),cur._back={hide:[function(){(0,p.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=null}],show:[function(){R._initScroll()}]},(0,a.isObject)(cur.curLoc)&&(cur.curLoc.section=cur.section),cur.getOwnerId=function(){return cur.oid},R.initNavigation(),R.initSearch();const e=R._getCurrentSectionType();if(R.isInAlbum()||R.loadSilent(),R.loadSilent(R.getLoc().section),"catalog"===e&&"playlists"!==R.getLoc().section||R.initOwnerVideoPage(),cur.videoCanSort&&"all_playlists"===cur.showcaseSection){const e=document.getElementById("video_all_playlists_list");e&&(0,x.getGridSorterModule)().then((()=>{cur.albumsSorter=new window.GridSorter(e,"video_item__thumb_link",{onReorder:R._onAlbumReorder})}))}cur.curLoc=!1,cur.section=!1,cur.currentModule=function(){return R.isInSearch()?"video_search":cur.is_showcase&&cur.ref?cur.ref:R.isInCatalog()?"videocat":R.isInVideosList()?B.Ranges.isGroupId(cur.oid)?"community_videos":cur.oid==vk.id?"profile_own_videos":"profile_videos":cur.module},R._initScroll(),R._loadNextChunkIfNeed(),R._updateThumbsInView(),(0,T.partConfigEnabled)("video_front_sort_get_lang")&&(cur.videoSortItems=[["default",c.getLang("video_sort_dd_by_default")],["popularity",c.getLang("video_sort_dd_by_popularity")],["new",c.getLang("video_sort_dd_newest")],["old",c.getLang("video_sort_dd_oldest")],["short",c.getLang("video_sort_dd_shortest")],["long",c.getLang("video_sort_dd_longest")]])},_loadNextChunkIfNeed:function(){if(!cur.is_showcase)return;const e=document.getElementById(`ui_${cur.showcaseSection}_load_more`);if(e&&e.clientHeight&&(0,L.isElementInViewport)(e))return void R.onScroll();const o=document.getElementById(`video_${cur.showcaseSection}_list`);if(o){o.getBoundingClientRect().bottom-(0,i.clientHeight)()<300&&R.onScroll()}},_getMyAddedVideosPath:function(){return cur.my_added_videos_path},_initScroll:function(){cur._ev_onScroll&&(0,p.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=(0,y.throttle)(R.onScroll,100),(0,p.addEvent)(window,"scroll",cur._ev_onScroll),(0,O.pushNavDestroy)((()=>{(0,p.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=null}))},initOwnerVideoPage:function(){if(cur._videoInited)return;if(cur._videoInited=!0,cur.videoCanSort){if(!R.isInAlbum()){const e=cur.is_showcase?"video_playlist_list":"video_albums_list";(0,x.getGridSorterModule)().then((()=>{cur.albumsSorter=new window.GridSorter(e,"video_item__thumb_link",{onReorder:R._onAlbumReorder})}))}R._createSorters()}R.isGroupsRedesignEnabled()&&Promise.all([t.e(98066),t.e(76400),t.e(76429),t.e(68592),t.e(50320),t.e(3601),t.e(89658)]).then(t.bind(t,26813)).then((({renderVideoExtraTabsActions:e,mapRawVideosOrderItemToVideosOrderItem:o})=>{e({commentsTooltipText:c.getLang("video_comments_review"),orderItems:cur.videoSortItems.map(o),canSeeComments:!!cur.canSeeCommentsPage,canSeeOrder:!!cur.canSeeOrder,onCommentsButtonClick:()=>{var e,o;return(null==(o=nav)||null==(e=o.objLoc)?void 0:e[0])&&nav.go(nav.objLoc[0]+"/comments")},onVideosOrderChange:R._sortVideos})}));const e=(0,i.ge)("video_sort_dd");e&&(cur.videoSortDD=new InlineDropdown(e,{items:cur.videoSortItems,withArrow:!0,ariaLabel:c.curLang("video_search_order"),selected:"default",onSelect:R._sortVideos})),R._toggleSorter("albums"!==R.getLoc().section)},_toggleSorter:function(e){const o=(0,i.geByClass1)("video_tab_actions_wrap"),t=[(0,i.geByClass1)("_video_sort_dd_wrap",o),(0,i.geByClass1)("divider",o)];(0,i.toggle)(t[0],e),(0,i.toggle)(t[1],e)},updateEmptyPlaceholder:function(e){if(!e)return;let o=!1,t="";"albums"===e?cur.playlistsCount||(o=!0,t=c.getLang("video_no_albums_placeholder_text")):cur.videosCount[cur.getOwnerId()][e]||(o=!0,t=c.getLang("video_no_videos_here_yet")),R._toggleEmptyPlaceholder(o,t)},initNavigation:function(){(0,m.pickTrackCodeFromURL)(),cur.nav.push((function(e,o,t,n){const s=void 0!==e[0],c=!cur.is_showcase&&"comments"===t.section,a=t.q&&!o.q&&t[0].indexOf("video")>=0,d=o.q&&!t.q&&o[0].indexOf("video")>=0,u="upload"===o.section&&!t.section,_=e.q;if(a||_?R._initSearchStats(t):d&&R._clearSearchStats(),(0,r.revertLastInlineVideo)(),c)return delete cur._back,!0;if(s){const o=cur.getOwnerId();if(o==vk.id&&(cur.is_showcase||!(0,g.inArray)(e[0],["video","videos"+o])))return!0;if(o!=vk.id&&!(0,g.inArray)(e[0],["videos"+o]))return!0}if(u)return!0;if(uiTabs.hideProgress("video_main_tabs"),"all"===e.section&&delete t.section,a&&(cur.videoLocBeforeSearch=o),d&&(cur.videoSearchFilters={},cur.lastProcessedSearchParams=null,R.doSearch(),R.inputVal(cur.searchInputEl,""),cur.videoLocBeforeSearch&&n.fromSearch)){const e=(0,g.clone)(cur.videoLocBeforeSearch);return delete cur.videoLocBeforeSearch,nav.go(e),!1}const h=t.section||"all";if(t.q||(0,S.removeSearchPositionTracker)(S.serviceVideo),t.q)R.isInAlbum()||delete t.section,a&&"lives"===cur.section_id&&(t.live=1),R._prepareSearchFilters(t),n.fromSearch||R.inputVal(cur.searchInputEl,t.q),n.fromSearch||n.globalQuery||(n.globalQuery=t.q),R.doSearch(t.q);else{var v;if(cur.is_showcase)return"left_nav"===(null==(v=n.params)?void 0:v._ref)||(nav.setLoc(t),!(!cur.is_showcase||!t.z||o.z===t.z)||(o.section!==t.section||o[0]!==t[0]));if(-1==R.AVAILABLE_TABS.indexOf(h))return~h.indexOf("album")&&(0,l.statlogsValueEvent)("video_play_album",0,"open_album"),!0;{if(R.isInAlbum(o.section))return nav.setLoc(t),!0;(0,g.each)(R.AVAILABLE_TABS,(function(e,o){(0,i.hide)("video_subtab_pane_"+o)})),(0,i.show)("video_subtab_pane_"+h),R.updateEmptyPlaceholder(h);const e=(0,i.domFC)((0,i.ge)("video_tab_"+h));e&&uiTabs.switchTab(e,{noAnim:n.hist}),"albums"!==h?(R.loadSilent(h),cur.videoSortDD&&cur.videoSortDD.select(cur.currentSortings[h]||"default",!0),R._toggleSorter(!0)):R._toggleSorter(!1),R._createSorters(h)}}return!!t.show_original||(nav.setLoc(t),!1)})),(0,O.pushNavDestroy)((()=>{cur.nav.pop()}))},initSearch:function(){cur.searchInputEl=(0,i.ge)("video_search_input"),cur.lastProcessedSearchParams=null,cur._videoRenderedSearchResults={},cur.searchInputEl&&!cur.is_showcase&&((0,i.data)(cur.searchInputEl,"opts").onChange=R.onSearchInputChange,(0,i.data)(cur.searchInputEl,"opts").onBlur=R.onSearchInputBlur,cur.searchInputEl.focus())},onSearchInputChange:function(e,o,t){e=(0,g.trim)(e),o=(0,a.isString)(o)?(0,g.trim)(o):"";let i={};e||((0,g.each)(R.SEARCH_FILTERS,(function(e,o){i[o]=!1})),cur.videoPrevSearchFilters=(0,g.clone)(cur.videoSearchFilters),setTimeout((function(){delete cur.videoPrevSearchFilters}),R.SEARCH_KEEP_FILTERS_DELAY)),e&&cur.videoPrevSearchFilters&&(i=cur.videoPrevSearchFilters,delete cur.videoPrevSearchFilters),nav.change((0,g.extend)({q:e||!1,no_spellcheck:!1,suggest_track_code:t||!1},i),!1,{fromSearch:!0,globalQuery:o})},onSearchInputBlur:function(){(0,g.trim)((0,i.val)(cur.searchInputEl))&&(cur.vSearchInputBlurred=!0)},_sortVideos:function(e){var o,t,n;window.tooltips&&tooltips.hideAll();let r=R._getCurrentSectionType();const s=cur.getOwnerId();"album"===r&&(r=R.getLoc().section);let a=cur.silentLoaded[s][r];if(!a)return R.isGroupsRedesignEnabled()?window.dispatchEvent(new CustomEvent(V.VideoOrderEvents.START_LOADING)):((0,i.show)("video_sort_progress"),(0,i.hide)("video_sort_dd")),void R._addPendingAction(r,(function(){R._sortVideos(e)}));R.isGroupsRedesignEnabled()?window.dispatchEvent(new CustomEvent(V.VideoOrderEvents.END_LOADING)):((0,i.hide)("video_sort_progress"),(0,i.show)("video_sort_dd"));let d=0;a=a.filter((function(e){const o=e[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+e[VideoConstants.VIDEO_ITEM_INDEX_ID];return!cur.videoRecentlyRemoved[o]||(d++,!1)}));const l=cur.videosCount[cur.getOwnerId()];if(d&&l)if(R.isInAlbum()){const e="album_"+R._getSectionAlbumId();l[e]&&(l[e]-=d,(0,i.val)((0,i.geByClass1)("_video_subtitle_counter",(0,i.ge)("video_layout_contents")),(0,c.langNumeric)(l[e],c.curLang("video_playlist_size"))))}else l.all-=d,R.updateTabCounter(l.all);(null==(n=cur.pageVideosList)||null==(t=n[s])||null==(o=t[r])?void 0:o.count)===cur.silentLoaded[s][r].length&&(cur.pageVideosList[s][r].list=a,cur.pageVideosList[s][r].count=a.length),cur.silentLoaded[s][r]=a,clearTimeout(cur._sortTO),cur._sortTO=setTimeout((function(){if(!a.length)return;a.sort((function(o,t){switch(e){case"default":return o[cur.indexIndex]-t[cur.indexIndex];case"new":return t[VideoConstants.VIDEO_ITEM_INDEX_DATE]-o[VideoConstants.VIDEO_ITEM_INDEX_DATE];case"old":return o[VideoConstants.VIDEO_ITEM_INDEX_DATE]-t[VideoConstants.VIDEO_ITEM_INDEX_DATE];case"popularity":return t[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]-o[VideoConstants.VIDEO_ITEM_INDEX_VIEWS];case"short":return o[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]-t[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION];case"long":return t[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]-o[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]}}));(0,i.ge)("video_"+r+"_list").innerHTML="",cur.videoShowWindow&&cur.videoShowWindow[s]&&(cur.videoShowWindow[s][r]=!1),R.showMore(r),R._reinitSorters("default"!==e),cur.currentSortings=cur.currentSortings||{},cur.currentSortings[r]=e}),10)},_reindex:function(e){for(let o=0,t=e.length;o<t;o++)e[o].length>=cur.indexIndex?e[o][cur.indexIndex]=o:e[o].push(o)},_onAlbumReorder:function(e,o,t){const i=e.getAttribute("data-id"),n=t&&!t.getAttribute("nodrag")?t.getAttribute("data-id"):null,r=o&&!o.getAttribute("nodrag")?o.getAttribute("data-id"):null;let s=!1;const c=cur.albumsSorter._contEl;if(cur.is_showcase&&c){if(s=e.classList.contains("VideoCard--first")||e.classList.contains("VideoCard--second"),!s){const e=[...c.querySelectorAll(".js-video_playlist_item")];e.length&&(s=e[0].getAttribute("data-id")===i||e[1].getAttribute("data-id")===i)}const o=c.querySelector(`.VideoPlaylistInfo[data-id='${i}']`);o&&e.insertAdjacentElement("afterend",o)}s&&[...c.querySelectorAll(".js-video_playlist_item:not(.VideoCard--isSystem)")].forEach(((e,o)=>{e.classList.toggle("VideoCard--first",0===o),e.classList.toggle("VideoCard--second",1===o)})),ajax.post("al_video.php?act=reorder_albums",{oid:cur.getOwnerId(),aid:i,before:r,after:n,hash:cur.videoAlbumsSortHash,need_update:s?1:0},{onDone:function(e){R._updatePlaylistPanel(e)}})},_onReorder:function(e,o,t){const n=cur.getOwnerId(),r=(0,i.domData)(e,"id"),s=t?(0,i.domData)(t,"id"):null,c=o?(0,i.domData)(o,"id"):null;let a=R._getCurrentSectionType();"album"===a&&(a=R.getLoc().section.split("_")[1]);const d=R._getCurrentSectionType(),l=cur.silentLoaded[n][d];if(l){let e=-1,o=-1;if((0,g.each)(l,(function(t,i){const n=i[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+i[VideoConstants.VIDEO_ITEM_INDEX_ID];if(n==r&&(e=t),n==s&&(o=t),o>=0&&e>=0)return!1})),e>=0){const t=l.splice(e,1)[0];o<0?l.unshift(t):(o>e&&o--,l.splice(o+1,0,t)),R._reindex(l)}}let u=!1;if(cur.is_showcase){if(u=e.classList.contains("VideoCard--first"),!u){const e=document.querySelector(`._video_playlist_${a}_list .VideoCard`);e&&(u=e.getAttribute("data-id")===r)}u&&[...document.querySelectorAll(`._video_playlist_${a}_list .VideoCard`)].forEach(((e,o)=>{e.classList.toggle("VideoCard--first",0===o)}))}ajax.post("al_video.php?act=reorder_videos",{album_id:a,target_id:n,vid:r,before:c,after:s,hash:cur.videoSortHash,ref:window.cur.ref,update_cover:u?1:0},{onDone:function(e,o,t){if(e){var i;const t=document.querySelector(".VideoInfoPanel--playlistPage");null==(i=t)||i.classList.toggle("VideoInfoPanel--hasRestriction",o);const n=t.querySelector(".VideoInfoPanel__coverImage");if(n){n.src=e;const i=t.querySelector(".VideoInfoPanel__coverIcon");i&&(i.innerHTML=o?(0,w.getIcon24HideOutline)().icon:"")}}R._updatePlaylistPanel(t)}})},_updatePlaylistPanel:function(e){if(!e)return;const o=document.getElementById("own_playlist_panel");o&&(o.innerHTML="",o.insertAdjacentHTML("beforeend",e))},_prepareSearchFilters:function(e){return cur.videoSearchFilters={},(0,g.each)(R.SEARCH_FILTERS,(function(o,t){let i=e[t];(0,a.isString)(i)&&(i=(0,a.htsc)(i)),cur.videoSearchFilters[t]=i})),cur.videoSearchFilters},onFilterRemoved:function(e){R._setFilterSelector(e),clearTimeout(cur._frto),cur._frto=setTimeout(R._onFiltersChanged,10)},_setFilterSelector:function(e,o){const t=cur["videoFilter_"+e];let n;return!!t&&("Selector"===t.__className?(void 0===o&&(o=t.options.defaultItems[0][0]),t.selectItem(o,!1),n=(0,g.clone)(t.selectedItems()[0]),n.push(n[0]==t.options.defaultItems[0][0])):(0,i.hasClass)(t,"checkbox")&&((0,i.toggleClass)(t,"on",!!o),n=[!!o,(0,i.data)(t,"title"),!o]),n)},_onFiltersChanged:function(){const e=(0,f.isChecked)("video_fltr_hd"),o=(0,f.isChecked)("video_fltr_notsafe"),t=(0,f.isChecked)("video_fltr_live"),i=cur.videoFilter_len.selectedItems()[0][0],n=cur.videoFilter_date.selectedItems()[0][0],r=cur.videoFilter_order.selectedItems()[0][0];nav.change({hd:!!e&&"1",len:i>0&&i,date:n>0&&n,order:r>=0&&r,notsafe:!!o&&"1",live:!!t&&"1"},!1,{filtersChanged:!0})},initFilters:function(){if(!(0,i.geByClass1)("video_search_input"))return;cur.videoFilter_len=new Dropdown((0,i.ge)("video_fltr_len"),cur.lenFilters,{big:1,zeroPlaceholder:!0,onChange:R._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_date=new Dropdown((0,i.ge)("video_fltr_date"),cur.dateFilters,{big:1,zeroPlaceholder:!0,onChange:R._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_order=new Dropdown((0,i.ge)("video_fltr_order"),cur.orderFilters,{big:1,zeroPlaceholder:!0,onChange:R._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_hd=(0,i.ge)("video_fltr_hd"),(0,p.removeEvent)(cur.videoFilter_hd,"click"),(0,p.addEvent)(cur.videoFilter_hd,"click",R._onFiltersChanged),(0,i.data)(cur.videoFilter_hd,"title",c.curLang("video_hd_checkbox")),vk.id&&(cur.videoFilter_notsafe=(0,i.ge)("video_fltr_notsafe"),(0,p.removeEvent)(cur.videoFilter_notsafe,"click"),(0,p.addEvent)(cur.videoFilter_notsafe,"click",R._onFiltersChanged),(0,i.data)(cur.videoFilter_notsafe,"title",c.curLang("video_filter_no_safe"))),cur.videoFilter_live=(0,i.ge)("video_fltr_live"),(0,p.removeEvent)(cur.videoFilter_live,"click"),(0,p.addEvent)(cur.videoFilter_live,"click",R._onFiltersChanged),(0,i.data)(cur.videoFilter_live,"title",c.curLang("video_filter_live"));const e=R.getLoc().q;e&&(R._prepareSearchFilters(R.getLoc()),cur.searchText=e,R.inputVal(cur.searchInputEl,cur.searchText),R.doSearch(e))},_isGeneralSection:function(e){for(let o=0;o<R.AVAILABLE_TABS.length;o++)if(e==R.AVAILABLE_TABS[o])return!0;return!1},showMoreShowcase:function(e,o,t=(()=>{})){if(!(0,i.isVisible)(o)||(0,f.isButtonLocked)(o))return;(0,f.lockButton)(o);const n={silent_loading:1,next_from:cur.listNextFrom,__showcase_session_id:cur.showcaseSessionId},r=window.nav.strLoc;ajax.post(r,n,{onDone:function(n){const{videos:s,playlists:c,nextFrom:d,communities:l,shopping:u,shoppingVideos:_}=JSON.parse(n);if(d&&(cur.listNextFrom=d),"type_my_communities"===e)return void R.showMoreCommunities(l,d,o);if(!(0,a.isEmpty)(u)&&void 0!==u)return void R.showMoreShopping(_,d,o,t);if(r!==window.nav.strLoc)return;const h=document.getElementById(`video_${e}_list`),v=document.createDocumentFragment(),g=!(0,T.partConfigEnabled)("video_showcase_subscriptions_disable_date_separation"),p=[];if(!(0,a.isEmpty)(s)){for(let o of s){if("type_my_history"===e||"type_subscribes"===e&&g){let t;if(t="type_my_history"===e?o[VideoConstants.VIDEO_ITEM_INDEX_VIEWED_DAY]:Math.floor(1e3*o[VideoConstants.VIDEO_ITEM_INDEX_DATE]/R.DAY_IN_MS)*R.DAY_IN_MS,t){if(!document.querySelector(`.VideoGrid__separator[data-date='${t}']`)&&-1===p.indexOf(t)){p.push(t);const e=(0,C.buildDateSeparatorEl)(t);v.appendChild(e)}}}const t=R.buildVideoEl(o,!0);v.appendChild(t)}if(cur.catPlaylistId&&(cur.catVideosList[cur.catPlaylistId].list.push(...s),window.VideoPlaylist&&window.mvcur)){const e=window.VideoPlaylist.getCurList();e&&(window.VideoPlaylist.addVideosToBlockList(s,!e.reversed,e.reversed),d&&s&&s.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}}if(!(0,a.isEmpty)(c))for(let e of c){const o=R.buildPlaylistEl(e,!0);v.appendChild(o)}h.appendChild(v),(0,f.unlockButton)(o),d||(0,i.hide)(o),"function"==typeof t&&t()},onFail:()=>{(0,f.unlockButton)(o)},timeout:3e4})},showMoreOwnerPlaylists:function(){if(!cur.playlistsNextOffset||cur.loadingAlbums)return;cur.loadingAlbums=!0;const e=document.getElementById("video_all_playlists_list"),o=document.getElementById("ui_all_playlists_load_more");(0,f.lockButton)(o),ajax.post("/video?act=more_owner_playlists",{owner_id:cur.oid,offset:cur.playlistsNextOffset},{onDone:(t,n,r,s)=>{var c;null==(c=e)||c.insertAdjacentHTML("beforeend",t),window.VideoShowcase.initPlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),cur.playlistsNextOffset=s,cur.loadingAlbums=!1,(0,f.unlockButton)(o),s||(0,i.hide)(o)},onFail:()=>{cur.loadingAlbums=!1,(0,f.unlockButton)(o)}})},showMoreSubscriptionsPlaylists:function(){if(!cur.playlistsNextOffset||cur.loadingAlbums)return;cur.loadingAlbums=!0;const e=document.getElementById("video_all_playlist_subscriptions_list"),o=document.getElementById("ui_all_playlist_subscriptions_load_more");(0,f.lockButton)(o),ajax.post("/video?act=more_subscriptions_playlists",{owner_id:cur.oid,offset:cur.playlistsNextOffset},{onDone:(t,n)=>{var r;null==(r=e)||r.insertAdjacentHTML("beforeend",t),window.VideoShowcase.initPlaylistSlider(),cur.playlistsNextOffset=n,cur.loadingAlbums=!1,(0,f.unlockButton)(o),n||(0,i.hide)(o)},onFail:()=>{cur.loadingAlbums=!1,(0,f.unlockButton)(o)}})},showMoreCommunities:function(e,o,t){const n=document.getElementById("video_type_my_communities_list"),r=document.createDocumentFragment();if(!(0,a.isEmpty)(e))for(let o of e)(0,g.each)((0,C.buildCommunityEl)(o),(function(e,o){r.appendChild(o)}));n.appendChild(r),window.VideoShowcase.updatePlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),(0,f.unlockButton)(t),o||(0,i.hide)(t)},showMoreShopping:function(e,o,t,n){const r=document.querySelectorAll("#video_subtab_pane_type_trends"),s=r[r.length-1].firstElementChild,c=document.createDocumentFragment();for(let o of e){const e=R.buildVideoEl(o,!0);c.appendChild(e)}if(cur.catPlaylistId&&(cur.catVideosList[cur.catPlaylistId].list.push(...e),window.VideoPlaylist&&window.mvcur)){const t=window.VideoPlaylist.getCurList();t&&(window.VideoPlaylist.addVideosToBlockList(e,!t.reversed,t.reversed),o&&e&&e.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}s.appendChild(c),window.VideoShowcase.updatePlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),(0,f.unlockButton)(t),o||(0,i.hide)(t),"function"==typeof n&&n()},loadSilent:function(e){e=e||"all";const o=cur.getOwnerId(),t=R.isInAlbum(e),i=!!cur.isSnippetVideoSelection;if(!t&&!this._isGeneralSection(e)||"albums"==e)return;cur.silentLoaded=cur.silentLoaded||{},cur.silentLoaded[o]=cur.silentLoaded[o]||{},cur.silentLoadingProgress=cur.silentLoadingProgress||{},cur.silentLoadingProgress[o]=cur.silentLoadingProgress[o]||{};const n=cur.silentLoadingProgress[o][e];!0!==n&&cur.pageVideosList&&cur.pageVideosList[o]&&(!1!==n?void 0===n&&(cur.silentLoadingProgress[o][e]=!0,function(e){function n(t,i){cur.silentLoadingProgress&&cur.silentLoadingProgress[o]&&(cur.silentLoadingProgress[o][e]=!1,t&&(t.length&&(cur.indexIndex=t[0].length),R._reindex(t),cur.silentLoaded[o][e]=t),i&&(cur.albumsPreload[o]=!1,cur.silentLoaded[o].albums=i),R.indexItems((function(){cur.silentLoadingProgress&&(R._callPendingAction(e),i&&R._callPendingAction("albums"),cur.is_showcase?R.onScroll():R.showMore(e))})))}const r=cur.pageVideosList[o][e],s=!!r&&cur.videosCount[o][e]<=r.list.length,c=!!t||cur.albumsPreload&&cur.playlistsCount<=cur.albumsPreload[o].length;if(c&&(cur.silentLoaded[o].albums=cur.albumsPreload[o]),s&&c)n(cur.pageVideosList[o][e].list,cur.albumsPreload[o]);else if(cur.noVideos)n([],[]);else{const t=!cur.videosCount||!cur.videosCount[o],r=!cur.playlistsCount;if(t&&r)return n([],[]);const s=cur.VIDEO_SILENT_VIDEOS_CHUNK_SIZE;let a=0;if(cur.videosCount[o]&&cur.videosCount[o][e]){const t=Math.min(cur.videosCount[o][e],cur.VIDEO_SILENT_VIDEOS_MAX_SIZE);a=Math.ceil(t/s)}const d=Math.ceil((cur.playlistsCount||0)/s),l=Math.max(a,d),u=new Array(a);let _=[];const h=()=>{n([].concat.apply([],u),_)},v=new window.callHub(h,l);if(0==l)return n([],[]);let p;for(let t=0;t<l;t++)!function(t){if(cur.serverPaging&&!cur.isCurrentVideoLayer){if(cur.pageVideosList[o]){n(cur.pageVideosList[o].all||[],[])}}else{const n="/al_video.php?act=load_videos_silent",r={oid:o,section:e,rowlen:R.VIDEOS_PER_ROW,offset:t*s,snippet_video:i?1:0,need_albums:(0,g.intval)(!c&&"all"==e&&(0,g.intval)(0==t))};p=()=>{ajax.post(n,r,{onDone:function(o,i,n){n&&(cur.listNextFrom=n),o&&o[e]&&o[e].list?u[t]=o[e].list:u[t]=[],0==t&&(_=i),v.done()}})},cur.direct_link?(0,V.idlizeCall)(p):p()}}(t)}}(e)):R._callPendingAction(e))},indexItems:function(e){if(!cur.getOwnerId)return;let o=0;const t=cur.getOwnerId();cur.videoIndexes=cur.videoIndexes||{},cur.videoIndexes[t]=cur.videoIndexes[t]||{},(0,g.each)(cur.silentLoaded[t],(function(e){cur.videoIndexes[t][e]||o++}));const i=new callHub(e,o);(0,x.getIndexerModule)().then((()=>{(0,g.each)(cur.silentLoaded[t],(function(e,o){cur.videoIndexes[t][e]||(cur.videoIndexes[t][e]=new vkIndexer(o,(function(o){return"albums"===e?o[0]:o[VideoConstants.VIDEO_ITEM_INDEX_TITLE]}),(function(){i.done()})))}))}))},_updateSearchPageTitle:function(e){(0,h.curBox)()||(e?(cur.prevVideoPageTitle||(cur.prevVideoPageTitle=document.title),(0,i.setDocumentTitle)(c.getLang("video_title_search").replace("{q}",e))):cur.prevVideoPageTitle&&(0,i.setDocumentTitle)(cur.prevVideoPageTitle))},inputVal:function(e,o){if((0,i.val)(e)==o)return;(0,i.val)(e,o);const t=(0,i.gpeByClass)("_wrap",e);(0,i.toggleClass)(t,"ui_search_field_empty",!o)},doSearch:function(e){if(!cur.searchInputEl)return;const o=(0,g.trim)(e),t=o+R._buildFiltersSearchStr();if(cur.lastProcessedSearchParams===t)return;cur.videoLocalSearchQuery=o,cur.videoGlobalSearchQuery=o;const n=cur.searchQueryId&&cur.videoSearchTrackCodeForQID?cur.searchQueryId:(0,S.generateQID)();cur.searchQueryId=n,(0,g.each)(R.SEARCH_FILTERS,(function(e,o){const t=R._setFilterSelector(o,cur.videoSearchFilters[o]);t&&uiSearch.toggleFilter(cur.searchInputEl,o,t[1],!t[2])})),cur.noEmptyLocalResults=R.isInCatalog();const r=[R.VIDEO_SEARCH_TYPE,R.ALBUM_SEARCH_TYPE,R.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE,R.VIDEO_GLOBAL_SEARCH_TYPE];R.isInSearch()&&cur.noEmptyLocalResults&&r.pop(),(0,g.each)(r,(function(e,o){(0,i.hide)("video_subtab_pane_"+o)})),o||R._toggleSearchContent(!1),(0,h.curBox)()?(0,i.ge)("box_layer_wrap").scrollTop=0:(0,_.scrollToTop)(cur.is_showcase?500:1e3);const s=R.isInAlbum()?R.getLoc().section:"all";R._clearPendingAction(s),R._updateSearchPageTitle(o),o?(R._addPendingAction(s,(function(){const e=R._searchLocally(o);(0,S.saveSearchAttemptStats)(S.serviceVideo,0,e,o,n,0,"0","",S.blockNameOwn),cur.lastProcessedSearchParams=t,e<15&&R._searchGlobally(o)})),R.loadSilent(s),R._searchGlobally(o)):cur.lastProcessedSearchParams=t},getCurrentGlobalSearchKey(){if(!window.cur.searchInputEl)return"";const e=(0,g.trim)((0,i.val)(window.cur.searchInputEl));return e?e+R._buildFiltersSearchStr():""},isGlobalSearchMode:()=>!!R.getCurrentGlobalSearchKey(),shouldShowSectionInPlaylistWithSearch:()=>!R.shouldShowSearchInPlaylistWithSearch()&&!R.shouldShowOtherInPlaylistWithSearch(),shouldShowOtherInPlaylistWithSearch:()=>"other"===window.cur.videosInSearchPlaylistAB,shouldShowSearchInPlaylistWithSearch:()=>"search"===window.cur.videosInSearchPlaylistAB,_searchGlobally:function(e,o){if(!e)return;o=(0,g.intval)(o)||0;const t=cur.searchQueryId,i=o>0;cur.globalSearchResults=cur.globalSearchResults||{};const n=e+R._buildFiltersSearchStr(),r=cur.globalSearchResults[n];if(!i&&r)return(0,S.saveSearchAttemptStats)(S.serviceVideo,0,r.count,e,t,r.eventBits,"1",r.modelName,S.blockNameSearch,"",r.isAnonym),cur.globalSearchInProgress=!1,R._showGlobalSearchResults(e),void R._toggleSearchProgress(!1);if(cur.globalSearchInProgress===e)return;cur.globalSearchInProgress=e;const s=!!cur.isSnippetVideoSelection,c={q:e,offset:o,from:cur.oid,query_id:t};s&&(c.snippet_video=1),cur.videoSearchTrackCodeForQID&&(c.track_code_for_qid=cur.videoSearchTrackCodeForQID,cur.videoSearchTrackCodeForQID=""),i||R._toggleSearchProgress(!0);const a=Date.now(),d={onDone:function(o,r,s,c,d,l,u,_,v,g,p){if(!i){R._toggleSearchProgress(!1),cur.lastEventBits=u,cur.lastModelName=_;const i=Date.now()-a;(0,S.saveSearchAttemptStats)(S.serviceVideo,0,o,e,p||t,u,i,_,S.blockNameSearch,"",g),cur.searchQueryId=p}cur.globalSearchInProgress=!1,(0,h.curBox)()&&(d=!1),cur.globalSearchResults=cur.globalSearchResults||{},cur.globalSearchResults[n]=cur.globalSearchResults[n]||{count:0,countHash:r,list:[],realOffset:0,promoPlaylists:d,modelName:_,eventBits:u,playlistTotalCount:v,isAnonym:g};const f=cur.globalSearchResults[n];f.done=f.done||!s.list||0==s.list.length;const m=f.list.length;if(!f.done){const e=s.list[0];let t=0;for(let o=f.list.length-1;o>=0;o--){const i=f.list.length-o;if(i>20)break;const n=f.list[o];if(e[0]==n[0]&&e[1]==n[1]){t=i;break}}f.count=parseInt(o);const i=s.list.slice(t);if(Array.prototype.push.apply(f.list,i),window.VideoPlaylist&&window.mvcur){var w;const e=window.VideoPlaylist.getCurList();(null==(w=e)?void 0:w.id)===R.VIDEO_GLOBAL_SEARCH_TYPE&&(window.VideoPlaylist.addVideosToBlockList(i,!e.reversed,e.reversed),!c&&i&&i.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}const n=f.list.length%R.VIDEOS_PER_ROW;o>R.VIDEOS_PER_PAGE&&n&&f.list.length<f.count&&(f.list.splice(-n,R.VIDEOS_PER_ROW),l-=n),f.realOffset=l}(c||!f.done&&f.list.length==m)&&(f.done=!0),R._showGlobalSearchResults(e,i)}};cur.is_showcase?(clearTimeout(cur.searhRequestTimeout),cur.searhRequestTimeout=setTimeout((()=>{cur.is_section&&(0,T.partConfigEnabled)("search_video_catalog_web2")||ajax.post("/al_video.php?act=search_video",(0,g.extend)(c,cur.videoSearchFilters),d)}),300)):ajax.post("/al_video.php?act=search_video",(0,g.extend)(c,cur.videoSearchFilters),d)},toggleSearchProgress:function(e){R._toggleSearchProgress(e)},_toggleSearchProgress:function(e){cur.is_showcase||(cur.searchProgressRef=cur.searchProgressRef||0,cur.searchProgressRef=Math.max(0,cur.searchProgressRef+(e?1:-1)),e=cur.searchProgressRef>0);const o=(0,i.geByClass1)("ui_search_fltr_control",(0,i.geByClass1)("video_search_input")),t=(0,i.geByClass1)("ui_search_fltr_progress",o);(0,i.toggle)(t,e),(0,i.hasClass)(o,"shown")||(0,i.toggleClass)((0,i.gpeByClass)("_wrap",cur.searchInputEl),"ui_search_loading",e)},_buildFiltersSearchStr:function(){const e=[];return(0,g.each)(cur.videoSearchFilters||{},(function(o,t){t&&e.push(o+":"+t)})),"$"+e.join("#")},_toggleEmptySearchPlaceholder:function(e,o,t){const n=(0,i.ge)("video_empty_placeholder_search");let r=B.Ranges.isGroupId(cur.getOwnerId())?c.getLang("video_not_found_group"):c.getLang("video_not_found_user");if(cur.getOwnerId()==vk.id&&(r=c.getLang("video_not_found_yours")),R.isInAlbum()&&(r=c.getLang("video_not_found_in_album")),R.isInCatalog()&&(r=c.getLang("video_not_found_globally")),o){const e=r.replace("{searchText}",'<b class="VideoEmptyStub__token">'+(0,g.clean)(o.replace(/\$/g,"$$$$"))+"</b>");n.classList.contains("VideoEmptyStub")?n.querySelector(".VideoEmptyStub__text").innerHTML=e:n.innerHTML=e}if((0,i.toggle)(n,e),t){let e=!0;const o=(0,i.ge)("video_layout_search");(0,g.each)((0,i.domChildren)(o),(function(){if((0,i.isVisible)(this))return e=!1,!1})),e&&(0,i.toggle)(n,!0)}},_toggleEmptyPlaceholder:function(e,o){const t=(0,i.ge)("video_empty_placeholder_main");e&&t&&(t.classList.contains("VideoEmptyStub")?t.querySelector(".VideoEmptyStub__text").innerHTML=o:t.innerHTML=o),(0,i.toggle)(t,e)},_showSearchResult:function(e){const o=cur.found[e],t=cur.getOwnerId();if((0,i.toggle)("video_subtab_pane_"+e,!!o.count&&!!o.list),o.count){let n="";switch(e){case R.ALBUM_SEARCH_TYPE:n=R.isInAlbum()?c.curLang("video_found_albums_in_album"):B.Ranges.isGroupId(cur.getOwnerId())?c.curLang("video_found_albums_community"):cur.getOwnerId()==vk.id?c.curLang("video_found_albums_yours"):c.curLang("video_found_albums_of");break;case R.VIDEO_SEARCH_TYPE:n=R.isInAlbum()?c.curLang("video_found_videos_in_album"):B.Ranges.isGroupId(cur.getOwnerId())?c.curLang("video_found_videos_community"):cur.getOwnerId()==vk.id?c.curLang("video_found_videos_yours"):c.curLang("video_found_videos_of");break;case R.VIDEO_GLOBAL_SEARCH_TYPE:n=cur.is_showcase?c.getLang("video_found_videos"):c.curLang("video_found_videos_global");break;case R.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE:n=cur.is_showcase?c.getLang("video_search_playlists"):c.getLang("video_search_promo_playlists")}n=(0,c.langNumeric)(o.count,n,!0),n=n.replace("{user}",c.curLang("video_owner_name_gen"));const r=(0,i.ge)("video_subtab_pane_"+e),s=(0,i.geByClass1)("js-video-subtitle",r);if((0,i.val)(s,n),cur.is_showcase&&o.count){const e=(0,i.geByClass1)("js-video-subtitle-counter",r);(0,i.val)(e,(0,c.langNumeric)(o.count,"%s",!0))}let a=e==R.VIDEO_GLOBAL_SEARCH_TYPE?cur.videoGlobalSearchQuery:cur.videoLocalSearchQuery;a+=R._buildFiltersSearchStr(),cur._videoRenderedSearchResults=cur._videoRenderedSearchResults||{};const d=cur._videoRenderedSearchResults;d[e]!=a&&(d[e]=a,(0,i.ge)("video_"+e+"_list").innerHTML="",cur.videoShowWindow&&cur.videoShowWindow[t]&&delete cur.videoShowWindow[t][e],R.showMore(e))}},_showGlobalSearchResults:function(e,o){const t=e+R._buildFiltersSearchStr(),i=cur.getOwnerId(),n=R.isInAlbum()?R.getLoc().section:"all",r=cur.is_showcase||!!cur.silentLoaded[i][n];if((e==cur.videoGlobalSearchQuery||e==cur.videoLocalSearchQuery)&&r&&cur.globalSearchResults[t]&&cur.globalSearchResults[t].count>=0){const i=cur.globalSearchResults[t];cur.found[R.VIDEO_GLOBAL_SEARCH_TYPE]={list:i.list,count:i.count,done:i.done,realOffset:i.realOffset},cur.found[R.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE]={list:i.promoPlaylists,count:i.playlistTotalCount||i.promoPlaylists.length,done:!i.promoPlaylists.length},cur.noEmptyLocalResults&&(R._toggleSearchContent(!0),0==i.count?R._toggleEmptySearchPlaceholder(!0,e):R._toggleEmptySearchPlaceholder(!1)),o||(R._showSearchResult(R.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE),R._showSearchResult(R.VIDEO_GLOBAL_SEARCH_TYPE)),R._callPendingAction(R.VIDEO_GLOBAL_SEARCH_TYPE)}},_toggleSearchContent:function(e){(0,i.toggle)("video_layout_contents",!e),(0,i.toggle)("video_layout_search",!!e),cur.is_showcase&&(0,i.toggle)("video_block_header",!e)},setVisibilityShowcaseContent:function(e){(0,i.toggle)("video_main_block",e)},_searchLocally:function(e){if(cur.found={},!e||!cur.videoIndexes)return!1;const o=cur.getOwnerId(),t=[];let i=[];!R.isInAlbum()&&cur.videoIndexes[o].albums&&(i=cur.videoIndexes[o].albums.search(e),cur.found[R.ALBUM_SEARCH_TYPE]={list:i,count:i.length},R._showSearchResult(R.ALBUM_SEARCH_TYPE));const n=R.isInAlbum()?R.getLoc().section:"all";if(cur.videoIndexes[o][n]){const i=cur.videoIndexes[o][n].search(e);(0,g.each)(i,(function(e,o){(!cur.videoSearchFilters.hd||o[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_HD)&&(!cur.videoSearchFilters.live||o[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_LIVE)&&(Date.now()/1e3-o[VideoConstants.VIDEO_ITEM_INDEX_DATE]>cur.videoSearchFilters.date||t.push(o))})),cur.found[R.VIDEO_SEARCH_TYPE]={list:t,count:t.length},R._showSearchResult(R.VIDEO_SEARCH_TYPE)}return i.length+t.length?(R._toggleSearchContent(!0),R._toggleEmptySearchPlaceholder(!1)):cur.noEmptyLocalResults?R._toggleEmptySearchPlaceholder(!1,void 0,!0):(R._toggleSearchContent(!0),R._toggleEmptySearchPlaceholder(!0,e)),t?t.length:0},onItemEnter:function(e){(0,i.setTitle)(e,e)},showMoreAlbums:function(e){let o=!1;const t=cur.getOwnerId();cur.albumsPreload&&cur.albumsPreload[t]&&!cur.silentLoaded[t].albums&&(cur.silentLoaded[t].albums=cur.albumsPreload[t],o=!0),cur.albumsShowingAll[t]=!0,R.showMore("albums",e),o&&(cur.silentLoaded[t].albums=!1)},prepareVideoItemAttrs:function(e){let o="",t="";const i={};i[VideoConstants.VIDEO_ITEM_FLAG_EXTERNAL]="video_ext",i[VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE]="video_active_live",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_EDIT]="video_can_edit",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DOWNLOAD]="video_can_download",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_ADD]="video_can_add",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE]="video_can_delete",i[VideoConstants.VIDEO_ITEM_FLAG_NO_AUTOPLAY]="video_nap",i[VideoConstants.VIDEO_ITEM_FLAG_ADDED]="VideoCard--videoAdded",i[VideoConstants.VIDEO_ITEM_FLAG_SKIP_THUMB_LOAD]="video_skip_thumb_load",i[VideoConstants.VIDEO_ITEM_FLAG_DELETED]="video_deleted",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE_FROM_HISTORY]="VideoCard--history",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE]="VideoCard--private",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_MEMBERS]="VideoCard--privateMembers",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_BY_LINK]="VideoCard--privateByLink",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_NOT_PUBLISHED]="VideoCard--privateNotPublished",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_MOVE]="video_can_edit_albums",i[VideoConstants.VIDEO_ITEM_FLAG_HORIZONTAL]="VideoCard--horizontal";const n=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS];(0,g.each)(i,(function(e,t){n&e&&(o+=t+" ")})),n&VideoConstants.VIDEO_ITEM_FLAG_SCHEDULED&&(o+=" VideoCard--scheduled"),e[VideoConstants.VIDEO_ITEM_INDEX_PLATFORM]||e[VideoConstants.VIDEO_ITEM_INDEX_DURATION]||n&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE||(o+=" video_no_duration"),cur.is_showcase&&n&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE&&(o+=" video_no_duration"),e[VideoConstants.VIDEO_ITEM_INDEX_DATE]||(o+=" no_date");const r=e[VideoConstants.VIDEO_ITEM_INDEX_MUSIC_VIDEO_META];r&&r.explicit&&(o+=" video_explicit");const s=!(n&VideoConstants.VIDEO_ITEM_FLAG_CAN_EDIT||n&VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE),c=e[VideoConstants.VIDEO_ITEM_INDEX_BLOCKED],a=!(n&VideoConstants.VIDEO_ITEM_FLAG_CAN_ADD);return s&&(a||c)&&(o+=" video_no_actions"),c&&(o+=" video_blocked"),cur.videoCanAddAlbums&&!c&&(o+=" video_can_edit_albums"),cur.isSnippetVideoSelection&&(o+=" no_video_select_btn"),n&VideoConstants.VIDEO_ITEM_FLAG_NEED_SIGN_IN&&(t+=' rel="nofollow"'),[o,t]},buildVideoEl:function(e,o=!1,t=!1){return(0,C.buildVideoEl)(e,o)},buildPlaylistEl:function(e,o=!1){return(0,C.buildPlaylistEl)(e,o)},addShowMoreButton:function(e,o){if(!e||!o||0===o.length)return;const t=(0,i.ce)("div",{className:(R.showMoreClassNames||"").replace("%type%",o),innerHTML:c.curLang("video_show_more")});return e.parentNode.append(t),t.onClick=R.showMore(o,t),t},onMoreLoaded:function(e,o,t,n,r){R._loading=!1;const s=cur.getOwnerId(),c=cur.videoShowWindow[s][o],a=(0,i.ge)("video_"+o+"_list"),d=(0,i.gpeByClass)("ge_video_pane",a),l=a.classList.contains("VideoGrid");let u;if(a){e=(0,i.geByClass1)("ui_load_more_btn",d);const h=o.indexOf("albums")>=0,v=h?0:3;let p=R._getCurrentSectionType();p="album"==p?R.getLoc().section:"all";let f=!1;var _;if(o.indexOf("search")>=0&&cur.videoIndexes&&cur.searchText)f=new RegExp("("+cur.searchText.replace(/\|/g,"").replace(null==(_=cur.videoIndexes[s][p])?void 0:_.delimiter,"|").replace(/^\||\|$/g,"").replace(/([\+\*\)\(])/g,"\\$1")+")","gi");for(let e=0,i=t.length;e<i;e++){const i=(0,g.extend)({},t[e]);f&&!l&&(i[v]=i[v].replace(f,"<em>$1</em>")),u=h?R.buildPlaylistEl(i,l):R.buildVideoEl(i,l),o==R.VIDEO_GLOBAL_SEARCH_TYPE&&u.setAttribute("data-search-pos",e+c.offset),a.appendChild(u)}!e&&!r&&!c.done&&n>c.offset&&(e=R.addShowMoreButton(a,p)),c.offset=n,c.done=!t.length||r,(0,i.toggle)(e,!c.done),cur.is_showcase&&d.classList.toggle("VideoPane--noMore",c.done),o==R.VIDEO_GLOBAL_SEARCH_TYPE&&(cur.videoSearchStats||R._initSearchStats(R.getLoc()),cur.videoSearchStats.lastActionTime=Date.now(),R._updateLastSeenElement(a))}},showMore:function(e,o){e=e||R._getCurrentSectionType();const t=(0,h.curBox)()?(0,h.curBox)().bodyNode:void 0,n=(0,i.geByClass1)("_video_"+e+"_list",t);if(!n)return;const r=R.isInAlbum(e),s=cur.getOwnerId();if((r||-1!=R.AVAILABLE_TABS.indexOf(e))&&!cur.silentLoaded[s][e])return void((0,f.isButtonLocked)(o)||(R._addPendingAction(e,(function(){R.showMore(e,o)})),(0,f.lockButton)(o)));let a;(0,f.unlockButton)(o),cur.videoShowWindow=cur.videoShowWindow||{},cur.videoShowWindow[s]=cur.videoShowWindow[s]||{},cur.videoShowWindow[s][e]||(cur.videoShowWindow[s][e]={done:!1,offset:n.children.length});const d=cur.videoShowWindow[s][e];if(!d.done)if(e.indexOf("search")>=0&&cur.found[e]){let t,r,s;if(e===R.VIDEO_GLOBAL_SEARCH_TYPE){if(a=cur.found[e].list.length,t=cur.found[e].realOffset||a,r=cur.found[e].list.slice(d.offset,a),s=cur.found[e].done,!s&&0===r.length)return R._addPendingAction(e,(function(){R.showMore(e,o)})),(0,f.lockButton)(o),void(cur.globalSearchInProgress||R._searchGlobally(cur.videoGlobalSearchQuery,t))}else if(e===R.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE){const t=0===d.offset,n=(0,i.ge)("video_"+e+"_list"),c=n.classList.contains("VideoGrid");if(!t)return(0,f.lockButton)(o),void R.showMorePlaylist(cur.videoGlobalSearchQuery,d.offset,((t,i,r)=>{c&&n.classList.remove("VideoGrid--oneRow"),(0,f.unlockButton)(o),R.onMoreLoaded(o,e,i,r,t)}));a=cur.found[e].list.length,r=cur.found[e].list,s=a>=cur.found[e].count,c&&n.classList.add("VideoGrid--oneRow")}else if(cur.is_showcase&&e===R.ALBUM_SEARCH_TYPE){if(0===d.offset){a=R._getNumberOfVideoGridColumns()||R.PLAYLIST_FIRST_CHUNK_SIZE,r=cur.found[e].list.slice(0,a);const o=cur.found[e].list.length-a;if(o>0){s=!1;const e=(0,i.geByClass1)("ui_load_more_btn",(0,i.gpeByClass)("ge_video_pane",n));if(e){const t=c.curLang("video_show_more_playlists").map((e=>e.replace("%s",'<span class="VideoShowMoreButton__counter">%s</span>')));e.innerHTML=(0,c.langNumeric)(o,t)}}else s=!0}else(0,i.ge)("video_"+e+"_list").classList.remove("VideoGrid--oneRow"),r=cur.found[e].list.slice(d.offset,cur.found[e].list.length),s=!0}else a=d.offset+R.VIDEOS_PER_PAGE,r=cur.found[e].list.slice(d.offset,a),s=a>=cur.found[e].list.length;R.onMoreLoaded(o,e,r,a,s)}else if((r||-1!=R.AVAILABLE_TABS.indexOf(e))&&cur.silentLoaded[s][e]){const t=cur.silentLoaded[s][e];if(!a&&!t.length)return cur.is_showcase?void(0,i.hide)(o):void R._toggleEmptyPlaceholder(!0,c.getLang("video_no_videos_here_yet"));a=Math.min(t.length,d.offset+R.VIDEOS_PER_PAGE);const n=t.slice(d.offset,a);let r;if("albums"===e&&cur.albumsPreload[s])r=cur.albumsNoMore,cur.albumsPreload[s]=!1;else{r=a>=t.length;const e=Math.ceil(a,R.VIDEOS_PER_PAGE);if(window.cur.unauthScrollMoreBox){const{ownerId:o,screens:t}=window.cur.unauthScrollMoreBox;e>t&&R.getCurOwnerId()===o&&(window.cur.unauthScrollMoreBox.needShow=!0,r=!0)}}"albums"===e&&(cur.albumsShowingAll[s]=!r),R.onMoreLoaded(o,e,n,a,r)}R._updateThumbsInView()},showMorePlaylist:function(e,o,t){ajax.post("/al_video.php?act=search_video_playlist",{q:e,offset:o,query_id:cur.searchQueryId},{onDone:function(e,o,i){t(e,o,i)}})},isInAlbum:function(e){return 0===(e=e||R.getLoc().section||"").indexOf("album_")||0===e.indexOf("playlist_")},isInSearch:function(){return!!R.getLoc().q},_getSectionAlbumId:function(){const e=R.getLoc().section||"all";switch(e){case"all":return-2;case"uploaded":return-1;default:return e.split("_")[1]}},isInCatalog:function(e){return e=e||R.getLoc(),cur.is_showcase?!cur.isOwnerVideos&&!(0,g.inArray)(e.section,R.USER_SYSTEMS_ALBUM_TYPES):"video"===e[0]&&!e.section},_getCurrentSectionType:function(){return cur.videoForcedSection?cur.videoForcedSection:R.isInAlbum(R.getLoc().section)?"album":R.isInCatalog()?"catalog":R.getLoc().section||"all"},_getNumberOfVideoGridColumns:function(){const e=document.querySelector(".VideoLayout__contentsWrapper"),o=document.querySelector(".VideoLayout__contents .VideoGrid");let t,i;if(o){t=o.offsetWidth||e.offsetWidth;const n=getComputedStyle(o);i=parseInt(n.getPropertyValue("column-gap"),10)}else t=e.offsetWidth,i=12;return Math.floor((t+i)/(300+i))},onScroll:function(){if("upload"===R.getLoc().section)return;let e;cur.getOwnerId&&cur.albumsShowingAll[cur.getOwnerId()]?e="albums":(e=R._getCurrentSectionType(),R.getLoc().q||"search"===e?e=(0,i.isVisible)((0,i.gpeByClass)("ge_video_pane","ui_search_global_videos_load_more"))?R.VIDEO_GLOBAL_SEARCH_TYPE:R.VIDEO_SEARCH_TYPE:"album"===e?e=R.getLoc().section:cur.showcaseSection&&(e=cur.showcaseSection));const o=(0,h.curBox)()?(0,h.curBox)().bodyNode:void 0,t=(0,i.geByClass1)("_video_"+e+"_list",o);if(t&&"all_playlists"!==e&&"all_playlist_subscriptions"!==e){const o=(0,i.gpeByClass)("ge_video_pane",t),n=(0,i.geByClass1)("ui_load_more_btn",o);if(n){const o=(0,i.clientHeight)(),t=(0,_.scrollGetY)(),r=(0,i.getXY)(n);t+o>(cur.serverPaging?r[1]-o:r[1]-o/2)&&(cur.serverPaging&&cur.showcaseSection===e?R.showMoreShowcase(e,n,(()=>{R._updateThumbsInView(),R._loadNextChunkIfNeed()})):R.showMore(e,n))}e===R.VIDEO_GLOBAL_SEARCH_TYPE&&R._updateLastSeenElement(t)}else if("all_playlists"===cur.showcaseSection&&cur.playlistsNextOffset&&!cur.loadingAlbums){const e=(0,i.clientHeight)(),o=document.body.clientHeight;(0,_.scrollGetY)()+e>o-e/2&&R.showMoreOwnerPlaylists()}else if("all_playlist_subscriptions"===cur.showcaseSection&&cur.playlistsNextOffset&&!cur.loadingAlbums){const e=(0,i.clientHeight)(),o=document.body.clientHeight;(0,_.scrollGetY)()+e>o-e/2&&R.showMoreSubscriptionsPlaylists()}R._updateChooseFixedBottom(),R._updateThumbsInView()},_createSorters:function(e){if(!cur.videoCanSort)return;cur.videoSorter&&cur.videoSorter.destroy(),"album"===(e=e||R._getCurrentSectionType())&&(e=R.getLoc().section);const o=cur.is_showcase?"VideoCard--dragOver":"video_on_drag_over";(0,x.getGridSorterModule)().then((()=>{cur.videoSorter=new window.GridSorter((0,i.ge)("video_"+e+"_list"),"video_item__thumb_link",{onReorder:R._onReorder,onDragOverElClass:"js-video_playlist_item",onDragLeave:function(e,t){(0,i.removeClass)(e,o),(0,i.removeClass)(t,"video_on_drag_over")},onDragEnter:function(e,t){(0,i.addClass)(e,o),(0,i.addClass)(t,"video_on_drag_over")},onDragDrop:function(e,o){const t=(0,i.attr)(o,"data-id").split("_"),n=(0,i.attr)(e,"data-id");return ajax.post("/al_video.php?act=a_add_to_playlist",{oid:t[0],vid:t[1],gid:B.Ranges.isGroupId(cur.getOwnerId())?B.Ranges.convertGroupIdToOwnerId(cur.getOwnerId()):0,add:1,playlist_id:n,own:1,hash:cur.videoAddToPlaylistOwnHash},{onDone:function(o,t){if(t&&t[n]){const o=R.buildPlaylistEl(t[n],cur.is_showcase);(0,i.domPN)(e).replaceChild(o,e),R._reinitSorters(),cur.albumsSorter.update()}}}),!0}})}))},_reinitSorters:function(e){cur.videoCanSort&&(clearTimeout(cur._rsto),cur._rsto=setTimeout((function(){cur.videoSorter?e?cur.videoSorter.disable():cur.videoSorter.enable():R._createSorters()})))},_saveHistoryAction:function(e,o){if(R.isInSearch()&&cur.videoGlobalSearchQuery){const t=cur.videoGlobalSearchQuery+R._buildFiltersSearchStr(),i=cur.globalSearchResults[t];i&&!cur.videoSearchFilters.notsafe&&uiSearch.saveHistorySearch(this.searchInputEl,cur.videoGlobalSearchQuery,e,o,i.count,i.countHash)}},onVideoAdd:function(e,o,t,n,r){var s,a,d;const l=null==(s=o)?void 0:s.closest("._video_item");if((null==(d=l)||null==(a=d.classList)?void 0:a.contains("VideoCard"))&&(0,T.partConfigEnabled)("video_card_add_playlists_actionsheet"))return;const u=(0,g.intval)((0,i.toggleClass)(l,"VideoCard--videoAdded"));let _;return _=u?{playlist_id:D.MY_VIDEO_ALBUM_ID}:{playlists:0},R._saveHistoryAction(t,n),ajax.post("/al_video.php?act=a_add_to_playlist",(0,g.extend)({oid:t,vid:n,add:(0,g.intval)(u),hash:r},_),{onFail:function(){u&&(window.tooltips&&tooltips.destroyAll(),(0,i.removeClass)(l,"VideoCard--videoAdded"))},onDone:function(o,r,s){var a;const d=cur.currentSortings&&(!cur.currentSortings.all||"default"===cur.currentSortings.all),l=!!cur._preloadedPages&&(0,i.geByClass1)("_video_list_my_all",cur._preloadedPages.all);let _,h=!1;if(_=u?c.getLang("video_added_to_section"):c.getLang("video_deleted_from_section"),(0,v.showSnackbarUnsafe)({text:_,before:{content:(0,E.getIcon28ListCheckOutline)().icon},action:{label:`«${c.getLang("video_catalog_showcase_section_my_video_added_title")}»`,onClick:()=>window.location.href=(0,D.getPlaylistURL)(t,D.MY_VIDEO_ALBUM_ID)}}),l){const e=(0,i.geByClass1)("ge_video_item_"+t+"_"+n,l);e&&(0,i.re)(e),h=!!e,u&&d&&l.insertBefore(R.buildVideoEl(s,cur.is_showcase),l.firstChild)}if(cur.silentLoaded&&cur.silentLoaded[vk.id]&&cur.silentLoaded[vk.id].all){const e=cur.silentLoaded[vk.id].all;if(u)d&&(e.unshift(s),R._reindex(e));else for(let o=0,i=e.length;o<i;o++)if(e[o][0]==t&&e[o][1]==n){e.splice(o,1);break}if(cur.videosCount[vk.id]){let e=u?1:-1;1===e&&h&&(e=0);const o=cur.videosCount[vk.id].all=Math.max(0,(cur.videosCount[vk.id].all||0)+e);R.updateTabCounter(o)}}const g=(0,M.getTrackCodeFromElement)(null==(a=e)?void 0:a.target);(0,M.logEvent)({action:u?M.SearchClickActionMap.ADD_TO_ME:M.SearchClickActionMap.REMOVE_FROM_ME,track_code:g,type:M.EventItemType.VIDEO})}}),window.tooltips&&tooltips.destroyAll(),(0,p.cancelEvent)(e)},updateTabCounter:function(e){const o=(0,i.ge)("video_tab_all");if(o){(0,i.geByClass1)("ui_tab_count",o).innerHTML=e}},onVideoMove:function(e,o,t,i,n){return(0,d.showBox)("/al_video.php?act=video_playlists_box",{target_id:cur.getOwnerId(),oid:t,vid:i,hash:n},{stat:[window.jsc("web/indexer.js")]}),(0,p.cancelEvent)(e)},_showProgressPanel:function(e){const o=(0,i.se)('<div class="video_delete_progress _video_delete_progress VideoCard__deleteProgress"><div class="round_spinner"></div></div>');return e.appendChild(o),o},onVideoDelete:function(e,o,t,n,r,s=!1){const c=(0,i.gpeByClass)("_video_item",o),a=R._getCurrentSectionType(),d=R._showProgressPanel(c),l="album"===a?R._getSectionAlbumId():-2;return(0,i.addClass)(c,c.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),cur.videoRecentlyRemoved||(cur.videoRecentlyRemoved={}),cur.videoRecentlyRemoved[t+"_"+n]=!0,ajax.post("/al_video.php?act=a_delete_video",{oid:t,vid:n,from:cur.oid,pl_id:l,section:cur.section_id,hash:r,is_showcase:cur.is_showcase,is_short:+s},{onDone:function(e){(0,i.re)(d),c.appendChild((0,i.se)(e));let o=(0,i.data)(c,"restoreTO");clearTimeout(o),o=setTimeout((function(){(0,i.re)((0,i.geByClass1)("_video_restore_act",c))}),6e4),(0,i.data)(c,"restoreTO",o)}}),(0,p.cancelEvent)(e)},restoreVideo:function(e,o,t,n){const r=(0,i.gpeByClass)("_video_item",e),s=(0,i.gpeByClass)("_video_restore",e),c=R._showProgressPanel(r),a="album"===R._getCurrentSectionType()?R._getSectionAlbumId():-2;if((0,i.re)(s),"my_bookmarks"===cur.section_id){let e=o.split("_");return(0,i.removeClass)(r,r.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,i.re)(c),void window.bookmark(e[0],e[1],"video",n,!1)}if("my_liked"!==cur.section_id)ajax.post("/al_video.php?act=a_restore_video",{from:t,video_id:o,pl_id:a,hash:n,section:cur.section_id},{onDone:function(){(0,i.removeClass)(r,r.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,i.re)(c)}}),delete cur.videoRecentlyRemoved[o];else{(0,i.removeClass)(r,r.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,i.re)(c);const t=()=>Likes.toggle(e,!1,"video"+o,n);window.Likes?t():(0,P.getLikesModule)().then(t)}},onVideoUMA:function(e,o,t,i){return(0,d.showBox)("al_video.php?act=get_uma_restrictions",{oid:t,vid:i},{params:{width:750}}),(0,p.cancelEvent)(e)},onVideoEdit:function(e,o,t,n,r=!1){cur.videoEditItem=(0,i.gpeByClass)("_video_item",o),window.Videoview&&Videoview.hidePlayer();return(0,d.showBox)("al_video.php?act=edit_box",{vid:n,oid:t,is_short_video:+r},{containerClass:"video_edit",stat:[window.jsc("web/privacy.js"),"privacy.css","video_edit.css",window.jsc("web/videoview.js"),window.jsc("web/video_upload.js"),window.jsc("web/upload.js")]}).setOptions({onHide:function(){window.Videoview&&Videoview.showPlayer()}}),(0,p.cancelEvent)(e)},switchChooserToOwner:function(e){const o={to_id:e,switched:1};!!cur.isSnippetVideoSelection&&(o.snippet_video=1),boxQueue.hideLast(),(0,d.showBox)("al_video.php?act=a_choose_video_box",o,{cache:1})},chooseBoxBack:function(){cur.videoChoosePrevSection=cur.videoChoosePrevSection||"all",0==cur.videoChoosePrevSection.indexOf("album_")&&(cur.videoChoosePrevSection="albums"),nav.go("/videos?section="+cur.videoChoosePrevSection)},initChooseBox:function(e,o,t,n,r,a,d,l){if(arguments.length>0)this.initChooseBoxOptions={isNoteEdit:e,isReview:o,toMail:t,curOwnerId:n,defaultTitle:r,blockPersonal:a,isSnippetVideo:d};else{if(!this.initChooseBoxOptions)return;e=this.initChooseBoxOptions.isNoteEdit,o=this.initChooseBoxOptions.isReview,t=this.initChooseBoxOptions.toMail,n=this.initChooseBoxOptions.curOwnerId,r=this.initChooseBoxOptions.defaultTitle,a=this.initChooseBoxOptions.blockPersonal,d=this.initChooseBoxOptions.isSnippetVideo}cur.found={},cur.currentSortings={},cur._preloadedPages={},cur.videoSearchFilters={},cur.chosenVideos=[],cur.albumsShowingAll={},cur.isNoteEdit=e,cur.videoShowWindow={},cur.isSnippetVideoSelection=d;const u=(0,h.curBox)(),_=cur.getOwnerId;function v(){u.setOptions({width:631,bodyStyle:"padding: 0",hideButtons:!0}),(0,i.ge)("box_layer_wrap").scrollTop=0}function f(){(0,g.each)(R.AVAILABLE_TABS,(function(e,o){(0,i.hide)("video_subtab_pane_"+o)})),(0,i.hide)((0,i.geByClass1)("video_subtab_pane_album"))}function S(){u.setOptions({title:'<div class="back" onclick="Video.chooseBoxBack();"><span class="back__icon">'+(0,I.getIcon24BrowserBack)().icon+"</span>"+c.getLang("video_choose_box_back_to_videos")+"</div>",bodyStyle:"padding: 0",noRefreshCoords:1})}function m(){let e=r;if(!a&&!o&&cur.videoSwitchOwnerId){const o=n==vk.id?c.getLang("video_choose_wall_to_group_videos"):c.getLang("video_choose_wall_to_my_videos");e+='<span class="divider">|</span><a class="toggle" onclick="Video.switchChooserToOwner('+(n==vk.id?cur.videoSwitchOwnerId:vk.id)+')">'+o+"</a>"}u.getOptions().defaultTitle&&(e=u.getOptions().defaultTitle),u.setOptions({title:e,grey:o})}function w(){(0,h.curBox)()&&(0,g.each)((0,i.geByClass)("video_item",(0,h.curBox)().bodyNode),(function(){const e=(0,i.geByClass1)("media_check_btn_wrap",this),o=this.getAttribute("data-id");(0,i.toggleClass)(e,"checked",-1!=cur.chosenVideos.indexOf(o))}))}cur.getOwnerId=function(){return n},u.setOptions({onHideAttempt:function(){return cur.getOwnerId=_,!0}}),cur.nav.push((function(e,o,t,r){if(!r.filtersChanged&&1===Object.keys(t).length&&t[0]&&0!=t[0].indexOf("video")&&!r.fromSearch)return!0;if(e[0]&&!e.section&&t[0]!=="videos"+n)return!0;(0,i.hide)("global_prg");const c=(0,i.geByClass1)("video_default_tabs",u.bodyNode),a=(0,i.geByClass1)("video_subtab_pane_album",u.bodyNode);let d=e.section||"all";R._prepareSearchFilters(t);const l=e.section?"":t.q||(0,i.val)(cur.searchInputEl);if(l?(d="search",r.fromSearch||r.globalQuery||(r.globalQuery=l),R.doSearch(l),S(),R._updateChooseFixedBottom()):(R.inputVal(cur.searchInputEl,""),R.doSearch("")),cur.videoForcedSection=d,-1!==R.AVAILABLE_TABS.indexOf(d))f(),(0,i.show)("video_subtab_pane_"+d),(0,i.show)(c),(0,i.hide)("albumPane"),m(),v(),cur.videoChoosePrevSection=d,"albums"!==d&&R.loadSilent(d),R.updateEmptyPlaceholder(d);else if(d&&0==d.indexOf("album_")){const e=d.split("_")[1];(0,s.showGlobalPrg)((0,i.ge)("video_playlist_item_"+e),{cls:"progress_inv_img",w:46,h:16,shift:[0,-22],zIndex:1e3}),R._addPendingAction(d,(function(){S(),f(),(0,i.hide)("global_prg"),(0,i.hide)(c),a.id="video_subtab_pane_"+d;const e=(0,i.geByClass1)("video_items_list",a);e.id="video_"+d+"_list",(0,i.addClass)(e,"_video_"+d+"_list"),e.innerHTML="",(0,i.show)(a);const o=cur.getOwnerId();cur.videoShowWindow=cur.videoShowWindow||{},cur.videoShowWindow[o]=cur.videoShowWindow[o]||{},cur.videoShowWindow[o][d]=!1,R.showMore(d,(0,i.geByClass1)("ui_load_more_btn",(0,i.ge)("video_subtab_pane_album"))),v(),w(),R._updateChooseFixedBottom()})),cur.videoChoosePrevSection=d,R.loadSilent(d)}return w(),!1})),cur.chooseVideoToMail=t,cur.isCurrentVideoLayer=!0,R.loadSilent(l),v(),(0,p.addEvent)((0,i.ge)("box_layer_wrap"),"scroll",R.onScroll);const E=boxLayerWrap.scrollTop;(0,i.elfocus)((0,i.geByClass1)("_scroll_node",u.bodyNode)),boxLayerWrap.scrollTop=E,R.initSearch(),m(),o||(cur.chooseVideoMedia=function(e,o,t){let n,r=e;if((0,i.hasClass)(r,"media_check_btn_wrap")?cur.cancelClick=!0:r=(0,i.geByClass1)("media_check_btn_wrap",r),(n=cur.chosenVideos.indexOf(o))>=0)cur.chosenVideos.splice(n,1);else{if(cur.chosenVideos.length>=(cur.maxFiles||10))return;cur.chosenVideos.push(o)}if((0,i.toggleClass)(r,"checked"),1===cur.chosenVideos.length&&!t)return R.doAttachSelectedVideos(e),!1;const s=(0,i.ge)("video_choosebox_bottom");if(cur.chosenVideos.length>0){var a;(0,i.show)(s);const e=cur.chooseVideoAdd?c.curLang("video_add_videos"):c.curLang("global_attach_videos"),o=null==(a=s)?void 0:a.querySelector(".video_choosebox_attach_btn");o&&A.FlatButton.setLabel(o,(0,c.langNumeric)(cur.chosenVideos.length,e)),R._updateChooseFixedBottom()}else(0,i.hide)(s);return(0,i.toggleClass)((0,i.ge)("video_choose_box"),"with_bottom_fixed",(0,i.isVisible)(s)),!1}),window.uiScrollBox&&window.uiScrollBox.init((0,h.curBox)(),{onHide:function(){(0,i.hide)("global_prg"),cur.nav.pop(),(0,p.removeEvent)((0,i.ge)("box_layer_wrap"),"scroll",R.onScroll),cur.isCurrentVideoLayer=!1,cur.chooseVideoMedia=null},onShow:function(){R.initChooseBox()}})},doAttachSelectedVideos:function(e){A.FlatButton.isFlatButton(e)?A.FlatButton.lock(e):(0,s.showGlobalPrg)((0,i.geByClass1)("video_item_thumb_wrap",e)||e,{cls:"progress_inv_img",w:46,h:16,zIndex:1e3});const o=function(){A.FlatButton.isFlatButton(e)&&A.FlatButton.unlock(e),(0,i.hide)("global_prg")};if(cur.chooseVideoAdd)return cur.chooseVideoAdd(cur.chosenVideos,"",o);R.attachVideos(cur.chosenVideos,o)},attachVideos:function(e,o){ajax.post("al_video.php?act=a_videos_attach_info",{from:cur.getFrom?cur.getFrom():"",videos:e.join(",")},{onDone:function(e){if(o&&o(),cur.isSnippetVideoSelection&&cur.chooseSnippetVideo)return(0,g.each)(e,(function(e,o){return cur.chooseSnippetVideo(e,o),!1})),void((0,h.curBox)()&&(0,h.curBox)().hide());let t=0;(0,g.each)(e,(function(e,o){cur.isNoteEdit&&window.editorChooseVideo?window.editorChooseVideo(o.thumb,o.name,o.duration,"/video"+e,e):cur.chooseMedia("video",e,o,t,cur.chosenVideos.length>1),t++})),(0,h.curBox)()&&cur.chosenVideos.length>1&&(0,h.curBox)().hide()}})},_updateChooseFixedBottom:function(){const e=(0,h.curBox)(),o=(0,i.ge)("video_choosebox_bottom");if(e&&o){const t=(0,i.gpeByClass)("box_layout",e.bodyNode);(0,i.getSize)(t)[1]+((0,i.getXY)(t)[1]-(0,_.scrollGetY)())-(0,i.clientHeight)()>0?(0,i.addClass)(o,"fixed"):(0,i.removeClass)(o,"fixed")}},_addPendingAction:function(e,o){const t=cur.getOwnerId?cur.getOwnerId():cur.oid;if(cur.videoPendingAction=cur.videoPendingAction||{},cur.videoPendingAction[t]=cur.videoPendingAction[t]||{},e){const i=cur.videoPendingAction[t][e];cur.videoPendingAction[t][e]=function(){o(),i&&i()}}},_callPendingAction:function(e){R._addPendingAction();const o=R.getCurOwnerId();cur.videoPendingAction[o][e]&&cur.videoPendingAction[o][e](),cur.videoPendingAction[o][e]=!1},_clearPendingAction:function(e){R._addPendingAction();const o=R.getCurOwnerId();cur.videoPendingAction[o][e]=!1},toggleTooltip:function(e,o,t){let i=[9,18,9];"view-toggle"===t&&(i=[-5,-1,3]),(0,u.showTooltip)(e,{black:1,text:o,shift:i,needLeft:!0,forcetodown:!0})},toggleAddTooltip:function(e,o,t){const n=(0,i.gpeByClass)("_video_item",e);R.toggleTooltip(e,(0,i.hasClass)(n,"VideoCard--videoAdded")?t:o)},show:function(e,o,t,n){var s,a,d;if(cur.videoEditItem=(0,i.gpeByClass)("_video_item",n),cur.articleEditorLayer)return(0,p.cancelEvent)(e);if(t.playAlbum&&(0,l.statlogsValueEvent)("video_play_album",0,"play_album"),cur.isCurrentChooseVideoBox){const t=window.event,i=o.split("_");return ajax.post("al_video.php?act=a_video_photo_sizes",{oid:i[0],vid:i[1],type:cur.isCurrentChooseVideoBox},{onDone:function(){switch(window.event=t||window.event,cur.isCurrentChooseVideoBox){case"video_add":cur.chooseVideoAdd(o,arguments[0]);break;case"wiki_editor":window.editorChooseVideo(arguments[0],arguments[1],arguments[2],"video"+o,o);break;case"video_choose":cur.chooseMedia("video",o,arguments[0])}}}),(0,p.cancelEvent)(e),!1}if(n&&(0,i.hasClass)(n,"video_row_deleted"))return!1;if(!vk.id&&n&&(0,i.hasClass)(n,"video_row_not_public"))return(0,h.showDoneBox)(c.getLang("video_please_sign_in")),!1;const u=(0,g.extend)({root:1,autoplay:1},t||{});let _=(t?t.listId:"")||this.getDefaultListId();if(!u.module){let e=cur.currentModule?cur.currentModule():cur.module;"video_search"===e&&(0,i.isAncestor)(n,"video_search_videos_list")&&(e="video_search_local"),u.module=e}if(R.isInVideosList()&&!u.playlistId){let e,o;e=cur.is_showcase?cur.showcaseSection:R.getLoc().section||"all","all"===e?u.playlistId=cur.oid+"_-2":"uploaded"===e?u.playlistId=cur.oid+"_-1":(o=e.match(/^(album|playlist)_(-?\d+)$/))&&(u.playlistId=cur.oid+"_"+o[1])}if(!R.isInCatalog()||u.playlistId||!cur.catPlaylistId||cur.isCatalog||this.isGlobalSearchMode()&&!this.shouldShowSectionInPlaylistWithSearch()||(u.playlistId=cur.catPlaylistId),u.playlistId&&(u.addParams=(0,g.extend)(u.addParams||{},{playlist_id:u.playlistId,show_next:(0,g.intval)(window.VideoPlaylist&&!!VideoPlaylist.getList(u.playlistId)),force_no_repeat:1,show_all_videos:(0,g.intval)(cur.isCatalog&&(!window.VideoPlaylist||!VideoPlaylist.getList(u.playlistId)))})),u.playFrom&&(u.addParams=(0,g.extend)(u.addParams||{},{t:u.playFrom})),cur.videoSearchStats){const e=(0,i.domClosest)("video_item",n);if(e&&e.hasAttribute("data-search-pos")){cur.videoSearchPos=parseInt(e.getAttribute("data-search-pos")),cur.videoSearchPos>cur.videoSearchStats.lastSeenIndex&&(cur.videoSearchStats.lastSeenElement=e,cur.videoSearchStats.lastSeenIndex=cur.videoSearchPos),cur.videoSearchStats.positions[cur.videoSearchPos]=(0,g.extend)({clicked:0},cur.videoSearchStats.positions[cur.videoSearchPos]),cur.videoSearchStats.positions[cur.videoSearchPos].clicked++;const o=++cur.videoSearchStats.clickNum,t=Date.now()-cur.videoSearchStats.lastActionTime;u.addParams=(0,g.extend)(u.addParams||{},{click_num:o,click_time:t})}}if(!cur.is_section||!(0,T.partConfigEnabled)("search_video_catalog_web2")){const e=o.split("_");R._saveHistoryAction(e[0],e[1])}if(null==(d=e)||null==(a=d.target)||null==(s=a.closest)?void 0:s.call(a,"#search_auto_rows")){var v;const o=(0,M.getTrackCodeFromElement)(null==(v=e)?void 0:v.target);(0,M.logEvent)({action:M.SearchClickActionMap.PLAY,track_code:o,type:M.EventItemType.VIDEO})}return(0,r.showVideo)(o,_,u,e)},getDefaultListId:function(){return B.Ranges.isGroupId(window.cur.oid)?"club"+-window.cur.oid:window.cur.pvVideoTagsShown&&window.cur.pvShown?"tag"+window.cur.pvVideoTagsShown:""},isInVideosList:function(){if(cur.is_showcase)return(0,g.inArray)(cur.showcaseSection,["all","uploaded","all_playlists"])||/^playlist_-?\d+$/.test(cur.showcaseSection);const e=R.getLoc();return/^videos-?\d+|video-?\d+_\d+$/.test(e[0])&&!e.q&&((0,g.inArray)(R._getCurrentSectionType(),R.AVAILABLE_TABS)||R.isInAlbum())},deleteAlbum:function(e,o){return e=e.split("_")[1],(0,d.showBox)("al_video.php?act=delete_album",{aid:e,oid:cur.oid,is_showcase:cur.is_showcase}),(0,p.cancelEvent)(o)},editAlbum:function(e,o){return e=e.split("_")[1],(0,d.showBox)("al_video.php?act=edit_album",{oid:cur.oid,aid:e,is_showcase:cur.is_showcase},{stat:[window.jsc("web/upload.js"),"video_edit.css"],containerClass:"VideoPlaylistPopup"}),(0,p.cancelEvent)(o)},initEditAlbumBox:function(e,o,t,n,r,s,d){const l=(0,h.curBox)(),u=(0,a.isObject)(r),_=!!Object.keys(d).length;if(_&&(VideoUpload.initThumbUpload(d,l.bodyNode),(0,a.isObject)(s)&&s.uploaded_id)){const e=(0,i.geByClass1)("js-video_tc_upload_image",l.bodyNode);(0,i.setStyle)(e,{backgroundImage:"url("+s.uploaded_url+")"}),(0,i.show)(e);const o=(0,i.geByClass1)("js-video_tc_uploader",l.bodyNode);o&&(0,i.domData)(o,"thumb-id",s.uploaded_id)}u&&(cur.privacy=(0,g.extend)(cur.privacy||{},r));const p=o?c.getLang("global_save"):c.getLang("video_create_new_playlist");l.setOptions({bodyStyle:"padding: 20px; padding-bottom: 25px;",width:422}),l.removeButtons(),l.addButton(p,(function(r){let s=(0,i.ge)("video_album_edit_title"),a=s.value.trim();if(!a)return(0,f.notaBene)(s);let d=u?Privacy.getValue("video_playlist"+o):"",h="";if(_){const e=(0,i.geByClass1)("js-video_tc_uploader",l.bodyNode);h=(0,i.domData)(e,"thumb-id")||"0_0"}ajax.post("al_video.php?act=do_edit_album",{id:o,oid:e,hash:t,title:a,privacy:d,thumb_id:h},{showProgress:()=>(0,f.lockButton)(r),hideProgress:()=>(0,f.unlockButton)(r),onDone:function(t){if((0,T.partConfigEnabled)("video_card_add_playlists_actionsheet")){const e=l.boxLayoutNode.dataset.videoId,o=l.boxLayoutNode.dataset.videoOwnerId;if(e&&o)return window.dispatchEvent(new CustomEvent(V.CreatePlaylistFormEvents.CREATE,{detail:{newAlbumId:t,videoOwnerId:o,videoId:e,title:a}})),void l.hide()}if((0,T.partConfigEnabled)("video_playlist_page_redesign"))return window.dispatchEvent(new CustomEvent(V.CreatePlaylistFormEvents.UPDATE,{detail:{albumId:o,ownerId:e,title:a}})),void l.hide();if(o)cur.isAdmin?AdminShowcasePlaylists.search():nav.reload();else{const o=()=>{cur.is_showcase?nav.go(n+"/"+e+"_"+t):nav.change({section:"album_"+t},!1,{noback:!0})},{icon:i}=(0,E.getIcon28ListCheckOutline)();(0,v.showSnackbarUnsafe)({before:{content:i},text:c.getLang("video_playlist_created_notification"),action:{label:c.getLang("video_open_new_playlist"),onClick:o}})}l.hide()}})}),"yes",!1,"popup_save_button"),l.addButton(c.getLang("global_cancel"),l.hide,"no"),(0,i.elfocus)("video_album_edit_title")},editCategories:function(e,o,t=cur.oid){let n=e.split("_")[1];return(0,d.showBox)("al_video.php?act=update_categories",{owner_id:t,playlist_id:n},{onDone:function(e,o){cur.categoriesUpdateOptions={hash:o.hash,owner_id:o.owner_id,playlist_id:o.playlist_id};const t=new Dropdown((0,i.ge)("video_playlist_categories"),o.all_categories,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:o.category_ids});e.setOptions({bodyStyle:"padding: 20px; padding-bottom: 25px;",width:422}),e.removeButtons(),e.addButton("Сохранить",(function(n){let r={hash:cur.categoriesUpdateOptions.hash,owner_id:cur.categoriesUpdateOptions.owner_id,playlist_id:cur.categoriesUpdateOptions.playlist_id,category_ids:t.selectedItems().map((function(e){return e[0]})),info_updated_at:o.info_updated_at,info_age_rating:(0,i.ge)("video_movie_age_rating").value};ajax.post("al_video.php?act=do_update_categories",r,{showProgress:()=>(0,f.lockButton)(n),hideProgress:()=>(0,f.unlockButton)(n),onDone:function(){e.hide()}})})),e.addButton("Отмена",e.hide,"no")}}),(0,p.cancelEvent)(o)},initCreateAlbumWarningBox:function(){const e=(0,h.curBox)();e.removeButtons(),e.addButton(c.getLang("video_cancel_but"),e.hide,"neutral")},createAlbum:function(e,o=cur.oid,t,i){return(0,g.intval)(o)?cur.is_showcase&&!vk.id?((0,d.showBox)("al_login.php?act=box",{from:nav.strLoc},{},e),!1):void(0,d.showBox)("al_video.php?act=edit_album",{oid:o,is_showcase:cur.is_showcase},{stat:[window.jsc("web/upload.js")],containerClass:"VideoPlaylistPopup",onDone:function(e){e.setOptions({width:500}),e.titleWrap.classList.toggle("OwnerChooseWrapper",cur.is_showcase),e.titleWrap.classList.toggle("OwnerChooseWrapper--colorGrey",!0),e.boxLayoutNode.dataset.videoId=t,e.boxLayoutNode.dataset.videoOwnerId=i},onFail:function(e){if(e)return(0,h.curBox)().hide(),(0,d.showFastBox)(c.getLang("global_error"),e),!0}}):((0,n.showQuickLoginBox)(),!1)},isVideoPlayerOpen:function(e,o){let t=e;return o&&(t+="_"+o),window.mvcur&&!0===mvcur.mvShown&&mvcur.videoRaw===t},startPollVideoReady:function(e,o){const t=e+"_"+o;setTimeout((function(){ajax.post("al_video.php?act=check_upload_status",{video:t,oid:e,vid:o},{onDone:function(i){R.isVideoPlayerOpen(e,o)&&(i?(mvcur.minimized?Videoview.hide(!1,!0):Videoview.backLocation(),(0,r.showVideo)(t,"",{})):R.startPollVideoReady(e,o))}})}),1e4)},tcSlide:function(e,o,t,n){const r=(0,i.gpeByClass)("video_tc_slider",o),s=(0,i.geByClass1)("video_tc_slider_cont",r),c=(0,i.getW)(s),a=getComputedStyle(s.children[0]),d=getComputedStyle(s.children.length>0?s.children[1]:s.children[0]),l=parseInt(a.getPropertyValue("margin-left"))+parseInt(a.getPropertyValue("margin-right")),u=parseInt(d.getPropertyValue("margin-left"))+parseInt(d.getPropertyValue("margin-right")),_=(0,i.getW)(s.children[0])+l,h=(0,i.getW)(s.children.length>0?s.children[1]:s.children[0])+u,v=_>0?Math.max(Math.floor(c/_),Math.floor((c-u)/h)):Math.floor((c-u)/h),g=Math.max(0,s.children.length-v);let f=(0,i.data)(s,"currOffset")||0;f+=t,f=Math.min(s.children.length,Math.max(0,f),g),(0,i.data)(s,"currOffset",f),n&&(0,i.addClass)(s,"no_transition");const S=_*+(s.children.length>0)+h*(s.children.length-1)-c-u;let m=_*+(f>0)+Math.max(0,h*(f-1));m=Math.max(0,Math.min(m,S)),(0,i.setStyle)(s,{left:-m}),n&&setTimeout((function(){(0,i.removeClass)(s,"no_transition")}));const w=0===f,E=f===g||m===S,I=(0,i.geByClass1)("video_tc_btn_left",r),b=(0,i.geByClass1)("video_tc_btn_right",r);function y(e,o){e?(0,p.addEvent)(o,"mouseleave",(function(){(0,i.setStyle)(o,"pointer-events","none"),(0,p.removeEvent)(o,"mouseleave")})):((0,i.setStyle)(o,"pointer-events","all"),(0,p.removeEvent)(o,"mouseleave"))}return(0,i.toggleClass)(I,"video_tc_btn_none",w),(0,i.toggleClass)(b,"video_tc_btn_none",E),y(w,I),y(E,b),e&&(0,p.cancelEvent)(e),!1},_initSearchStats:function(e){cur.videoSearchPos=null,cur.videoSearchStats={loc:e,totalViews:0,lastSeenElement:null,lastSeenIndex:-1,totalViewedTime:0,clickNum:0,lastActionTime:Date.now(),positions:[]}},_clearSearchStats:function(){delete cur.videoSearchPos,delete cur.videoSearchStats},_updateLastSeenElement:function(e){if(!cur.videoSearchStats)return;if(!(null!==cur.videoSearchStats.lastSeenElement&&e.contains(cur.videoSearchStats.lastSeenElement)||(cur.videoSearchStats.lastSeenElement=(0,i.domFC)(e),cur.videoSearchStats.lastSeenElement)))return;cur.videoSearchStats.lastSeenIndex=0;const o=(0,i.clientHeight)();let t=(0,i.domNS)(cur.videoSearchStats.lastSeenElement);if(!t)return;let n=t.getBoundingClientRect();for(;n.top+t.clientHeight/2<o&&(cur.videoSearchStats.lastSeenElement=t,t=(0,i.domNS)(cur.videoSearchStats.lastSeenElement),t);)n=t.getBoundingClientRect();cur.videoSearchStats.lastSeenIndex=parseInt(cur.videoSearchStats.lastSeenElement.getAttribute("data-search-pos"))||0},_updateThumbsInView:function(){(0,C.updateThumbsInView)()},getCurOwnerId:function(){return cur.getOwnerId?cur.getOwnerId():cur.oid},onImageError:function(e,o=!0){if(!e.getAttribute("data-thumb")){const t=e.parentNode;if(t.removeChild(e),o){let e=(0,b.getIcon56VideoOutline)().icon;t.insertAdjacentHTML("beforeend",`<div class="VideoCard__thumbIcon">${e}</div>`)}}},checkClickEvent:e=>"click"===e.type&&(e.ctrlKey||e.metaKey),isGroupsRedesignEnabled:()=>{const e=cur.getOwnerId?cur.getOwnerId():cur.oid;return B.Ranges.isGroupId(e)}}}}]);try{stManager.done("dist/bf7fedeb27b41e4aa99b3e69118551cf.7283ff812b0e015ef3ad.js")}catch(e){}