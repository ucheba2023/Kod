(()=>{"use strict";var e,t,s,a,r,n,o={544176:(e,t,s)=>{var a,r,n,o=s(11010),i=s(434788),l=s(22412),d=s(970978),p=s(514986),g=s(29271),u=s(849222),c=s(766698),h=s(162532),m=s(701822),y=s(599809),_=s(888385),b=s(839470),f=s(723062),v=s(184016),M=s(442426);(null==(r=window.vk)||null==(a=r.pe)?void 0:a.static_manager_dynamic_imports)&&(null==(n=window.vk)?void 0:n.stDomain)&&(s.p=window.vk.stDomain+"/dist/");const C=(0,b.partConfigEnabled)("calls_forbid_web_calls_for_ads_account"),w=(0,b.partConfigEnabled)("web_calls_queue_subscribe");function D(){return(D=(0,o._)((function*(){var e;if(null==(e=window.Calls)?void 0:e.initialized)return;if(C||!f.Ranges.isUserId(window.vk.id))return;(0,_.setApiWrappers)((()=>y.api),(()=>y.api));const t=(0,m.fetchCallToken)(window.vk.id,window.vk.isCallsDevEnv),{callsCredentials:s,toggles:a,settings:r,activeCall:n}=yield(0,h.executeGetCallsSettings)(window.vk.id),b={callsCredentials:s,sdkToken:yield t,toggles:(0,i._)({},a,{videoSlotsCount:r.video_slots_count,browserWarnings:r.browser_warnings,customScreenSharePacketSize:r.custom_screen_share_packet_size,customScreenShareCongestionControlThreshold:r.custom_screen_share_congestion_control_threshold,enableQueueManager:w,showFeedbackScreen:!0,enableVideoSlots:!0,enableScreenTrack:!0,enableProducerScreenTrack:!0,desktopAppNotification:!0,enableCustomScreenSharePacketSize:!0,enableSpsPpsIdrInKeyframe:!0,screenShareCongestionControl:!0,enableVmoji:!0,enableRoomControl:!0}),onError:({msg:e})=>(e&&(0,d.logError)(e),e&&(0,p.showFastBox)(g.getLang("global_error"),e)),onBeforeCallStart:()=>{window.Notifier.pauseGlobalMedia()},onAfterCallFinish:()=>{window.Notifier.resumeGlobalMedia()},tabIsMaster:()=>window.Notifier.tabIsMaster(),isFriend:e=>{var t,s;return!!(null==(s=window.curFastChat)||null==(t=s.friends)?void 0:t[e+"_"])},removeLeftMenuItemBadge:()=>{c.leftMenu.removeBadge(u.PAGE_ID_CALLS)}};var D;window.browser.mozilla?(window.Calls=null!=(D=window.Calls)?D:{},window.Calls.initArgs=b,window.requestIdleCallback((()=>{T().then((()=>{var e,t;null==(t=window.Calls)||null==(e=t.init)||e.call(t,b)}))}))):function(e){var t;if(!1===(null==(t=window.Calls)?void 0:t.initialized))return void window.Calls.init(e);const s={},a=t=>(...s)=>T().then((()=>{var t,s;return null==(s=window.Calls)||null==(t=s.init)?void 0:t.call(s,e)})).then((()=>{var e,a;return null==(a=window.Calls)||null==(e=a[t])?void 0:e.call(a,...s)}));if(s.call=a("call"),s.startGroupCall=a("startGroupCall"),s.startCall=a("startCall"),s.acceptCall=a("acceptCall"),s.joinCallByLink=a("joinCallByLink"),s.showJoinPopup=a("showJoinPopup"),s.showCallByNamePopup=a("showCallByNamePopup"),s.showCreateCallByLinkPopup=a("showCreateCallByLinkPopup"),s.showPlanCalendarEventPopup=a("showPlanCalendarEventPopup"),s.showStartCallModal=a("showStartCallModal"),s.showHistoryScreen=a("showHistoryScreen"),s.joinOrStartCallModal=a("joinOrStartCallModal"),s.initArgs=e,window.Calls=s,w)return;const r=window.Notifier.getLpInstance(),n=(...t)=>{var s;(null==(s=window.Calls)?void 0:s.initialized)?r.offData(n):t.forEach((t=>{if(t.type===l.INCOMING_CALL)return r.offData(n),T().then((()=>{var t;return null==(t=window.Calls)?void 0:t.init(e)})).then((()=>{var e;return null==(e=window.Calls)?void 0:e.handleEvent(t)}))}))};if(!r)return;r.onData(n)}(b);if(!w)return;const E=(0,o._)((function*(){var e,t;(null==(e=window.Calls)?void 0:e.initialized)||(yield T(),yield null==(t=window.Calls)?void 0:t.init(b))}));var A;n&&(yield E(),null==(A=window.Calls)||A.handleQueueEvent({entity_type:M.ECallLongpollEntityType.Calls,entity_id:1,data:{type:M.ECallLongpollType.IncomingCall,value:n}}));(0,v.startQueueManager)(window.vk.id,E)}))).apply(this,arguments)}function T(){return new Promise((e=>{window.stManager.add([window.jsc("web/calls.js"),"calls.css"],e)}))}(function(){return D.apply(this,arguments)})().catch(console.error);try{window.stManager.done(window.jsc("web/calls_lazy_module.js"))}catch(e){}},888385:(e,t,s)=>{s.d(t,{createApi:()=>l,getApiWrapper:()=>i,setApiWrappers:()=>o});var a=s(464380);let r=null,n=null;const o=(e,t)=>{r=e,n=t},i=(e=!0)=>e?r:n;function l(e){return(t,s,r)=>((0,a.debugMessage)(a.DebugMessageType.DEBUG,{type:"request",method:e}),i()()(e,t,r,s).then((t=>((0,a.debugMessage)(a.DebugMessageType.DEBUG,{type:"response",method:e,data:t}),t))))}},455118:(e,t,s)=>{s.d(t,{get:()=>r});var a=s(659397);const r=(e,t)=>{if(!(0,a.isString)(e)&&!(0,a.isArray)(e))return;const s=(0,a.isArray)(e)?e:e.split(".").filter(Boolean),r=s.length-1;let n=t;for(let e=0;e<s.length;e+=1){if(!(0,a.isObjectLike)(n))return;const t=n[s[e]];if(!t)return;if(e===r)return t;n=t}}},465768:(e,t,s)=>{s.d(t,{handlePromiseError:()=>r});var a=s(464380);const r=(...e)=>{(0,a.debugMessage)(a.DebugMessageType.ERROR,...e)}},162532:(e,t,s)=>{s.d(t,{baseUserFields:()=>h,callsCheckParticipantName:()=>Ee,callsDeleteParticipantName:()=>Te,callsEditParticipantName:()=>De,callsGetJoinHistory:()=>be,callsGetParticipants:()=>fe,callsGetReactions:()=>_e,callsGetUserSettings:()=>ve,callsSetUserSettings:()=>Me,callsStart:()=>ae,deleteAsrTranscriptions:()=>Be,executeGetCallsSettings:()=>Ie,fetchCallsAnonymQueue:()=>Ae,fetchCallsQueue:()=>$,fetchUrl:()=>H,forceCallFinish:()=>A,friendsSearch:()=>ee,getAnonymCallToken:()=>U,getAsrTranscriptions:()=>Ue,getCallAuthToken:()=>w,getCallParticipants:()=>B,getCallParticipantsApiCall:()=>x,getCallUrlLink:()=>D,getCallsConversationsByCall:()=>qe,getCallsHistory:()=>z,getConversationsByCall:()=>k,getCurrentCalls:()=>F,getFriends:()=>Z,getGroupById:()=>G,getGroupMembers:()=>N,getGroupsForCall:()=>j,getGroupsForStreaming:()=>R,getSearchVideo:()=>pe,getUpcomingLives:()=>S,getVideos:()=>P,getWatchTogetherOwnerVideos:()=>de,getWatchTogetherRecommended:()=>le,loadCallPeers:()=>_,loadCallPeersByPeerIds:()=>y,loadChatMembers:()=>C,loadFriends:()=>E,loadPrivacySettings:()=>O,loadUsers:()=>W,logCallReceived:()=>q,makeCallsAnonymQueueUrl:()=>ke,makeCallsQueueUrl:()=>V,messagesDeleteScheduledCall:()=>oe,messagesEditCall:()=>ie,messagesGetCallPreview:()=>T,messagesGetConversations:()=>te,messagesGetScheduledCalls:()=>ne,messagesSearch:()=>re,messagesSend:()=>se,photosDelete:()=>X,photosGetAllImages:()=>J,photosSaveBackgroundPhoto:()=>Y,queueSubscribe:()=>Q,retryLoadCallPeers:()=>M,searchCallParticipants:()=>ye,searchGroupMembers:()=>L,sendVideoEdit:()=>I,videoDelete:()=>me,videoEditStreaming:()=>he,videoGet:()=>ge,videoGetThumbsUploadServer:()=>ue,videoStartStreaming:()=>ce});var a=s(11010),r=s(434788),n=s(393356),o=s(878198),i=s(888385),l=s(464380),d=s(455118),p=s(465768),g=(s(599809),s(654198)),u=s(723062);const c=["photo_200","sex","screen_name","first_name_gen","is_nft","animated_avatar","custom_names_for_calls"].join(","),h=["photo_200","sex","screen_name","first_name_gen","is_nft","animated_avatar","custom_names_for_calls"].join(","),m=["name","photo_100","photo_200","can_upload_video","custom_names_for_calls"].join(","),y=e=>(0,i.getApiWrapper)()()("messages.getConversationsById",{peer_ids:e,extended:1,fields:h}),_=e=>(0,i.getApiWrapper)()()("messages.getConversationsById",{peer_ids:[e],extended:1,fields:h});let b=0,f=[],v=[];const M=(0,o.exponentialRetry)(((e,t=50)=>(f.push(e),new Promise((e=>{v.push(e),b||(b=window.setTimeout((()=>{y(f).then((e=>{v.forEach((t=>{t(e)})),v=[]})).catch(p.handlePromiseError),f=[],b=0}),t))}))))),C=e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getConversationMembers",data:{peerId:e}}),(0,i.getApiWrapper)()()("messages.getConversationMembers",{peer_id:e,fields:c.concat(",can_call"),extended:1}).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getConversationMembers",data:e}),e)))),w=(e,t=0)=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallToken",data:{isDev:e,groupId:t}}),(0,i.getApiWrapper)()()("messages.getCallToken",{env:e?"development":"production",group_id:t},{version:n.API_VERSION}).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallToken",data:e}),e)))),D=((0,o.exponentialRetry)(w),(e,t,s=0)=>{const a={call_id:e,invalidate:t?1:0,group_id:s};return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getJoinLink",data:a}),(0,i.getApiWrapper)()()("messages.getJoinLink",a).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getJoinLink",data:e}),e)))}),T=(e,t=!1,s={})=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallPreview",data:{link:e,fields:h,device_id:"anyId"}}),(0,i.getApiWrapper)(!t)()("messages.getCallPreview",{link:e,fields:h,device_id:"anyId",extended:1},s).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallPreview",data:e}),e)))),E=()=>{const e={fields:c.concat(",can_call"),filters:"without_dead",order:"hints"};return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"friends.get",data:e}),(0,i.getApiWrapper)()()("friends.get",e).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"friends.get",data:e}),e)))},A=e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.forceCallFinish",data:{call_id:e}}),(0,i.getApiWrapper)()()("messages.forceCallFinish",{call_id:e}).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.forceCallFinish",data:e}),e)))),k=(e,t={})=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getConversationsByCall",data:(0,r._)({call_ids:e,fields:h},t)}),(0,i.getApiWrapper)()()("messages.getConversationsByCall",(0,r._)({call_ids:e,fields:h},t)).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getConversationsByCall",data:e}),e)))),U=(e,t,s,a,r)=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getAnonymCallToken",data:{link:e,user_id:t,name:s,secret:a,device_id:"anyId"}}),(0,i.getApiWrapper)(!1)()("messages.getAnonymCallToken",{link:e,user_id:t,name:s,secret:a,device_id:"anyId"},r).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getAnonymCallToken",data:e}),e)))),B=(e,t,s,a=!1,r)=>{const l=[];let d=Array.from(new Set(t));for(;d.length;)d.length>1e3?(l.push(d.slice(0,1e3)),d=d.slice(1e3)):(l.push(d),d=[]);const p=(0,o.exponentialRetry)((function(t,r){const o=a?{call_id:e,peer_ids:r.join(","),fields:h,device_id:"anyId",secret:t.secret,user_id:s}:{call_id:e,peer_ids:r.join(","),fields:h};return(0,i.getApiWrapper)(!a)()("messages.getCallParticipants",o,{version:n.API_VERSION}).then((e=>({count:e.count+t.count,secret:e.secret,profiles:(t.profiles||[]).concat(e.profiles||[]),anonyms:(t.anonyms||[]).concat(e.anonyms||[]),groups:(t.groups||[]).concat(e.groups||[])})))})),g=Promise.resolve({secret:r,count:0});return l.reduce(((e,t)=>e.then((e=>p(e,t)))),g)},G=e=>(0,i.getApiWrapper)()()("groups.getById",{group_ids:e,fields:m},{version:n.API_VERSION}),S=e=>(0,i.getApiWrapper)()()("video.getUpcomingLives",{owner_ids:e}),P=(e,t,s)=>(0,i.getApiWrapper)()()("video.get",{owner_id:e,videos:t,need_privacy:s}),I=(e,t,s,a,r)=>(0,i.getApiWrapper)()()("video.edit",{owner_id:e,video_id:t,name:s,desc:a,privacy_view:r}),W=e=>(0,i.getApiWrapper)()()("users.get",e),q=e=>(0,i.getApiWrapper)()()("messages.callReceived",{call_id:e}),O=e=>(0,i.getApiWrapper)()()("account.getPrivacySettings",e),j=()=>(0,i.getApiWrapper)()()("messages.getGroupsForCall",{count:200}),N=(e,t=0,s=10)=>{let a={fields:c.concat(",can_call_from_group"),group_id:e,offset:t,count:s,sort:"time_asc"};return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"groups.getMembers",params:a}),(0,i.getApiWrapper)()()("groups.getMembers",a).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"groups.getMembers",data:e}),e)))},L=(e,t="")=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"users.search",data:{groupId:e,q:t}}),(0,i.getApiWrapper)()()("users.search",{fields:c.concat(",can_call_from_group"),group_id:e,q:t}).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"users.search",data:e}),e))));function x(e,t,s=!1,a="",o=0){let d={call_id:e,peer_ids:t.join(","),fields:h};return s&&(d=(0,r._)({},d,{device_id:"anyId",secret:a,user_id:o})),(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallParticipants",data:d}),(0,i.getApiWrapper)(!s)()("messages.getCallParticipants",d,{version:n.API_VERSION}).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallParticipant",response:e}),e)))}function R(){return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"video.getGroupsForStreaming"}),(0,i.getApiWrapper)()()("video.getGroupsForStreaming",{}).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"video.getGroupsForStreaming",response:e}),e)))}function F(e=c){let t={fields:e};return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getCurrentCalls",data:t}),(0,i.getApiWrapper)()()("messages.getCurrentCalls",t).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getCurrentCalls",response:e}),e)))}function Q(e){return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"queue.subscribe",data:e}),(0,i.getApiWrapper)()()("queue.subscribe",e,{grouping:!1}).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"queue.subscribe",response:e}),e)))}function $(e){return Q({queue_ids:`calls_${e}`}).then((t=>{const{base_url:s,queues:a}=t,{key:r,timestamp:n}=a[0];return{baseUrl:s,key:r,timestamp:n,userId:e}}))}function V(e){const{baseUrl:t,key:s,userId:a,timestamp:r}=e;return`${t}?act=a_check&key=${s}&id=${a}&ts=${r}&wait=20`}function H(e){return fetch(e).then((e=>e.json()))}function z(e=5,t=0,s=0,a="all"){let r={count:e,start_from:t,fields:c+",last_name_gen",filter:a,group_id:s};return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getCallHistory",data:r}),(0,i.getApiWrapper)()()("messages.getCallHistory",r).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getCallHistory",response:e}),e)))}const J=(e={})=>{const t=(0,i.getApiWrapper)(!0)();return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"photos.get",params:e}),t("photos.get",(0,r._)({album_id:"-166"},e)).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"photos.get",response:e}),e)))},K=e=>["error_msg","error_code"].some((t=>(0,d.get)(t,e)))?Promise.reject(e):Promise.resolve(e),Y=e=>{const t=(0,i.getApiWrapper)(!0)(),s=(0,i.getApiWrapper)(!0)();return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"photos.getCallBackgroundsPhotoUploadServer"}),t("photos.getCallBackgroundsPhotoUploadServer",{}).then(K).then((t=>{(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"photos.getCallBackgroundsPhotoUploadServer",response:t});const s=new FormData;return s.append("file1",e,e.name),(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:`[photoUploadUrl] ${t.upload_url}`,formData:s}),fetch(t.upload_url,{method:"POST",body:s}).then((e=>e.json())).then(K)})).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"[photoUploadUrl]",json:e}),(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"photos.saveBackgroundPhoto",json:e}),s("photos.saveBackgroundPhoto",{response_json:JSON.stringify(e)})))).then(K)},X=e=>{const t=(0,i.getApiWrapper)(!0)();return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"photos.delete",params:e}),t("photos.delete",e).then(K)},Z=(e=10,t=0,s="hints")=>{const a={fields:c.concat(",can_call,online_info"),count:e,offset:t,order:s,filters:"without_dead"};return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"friends.get",data:a}),(0,i.getApiWrapper)()()("friends.get",a).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"friends.get",data:e}),e)))},ee=(e,t="",s=10,a=0)=>{const r={user_id:e,q:t,fields:c.concat(",can_call,online_info,photo_50"),count:s,offset:a};return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"friends.search",data:r}),(0,i.getApiWrapper)()()("friends.search",r).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"friends.search",data:e}),e)))},te=(e={extended:1,count:30})=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getConversations",data:e}),(0,i.getApiWrapper)()()("messages.getConversations",e).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getConversations",data:e}),e)))),se=(e={})=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.send",data:e}),(0,i.getApiWrapper)()()("messages.send",e).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.send",data:e}),e)))),ae=(0,i.createApi)("calls.start"),re=(e={})=>{const t=(0,r._)({count:20,extended:1},e);return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.search",data:t}),(0,i.getApiWrapper)()()("messages.search",t).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.search",data:e}),e)))},ne=(e={})=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.getScheduledCalls",data:e}),(0,i.getApiWrapper)()()("messages.getScheduledCalls",e).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.getScheduledCalls",data:e}),e)))),oe=e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.deleteScheduledCall",data:e}),(0,i.getApiWrapper)()()("messages.deleteScheduledCall",e).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.deleteScheduledCall",data:e}),e)))),ie=e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"messages.editCall",data:e}),(0,i.getApiWrapper)()()("messages.editCall",e).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"messages.editCall",data:e}),e)))),le=(e={},t={})=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"video.getWatchTogetherRecommendedVideos",params:e}),(0,i.getApiWrapper)()()("video.getWatchTogetherRecommendedVideos",e,{},t).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"video.getWatchTogetherRecommendedVideos",data:e}),e))).then(K)),de=(e={},t={})=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"video.getWatchTogetherOwnerVideos",params:e}),(0,i.getApiWrapper)()()("video.getWatchTogetherOwnerVideos",e,{},t).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"video.getWatchTogetherOwnerVideos",data:e}),e))).then(K)),pe=(e={},t)=>(e.united_video_only=1,e.extended=1,(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"video.search",params:e}),(0,i.getApiWrapper)()()("video.search",e,{version:"5.167"},t).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"video.search",data:e}),e))).then(K)),ge=(e,t)=>{const s=(0,r._)({extended:1},e);return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"video.get",data:s}),(0,i.getApiWrapper)()()("video.get",s,void 0,t).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"video.get",data:e}),e)))},ue=((0,i.createApi)("video.save"),(0,i.createApi)("video.replaceThumb"),(0,i.createApi)("video.getThumbsUploadServer")),ce=(0,i.createApi)("video.startStreaming"),he=(0,i.createApi)("video.editStreaming"),me=(0,i.createApi)("video.delete"),ye=(e,{userId:t,isAnon:s=!1,secret:a,search:o},d)=>{const p="messages.getCallParticipants",g={call_id:e,fields:h,search:o},u=s?(0,r._)({},g,{device_id:"anyId",secret:a,user_id:t}):g;return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:p,params:u}),(0,i.getApiWrapper)(!s)()(p,u,{version:n.API_VERSION},d).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:p,data:e}),{count:e.count,secret:e.secret,profiles:e.profiles||[],anonyms:e.anonyms||[],groups:e.groups||[]})))},_e=(e={},t)=>{const s="calls.getReactions";return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:s,params:e}),(0,i.getApiWrapper)()()(s,e,void 0,t).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:s,data:e}),e)))},be=(e,t)=>{const s="calls.getCallJoinHistory";return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:s,params:e}),(0,i.getApiWrapper)()()(s,e,void 0,t).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:s,data:e}),e.csv)))},fe=(e,t)=>{const s="calls.getParticipants";e.fields=h,(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:s,params:e});return(0,i.getApiWrapper)()()(s,e,void 0,t).then((e=>((0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:s,data:e}),e)))},ve=()=>Ce("calls.getUserSettings",{},{maxRetries:0}),Me=e=>Ce("calls.setUserSettings",e);function Ce(e,t,s,a){return we.apply(this,arguments)}function we(){return(we=(0,a._)((function*(e,t,s,a){(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:e,params:t});const r=(0,i.getApiWrapper)(),n=yield r()(e,t,s,a);return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:e,data:n}),n}))).apply(this,arguments)}const De=e=>(0,i.getApiWrapper)()()("calls.editParticipantName",e).then((e=>e)),Te=e=>(0,i.getApiWrapper)()()("calls.deleteParticipantName",e).then((e=>e)),Ee=e=>(0,i.getApiWrapper)()()("calls.checkParticipantName",e,void 0).then((e=>e));function Ae(e,t,s){const a={anonym_auth_user_id:e,secret:t,device_id:s};return(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"request",method:"calls.subscribeToQueue",data:a}),(0,i.getApiWrapper)()()("calls.subscribeToQueue",a).then((e=>{(0,l.debugMessage)(l.DebugMessageType.DEBUG,{type:"response",method:"calls.subscribeToQueue",response:e});const{secret:t,queue_subscription_info:s}=e;return{secret:t,queue_subscription_info:s}}))}function ke(e,t){const{base_url:s,queues:a}=e.queue_subscription_info,{key:r,timestamp:n}=a[0];return`${s}?act=a_check&key=${r}&id=${t}&ts=${n}&wait=20`}const Ue=(0,i.createApi)("calls.getAsrTranscriptions"),Be=((0,i.createApi)("calls.editAsrTranscription"),(0,i.createApi)("calls.deleteAsrTranscriptions"));function Ge(){return(Ge=(0,a._)((function*(){const e=yield Ce("calls.getSettings",{}),t=Object.fromEntries(e.toggles.map((e=>[e.name,e.enabled])));return(0,r._)({},e,{toggles:t})}))).apply(this,arguments)}function Se(){return Se=(0,a._)((function*(){const e=yield function(){return Ge.apply(this,arguments)}();return{user:{firstName:"",lastName:"",sex:0,link:"",peerId:0,photo:"",photo_100:"",isClosed:!1,canAddMembers:!0,name:"",shortName:""},privacySettings:{callsIp:"friends"},params:e,activeCall:null}})),Se.apply(this,arguments)}function Pe(){return(Pe=(0,a._)((function*(e){var t;const s="calls_ip",a=`\n  var settings = fork(API.calls.getSettings());\n  var privacy = fork(\n    API.account.getPrivacySettings({\n      privacy_keys: '${s}',\n      need_default: 0,\n    })\n  );\n  var activeIncomingCalls = fork(\n    API.messages.getInboundCalls()\n  );\nreturn [\n  wait(settings),\n  wait(privacy),\n  wait(activeIncomingCalls),\n  API.users.get({\n    user_ids: ${String(e)},\n    fields: '${["animated_avatar","is_nft","photo_100","photo_200","maiden_name","sex","screen_name","domain"].join(",")}',\n  }),\n];\n  `,[n,o,i,l]=yield Ce("execute",{code:a}),[d]=l;var p,u,c,h;const m={firstName:null!=(p=d.first_name)?p:"",lastName:null!=(u=d.last_name)?u:"",sex:null!=(c=d.sex)?c:0,link:(0,g.getOwnerHref)(d),peerId:d.id,photo:d.photo_200,photo_100:d.photo_100,isClosed:null!=(h=d.is_closed)&&h,canAddMembers:!0,name:(0,g.getOwnerFullName)(d),shortName:(0,g.getOwnerShortName)(d),animated_avatar:d.animated_avatar},y=o.settings.find((e=>e.key===s)),_={callsIp:"friends"};y&&"category"in y.value&&(_.callsIp=y.value.category);const b=Object.fromEntries(n.toggles.map((e=>[e.name,e.enabled])));var f;const v=null!=(f=null==(t=i.items)?void 0:t.shift())?f:null;return{user:m,privacySettings:_,params:(0,r._)({},n,{toggles:b}),activeCall:v}}))).apply(this,arguments)}function Ie(e){return We.apply(this,arguments)}function We(){return We=(0,a._)((function*(e){const t=!u.Ranges.isUserId(e),{user:s,privacySettings:a,params:r,activeCall:n}=t?yield function(){return Se.apply(this,arguments)}():yield function(e){return Pe.apply(this,arguments)}(e),{toggles:o,settings:i}=r;return{settings:i,toggles:o,callsCredentials:{key:i.public_key,is_dev:i.is_dev,privacySettings:a,ip_setting_enabled:i.ip_setting_enabled,me:s},activeCall:n}})),We.apply(this,arguments)}function qe(e,t){return Ce("calls.getConversationByCall",{call_id:e,hall_id:t})}},701822:(e,t,s)=>{s.d(t,{fetchCallToken:()=>o});var a=s(11010),r=s(204651);let n;function o(e){return i.apply(this,arguments)}function i(){return(i=(0,a._)((function*(e,t=!1){if(n)return n;const s=(0,r.getLocalToken)(e);return s?(n=Promise.resolve(s),n):(n=(0,r.fetchToken)(t),n.then((t=>(0,r.saveLocalToken)(t,e))),n)}))).apply(this,arguments)}},442426:(e,t,s)=>{var a,r;s.d(t,{ECallLongpollEntityType:()=>a,ECallLongpollType:()=>r}),function(e){e.Calls="calls"}(a||(a={})),function(e){e.ScheduledCallsUpdate="scheduled_calls_update",e.CurrentCallsUpdate="current_calls_update",e.ChatInfoUpdated="chat_info_updated",e.CallAccepted="call_accepted",e.IncomingCall="incoming_call",e.CallFinished="call_finished",e.ParticipantNameChanged="participant_name_changed"}(r||(r={}))},640467:(e,t,s)=>{s.d(t,{CredentialCache:()=>r});var a=s(434788);class r{put(e){this.data=e}update(e){this.data&&(this.data=(0,a._)({},this.data,{ts:e}))}get(){return this.data}drop(){this.data=null}}},184016:(e,t,s)=>{s.d(t,{startQueueManager:()=>g});var a=s(11010),r=s(162532),n=s(167096),o=s(442426),i=s(640467);const l=6287487,d=new i.CredentialCache,p=1;function g(e,t){return u.apply(this,arguments)}function u(){return(u=(0,a._)((function*(e,t){const s=()=>{const i=new n.QueueManager,g=`calls_${e}_${l}_0`,u=(0,a._)((function*(){const t=d.get();if(t)return t;const s=yield(0,r.queueSubscribe)({queue_ids:g}),{base_url:a,queues:n}=s,{key:o,timestamp:i}=n[0],l={id:e,key:o,ts:i,url:a};return d.put(l),l}));i.addQueue(g,u),i.subscribe((0,a._)((function*(e,s){var a,r;s.failed&&s.failed!==p?d.drop():(d.update(Number(s.ts)),s.failed!==p&&(!(null==(a=window.Calls)?void 0:a.handleQueueEvent)&&s.events.some((e=>e.data.type===o.ECallLongpollType.IncomingCall))&&(yield t()),(null==(r=window.Calls)?void 0:r.handleQueueEvent)&&s.events.forEach((e=>{var t;null==(t=window.Calls)||t.handleQueueEvent(e)}))))})),(()=>{console.log("reset"),i.destroy(),s()}))};s()}))).apply(this,arguments)}},204651:(e,t,s)=>{s.d(t,{fetchToken:()=>d,getLocalToken:()=>l,saveLocalToken:()=>i});var a=s(11010),r=s(659397),n=s(162532);const o=e=>"calls_token"+(e?`_${e}`:"");function i(e,t){r.localStorage.setItem(o(t),e)}function l(e){return r.localStorage.getItem(o(e))}function d(e){return p.apply(this,arguments)}function p(){return(p=(0,a._)((function*(e){const{token:t}=yield(0,n.getCallAuthToken)(e);return t}))).apply(this,arguments)}},42977:(e,t,s)=>{s.d(t,{BaseSexEnumNames:()=>a});const a={UNKNOWN:0,FEMALE:1,MALE:2}},167096:(e,t,s)=>{s.d(t,{QueueManager:()=>r});var a=s(373472);class r{addQueue(e,t){var s;return null==(s=this._transport)||s.addQueue(e,t),this}removeQueue(e){var t;return null==(t=this._transport)||t.removeQueue(e),this}subscribe(e,t){var s;return null==(s=this._transport)||s.subscribe(e,t),this}destroy(){var e;null==(e=this._transport)||e.destroy()}constructor(){this._transport=null,"undefined"!=typeof SharedWorker?this._transport=new a.SharedWorkerTransport:console.warn("Shared Worker not supported")}}},373472:(e,t,s)=>{s.d(t,{SharedWorkerTransport:()=>o});var a=s(11010),r=s(172045),n=s(321609);class o{_postMessage(e){this._worker.port.postMessage(e)}_handleMessage(e){switch("ping"!==e.data.type&&console.log("Message received from worker\n",e.data),e.data.type){case"ping":e.data.payload===this._clientId&&(this._postMessage({type:"pong"}),this._checkKeepAlivePortInterval());break;case"longpoll-event":var t;if(e.data.payload.clientId===this._clientId)null==(t=this._onMessage)||t.call(this,e.data.payload.queueId,e.data.payload.data);break;case"request-credentials":e.data.payload.clientId===this._clientId&&this._requestCredentials(e.data.payload.queueId)}}_checkKeepAlivePortInterval(){this._keepAliveTimeout&&clearTimeout(this._keepAliveTimeout),this._keepAliveTimeout=setTimeout((()=>{var e;return null==(e=this._onReset)?void 0:e.call(this)}),n.TO_PORT_PING_INTERVAL+n.TO_PORT_PING_INTERVAL/2)}_setBeforeUnloadListener(){const e=()=>this.destroy();return window.addEventListener("beforeunload",e),e}_requestCredentials(e){var t=this;return(0,a._)((function*(){const s=t._credentialsGetters.get(e);if(s&&!t._credentialsProcessing.has(e)){t._credentialsProcessing.add(e);try{const a=yield s();t._postMessage({type:"set-credentials",payload:{queueId:e,params:a}})}catch(e){console.error("[SharedWorkerTransport][_requestCredentials]",e)}finally{t._credentialsProcessing.delete(e)}}}))()}destroy(){this._postMessage({type:"disconnect",payload:this._clientId}),this._worker.port.close(),window.removeEventListener("beforeunload",this._onBeforeUnloadLink),this._onMessage=null,this._onReset=null}addQueue(e,t){this._credentialsGetters.set(e,t),this._postMessage({type:"add-queue",payload:{queueId:e}})}subscribe(e,t){this._onMessage=e,this._onReset=t}removeQueue(e){this._credentialsGetters.delete(e),this._postMessage({type:"remove-queue",payload:{queueId:e}})}constructor(){this._onReset=null,this._onMessage=null,this._keepAliveTimeout=null,this._clientId=(0,r.default)(),this._worker=new SharedWorker(new URL(s.p+s.u(63023),s.b)),this._onBeforeUnloadLink=this._setBeforeUnloadListener(),this._credentialsGetters=new Map,this._credentialsProcessing=new Set,this._worker.onerror=e=>console.error(e),this._worker.port.onmessage=e=>this._handleMessage(e),this._postMessage({type:"debug",payload:!0}),this._postMessage({type:"connect",payload:this._clientId}),this._worker.port.start(),this._checkKeepAlivePortInterval()}}},321609:(e,t,s)=>{s.d(t,{TO_PORT_PING_INTERVAL:()=>a,TO_PORT_PING_REPLY_WAIT:()=>r});const a=1e4,r=1e3},654198:(e,t,s)=>{s.d(t,{getOwnerFullName:()=>i,getOwnerHref:()=>o,getOwnerShortName:()=>l,isOwnerGroup:()=>n,isOwnerUser:()=>r});var a=s(42977);const r=e=>"first_name"in e,n=e=>"name"in e;function o(e,t=!1){const s=`/${e.screen_name||e.domain||`id${e.id}`}`;return t?window.location.origin+s:s}function i(e){let t="";return e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim()}`),e.maiden_name&&e.sex===a.BaseSexEnumNames.FEMALE&&(t+=` (${e.maiden_name.trim()})`),t}function l(e){let t="";return e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim().slice(0,1)}.`),t}}},i={};function l(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={id:e,loaded:!1,exports:{}};return o[e].call(s.exports,s,s.exports,l),s.loaded=!0,s.exports}l.m=o,l.amdO={},e=[],l.O=(t,s,a,r)=>{if(!s){var n=1/0;for(p=0;p<e.length;p++){for(var[s,a,r]=e[p],o=!0,i=0;i<s.length;i++)(!1&r||n>=r)&&Object.keys(l.O).every((e=>l.O[e](s[i])))?s.splice(i--,1):(o=!1,r<n&&(n=r));if(o){e.splice(p--,1);var d=a();void 0!==d&&(t=d)}}return t}r=r||0;for(var p=e.length;p>0&&e[p-1][2]>r;p--)e[p]=e[p-1];e[p]=[s,a,r]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var r=Object.create(null);l.r(r);var n={};t=t||[null,s({}),s([]),s(s)];for(var o=2&a&&e;"object"==typeof o&&!~t.indexOf(o);o=s(o))Object.getOwnPropertyNames(o).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,l.d(r,n),r},l.d=(e,t)=>{for(var s in t)l.o(t,s)&&!l.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((t,s)=>(l.f[s](e,t),t)),[])),l.u=e=>25394===e?"AudioLongtapModal.2932c6e9c6120eff2657.js":24817===e?"hls.7bfefe299fa92971b99a.js":75980===e?"menu_settings.3ea04534d06cb6d38e2c.js":96816===e?"web-audio-lyrics-modal.218229d2232b2e3d93fb.js":9375===e?"voice_message_player.e464fba002f2d3244773.js":28762===e?"speech.be0c329a1eff7c81577d.js":57468===e?"SilentModeForms.81e354f9bd61dfd364b5.js":96248===e?"feed-skeleton.add07457f9a9b141ed5a.js":59240===e?"performance-stats.4b38c82ee7bdbd67bf4a.js":63023===e?e+".5f136a88c441b3153417.js":38288===e?"lottie.5e4758c39f106eab733a.js":void 0,l.miniCssF=e=>e+"."+{25394:"6af57e1b0cf5a74f9a87",57468:"35be3dfa1e90e3cdd0a1",75980:"5bbee2c9f3e189193a73"}[e]+".css",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a={},l.l=(e,t,s,r)=>{if(a[e])a[e].push(t);else{var n,o;if(void 0!==s)for(var i=document.getElementsByTagName("script"),d=0;d<i.length;d++){var p=i[d];if(p.getAttribute("src")==e||p.getAttribute("data-webpack")=="vk:"+s){n=p;break}}n||(o=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,l.nc&&n.setAttribute("nonce",l.nc),n.setAttribute("data-webpack","vk:"+s),n.src=e),a[e]=[t];var g=(t,s)=>{n.onerror=n.onload=null,clearTimeout(u);var r=a[e];if(delete a[e],n.parentNode&&n.parentNode.removeChild(n),r&&r.forEach((e=>e(s))),t)return t(s)},u=setTimeout(g.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=g.bind(null,n.onerror),n.onload=g.bind(null,n.onload),o&&document.head.appendChild(n)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="/dist/",r=e=>new Promise(((t,s)=>{var a=l.miniCssF(e),r=l.p+a;if(((e,t)=>{for(var s=document.getElementsByTagName("link"),a=0;a<s.length;a++){var r=(o=s[a]).getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(r===e||r===t))return o}var n=document.getElementsByTagName("style");for(a=0;a<n.length;a++){var o;if((r=(o=n[a]).getAttribute("data-href"))===e||r===t)return o}})(a,r))return t();((e,t,s,a)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.onerror=r.onload=n=>{if(r.onerror=r.onload=null,"load"===n.type)s();else{var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=o,l.request=i,r.parentNode.removeChild(r),a(l)}},r.href=t,document.head.appendChild(r)})(e,r,t,s)})),n={21436:0},l.f.miniCss=(e,t)=>{n[e]?t.push(n[e]):0!==n[e]&&{25394:1,57468:1,75980:1}[e]&&t.push(n[e]=r(e).then((()=>{n[e]=0}),(t=>{throw delete n[e],t})))},(()=>{l.b=document.baseURI||self.location.href;var e={21436:0};l.f.j=(t,s)=>{var a=l.o(e,t)?e[t]:void 0;if(0!==a)if(a)s.push(a[2]);else if(75980!=t){var r=new Promise(((s,r)=>a=e[t]=[s,r]));s.push(a[2]=r);var n=l.p+l.u(t),o=new Error;l.l(n,(s=>{if(l.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var r=s&&("load"===s.type?"missing":s.type),n=s&&s.target&&s.target.src;o.message="Loading chunk "+t+" failed.\n("+r+": "+n+")",o.name="ChunkLoadError",o.type=r,o.request=n,a[1](o)}}),"chunk-"+t,t)}else e[t]=0},l.O.j=t=>0===e[t];var t=(t,s)=>{var a,r,[n,o,i]=s,d=0;if(n.some((t=>0!==e[t]))){for(a in o)l.o(o,a)&&(l.m[a]=o[a]);if(i)var p=i(l)}for(t&&t(s);d<n.length;d++)r=n[d],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(p)},s=self.webpackChunkvk=self.webpackChunkvk||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var d=l.O(void 0,[75514,98066,56990,24509,76400,40885,76429,68592,50320,3601],(()=>l(544176)));d=l.O(d)})();